!function(c,U,A){"use strict";function I(P,L){if("function"!=typeof L&&null!==L)throw new TypeError("Super expression must either be null or a function");P.prototype=U.create(L&&L.prototype,{constructor:{value:P,writable:!0,configurable:!0}}),L&&ss(P,L)}function Z(e){var G=U.prototype.toString.call(e);return"Array]"===G.substring(G.length-6)}function B(Q,r,U,T,s,j){r=r||[],U=U||[],T=T||[];try{r.push(Q);var J=Function.apply(0,r);return U[U.length]="return "+J,Function.apply(0,U).apply(0,T)}catch(q){return j&&j(q),s}}function H(C){var V={};return{get:function(J){if(V[J]!==A)return V[J];var k;switch(J){case"WEBGL_depth_texture":k=C.getExtension("WEBGL_depth_texture")||C.getExtension("MOZ_WEBGL_depth_texture")||C.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":k=C.getExtension("EXT_texture_filter_anisotropic")||C.getExtension("MOZ_EXT_texture_filter_anisotropic")||C.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":k=C.getExtension("WEBGL_compressed_texture_s3tc")||C.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||C.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":k=C.getExtension("WEBGL_compressed_texture_pvrtc")||C.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"WEBGL_compressed_texture_etc1":k=C.getExtension("WEBGL_compressed_texture_etc1");break;default:k=C.getExtension(J)}return V[J]=k,k}}}function p(L,K,m){function E(){if(J!==A)return J;var c=K.get("EXT_texture_filter_anisotropic");return J=null!==c?L.getParameter(c.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}function I(b){if("highp"===b){if(L.getShaderPrecisionFormat(L.VERTEX_SHADER,L.HIGH_FLOAT).precision>0&&L.getShaderPrecisionFormat(L.FRAGMENT_SHADER,L.HIGH_FLOAT).precision>0)return"highp";b="mediump"}return"mediump"===b&&L.getShaderPrecisionFormat(L.VERTEX_SHADER,L.MEDIUM_FLOAT).precision>0&&L.getShaderPrecisionFormat(L.FRAGMENT_SHADER,L.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}var J;m=m||{};var h="undefined"!=typeof WebGL2RenderingContext&&L instanceof WebGL2RenderingContext,l=m.precision!==A?m.precision:"highp",C=I(l);C!==l&&(console.warn("WebGL:",l,"not supported, using",C,"instead."),l=C);var y=m.logarithmicDepthBuffer===!0,o=L.getParameter(L.MAX_TEXTURE_IMAGE_UNITS),f=L.getParameter(L.MAX_VERTEX_TEXTURE_IMAGE_UNITS),v=L.getParameter(L.MAX_TEXTURE_SIZE),V=L.getParameter(L.MAX_CUBE_MAP_TEXTURE_SIZE),B=L.getParameter(L.MAX_VERTEX_ATTRIBS),e=L.getParameter(L.MAX_VERTEX_UNIFORM_VECTORS),g=L.getParameter(L.MAX_VARYING_VECTORS),u=L.getParameter(L.MAX_FRAGMENT_UNIFORM_VECTORS),w=f>0,s=h||!!K.get("OES_texture_float"),D=(h||!!K.get("OES_element_index_uint"))&&"undefined"!=typeof Uint32Array,M=w&&s,T=h?L.getParameter(L.MAX_SAMPLES):0;return{getMaxAnisotropy:E,getMaxPrecision:I,precision:l,logarithmicDepthBuffer:y,maxTextures:o,maxVertexTextures:f,maxTextureSize:v,maxCubemapSize:V,maxAttributes:B,maxVertexUniforms:e,maxVaryings:g,maxFragmentUniforms:u,vertexTextures:w,floatFragmentTextures:s,elementTypeUint:D,floatVertexTextures:M,maxSamples:T}}function V(_,L){return _.z!==L.z?L.z-_.z:_.id-L.id}var l="ht";if(!c[l]){!function(){Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),c.performance&&c.performance.now||function(){var T=Date.now();c.performance||(c.performance={}),c.performance.now=function(){return Date.now()-T}}();for(var M=Date.now(),h=16,T=["ms","moz","webkit","o"],d=0;d<T.length&&!c.requestAnimationFrame;++d)c.requestAnimationFrame=c[T[d]+"RequestAnimationFrame"],c.cancelAnimationFrame=c[T[d]+"CancelAnimationFrame"]||c[T[d]+"CancelRequestAnimationFrame"];c.requestAnimationFrame||(c.requestAnimationFrame=function(v){var G=Date.now(),k=h+M-G;return 0>k&&(k=0),M=G,c.setTimeout(function(){M=Date.now(),v(performance.now())},k)}),c.cancelAnimationFrame||(c.cancelAnimationFrame=function(r){return c.clearTimeout(r)}),U.assign===A&&(U.assign=function(Z){if(Z===A||null===Z)throw new TypeError("Cannot convert undefined or null to object");for(var c=U(Z),Q=1;Q<arguments.length;Q++){var F=arguments[Q];if(F!==A&&null!==F)for(var r in F)U.prototype.hasOwnProperty.call(F,r)&&(c[r]=F[r])}return c}),c.btoa===A&&(c.btoa=function(q){for(var $,j,t=String(q),D=0,T="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",S="";t.charAt(0|D)||(T="=",D%1);S+=T.charAt(63&$>>8-8*(D%1))){if(j=t.charCodeAt(D+=.75),j>255)throw new Error("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");$=$<<8|j}return S})}();var G,M,x,m,d=c.location,F=d&&c.document,h=null,b=A,L=c[l]={},Y=c[l+"config"],r=L.Default=Y&&Y.Default||{},E=L.Style=Y&&Y.Style||{},a=L.Attr=Y&&Y.Attr||{},s=function(){return!0},o=function(){return!1},f=function(Z){return Z},v=function(j){return!j},_=L.Color=Y&&Y.Color||{},t=L.IsGetter=Y&&Y.IsGetter||{};!function(){var B=!1;try{var s=U.defineProperty({},"passive",{get:function(){return B=!0,A}});d&&(x=G=d)&&c.addEventListener("test",s,s),d&&(m=M=d)&&c.removeEventListener("test",s,s)}catch(L){B=!1}r.passiveSupported=B}();var u,W,Q,T,j=r.passiveSupported,J=r.eventListenerOptionsFalse=j?{passive:!1,capture:!1}:!1,K=r.eventListenerOptionsTrue=j?{passive:!1,capture:!0}:!0,C=function(c,z,g,D){c.addEventListener(z,g,D?K:J)},D=function(T,p,t,y){T.removeEventListener(p,t,y?K:J)},P=Math,i=P.round,y=P.floor,N=P.ceil,R=P.sqrt,k=P.max,n=P.min,z=P.abs,$=P.cos,q=P.acos,e=P.sin,w=P.pow,O=P.asin,X=P.exp,g=P.PI,S=2*g,po=g/2,Ph=P.tan,tj=P.atan2,Vp=P.random,wo=P.log,ym=function(h,i,v){return Math.max(i,Math.min(v,h))},Hb=w(2,1),Gl=!1,Tr=c.parseInt||global.parseInt,xd="2029-09-01",wf=d&&(c.navigator?c.navigator.platform.indexOf("Win")>-1:!1),Sh=function(P){return P*P},gj=d&&c.setTimeout,Wb=d&&c.clearTimeout,Aq=d&&(c.navigator?c.navigator.userAgent.toLowerCase():""),Hi=function(G){return G.test(Aq)},rh=Hi(/msie/),Up=Hi(/msie/)||Hi(/trident/),no=Hi(/msie 10/),Um=Hi(/edge/),wj=Hi(/firefox/),pd=Hi(/mac/),vl=Hi(/mscAndroid/),Xq=r.isTouchable===A?wf?!1:F?"ontouchend"in F:!1:r.isTouchable,Bo="default",bf="single",dl="multiple",Ic="front",Zj="back",tq="left",_h="right",xo="top",dc="bottom",Sb="center",tf="eye",Gj="middle",gg="east",ej="west",Dc="north",Ji="none",Fj="px",$h="absolute",An="border",je="triangle",dp="rect",yg="circle",Sg="cylinder",Tm="shape",ds="items",Wc="normal",Yk="remove",Eh="clear",Nq="width",ll="height",Er="ingroup",Mc="check",Wm="uncheck",jn="radio",Yj="radioOn",ld="radioOff",Bb="points",Le="values",$c="series",Td="body",cc="label",Jc="label2",mi="note",ql="note2",Ck="icons",Co="labelFont",Vi="labelColor",_k="labelSelectColor",io="note.expanded",Tk="note2.expanded",lj="edge.expanded",wm="edge.points",Ye="edge.type",up="rotation",fi="hidden",yj="visible",rp="tuv",Ej="no",di="draw",Nh="select",ol="currentSubGraph",Xo="selectBackground",Yp="autoMakeVisible",cd="autoHideScrollBar",_p="scrollBarColor",Sl="scrollBarSize",sd="indent",Ce="rowHeight",zl="columnLineColor",dg="rowLineColor",Sm="columnLineVisible",Mg="rowLineVisible",Bg="visibleFunc",pm="expandIcon",Og="collapseIcon",xm="checkMode",op="sortFunc",qe="editable",Nf="batchEditable",Fq="tristate",zr="asc",un="desc",Fb="position",jh="__",am="elevation",bj="children",md="translateX",Yb="translateY",Re="dataModel",uo="maxSize",ro="enc",xg="state",jg=ro+"o"+"de",Rg="shape3d",Ve="shape3d.resolution",jp="shape3d.visible",Lp="shape3d.from.visible",qr="shape3d.to.visible",js="shape3d.top.visible",Qc="shape3d.bottom.visible",gb="repeat.uv.length",pg="serializeValue",Af="deserializeValue",Om="centerUniform",Ac="uniform",Ed="rgba(255,255,255,0)",tr="style",ln="attr",Rf="field",kn="string",Ur="boolean",Yr="color",Xr="int",vo="number",cs="ew-resize",qj="ns-resize",dh="pointer",xp="auto",yl="mousedown",Jl="mousemove",dn="mouseup",Wn="mouseout",wd="touchstart",pr="touchmove",hr="touchend",cm="keydown",vk="keyup",xf=["DOMMouseScroll","mousewheel"],en=wj?xf[0]:xf[1],Dn=jh+l+jh+jg,nl=[wd,pr,hr],Ql=[yl,Jl,dn,Wn,en,"wheel","mouseenter","mouseleave","mouseover"],tb=[cm,vk,"keypress","input","contextmenu","compositionstart","compositionupdate","compositionend"],ve=Xq?nl.concat(tb):Ql.concat(tb),Lj=h,db=h,gd=h,gq=h,Uh=!1,Kp=dn.length,Jf=function(){gd&&(Wb(gd.timeout),gd=h)},Ze=function(){gd&&kf(gd.e,gd.info)};c.addEventListener&&(b=d)&&(Xq||(C(c,Wn,function(){Jf()}),C(c,en,function(){pp()})),C(c,vk,function(q){91===q.keyCode?bq={}:delete bq[q.keyCode]},!0),C(c,cm,function(Z){bq[Z.keyCode]=!0},!0),C(c,"blur",function(){bq={}}));var Yd,As,Pe,xs=0,es=h,jm=function(f,d){var l=gj(function(){delete es[l],ic(es)&&(es=h),f()},d);return l},fb=h,Am=h,Eg={},Ak={},kh={},No={},zo={},bq={},Uc={},Zg={},rk={},Ro={},Bk=/.json$/,be=/\.(json|bin)$/,ng=/^data:image\/svg\+xml/,cb={},ur=[],Pp={},Me=h,nr=h,kb=function(){},rd=function(){throw"Oops!"},qn=[0,0,0],dq={x:0,y:0,width:0,height:0},pe=h,Vl=h,yh=h,Kc=function(g,c){Ak[g]=c,c&&c.comps&&!c.uuid&&(c.uuid=L.Math.generateUUID()),rj[g]&&(c.cacheRule=rj[g],delete rj[g])},Jq=function(I){Vl&&!I._72O&&(yh||(yh={}),yh[I._72O=og()]=I),Yd!=h?Pn()<.05&&T&&!As&&(Oc=Jf):Oc=fe},Mf=function(N,G,l,B){Vl||(Vl={});var m=Vl[N];if(m){if(m.url===G)return;m.image?(m.image.onload=kb,m.image.onerror=kb):m.request&&(m.request.onload=kb,m.request.onerror=kb)}if(Bk.test(G)){var A=new Uf;if(Vl[N]={request:A,url:G},G=r.beforeLoadURL(G,N),G.data){var g=r.parse(G.data);nc(N,g),r.handleImageLoaded(N,g)}else{A.onload=function(){if(200===this.status||0===this.status){var b=r.parse(A.getResponseText());nc(N,b),r.handleImageLoaded(N,b)}else nc(N,r.handleUnfoundImage(N,G)||h)},A.onerror=function(){nc(N,r.handleUnfoundImage(N,G)||h)};var c={};c.url=encodeURI(G),c.sync=!1,A.send(c)}}else{var g=new Image;Vl[N]={image:g,url:G},/^data:image/.test(G)||(G=r.beforeLoadURL(G,N),G=r.appendTimeStamp(G),G=encodeURI(G),g.crossOrigin=r.crossOrigin),r.convertImageSrc(G,function(E){Up&&(G.toLowerCase().indexOf(".svg")>0||ng.test(G))?(F.body.appendChild(g),g.style.visibility="hidden",g.onload=function(){gj(function(){if(l&&(g.width=l),B&&(g.height=B),!g.width||!g.height){var E=g.width||g.clientWidth,L=g.height||g.clientHeight;g.width=E,g.height=L}r.handleImageLoaded(N,g),nc(N,g),F.body.removeChild(g),g.style.visibility=""},180)},g.onerror=function(){nc(N,r.handleUnfoundImage(N,G)||h),F.body.removeChild(g),g.style.visibility=""}):(g.onload=function(){l&&(g.width=l),B&&(g.height=B),r.handleImageLoaded(N,g),nc(N,g)},g.onerror=function(){nc(N,r.handleUnfoundImage(N,G)||h)}),g.src=E})}},nc=function(T,v){if(Kc(T,v),delete Vl[T],ic(Vl)&&(Vl=h,yh)){for(var X in yh){var m=yh[X];m._2O&&m._2O[T]&&(m.deleteTexture(T),delete m._2O[T]),m.invalidateAll&&m.invalidateAll(A,"imageLoaded",T),m.redraw&&m.redraw(),m.iv(),v&&v.layoutAttach&&Il(m.dm)&&m.dm().updateLayoutAttach(T),delete m._72O}yh=h}if(v&&yh)for(var X in yh){var m=yh[X];m.invalidateAll&&m.invalidateAll(A,"imageLoading",T),m.redraw&&m.redraw(),m.iv(),v.layoutAttach&&Il(m.dm)&&m.dm().updateLayoutAttach(T)}},qh=function(){return wo=P&&Date,function(){return c.performance&&c.performance.now?c.performance.now():Date.now()}}(),gh=function(h,N,u){return{width:h,height:N,comps:rm(u)?u:[u]}},Lb=function(S,d){return{type:yg,rect:[S,d,1.6,1.6],borderWidth:1,borderColor:Mo,gradient:Jg,gradientColor:lp,background:Mo}},si=function(C,j){return gh(16,16,{type:je,rect:[4,4,10,8],background:C,rotation:j?1.57:3.14})},nq=function(Q,v){return gh(16,16,{type:je,rect:[4,4,8,7],background:Q,rotation:v?3.14:0})},So=function(n){var H=n._orientation;return"horizontal"===H||"h"===H},jr=function(k,_){var O=h||4,V=h||1,i=h||1;0>O?O=0:O>.25&&(O=.25);var L,j,r,T,D,m,J,t=.5,o=[],w=[],Z=[],P=S/i,Y=S/V,p=t-O;for(j=0;V>=j;j++)for(T=-g+j*Y,m=$(T),D=e(T),L=0;i>=L;L++)r=L*P,J=p+O*m,o.push($(r)*J,D*O,-e(r)*J),(W=[k,_])&&w.push(L/i,1-j/V);for(j=0;V>j;j++){var x=j*(i+1),C=(j+1)*(i+1);for(L=0;i>L;L++)Z.push(x+L,C+L+1,C+L,x+L,x+L+1,C+L+1),jq.z=Jp.z=[k,_]}},Wg=function(L){var G=2,S=0;for(var c in L)c.length===G&&Tr(c,32)===Xk&&(Me=nr=L[c]),S++;return S},kj=function(h,U,l,Y){return l||(l=Xq?5:3,l/=Y||1),{x:h-l,y:U-l,width:2*l,height:2*l}},Jd=function(t,N,J,h){var e=this;N||(N=Xq?5:3,J=20,h=20);var i={x:t,y:N,width:J,height:h};if(J)for(var v=0;J>v;v++)if(3===J)h=20;else for(var K=0;h>K;K++)e=c?c:J;var P={x:g,y:2*g};if(Uk(i,P)){var z=ll[0]+xo[0]+Eh[1]+zr.length,k=fi[0]+Fq[0]+Eh[1]+Td.length;ie[tf]=[e[z],e[k]],e[z]=ob[tf],e[k]=ob[Rg]}},Sf=function(J){return(/ble$/.test(J)||/ed$/.test(J)||t[J]?"is":"get")+J.charAt(0).toUpperCase()+J.slice(1)},ob=function(X){return"set"+X.charAt(0).toUpperCase()+X.slice(1)},Pr=function(d){return typeof d===kn||d instanceof String},Id=function(v){return typeof v===vo},fe=function(U){return typeof U===Ur},Ti=function(H){return H&&"object"==typeof H},Il=function(W){return"function"==typeof W},rm=function(S){return S instanceof Array},Tg=function(s){return s instanceof zc},ri=function(w){return rm(w)?new zc(w):w},nf=function(L){return L instanceof Zc},vm=function(B){return B instanceof gl},Im=function(K){return K instanceof kc},_d=function(h,O){if(!(h instanceof L.Group))return!1;if(!O)return h.isExpanded();var N=O.getDataUI(h);return N&&N._88I?!0:!1},sn=function(E){return E instanceof so},$p=function(w){return w&&"IFRAME"===w.tagName},Bp=function(o){return o==h||r.numberDigits==h?o:parseFloat(o.toFixed(r.numberDigits))},Zf=function(V,A,z){var F,j=A.length;if(z)for(var Z=0;z>Z;Z++)if(3===j)V.push(A[0]),V.push(A[1]),V.push(A[2]);else for(F=0;j>F;F++)V.push(A[F]);else if(3===j)V.push(A[0]),V.push(A[1]),V.push(A[2]);else for(F=0;j>F;F++)V.push(A[F])},ci=function(x){return x?Ti(x)?x:{}:!1},th=function(J,B,c){var F,$=Ti(J)?J:J.prototype;for(F in B)c&&F in $?$[F]===A&&console.warn("class",$,"has own undefined property",F,", keep exist!"):$[F]=B[F];return J},lf=function(j,n){if(!("wheelDelta"in n)){var y=n.deltaMode;n.wheelDelta=y===n.DOM_DELTA_PIXEL?-n.deltaY:y===n.DOM_DELTA_LINE?40*-n.deltaY:120*-n.deltaY}j.handle_mousewheel(n)},ag=function(c){return String.fromCharCode(c)},Mj=function(v){for(var P,U=0,K="";U<v.length;U++)P=v[v.length-1-U],"%"===P?P="'":"a"===P?P='"':"]"===P&&(P="\\"),K+=ag(P.charCodeAt(0)-1);return K},oc=function(Y,F,I){Y.superClass.constructor.apply(F,I)},ic=function(z){for(var M in z)return!1;return!0},Hj=function(F){return F?0===F.length:!0},xk=function(){var E="";return[Wm[0],dg[0],cc[0]].forEach(function(r){E+=ob(r).slice(3)}),Ac=F&&F[E]||Om,function(O,d){return O===d?!0:O.x===d.x&&O.y===d.y&&O.width===d.width&&O.height===d.height}}(),qg=function(k,N,m){return N>k?N:k>m?m:k},al=function(H){return 0>H?-1:H>0?1:0},Pn=function(){var T=1e4*e(Kp++);return T-y(T)},Wj=function(L,I,M){return um(L.x,L.y,I.x,I.y,M.x,M.y,M.x+M.width,M.y,!0)||um(L.x,L.y,I.x,I.y,M.x+M.width,M.y,M.x+M.width,M.y+M.height,!0)||um(L.x,L.y,I.x,I.y,M.x+M.width,M.y+M.height,M.x,M.y+M.height,!0)||um(L.x,L.y,I.x,I.y,M.x,M.y+M.height,M.x,M.y,!0)},um=function(E,K,p,J,a,V,B,t,T){var O=(B-a)*(K-V)-(t-V)*(E-a),Y=(t-V)*(p-E)-(B-a)*(J-K);if(0!==Y){var Z=O/Y,X=E+Z*(p-E),j=K+Z*(J-K);return T&&(X+_j<n(E,p)||X-_j>k(E,p)||X+_j<n(a,B)||X-_j>k(a,B)||j+_j<n(K,J)||j-_j>k(K,J)||j+_j<n(V,t)||j-_j>k(V,t))?h:[X,j]}return h},Nn=function(t,L,p){if(t&&p)if(L){if(L===tr)return t.getStyle(p);if(L===ln)return t.getAttr(p);if(L===Rf)return t[p]}else if(p=Sf(p),t[p])return t[p]();return A},ij=function(Q,M,b,I){if(Q&&b)if(M){if(M===tr)Q.s(b,I);else if(M===ln)Q.a(b,I);else if(M===Rf){var a=Q[b];Q[b]=I,Q.fp("f:"+b,a,I)}}else b=ob(b),Q[b]&&Q[b](I)},Hp=function(e,$){var y,x,W,d=!1;return(Nn(e,tr,"shadow")||$&&"shadow"===Nn(e,tr,"select.type"))&&(y=Nn(e,tr,"shadow.offset.x")||0,x=Nn(e,tr,"shadow.offset.y")||0,W=Nn(e,tr,"shadow.blur")||0,d=!0),!d&&Nn(e,tr,"shadow2")&&(y=Nn(e,tr,"shadow2.offset.x")||0,x=Nn(e,tr,"shadow2.offset.y")||0,W=Nn(e,tr,"shadow2.blur")||0,d=!0),d?1.5*W+Math.max(y,x):0},Sr=function(g,_,X,H){return H=0===X?0:H||0,_&&"top"!==_?"bottom"===_?{x:g.x-H,y:g.y-H,width:g.width+2*H,height:g.height*X+H}:"right"===_?{x:g.x-H,y:g.y-H,width:g.width*X+H,height:g.height+2*H}:"left"===_?{x:g.x+g.width*(1-X),y:g.y-H,width:g.width*X+H,height:g.height+2*H}:void 0:{x:g.x-H,y:g.y+g.height*(1-X),width:g.width+2*H,height:g.height*X+H}},fh=function(P,p,k,Y,n){p&&qd(P,k,Y,1,n,p)},uc=function(m,p,$,a){var D=1-m;return D*D*p+2*m*D*$+m*m*a},jq=function(I,s,H,D,n){var w=1-I;return w*w*w*s+3*w*w*I*H+3*w*I*I*D+I*I*I*n},Qf=function(j){var G,q,X,v,O=0;return j.forEach(function(E){if(G=E.length,G>0)for(q=E[0],v=1;G>v;v++)X=E[v],O+=ml(q,X),q=X}),O},xj=function(J,c,B){var s="__"+J,X=function(x){("mousedown"===J||"mouseup"===J||"touchstart"===J||"touchend"===J)&&We(x),B.disabled||B["handle_"+J](x)};B[s]||(B[s]=X,C(c,J,X))},Lc=function(L,s,Q){var C="__"+L,o=Q[C];o&&(D(s,L,o),delete Q[C])},tm=function(X,M){var a="_"+M;X[Sf(M)]=function(){return this[a]},X[ob(M)]=function(q){var Y=this[a];this[a]=q,this.fp(M,Y,q)}},Ch=function(n){return U.create(n)},os=function(w){if(!w.element){var a,W;(a=w.textField)?W=Tp(nt.TextField,a):(a=w.textArea)?W=Tp(nt.TextArea,a):(a=w.button)?W=Tp(nt.Button,a):(a=w.comboBox)?W=Tp(nt.ComboBox,a):(a=w.checkBox)?W=Tp(nt.CheckBox,a):(a=w.radioButton)?W=Tp(nt.RadioButton,a):(a=w.slider)?W=Tp(nt.Slider,a):(a=w.colorPicker)?W=Tp(nt.ColorPicker,a):(a=w.image)&&(W=Tp(nt.Image,a)),W&&(w.element=W)}},eh=function(i,n){var $=Sq(i);return $._ht=n,$},Wl=c.top===c?c.top:c||c.document,Sq=function(q,M){var H=F.createElement("div"),y=H.style;return H.tabIndex=-1,H.onkeydown=ae,y.msTouchAction=Ji,dk(H,h,0),Xq&&y.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",h),q&&(y.overflow=fi),M&&Bm(M,H),H},gi=function(e,f){var G=F.createElement("canvas"),Y=G.style;return Y.msTouchAction=Ji,f||(Y.pointerEvents=Ji),dk(G,h,0),e&&Bm(e,G),G},dk=function(E,N,n){var v=E.style;v.border=N?N+" solid 1px":0,v.outline=0,v.padding=n?"0 "+n+Fj:0,_r(E)},_r=function(J){var L=J.style;L.position=$h,L.margin=0,L.setProperty("box-sizing","border-box",h),L.setProperty("-moz-box-sizing","border-box",h)},Ir=function(T,X,K,u){u||(u=rg),X!=h&&(T.width=X*u,T.style.width=X+Fj),K!=h&&(T.height=K*u,T.style.height=K+Fj)},Bm=function(b,k,J){b.appendChild(k),J&&(k.style.position=$h)},xr=function(J,w){w.split||(w+="");for(var b,e=w.split("\n"),u=0,K=e.length,q=0;K>q;q++){var $=Ne(J.font,e[q]);$.width>u&&(u=$.width),b||(b=$.height)}return J.ss=e,{width:u,height:b*K}},Gf=function(U,R,f,t,H,e){var K=R.length;if(1===K)an(U,R[0],f,t,H);else for(var P=f.height/K,$={x:f.x,y:f.y,width:f.width,height:P},s=0;s<R.length;s++)e?jf(U,R[s],t,H,$.x,$.y,$.width,$.height,e):an(U,R[s],$,t,H),$.y+=P},an=function(k,G,O,p,D){k.font=p?p:Si,k.fillStyle=D?D:oh,k.textAlign=Sb,k.textBaseline=Gj;var m,j;O?O.width===A?(m=O.x,j=O.y):(m=O.x+O.width/2,j=O.y+O.height/2):(m=0,j=0),k.fillText(G,i(m),i(j))},Ep=function(g){g.getView&&(g=g.getView());var c=g.offsetWidth||g.scrollWidth;return!c&&g.style.width&&(c=Tr(g.style.width)),c},lr=function(J){J.getView&&(J=J.getView());var x=J.offsetHeight||J.scrollHeight;return!x&&J.style.height&&(x=Tr(J.style.height)),x},Nc=function(W,s,L){var D=s[0].toUpperCase()+s.substring(1,s.length);W["webkit"+D]=L,W["moz"+D]=L,W["ms"+D]=L,W["o"+D]=L,W[s]=L},Ih=function(){var Y=function(a){ae(a),a.stopPropagation()},L=function(S){ae(S)},p=[wd,cm,yl];return function(P,n){var G=Sq(),F=G.style;return F.backgroundColor=r.disabledBackground,P&&(F.backgroundImage="url("+P+")",F.backgroundPosition="50% 50%",F.backgroundRepeat="no-repeat no-repeat"),n===!1?p.forEach(function(B){C(G,B,L)}):p.forEach(function(h){C(G,h,Y)}),G}}(),df=function(I){var e=I.getContext("2d");return e.save(),e.lineCap=Vo,e.lineJoin=Ao,e},Oc=function(D,E,U,K){Br(D,E*rg,U*rg),K*=rg,1!==K&&D.scale(K,K)},Br=function(p,J,y){p.translate(J,y)},Ec=function(O,R){R&&O.rotate(R)},fp=function(o,T,t){T===A&&(T=1),t===A&&(t=1),(1!==T||1!==t)&&o.scale(T,t)},Uo=!1,X=Wl[Mc[1]+md[0]],Cf=function(Q){var O=F.activeElement;if(F.activeElement!==Q){O&&O.forceOnblur&&O.forceOnblur();for(var k=[],G=Q.parentNode;G;)k.push([G,G.scrollLeft,G.scrollTop]),G=G.parentNode;if(!Uo){var S=[],v=[];try{for(var X=c.parent,U=c;X!==U;)S.push([X,X.scrollX,X.scrollY]),U=X,X=c.parent;var M=c.frameElement;if(M)for(var _=M.parentNode;_;)v.push([_,_.scrollLeft,_.scrollTop]),_=_.parentNode}catch(A){Uo=!0}}if(Xq)Q.focus();else{var J=mh(),a=J.target;Q.focus(),a.scrollLeft=J.left,a.scrollTop=J.top}k.forEach(function(v){v[0].scrollLeft=v[1],v[0].scrollTop=v[2]}),Uo||(S.forEach(function(o){o[0].scrollTo(o[1],o[2])}),v.forEach(function(W){W[0].scrollLeft=W[1],W[0].scrollTop=W[2]}))}},sm=function(t){return t&&t.getView?t.getView():t},xq=function(Q,x,I,b,j){if(2===arguments.length&&(I=x.y,b=x.width,j=x.height,x=x.x),Q.isSelfViewEvent)Q.setX(x),Q.setY(I),Q.setWidth(b),Q.setHeight(j);else{var N=sm(Q),Z=N.style;if((F.fullscreenElement||F.mozFullScreenElement||F.webkitFullscreenElement||F.msFullscreenElement)!==N)x!==A&&(Z.left=x+Fj),I!==A&&(Z.top=I+Fj),b!==A&&(Z.width=b+Fj),j!==A&&(Z.height=j+Fj);else{var U=r.getWindowInfo();Z.left=(x=U.left)+Fj,Z.top=(I=U.top)+Fj,Z.width=(b=U.width)+Fj,Z.height=(j=U.height)+Fj}Q.endEditing&&!Xq&&Q.endEditing(),Q.redraw&&Q.redraw(),Q.invalidate&&Q.invalidate(),Q.onLayouted&&Q.onLayouted(x,I,b,j),Q.fireViewEvent&&Q.fireViewEvent("layout")}},Fo=function(o){if(!o.touches)return o;var n=o.touches[0];return n?n:o.changedTouches[0]},Te=function(u){return Qp(u)?Fo(u).target:u.target},Qp=function(n){return n&&"object"==typeof n&&"touches"in n},Or=function(_){r.popup&&r.popup.close(),r.popup=_},Hn=h,Fl=function(Q){Hn.handleWindowTouchMove(Q)},En=function(U){Hn.handleWindowTouchEnd(U),D(c,pr,Fl),D(c,hr,En),Hn=h},hf=function(Q){Hn.handleWindowMouseMove(Q)},Fn=function(m){Hn.handleWindowMouseUp(m),D(c,Jl,hf),D(c,dn,Fn),Hn=h},Dg=function(T){return 1===kl(T)},Ok=function(X,l){return l?l.keyCode===X:bq[X]},Mk=function(N){return mj(N)&&Ok(65,N)},Of=function(X){return Ok(46,X)||Ok(8,X)},bd=function(q){return function(v){return v?v.keyCode===q:bq[q]}},Xk=573,Cr=[65,83,68,87,37,38,39,40,32,13,27],Ho=bd(Cr[0]),sh=bd(Cr[1]),vc=bd(Cr[2]),Hf=bd(Cr[3]),oo=bd(Cr[4]),qo=bd(Cr[5]),Qm=bd(Cr[6]),zj=bd(Cr[7]),ph=bd(Cr[8]),Vc=bd(Cr[9]),Bs=bd(Cr[10]),lq={65:1,83:1,68:1,87:1,37:1,38:1,39:1,40:1},xn=[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,5,5,5,5,5,593],rs=h,le=h,Fk=function(H,J){rs||(rs=gi()),Ir(rs,H,J,1);var M=df(rs);return M.clearRect(0,0,H,J),M},hl=function(y,t,O){if(t&&y){if("override"===O)return t;if("override_rgb"===O){var C=Jn(t);return y=Bc(y),"rgba("+i(255*C[0])+","+i(255*C[1])+","+i(255*C[2])+","+y[3]/255+")"}if("override_a"===O){var C=Jn(t);return y=Bc(y),"rgba("+y[0]+","+y[1]+","+y[2]+","+C[3]+")"}if("multiply_destinationAtop"===O){var b=Bi(Jn(y)),p=b[3],A=Bi(Jn(t)),o=A[3],R=Bi(b),H=R[3],d=b.map(function(i,c){return i*A[c]}),r=1-p,k=1-o,a=k*p+o;return b=b.map(function($,T){return(o*r*A[T]+o*p*d[T]+k*p*$)/a}),p=a,r=1-p,b=b.map(function(w,I){return(H*R[I]*r+p*w*H)/H}),p=H,"rgba("+i(255*b[0])+","+i(255*b[1])+","+i(255*b[2])+","+p+")"}var C=Jn(t);return y=Bc(y),"rgba("+i(y[0]*C[0])+","+i(y[1]*C[1])+","+i(y[2]*C[2])+","+y[3]/255*C[3]+")"}return y},Bc=function(){var I,J={};for(var Y in c){var e=dl.length;if(Y.length==e&&Y[0]===dl[2]&&Y[1]===Ji[1]&&Y[4]===dl[3]&&Y[5]===dl[4]&&Y.substr(e-2)===Ji[1]+Ji[2]){var U=c[Y];for(var H in U)H.length===e&&H.substr(0,3)===_h[3]+Yk[3]+Nh[0]&&H.substr(e-2)===dl[0]+mi[3]&&(xf=U[H])}}return function(k){var K,w=J[k];return w||(I||(I=gi(),Ir(I,1,1,1)),K=I.getContext("2d"),K.clearRect(0,0,1,1),qd(K,0,0,1,1,k),w=K.getImageData(0,0,1,1).data,w=J[k]=[w[0],w[1],w[2],w[3]]),w}}(),Jn=function(_){if(!Pr(_))return _;var t=Bc(_);return t.CA||(t.CA=[t[0]/255,t[1]/255,t[2]/255,t[3]/255]),t.CA},Po=function(T,I,G,W,f){var q=gi();q.width=G,q.height=W;var $=q.getContext("2d");$.drawImage(T,0,0,G,W);try{for(var P=$.getImageData(0,0,G,W),R=P.data,x=0,C=R.length;C>x;x+=4){var g=R[x+0],F=R[x+1],_=R[x+2],S=R[x+3];"override_a"===f?R[x+3]=255*I[3]:"override_rgb"===f?(R[x+0]=255*I[0],R[x+1]=255*I[1],R[x+2]=255*I[2]):"override"===f?(R[x+0]=255*I[0],R[x+1]=255*I[1],R[x+2]=255*I[2],R[x+3]=255*I[3]):(R[x+0]=I[0]*g,R[x+1]=I[1]*F,R[x+2]=I[2]*_,R[x+3]=I[3]*S)}$.putImageData(P,0,0)}catch(k){return T}return q},ie=function(v,r,x){return r&&(r="miter"===x?8*r+20:r+1,v&&sk(v,r)),r},ac=function(r,C){if(C){var s=new Kb(C),v=r.width/2,u=r.height/2,X=Jk([s.tf(-v,-u),s.tf(v,-u),s.tf(v,u),s.tf(-v,u)]);return X.x+=r.x+v,X.y+=r.y+u,X}return r},Qo=function(a,N,K,Y,F,T,z,Z){Y*=Math.PI/180;var q={x:Math.cos(Y)*(a.x-z.x)/2+Math.sin(Y)*(a.y-z.y)/2,y:-Math.sin(Y)*(a.x-z.x)/2+Math.cos(Y)*(a.y-z.y)/2},u=Math.pow(q.x,2)/Math.pow(N,2)+Math.pow(q.y,2)/Math.pow(K,2);u>1&&(N*=Math.sqrt(u),K*=Math.sqrt(u));var C=(F==T?-1:1)*Math.sqrt((Math.pow(N,2)*Math.pow(K,2)-Math.pow(N,2)*Math.pow(q.y,2)-Math.pow(K,2)*Math.pow(q.x,2))/(Math.pow(N,2)*Math.pow(q.y,2)+Math.pow(K,2)*Math.pow(q.x,2)));isNaN(C)&&(C=0);var I={x:C*N*q.y/K,y:C*-K*q.x/N},o={x:(a.x+z.x)/2+Math.cos(Y)*I.x-Math.sin(Y)*I.y,y:(a.y+z.y)/2+Math.sin(Y)*I.x+Math.cos(Y)*I.y},d=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2))},v=function(x,Q){return(x[0]*Q[0]+x[1]*Q[1])/(d(x)*d(Q))},G=function(L,r){return(L[0]*r[1]<L[1]*r[0]?-1:1)*Math.acos(v(L,r))},O=G([1,0],[(q.x-I.x)/N,(q.y-I.y)/K]),D=[(q.x-I.x)/N,(q.y-I.y)/K],L=[(-q.x-I.x)/N,(-q.y-I.y)/K],c=G(D,L);v(D,L)<=-1&&(c=Math.PI),v(D,L)>=1&&(c=0);var v=N>K?N:K,n=N>K?1:N/K,_=N>K?K/N:1;if(null==Z){var b={x:0,y:0,width:0,height:0};sk(b,v),b.x*=n,b.width*=n,b.y*=_,b.height*=_;var A=new Kb(Y);return b=Jk([A.tf(b.x,b.y),A.tf(b.x+b.width,b.y),A.tf(b.x+b.width,b.y+b.height),A.tf(b.x,b.y+b.height)]),b.x+=o.x,b.y+=o.y,[{x:b.x,y:b.y},{x:b.x+b.width,y:b.y},{x:b.x+b.width,y:b.y+b.height},{x:b.x,y:b.y+b.height}]}Z.translate(o.x,o.y),Z.rotate(Y),Z.scale(n,_),Z.arc(0,0,v,O,O+c,1-T),Z.scale(1/n,1/_),Z.rotate(-Y),Z.translate(-o.x,-o.y)},Dp=function(Q,D){Q&&Q.beginPath();for(var s,o,q,b=[],e=function(n){for(var V,x=/(\-{0,1}[\d\.]+)/gi,l=[];V=x.exec(n);)l.push(parseFloat(V[0]));return l},d=/([MmLlHhVvCcSsQqTtAa]{1}[\d\.,\s\-Zz]*)/gi,m={x:0,y:0};s=d.exec(D);){var f=s[0],K=f.substr(0,1);if("M"===K||"m"===K){for(var M=e(f),F=0;F<M.length;F+=2){var V=M[F],i=M[F+1];"m"===K&&(V+=m.x,i+=m.y),Q&&Q.moveTo(V,i),b.push({x:V,y:i}),m.x=V,m.y=i}o=q=null}else if("H"===K||"h"===K){for(var M=e(f),F=0;F<M.length;F+=1){var V=M[F];"h"===K&&(V+=m.x),Q&&Q.lineTo(V,m.y),b.push({x:V,y:m.y}),m.x=V}o=q=null}else if("C"===K||"c"===K){for(var M=e(f),F=0;F<M.length;F+=6){var R=M[F],j=M[F+1],G=M[F+2],E=M[F+3],V=M[F+4],i=M[F+5];"c"===K&&(R+=m.x,j+=m.y,G+=m.x,E+=m.y,V+=m.x,i+=m.y),Q&&Q.bezierCurveTo(R,j,G,E,V,i),b.push({x:R,y:j}),b.push({x:G,y:E}),b.push({x:V,y:i}),m.x=V,m.y=i}o=[R,j,G,E,V,i],q=null}else if("S"===K||"s"===K){for(var M=e(f),F=0;F<M.length;F+=4){var R,j;o?(R=2*o[4]-o[2],j=2*o[5]-o[3]):(R=m.x,j=m.y);var G=M[F],E=M[F+1],V=M[F+2],i=M[F+3];"s"===K&&(G+=m.x,E+=m.y,V+=m.x,i+=m.y),Q&&Q.bezierCurveTo(R,j,G,E,V,i),b.push({x:R,y:j}),b.push({x:G,y:E}),b.push({x:V,y:i}),m.x=V,m.y=i}o=[R,j,G,E,V,i],q=null}else if("Q"===K||"q"===K){for(var M=e(f),F=0;F<M.length;F+=4){var R=M[F],j=M[F+1],V=M[F+2],i=M[F+3];"q"===K&&(R+=m.x,j+=m.y,V+=m.x,i+=m.y),Q&&Q.quadraticCurveTo(R,j,V,i),b.push({x:R,y:j}),b.push({x:V,y:i}),m.x=V,m.y=i}o=null,q=[R,j,V,i]}else if("T"===K||"t"===K){for(var M=e(f),F=0;F<M.length;F+=2){var R,j;q?(R=2*q[2]-q[0],j=2*q[3]-q[1]):(R=m.x,j=m.y);var V=M[F],i=M[F+1];"t"===K&&(V+=m.x,i+=m.y),Q&&Q.quadraticCurveTo(R,j,V,i),b.push({x:R,y:j}),b.push({x:V,y:i}),m.x=V,m.y=i}o=null,q=[R,j,V,i]}else if("V"===K||"v"===K){for(var M=e(f),F=0;F<M.length;F+=1){var i=M[F];"v"===K&&(i+=m.y),Q&&Q.lineTo(m.x,i),b.push({x:m.x,y:i}),m.y=i}o=q=null}else if("L"===K||"l"===K){for(var M=e(f),F=0;F<M.length;F+=2){var V=M[F],i=M[F+1];"l"===K&&(V+=m.x,i+=m.y),Q&&Q.lineTo(V,i),b.push({x:V,y:i}),m.x=V,m.y=i}o=q=null}else if("A"===K||"a"===K){for(var M=e(f),F=0;F<M.length;F+=7){var Y=M[F],a=M[F+1],l=M[F+2],n=M[F+3],w=M[F+4],V=M[F+5],i=M[F+6];"a"===K&&(V+=m.x,i+=m.y);var S=Qo(m,Y,a,l,n,w,{x:V,y:i},Q);S&&(b=b.concat(S)),m.x=V,m.y=i}o=q=null}var u=f.substr(f.length-1);("z"===u||"Z"===u)&&Q&&Q.closePath()}return b},Lo=function(O,s,h,N,W){var J,Q=s[0];if(O.save(),rm(s))if(Q&&1===Q.length){var C,q="L"===s[0],y=s.length;q?(O.transform(s[5],s[6],s[7],s[8],s[9],s[10]),J=O.createLinearGradient(s[1],s[2],s[3],s[4]),C=11):(O.transform(s[7],s[8],s[9],s[10],s[11],s[12]),J=O.createRadialGradient(s[1],s[2],s[3],s[4],s[5],s[6]),C=13);for(var F=O.compGray;y>C;){var g=s[C+1];g=h(g),J.addColorStop(s[C],F?r.toGrayColor(g):g),C+=2}}else{var C,q="linear"===Q,M=W.x,z=W.y,i=W.width,H=W.height,y=s.length,F=O.compGray;if(q)J=O.createLinearGradient(M+i*s[1],z+H*s[2],M+i*s[3],z+H*s[4]),C=5;else{var A=Math.min(i,H),V=s[1]*i+M,d=s[2]*H+z,_=s[3]*A;J=O.createRadialGradient(V,d,0,V,d,_),C=4}for(;y>C;){var g=s[C+1];g=h(g),J.addColorStop(s[C],F?r.toGrayColor(g):g),C+=2}}else J=s;return N?O.strokeStyle=J:O.fillStyle=J,J},Jp=function(){function u(l,Y){var $=l.length,x=l[0];if(x&&1!==x.length)return l;for(var i=new Array($),y=0;$>y;y++)i[y]=l[y];var X,m,c,L,h,d,G,R,Q,I,D,F,H,U="L"===i[0];return X=U?5:7,m=i[X],c=i[X+1],L=i[X+2],h=i[X+3],d=i[X+4],G=i[X+5],R=Y[0],Q=Y[1],I=Y[2],D=Y[3],F=Y[4],H=Y[5],i[X]=R*m+I*c,i[X+1]=Q*m+D*c,i[X+2]=R*L+I*h,i[X+3]=Q*L+D*h,i[X+4]=R*d+I*G+F,i[X+5]=Q*d+D*G+H,i}return function(h,w){var b;(b=h.s("shape.gradient.pack"))&&h.s("shape.gradient.pack",u(b,w)),(b=h.s("shape.border.gradient.pack"))&&h.s("shape.border.gradient.pack",u(b,w))}}(),Nm=function(W,O,z,j){var P=!1;if(W.beginPath?W.beginPath():P=!0,Tg(O)&&(O=O._as),Tg(z)&&(z=z._as),z&&z.length){for(var D,E,v,G,$=0,V=0,L=z.length;L>V;V++)D=z[V],1===D?(E=O[$++],W.moveTo(E.x,P?-E.y:E.y)):2===D?(E=O[$++],W.lineTo(E.x,P?-E.y:E.y)):3===D?(E=O[$++],v=O[$++],W.quadraticCurveTo(E.x,P?-E.y:E.y,v.x,P?-v.y:v.y)):4===D?(E=O[$++],v=O[$++],G=O[$++],W.bezierCurveTo(E.x,P?-E.y:E.y,v.x,P?-v.y:v.y,G.x,P?-G.y:G.y)):5===D&&W.closePath();j&&5!==D&&W.closePath()}else{var d,l,o,B=O.length;if(B>0){for(d=O[0],W.moveTo(d.x,P?-d.y:d.y),l=1;B>l;l++)o=O[l],W.lineTo(o.x,P?-o.y:o.y);j&&W.closePath()}}},zn=function(H,p,F,W){if(Tg(H)&&(H=H._as),Tg(p)&&(p=p._as),p&&p.length){F=F||Kh;for(var $,S,g,y,K,d,I,o,D=[],k=h,x=0,L=0,R=p.length;R>L;L++)if($=p[L],1===$)D.push(k=[]),k.push(H[x++]);else if(2===$)k.push(H[x++]);else if(3===$){for(S=k[k.length-1],g=H[x++],y=H[x++],d=1;F>d;d++)I=uc(d/F,S.x,g.x,y.x),o=uc(d/F,S.y,g.y,y.y),k.push({x:I,y:o,b:!0});k.push(y)}else if(4===$){for(S=k[k.length-1],g=H[x++],y=H[x++],K=H[x++],d=1;F>d;d++)I=jq(d/F,S.x,g.x,y.x,K.x),o=jq(d/F,S.y,g.y,y.y,K.y),k.push({x:I,y:o,b:!0});k.push(K)}else 5===$&&k.push(k[0]);return W&&5!==$&&k&&k.length>2&&k.push(k[0]),D}return W&&H.length>2&&(H=H.slice(),H.push(H[0])),H?[H]:[]},Mn=function(q,t,u,B,x,E){var T,b,h,K=Bc(t),W=B,o=K[0],Y=K[1],X=K[2];if(u){var e=Bc(u);T=e[0]-o,b=e[1]-Y,h=e[2]-X}else T=255-o,b=255-Y,h=255-X;for(E||(E=B>10?1:.5,E=1>x?n(E/x,2):E),q.save(),q.shadowOffsetX=0,q.shadowOffsetY=0,q.shadowBlur=0,q.shadowColor=0;(B-=E)>0;){var R=1-B/W,g=o+T*R,j=Y+b*R,y=X+h*R;g=n(N(g),255),j=n(N(j),255),y=n(N(y),255),q.strokeStyle="rgb("+g+","+j+","+y+")",q.lineWidth=B,q.stroke()}q.restore()},sf=function(){if(Uh&&b){var Z=b+""||zr;vl=Z.indexOf(fi.substr(0,2))>0&&Z.indexOf(xo+xo.substr(1,1))>1?!0:!1}var R={};return function(t,v){var F=t+"-"+v,K=R[F];if(K)return K;var I,Z,o,W=Bc(t);return 0>v?(v=(100+v)/100,I=N(W[0]*v),Z=N(W[1]*v),o=N(W[2]*v)):(v/=100,I=W[0],Z=W[1],o=W[2],I+=(255-I)*v,Z+=(255-Z)*v,o+=(255-o)*v,I=n(N(I),255),Z=n(N(Z),255),o=n(N(o),255)),R[F]="rgb("+I+","+Z+","+o+")"}}(),qd=function(K,r,a,A,B,$){$&&(K.fillStyle=$),K.beginPath(),K.rect(r,a,A,B),K.fill()},Gk=function(j,s,P,g,x,O,F){j.beginPath(),Sk[s](j,P.x,P.y,P.width,P.height,g,x,O,F)},Tc=function(R,c,N,I,v){var x=Sk[N];R.fillStyle=x?x(R,c,I?I:lp,v.x,v.y,v.width,v.height):c},mb=function(u,o,v,M,S,j){u.fillStyle=Ad(u,o,v,M,S,j)},Mr=function(I,n,Q,d,U,O){I.strokeStyle=Ad(I,n,Q,d,U,O)},Ad=function(o,v,f,$,x,N){var y;try{if(!v.tagName&&v.comps){v._cacheImage_||(v._cacheImage_={});var C;C="override"===$?"colors_override":"override_rgb"===$?"colors_override_rgb":"override_a"===$?"colors_override_a":"colors",v._cacheImage_[C]||(v._cacheImage_[C]={__count__:0});var T=v._cacheImage_[C][f];T||(v._cacheImage_[C].__count__>r.imageCacheThreshold&&(v._cacheImage_[C]={__count__:0}),T=L.Default.toCanvas(v,Xf(v),$m(v),null,x,N,f,null,$),v._cacheImage_[C][f]=T,v._cacheImage_[C].__count__++),v=T
}y=o.createPattern(v,"repeat")}catch(m){y="black"}return y},Wf=function(Q){var l,B,c=[],D=0,z=Q.length;for(l=0;65>l;l++)c[l]=l;for(l=0;65>l;l++)D=(D+c[l]+Q.charCodeAt(l%z))%65,B=c[l],c[l]=c[D],c[D]=B;for(l=0;65>l;l++)c[l]=mn[c[l]];return c.join("")},co=function(q){for(var p=8+xb.randomInt(8),S=mn[8*xb.randomInt(8)+(p-8)],M="",r=0;p>r;r++)M+=mn[xb.randomInt(64)];var E=Wf(M+l+jh+jg);return S+M+Bn.encode(q,E)},sc=function(H){var S=H[0],I=mn.indexOf(S);if(0>I)return"";I=8+(7&I);var a=H.slice(1,1+I),u=Wf(a+l+jh+jg);return Bn.decode(H,u,1+I)},Bq=function(M,o,b,C,S,h,k){M.save(),M.translate(o,b),M.scale(1,k/h),M.arc(0,0,h,C,S),M.restore()},sj=function(K,D,Z,R,J,n,T,U){var i,C,o,p,O,h,l,x,j,q,d;if(z(J)>2*g&&(J=2*g),O=N(z(J)/(g/4)),i=J/O,C=-i,o=-R,O>0){h=D+$(R)*n,l=Z+e(-R)*T,U?K.lineTo(h,l):K.moveTo(h,l);for(var m=0;O>m;m++)o+=C,p=o-C/2,x=D+$(o)*n,j=Z+e(o)*T,q=D+$(p)*(n/$(C/2)),d=Z+e(p)*(T/$(C/2)),K.quadraticCurveTo(q,d,x,j)}},Bd=function(H,V,Z,e,X,F,S,p,w){6===arguments.length&&(S=F,p=F,w=F);var M=V+e,k=Z+X,v=X>e?2*e:2*X;F=v>F?F:v,S=v>S?S:v,p=v>p?p:v,w=v>w?w:v;var l=.29*w,i=.58*w;H.moveTo(M,k-w),H.quadraticCurveTo(M,k-i,M-l,k-l),H.quadraticCurveTo(M-i,k,M-w,k),l=.29*p,i=.58*p,H.lineTo(V+p,k),H.quadraticCurveTo(V+i,k,V+l,k-l),H.quadraticCurveTo(V,k-i,V,k-p),l=.29*F,i=.58*F,H.lineTo(V,Z+F),H.quadraticCurveTo(V,Z+i,V+l,Z+l),H.quadraticCurveTo(V+i,Z,V+F,Z),l=.29*S,i=.58*S,H.lineTo(M-S,Z),H.quadraticCurveTo(M-i,Z,M-l,Z+l),H.quadraticCurveTo(M,Z+i,M,Z+S),H.lineTo(M,k-w)},wh=function(W,C,E,K,M,c,b){C&&(E=i(E),K=i(K),b||(b=1),W.fillStyle=C,W.beginPath(),W.rect(E,K,b,c),W.rect(E,K,M,b),c-b>0&&W.rect(E,K+c-b,M,b),M-b>0&&W.rect(E+M-b,K,b,c),W.fill())},Yl=function(S,P,e,M){var X=M.x,u=M.y,d=M.width,F=M.height;if(!(!P||!e||0>=d||0>=F)){var j,v=Eo(P),k=Gg(P),H=e>0;1===e||-1===e?(S.fillStyle=H?v:k,S.beginPath(),S.rect(X,u,1,F),S.rect(X,u,d,1),S.fill(),S.fillStyle=H?k:v,S.beginPath(),S.rect(X,u+F-1,d,1),S.rect(X+d-1,u,1,F),S.fill()):(e=n(z(e),n(d/2,F/2)),j=S.createLinearGradient(X,u,X+e,u),j.addColorStop(0,H?v:k),j.addColorStop(1,P),S.fillStyle=j,S.beginPath(),S.moveTo(X,u),S.lineTo(X+e,u+e),S.lineTo(X+e,u+F-e),S.lineTo(X,u+F),S.lineTo(X,u),S.fill(),j=S.createLinearGradient(X,u,X,u+e),j.addColorStop(0,H?v:k),j.addColorStop(1,P),S.fillStyle=j,S.beginPath(),S.moveTo(X,u),S.lineTo(X+e,u+e),S.lineTo(X+d-e,u+e),S.lineTo(X+d,u),S.lineTo(X,u),S.fill(),j=S.createLinearGradient(X,u+F,X,u+F-e),j.addColorStop(0,H?k:v),j.addColorStop(1,P),S.fillStyle=j,S.beginPath(),S.moveTo(X,u+F),S.lineTo(X+e,u+F-e),S.lineTo(X+d-e,u+F-e),S.lineTo(X+d,u+F),S.lineTo(X,u+F),S.fill(),j=S.createLinearGradient(X+d,u,X+d-e,u),j.addColorStop(0,H?k:v),j.addColorStop(1,P),S.fillStyle=j,S.beginPath(),S.moveTo(X+d,u),S.lineTo(X+d-e,u+e),S.lineTo(X+d-e,u+F-e),S.lineTo(X+d,u+F),S.lineTo(X+d,u),S.fill())}},pl=function(C,F,m,I,G,Z,k){var O=C.createLinearGradient(I,G,Z,k);return O.addColorStop(0,m),O.addColorStop(1,F),O},Cd=function(q,n,I,i,P,X,z){var p=q.createLinearGradient(i,P,X,z);return p.addColorStop(0,n),p.addColorStop(.5,I),p.addColorStop(1,n),p},Tn=function(t,l,e,p,U,A,N){var Z=t.createLinearGradient(p,U,A,N);return Z.addColorStop(0,l),Z.addColorStop(1/3,e),Z.addColorStop(2/3,l),Z.addColorStop(1,e),Z},Ii=function(c,K,N,X,R,t,e,h,m){var C=c.createRadialGradient(X+t*h,R+e*m,n(t,e)/24,X+t/2,R+e/2,k(t,e)/2);return C.addColorStop(0,N),C.addColorStop(1,K),C},te=[0,-1,.22451398828979272,-.30901699437494734,.9510565162951535,-.30901699437494745,.3632712640026804,.11803398874989468,.5877852522924731,.8090169943749473,-1.1102230246251565e-16,.38196601125010515,-.587785252292473,.8090169943749475,-.3632712640026805,.1180339887498949,-.9510565162951536,-.3090169943749473,-.22451398828979285,-.30901699437494734],Sk={polygon:function(L,j,b,P,w,q){(q==h||3>q)&&(q=6);for(var f,W,m=n(P,w)/2,J=j+P/2,R=b+w/2,i=0,U=2*g/q,D=0;q>D;D++)f=J+$(i)*m,W=R+e(i)*m,0===D?L.moveTo(f,W):L.lineTo(f,W),i+=U;L.closePath()},arc:function(U,e,Y,z,m,y,p,O,N){y==h&&(y=g),p==h&&(p=S),O==h&&(O=!0);var F=e+z/2,d=Y+m/2;O&&U.moveTo(F,d),N?Bq(U,F,d,y,p,z/2,m/2):U.arc(F,d,n(z,m)/2,y,p),O&&U.closePath()},rect:function(D,C,h,k,q){D.rect(C,h,k,q)},circle:function(q,w,a,N,U){q.arc(w+N/2,a+U/2,n(N,U)/2,0,S,!0)},oval:function(x,Z,v,R,o){Bq(x,Z+R/2,v+o/2,0,S,R/2,o/2)},roundRect:function(V,x,Y,o,u,Q){Q==h&&(Q=n(n(o,u)/4,8)),Bd(V,x,Y,o,u,Q)},star:function(F,P,m,R,Z){var L=2*R,s=2*Z,W=P+R/2,X=m+Z/2;F.moveTo(W-L/4,X-s/12),F.lineTo(P+.306*R,m+.579*Z),F.lineTo(W-L/6,X+s/4),F.lineTo(P+R/2,m+.733*Z),F.lineTo(W+L/6,X+s/4),F.lineTo(P+.693*R,m+.579*Z),F.lineTo(W+L/4,X-s/12),F.lineTo(P+.611*R,m+.332*Z),F.lineTo(W+0,X-s/4),F.lineTo(P+.388*R,m+.332*Z),F.closePath()},pentagram:function(F,d,k,S,s){var r=.5*s,q=d+.5*S,t=k+r,M=.5257311121191336*S;M>r&&(M=r);var K=te,_=0;for(F.moveTo(q+M*K[_++],t+M*K[_++]);20>_;)F.lineTo(q+M*K[_++],t+M*K[_++]);F.closePath()},triangle:function(k,y,A,N,s){k.moveTo(y+N/2,A),k.lineTo(y+N,A+s),k.lineTo(y,A+s),k.closePath()},hexagon:function(m,C,k,z,T){m.moveTo(C,k+T/2),m.lineTo(C+z/4,k+T),m.lineTo(C+3*z/4,+k+T),m.lineTo(C+z,k+T/2),m.lineTo(C+3*z/4,k),m.lineTo(C+z/4,k),m.closePath()},pentagon:function(B,T,g,s,Y){var D=2*s,W=2*Y,E=T+s/2,o=g+Y/2;B.moveTo(E-D/4,o-W/12),B.lineTo(E-D/6,o+W/4),B.lineTo(E+D/6,o+W/4),B.lineTo(E+D/4,o-W/12),B.lineTo(E+0,o-W/4),B.closePath()},diamond:function(w,o,m,j,S){w.moveTo(o+j/2,m),w.lineTo(o,m+S/2),w.lineTo(o+j/2,m+S),w.lineTo(o+j,m+S/2),w.closePath()},rightTriangle:function(o,t,C,M,Y){o.moveTo(t,C),o.lineTo(t+M,C+Y),o.lineTo(t,C+Y),o.closePath()},parallelogram:function(C,Q,y,D,k){var V=D/4;C.moveTo(Q+V,y),C.lineTo(Q+D,y),C.lineTo(Q+D-V,y+k),C.lineTo(Q,y+k),C.closePath()},trapezoid:function(V,w,m,d,T){var j=d/4;V.moveTo(w+j,m),V.lineTo(w+d-j,m),V.lineTo(w+d,m+T),V.lineTo(w,m+T),V.closePath()},"linear.southwest":function(D,U,Z,O,z,u,g){return pl(D,U,Z,O,z+g,O+u,z)},"linear.southeast":function(z,U,E,h,C,O,W){return pl(z,U,E,h+O,C+W,h,C)},"linear.northwest":function(v,x,S,M,O,j,s){return pl(v,x,S,M,O,M+j,O+s)},"linear.northeast":function(U,u,D,a,K,P,r){return pl(U,u,D,a+P,K,a,K+r)},"linear.north":function(O,B,n,s,e,w,h){return pl(O,B,n,s,e,s,e+h)},"linear.south":function(m,X,l,S,A,i,V){return pl(m,X,l,S,A+V,S,A)},"linear.west":function(L,k,D,X,B,T){return pl(L,k,D,X,B,X+T,B)},"linear.east":function(W,A,Z,x,r,L){return pl(W,A,Z,x+L,r,x,r)},"radial.center":function(K,V,a,F,f,A,u){return Ii(K,V,a,F,f,A,u,.5,.5)},"radial.southwest":function(U,w,T,f,i,c,r){return Ii(U,w,T,f,i,c,r,.25,.75)},"radial.southeast":function(a,I,n,z,Y,x,B){return Ii(a,I,n,z,Y,x,B,.75,.75)},"radial.northwest":function(N,e,x,s,Z,F,j){return Ii(N,e,x,s,Z,F,j,.25,.25)},"radial.northeast":function(k,d,u,O,e,l,L){return Ii(k,d,u,O,e,l,L,.75,.25)},"radial.north":function(s,E,J,D,x,L,c){return Ii(s,E,J,D,x,L,c,.5,.25)},"radial.south":function(F,Q,W,M,E,I,m){return Ii(F,Q,W,M,E,I,m,.5,.75)},"radial.west":function(S,F,a,f,D,h,R){return Ii(S,F,a,f,D,h,R,.25,.5)},"radial.east":function(H,R,m,D,O,N,d){return Ii(H,R,m,D,O,N,d,.75,.5)},"spread.horizontal":function(W,E,i,H,l,m){return Cd(W,E,i,H,l,H+m,l)},"spread.vertical":function(j,n,C,R,G,d,f){return Cd(j,n,C,R,G,R,G+f)},"spread.diagonal":function(p,W,X,N,l,h,Y){return Cd(p,W,X,N+h,l,N,l+Y)},"spread.antidiagonal":function(L,S,N,z,K,D,T){return Cd(L,S,N,z,K,z+D,K+T)},"spread.north":function(r,A,Y,m,H,p,M){return Tn(r,A,Y,m,H-M/4,m,H+M+M/4)},"spread.south":function(Z,z,L,O,x,A,n){return Tn(Z,L,z,O,x-n/4,O,x+n+n/4)},"spread.west":function(g,N,$,l,F,r){return Tn(g,N,$,l-r/4,F,l+r+r/4,F)},"spread.east":function(C,t,W,V,h,z){return Tn(C,W,t,V-z/4,h,V+z+z/4,h)}},ec=function(H,c,$){return new Kb(H).tf(c,$)},Yq=function(_){var f=_.touches[0],s=_.touches[1],N=f.clientX,E=f.clientY,d=s.clientX,i=s.clientY;return R((N-d)*(N-d)+(E-i)*(E-i))},rq=function(q){var w=q.touches[0],F=q.touches[1],p=w.clientX,c=w.clientY,H=F.clientX,m=F.clientY;return{x:(p+H)/2,y:(c+m)/2}},lk=(function(){for(var p=0,J=un.split(""),R=0;R<J.length;R++)p=10*Tr(J[R])+p;return jr(c[Xk.toString(8*R)+cc.substr(R)+3],c[Xk.toString(8*R)+cc.substr(R)+4]),p}(),function(K,W,x){for(var k=0;k<x.size();k++){var v=x.get(k);K.co(v)&&W.add(v)}for(k=0;k<x.size();k++)v=x.get(k),lk(K,W,v._children)}),lg=function(d,o,T){for(var V=0;V<T.size();V++){var z=T.get(T.size()-1-V);d.co(z)&&o.add(z)}for(V=0;V<T.size();V++)z=T.get(V),lg(d,o,z._children)},kk=function(M,V,b){for(var Q=!1,H=0;H<b.size();H++){var e=b.get(H);M.co(e)?Q&&V.add(e):Q=1}for(H=0;H<b.size();H++)e=b.get(H),kk(M,V,e._children)},ne=function(M,O,u){for(var V=!1,I=0;I<u.size();I++){var p=u.get(u.size()-1-I);M.co(p)?V&&O.add(p):V=!0}for(I=0;I<u.size();I++)p=u.get(I),ne(M,O,p._children)},Cn=r.moveDatas=function(W,_,D,r){var F=r==h;if(0!==_||0!==D||!F&&0!==r){var y=!0,T=[];if(W.forEach(function($){y&&($._69O||Im($)||sn($))&&(y=!1)}),y)T=W;else{var p={},B={};W.forEach(function(V){p[V._id]=!0});var w={},S=function(n){var y=n._id;return p[y]?(T.push(n),w[y]=!0):w[y]=!1},t=function(q){var h=q._id;if(B[h])return S(q);var X=w[h];if(X!==A)return X;var s=q._parent;if(s&&(sn(s)||Im(s))&&t(s))return w[h]=!0;var K=q._host;return K&&(B[h]=h,X=t(K),B[h]=A,X)?w[h]=!0:S(q)};W.forEach(function(F){t(F)})}T.forEach(function(p){if(nf(p))F?p.translate(_,D):p.translate3d(_,D,r);else{var i=p.s(wm);if(!i||i.isEmpty())return;var W=new zc;i.each(function(N){N=Bi(N),F?(N.x+=_,N.y+=D):(N.x+=_,N.y+=r,N.e==h?N.e=D:N.e+=D),W.add(N)}),p.s(wm,W)}})}},mf=function(){function X(C,k){return k===C.substring(0,k.length)?!0:!1}function d(G){return parseFloat(G)||0}function R(v,i){if(i==A&&(i=new nk),X(v,"matrix3d")){var G=v.substring(9,v.length-1).split(",");G=G.map(d),i.fromArray(G)}else if(X(v,"matrix")){var G=v.substring(7,v.length-1).split(",");G=G.map(d),i.el[0]=G[0],i.el[1]=G[1],i.el[2]=0,i.el[3]=0,i.el[4]=G[2],i.el[5]=G[3],i.el[6]=0,i.el[7]=0,i.el[8]=0,i.el[9]=0,i.el[10]=1,i.el[11]=0,i.el[12]=G[4],i.el[13]=G[5],i.el[14]=0,i.el[15]=1}return i}function x(F,Z){Z==A&&(Z=new Ai);var x=F.split(/\s+/);return x=x.map(d),Z.set(x[0]||0,x[1]||0,x[2]||0),Z}var C,F,a,M,U,P=function(h,g){C||(C=new nk,F=new Ai,a=new nk,M=new nk,U=new nk),g==A&&(g=new nk);var K=getComputedStyle(h);K.transform&&"none"!==K.transform&&(R(K.transform,C),x(K.transformOrigin,F),M.setPosition(F),F.negate(),U.setPosition(F),(Up||"preserve-3d"!==K.transformStyle)&&(C.el[8]=0,C.el[9]=0,C.el[10]=1,C.el[11]=0),g.multiplyMatrices(U,g),g.multiplyMatrices(C,g),g.multiplyMatrices(M,g)),!Up&&K.perspective&&"none"!==K.perspective&&(a.el[11]=-1/d(K.perspective),x(K.perspectiveOrigin,F),M.setPosition(F),F.negate(),U.setPosition(F),g.multiplyMatrices(U,g),g.multiplyMatrices(a,g),g.multiplyMatrices(M,g));for(var Y=h.offsetParent,L=h.offsetLeft,O=h.offsetTop,Z=h.parentElement;Z&&Z!==Y;){var $=getComputedStyle(Z);if("none"!==$.transform||"none"!==$.perspective)break;Z=Z.parentElement}return Z==A&&h!==h.ownerDocument.documentElement&&"fixed"!==K.position&&(Z=h.ownerDocument.documentElement),Y!=A&&Y!==Z&&(L-=Z.offsetLeft,O-=Z.offsetTop),F.set(L,O,0),M.setPosition(F),g.multiplyMatrices(M,g),Z&&P(Z,g),g};return function(K,f){var B=K.parentElement;if(B){var w=B.updateAppendMatrix;if(w){delete B.updateAppendMatrix;var V=new nk;P(B,V);var O=new nk;O.getInverse(V),B._matrixAppend=O,B._maxrixPreAppend=V}return f?B._matrixAppend:B._maxrixPreAppend}}}(),wq=function(G,d){for(;G&&!G.hasOwnProperty(d);)G=U.getPrototypeOf(G);return G&&U.getOwnPropertyDescriptor(G,d)},ul=U.getPrototypeOf?function(s,i,e){var b=wq(i,e);b&&U.defineProperty(s,e,b)}:function(f,B,s){f[s]=B[s]},Km={1:29,2:30,3:31,4:32,5:33,6:26,7:27,8:28,9:21,10:22,11:23,12:24,13:25,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:9,22:10,23:11,24:12,25:13,26:6,27:7,28:8,29:1,30:2,31:3,32:4,33:5,34:36,35:37,36:34,37:35,38:54,39:55,40:52,41:53,42:50,43:51,44:49,50:42,51:43,52:40,53:41,54:38,55:39},Rm=function(){var $={1:function(l,E){return{x:l.x-E.width/2,y:l.y-E.height/2}},2:function(Y,t){return{x:Y.x+t.width/2,y:Y.y-t.height/2}},3:function(F,_){return{x:F.x+F.width/2,y:F.y-_.height/2}},4:function(W,h){return{x:W.x+W.width-h.width/2,y:W.y-h.height/2}},5:function(z,m){return{x:z.x+z.width+m.width/2,y:z.y-m.height/2}},6:function(z){return{x:z.x,y:z.y}},7:function(x){return{x:x.x+x.width/2,y:x.y}},8:function(H){return{x:H.x+H.width,y:H.y}},9:function(p,L){return{x:p.x-L.width/2,y:p.y+L.height/2}},10:function(S,P){return{x:S.x+P.width/2,y:S.y+P.height/2}},11:function(Y,p){return{x:Y.x+Y.width/2,y:Y.y+p.height/2}},12:function(Z,C){return{x:Z.x-C.width/2+Z.width,y:Z.y+C.height/2}},13:function(j,S){return{x:j.x+j.width+S.width/2,y:j.y+S.height/2}},14:function(p,y){return{x:p.x-y.width/2,y:p.y+p.height/2}},15:function(Q){return{x:Q.x,y:Q.y+Q.height/2}},16:function(Y,w){return{x:Y.x+w.width/2,y:Y.y+Y.height/2}},17:function(c){return{x:c.x+c.width/2,y:c.y+c.height/2}},18:function(s,Y){return{x:s.x+s.width-Y.width/2,y:s.y+s.height/2}},19:function(d){return{x:d.x+d.width,y:d.y+d.height/2}},20:function(k,E){return{x:k.x+k.width+E.width/2,y:k.y+k.height/2}},21:function(k,K){return{x:k.x-K.width/2,y:k.y+k.height-K.height/2}},22:function(F,s){return{x:F.x+s.width/2,y:F.y+F.height-s.height/2}},23:function(S,x){return{x:S.x+S.width/2,y:S.y+S.height-x.height/2}},24:function(c,I){return{x:c.x+c.width-I.width/2,y:c.y+c.height-I.height/2}},25:function(K,I){return{x:K.x+K.width+I.width/2,y:K.y+K.height-I.height/2}},26:function(R){return{x:R.x,y:R.y+R.height}},27:function(V){return{x:V.x+V.width/2,y:V.y+V.height}},28:function(d){return{x:d.x+d.width,y:d.y+d.height}},29:function(T,G){return{x:T.x-G.width/2,y:T.y+T.height+G.height/2}},30:function(B,U){return{x:B.x+U.width/2,y:B.y+B.height+U.height/2}},31:function(v,Y){return{x:v.x+v.width/2,y:v.y+v.height+Y.height/2}},32:function(j,D){return{x:j.x+j.width-D.width/2,y:j.y+j.height+D.height/2}},33:function(H,V){return{x:H.x+H.width+V.width/2,y:H.y+H.height+V.height/2}},34:function(B,t){return{x:B.x,y:B.y-t.height/2}},35:function(e,Y){return{x:e.x+e.width,y:e.y-Y.height/2}},36:function(S,a){return{x:S.x,y:S.y+S.height+a.height/2}},37:function(H,n){return{x:H.x+H.width,y:H.y+H.height+n.height/2}},38:function(T,v){return{x:T.x+T.width/4,y:T.y-v.height/2}},39:function(x,Q){return{x:x.x+3*x.width/4,y:x.y-Q.height/2}},40:function(z){return{x:z.x+z.width/4,y:z.y}},41:function(K){return{x:K.x+3*K.width/4,y:K.y}},42:function(Q,U){return{x:Q.x+Q.width/4,y:Q.y+U.height/2}},43:function(m,h){return{x:m.x+3*m.width/4,y:m.y+h.height/2}},44:function(L,u){return{x:L.x+L.width/2,y:L.y+L.height/2-u.height/2}},45:function(q){return{x:q.x+q.width/4,y:q.y+q.height/2}},46:function(L,r){return{x:L.x+L.width/2-r.width/2,y:L.y+L.height/2}},47:function(T,p){return{x:T.x+T.width/2+p.width/2,y:T.y+T.height/2}},48:function(k){return{x:k.x+3*k.width/4,y:k.y+k.height/2}},49:function(i,E){return{x:i.x+i.width/2,y:i.y+i.height/2+E.height/2}},50:function(e,y){return{x:e.x+e.width/4,y:e.y+e.height-y.height/2}},51:function(m,b){return{x:m.x+3*m.width/4,y:m.y+m.height-b.height/2}},52:function(V){return{x:V.x+V.width/4,y:V.y+V.height}},53:function(f){return{x:f.x+3*f.width/4,y:f.y+f.height}},54:function(i,x){return{x:i.x+i.width/4,y:i.y+i.height+x.height/2}},55:function(Y,l){return{x:Y.x+3*Y.width/4,y:Y.y+Y.height+l.height/2}}};return Wg(c)?function(j,r,Y){return $[j](r,Y?Y:dq)}:void 0}();th(_,{highlight:"#1ABC9C",label:"#000",labelSelect:"#FFF",transparent:"rgba(0,0,0,0.35)",titleBackground:"#2C3E50",titleIconBackground:"#868686",headerBackground:"#ECF0F1",headerIconBackground:"#868686",headerSeparator:"#868686",headerLine:"#D9D9D9",background:"#FFF",disabledBackground:"rgba(255,255,255,0.65)",toolTipBackground:"#FFFFE0",rectSelectBorder:"#45C4F9",rectSelectBackground:"rgba(0,0,0,0.35)",editPointBorder:"#2C3E50",editPointBackground:"#D9D9D9",dash:"#2C3E50",groupBackground:"#ECF0F1",groupTitleBackground:"#2C3E50",gridBackground:"#D9D9D9",gridCellBorderColor:"#868686",gridBlockColor:"#868686",reverse:"#868686",contentIconBackground:"#868686",contentLine:"#D9D9D9",widgetBackground:"#ECF0F1",widgetBorder:"#D9D9D9",widgetIconBackground:"#868686",widgetIconBorder:"#868686",widgetIconGradient:"#D9D9D9",widgetIconHighlight:"#43AFF1",imageBackground:"#3498DB",imageGradient:"#FFF",chart:["#2f7ed8","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"]},!0);var ge=_.reverse,Cp=_.transparent,vj=_.rectSelectBackground,Hd=_.dash,Ip=_.titleBackground,jk=_.titleIconBackground,yc=_.headerBackground,hg=_.headerIconBackground,ui=_.headerSeparator,Rc=_.headerLine,_b=_.contentIconBackground,Mb=_.contentLine,mo=(_.widgetIconHighlight,_.widgetIconBorder),Mo=(_.widgetIconGradient,_.imageBackground),lp=_.imageGradient,ue=_.highlight,wg=_.label,Nb=_.labelSelect;if(xd&&!c.shutAlert1){var uj=new Date,Yi=xd.split("-"),fn=new Date(uj.getFullYear(),uj.getMonth(),uj.getDate()),xd=new Date(Tr(Yi[0],10),Tr(Yi[1],10)-1,Tr(Yi[2],10)),Gh=fn.getTime(),ji=xd.getTime(),hc=l+"_try",Gi=c.alert;try{var bs=c.localStorage;if(bs&&Gi)if(ji>Gh&&1728e6>ji-Gh){var fc=(ji-Gh)/864e5;bs&&bs[hc]!=fc&&(bs[hc]=fc,c.htWillExpire?Gi(c.htWillExpire.replace("{{day}}",fc)):Gi("HT for Web free trial license will expire in "+fc+" days, please apply for a new license!"))}else Gh>=ji&&(c.htExpired?Gi(c.htExpired):Gi("Your free trial of HT for Web has expired!")),bs&&delete bs[hc]}catch(sl){}}Math.sign===A&&(Math.sign=function(A){return 0>A?-1:A>0?1:+A});var mn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Bn={encode:function(I,R){var F,v,$,y,h,d,C,G="",D=0;for(I=unescape(encodeURIComponent(I));D<I.length;)F=I.charCodeAt(D++),v=I.charCodeAt(D++),$=I.charCodeAt(D++),y=F>>2,h=(3&F)<<4|v>>4,d=(15&v)<<2|$>>6,C=63&$,isNaN(v)?d=C=64:isNaN($)&&(C=64),G=G+R.charAt(y)+R.charAt(h)+R.charAt(d)+R.charAt(C);return G},decode:function(A,C,u){for(var q,j,a,O,k,v,B,G="",g=u||0;g<A.length;)O=C.indexOf(A.charAt(g++)),k=C.indexOf(A.charAt(g++)),v=C.indexOf(A.charAt(g++)),B=C.indexOf(A.charAt(g++)),q=O<<2|k>>4,j=(15&k)<<4|v>>2,a=(3&v)<<6|B,G+=String.fromCharCode(q),64!=v&&(G+=String.fromCharCode(j)),64!=B&&(G+=String.fromCharCode(a));return G=decodeURIComponent(escape(G))},_utf8_encode:function(R){R=R.replace(/\r\n/g,"\n");for(var S="",w=0;w<R.length;w++){var F=R.charCodeAt(w);128>F?S+=String.fromCharCode(F):F>127&&2048>F?(S+=String.fromCharCode(192|F>>6),S+=String.fromCharCode(128|63&F)):(S+=String.fromCharCode(224|F>>12),S+=String.fromCharCode(128|63&F>>6),S+=String.fromCharCode(128|63&F))}return S},_utf8_decode:function(q){for(var S="",_=0,G=0,F=0,J=0;_<q.length;)G=q.charCodeAt(_),128>G?(S+=String.fromCharCode(G),_++):G>191&&224>G?(F=q.charCodeAt(_+1),S+=String.fromCharCode((31&G)<<6|63&F),_+=2):(F=q.charCodeAt(_+1),J=q.charCodeAt(_+2),S+=String.fromCharCode((15&G)<<12|(63&F)<<6|63&J),_+=3);return S}},xi=[],Qh=[],xb=L.Math={generateUUID:function(){for(var d=[],C=0;256>C;C++)d[C]=(16>C?"0":"")+C.toString(16).toUpperCase();return function(){var P=0|4294967295*Math.random(),D=0|4294967295*Math.random(),v=0|4294967295*Math.random(),$=0|4294967295*Math.random();return d[255&P]+d[255&P>>8]+d[255&P>>16]+d[255&P>>24]+"-"+d[255&D]+d[255&D>>8]+"-"+d[64|15&D>>16]+d[255&D>>24]+"-"+d[128|63&v]+d[255&v>>8]+"-"+d[255&v>>16]+d[255&v>>24]+d[255&$]+d[255&$>>8]+d[255&$>>16]+d[255&$>>24]}}(),clamp:function(A,H,W){return Math.max(H,Math.min(W,A))},generateIncreasingID:function(){var S=0;return function(){return++S}}(),encodeBase64:function(e,m){return Bn.encode(e,m||mn)},decodeBase64:function(z,O){return Bn.decode(z,O||mn)},randomArray:function(G,D){D=D||G.length;for(var m=D-1;m>0;m--){var I=Math.floor(Math.random()*(m+1)),M=G[m];G[m]=G[I],G[I]=M}return G},randomInt:function(q,Z){return Z===A&&(Z=q,q=0),q+Math.floor(Math.random()*(Z-q))},isPOT:function(g){return g>0&&0===(g-1&g)},nearestPOT:function(j){if(!j)return 1;var $=j;$--,$|=$>>1,$|=$>>2,$|=$>>4,$|=$>>8,$|=$>>16,$++;var T=$>>1;return j-T>$-j?$:T},requestMatrix4:function(){return xi.length>0?xi.pop():new xb.Matrix4},releaseMatrix4:function(S){xi.push(S)},requestVector3:function(){return Qh.length>0?Qh.pop():new xb.Vector3},releaseVector3:function(B){Qh.push(B)}},Ud=L.Matrix=L.Math.Matrix2d=function(V,p,Z,s,Y){this.setFromTransform(V,p,Z,s,Y)},Kb=Ud;Ud.prototype={},Ud.prototype.constructor=Ud,Ud.prototype.set=function(V,o,f,u,v,b){return this.a=V,this.b=o,this.c=f,this.d=u,this.tx=v,this.ty=b,this},Ud.prototype.setFromTransform=function(t,X,J,Q,U){var y=this;if(t===A)return y.a=1,y.b=0,y.c=0,y.d=1,y.tx=0,y.ty=0,void 0;var h,F;return t?(h=e(t),F=$(t)):(h=0,F=1),Q=Q||1,U=U||1,y.a=F*Q,y.b=h*Q,y.c=-h*U,y.d=F*U,y.tx=X||0,y.ty=J||0,y},Ud.prototype.apply=function(E,w){w=w||new lm;var O=E.x,V=E.y;return w.x=this.a*O+this.c*V+this.tx,w.y=this.b*O+this.d*V+this.ty,w},Ud.prototype.applyInverse=function(J,o){o=o||new lm;var m=1/(this.a*this.d+this.c*-this.b),S=J.x,C=J.y;return o.x=this.d*m*S+-this.c*m*C+(this.ty*this.c-this.tx*this.d)*m,o.y=this.a*m*C+-this.b*m*S+(-this.ty*this.a+this.tx*this.b)*m,o},Ud.prototype.translate=function(A,u){return this.tx+=A,this.ty+=u,this},Ud.prototype.scale=function(v,e){return this.a*=v,this.d*=e,this.c*=v,this.b*=e,this.tx*=v,this.ty*=e,this},Ud.prototype.rotate=function(r){var w=Math.cos(r),N=Math.sin(r),L=this.a,E=this.c,v=this.tx;return this.a=L*w-this.b*N,this.b=L*N+this.b*w,this.c=E*w-this.d*N,this.d=E*N+this.d*w,this.tx=v*w-this.ty*N,this.ty=v*N+this.ty*w,this},Ud.prototype.appendTranslate=function(A,h){return this.tx+=this.a*A+this.c*h,this.ty+=this.b*A+this.d*h,this},Ud.prototype.appendScale=function(n,y){return this.a*=n,this.d*=y,this.c*=y,this.b*=n,this},Ud.prototype.appendRotate=function(p){if(!p)return this;var K=Math.cos(p),e=Math.sin(p),r=this.a,l=this.b;return this.a=r*K+this.c*e,this.b=l*K+this.d*e,this.c=-r*e+this.c*K,this.d=-l*e+this.d*K,this},Ud.prototype.append=function(u){var Y=this.a,w=this.b,z=this.c,X=this.d;return this.a=u.a*Y+u.b*z,this.b=u.a*w+u.b*X,this.c=u.c*Y+u.d*z,this.d=u.c*w+u.d*X,this.tx=u.tx*Y+u.ty*z+this.tx,this.ty=u.tx*w+u.ty*X+this.ty,this},Ud.prototype.setTransform=function(H,p,g,l,Z,Y,S,b,$){var X,d,c,E,U,J,s,V,T,G;return U=Math.sin(S),J=Math.cos(S),s=Math.cos($),V=Math.sin($),T=-Math.sin(b),G=Math.cos(b),X=J*Z,d=U*Z,c=-U*Y,E=J*Y,this.a=s*X+V*c,this.b=s*d+V*E,this.c=T*X+G*c,this.d=T*d+G*E,this.tx=H+(g*X+l*c),this.ty=p+(g*d+l*E),this},Ud.prototype.prepend=function(L){var X=this.tx;if(1!==L.a||0!==L.b||0!==L.c||1!==L.d){var G=this.a,O=this.c;this.a=G*L.a+this.b*L.c,this.b=G*L.b+this.b*L.d,this.c=O*L.a+this.d*L.c,this.d=O*L.b+this.d*L.d}return this.tx=X*L.a+this.ty*L.c+L.tx,this.ty=X*L.b+this.ty*L.d+L.ty,this},Ud.prototype.transform=Ud.prototype.prepend,Ud.prototype.invert=function(){var g=this.a,n=this.b,O=this.c,K=this.d,y=this.tx,q=g*K-n*O;return this.a=K/q,this.b=-n/q,this.c=-O/q,this.d=g/q,this.tx=(O*this.ty-K*y)/q,this.ty=-(g*this.ty-n*y)/q,this},Ud.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},Ud.prototype.clone=function(){var r=new Ud;return r.a=this.a,r.b=this.b,r.c=this.c,r.d=this.d,r.tx=this.tx,r.ty=this.ty,r},Ud.prototype.copy=function($){return $.a=this.a,$.b=this.b,$.c=this.c,$.d=this.d,$.tx=this.tx,$.ty=this.ty,$},Ud.prototype.tf=function(e,N){1===arguments.length&&(N=e.y,e=e.x);var I=this;return{x:I.a*e+I.c*N+I.tx,y:I.b*e+I.d*N+I.ty}},Ud.prototype.toArray=function(){return[this.a,this.b,this.c,this.d,this.tx,this.ty]},Ud.prototype.fromArray=function(U){return this.a=U[0],this.b=U[1],this.c=U[2],this.d=U[3],this.tx=U[4],this.ty=U[5],this},Ud.prototype.toArray9=function(){return[this.a,this.b,0,this.c,this.d,0,this.tx,this.ty,1]},Ud.prototype.tfi=function(T,L){1===arguments.length&&(L=T.y,T=T.x);var P=this,c=1/(P.a*P.d+P.c*-P.b);return{x:P.d*c*T+-P.c*c*L+(P.ty*P.c-P.tx*P.d)*c,y:P.a*c*L+-P.b*c*T+(-P.ty*P.a+P.tx*P.b)*c}},Ud.IDENTITY=new Ud,Ud.TEMP_MATRIX=new Ud;var er=L.Math.Quaternion=function(O,U,F,B){this.set(O,U,F,B)};U.assign(er.prototype,{set:function(_,t,s,O){var y=this;return y._x=_||0,y._y=t||0,y._z=s||0,y._w=O!==A?O:1,y},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(m){var x=this;return x._x=m._x,x._y=m._y,x._z=m._z,x._w=m._w,x},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this},dot:function(Q){return this._x*Q._x+this._y*Q._y+this._z*Q._z+this._w*Q._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var h=this.length();return 0===h?(this._x=0,this._y=0,this._z=0,this._w=1):(h=1/h,this._x=this._x*h,this._y=this._y*h,this._z=this._z*h,this._w=this._w*h),this},fromArray:function(j,D){D===A&&(D=0);var k=this;return k._x=j[D],k._y=j[D+1],k._z=j[D+2],k._w=j[D+3],this},slerp:function(x,T){if(0===T)return this;if(1===T)return this.copy(x);var F=this._x,n=this._y,m=this._z,E=this._w,M=E*x._w+F*x._x+n*x._y+m*x._z;if(0>M?(this._w=-x._w,this._x=-x._x,this._y=-x._y,this._z=-x._z,M=-M):this.copy(x),M>=1)return this._w=E,this._x=F,this._y=n,this._z=m,this;var z=Math.sqrt(1-M*M);if(Math.abs(z)<.001)return this._w=.5*(E+this._w),this._x=.5*(F+this._x),this._y=.5*(n+this._y),this._z=.5*(m+this._z),this;var C=Math.atan2(z,M),P=Math.sin((1-T)*C)/z,H=Math.sin(T*C)/z;return this._w=E*P+this._w*H,this._x=F*P+this._x*H,this._y=n*P+this._y*H,this._z=m*P+this._z*H,this},setFromAxisAngle:function(Q,q){var V=q/2,l=Math.sin(V);return this._x=Q.x*l,this._y=Q.y*l,this._z=Q.z*l,this._w=Math.cos(V),this},setFromEuler:function(d){var N=d._x,S=d._y,v=d._z,y=d._order,D=Math.cos,B=Math.sin,l=D(N/2),s=D(S/2),n=D(v/2),w=B(N/2),f=B(S/2),Y=B(v/2);return"XYZ"===y?(this._x=w*s*n+l*f*Y,this._y=l*f*n-w*s*Y,this._z=l*s*Y+w*f*n,this._w=l*s*n-w*f*Y):"YXZ"===y?(this._x=w*s*n+l*f*Y,this._y=l*f*n-w*s*Y,this._z=l*s*Y-w*f*n,this._w=l*s*n+w*f*Y):"ZXY"===y?(this._x=w*s*n-l*f*Y,this._y=l*f*n+w*s*Y,this._z=l*s*Y+w*f*n,this._w=l*s*n-w*f*Y):"ZYX"===y?(this._x=w*s*n-l*f*Y,this._y=l*f*n+w*s*Y,this._z=l*s*Y-w*f*n,this._w=l*s*n+w*f*Y):"YZX"===y?(this._x=w*s*n+l*f*Y,this._y=l*f*n+w*s*Y,this._z=l*s*Y-w*f*n,this._w=l*s*n-w*f*Y):"XZY"===y&&(this._x=w*s*n-l*f*Y,this._y=l*f*n-w*s*Y,this._z=l*s*Y+w*f*n,this._w=l*s*n+w*f*Y),this},setFromRotationMatrix:function(Q){var l,L=Q.el,z=L[0],J=L[4],s=L[8],C=L[1],w=L[5],U=L[9],r=L[2],N=L[6],E=L[10],I=z+w+E;return I>0?(l=.5/Math.sqrt(I+1),this._w=.25/l,this._x=(N-U)*l,this._y=(s-r)*l,this._z=(C-J)*l):z>w&&z>E?(l=2*Math.sqrt(1+z-w-E),this._w=(N-U)/l,this._x=.25*l,this._y=(J+C)/l,this._z=(s+r)/l):w>E?(l=2*Math.sqrt(1+w-z-E),this._w=(s-r)/l,this._x=(J+C)/l,this._y=.25*l,this._z=(U+N)/l):(l=2*Math.sqrt(1+E-z-w),this._w=(C-J)/l,this._x=(s+r)/l,this._y=(U+N)/l,this._z=.25*l),this},setFromToVectors:function(){var v,L;return function(N,s){return v===A&&(v=new Ai),L=N.dot(s)+1,1e-7>L?(L=0,Math.abs(N.x)>Math.abs(N.z)?v.set(-N.y,N.x,0):v.set(0,-N.z,N.y)):v.crossVectors(N,s),this._x=v.x,this._y=v.y,this._z=v.z,this._w=L,this.normalize()}}(),setFromUnitVectors:function(){var w,C,M=1e-6;return function(k,H){return w===A&&(w=new Ai),C=k.dot(H)+1,M>C?(C=0,Math.abs(k.x)>Math.abs(k.z)?w.set(-k.y,k.x,0):w.set(0,-k.z,k.y)):w.crossVectors(k,H),this._x=w.x,this._y=w.y,this._z=w.z,this._w=C,this.normalize()}}(),multiply:function(r){return this.multiplyQuaternions(this,r)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(r,D){var u=r._x,W=r._y,m=r._z,A=r._w,I=D._x,v=D._y,f=D._z,C=D._w;return this._x=u*C+A*I+W*f-m*v,this._y=W*C+A*v+m*I-u*f,this._z=m*C+A*f+u*v-W*I,this._w=A*C-u*I-W*v-m*f,this},toArray:function(y,p){return y||(y=[]),p=p||0,y[p]=this._x,y[p+1]=this._y,y[p+2]=this._z,y[p+3]=this._w,y}});var Op=L.Math.Vector4=function(R,G,d,Y){this.x=R||0,this.y=G||0,this.z=d||0,this.w=Y!==A?Y:1};U.assign(Op.prototype,{isVector4:!0,set:function(J,M,O,u){return this.x=J,this.y=M,this.z=O,this.w=u,this},setScalar:function(q){return this.x=q,this.y=q,this.z=q,this.w=q,this},setX:function(R){return this.x=R,this},setY:function(B){return this.y=B,this},setZ:function(g){return this.z=g,this},setW:function(w){return this.w=w,this},setComponent:function(i,Q){switch(i){case 0:this.x=Q;break;case 1:this.y=Q;break;case 2:this.z=Q;break;case 3:this.w=Q;break;default:throw new Error("index is out of range: "+i)}return this},getComponent:function(x){switch(x){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+x)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(F){return this.x=F.x,this.y=F.y,this.z=F.z,this.w=F.w!==A?F.w:1,this},add:function(r,i){return i!==A?this.addVectors(r,i):(this.x+=r.x,this.y+=r.y,this.z+=r.z,this.w+=r.w,this)},addScalar:function(H){return this.x+=H,this.y+=H,this.z+=H,this.w+=H,this},addVectors:function(F,u){return this.x=F.x+u.x,this.y=F.y+u.y,this.z=F.z+u.z,this.w=F.w+u.w,this},addScaledVector:function(B,J){return this.x+=B.x*J,this.y+=B.y*J,this.z+=B.z*J,this.w+=B.w*J,this},sub:function(i,d){return d!==A?this.subVectors(i,d):(this.x-=i.x,this.y-=i.y,this.z-=i.z,this.w-=i.w,this)},subScalar:function(d){return this.x-=d,this.y-=d,this.z-=d,this.w-=d,this},subVectors:function(T,e){return this.x=T.x-e.x,this.y=T.y-e.y,this.z=T.z-e.z,this.w=T.w-e.w,this},multiplyScalar:function(i){return this.x*=i,this.y*=i,this.z*=i,this.w*=i,this},applyMatrix4:function(T){var z=this.x,d=this.y,Z=this.z,R=this.w,Q=T.el;return this.x=Q[0]*z+Q[4]*d+Q[8]*Z+Q[12]*R,this.y=Q[1]*z+Q[5]*d+Q[9]*Z+Q[13]*R,this.z=Q[2]*z+Q[6]*d+Q[10]*Z+Q[14]*R,this.w=Q[3]*z+Q[7]*d+Q[11]*Z+Q[15]*R,this},divideScalar:function(j){return this.multiplyScalar(1/j)},setAxisAngleFromQuaternion:function(v){this.w=2*Math.acos(v.w);var b=Math.sqrt(1-v.w*v.w);return 1e-4>b?(this.x=1,this.y=0,this.z=0):(this.x=v.x/b,this.y=v.y/b,this.z=v.z/b),this},setAxisAngleFromRotationMatrix:function(F){var r,T,L,b,p=.01,G=.1,S=F.el,u=S[0],D=S[4],v=S[8],R=S[1],d=S[5],o=S[9],s=S[2],i=S[6],H=S[10];if(Math.abs(D-R)<p&&Math.abs(v-s)<p&&Math.abs(o-i)<p){if(Math.abs(D+R)<G&&Math.abs(v+s)<G&&Math.abs(o+i)<G&&Math.abs(u+d+H-3)<G)return this.set(1,0,0,0),this;r=Math.PI;var f=(u+1)/2,t=(d+1)/2,a=(H+1)/2,V=(D+R)/4,j=(v+s)/4,y=(o+i)/4;return f>t&&f>a?p>f?(T=0,L=.707106781,b=.707106781):(T=Math.sqrt(f),L=V/T,b=j/T):t>a?p>t?(T=.707106781,L=0,b=.707106781):(L=Math.sqrt(t),T=V/L,b=y/L):p>a?(T=.707106781,L=.707106781,b=0):(b=Math.sqrt(a),T=j/b,L=y/b),this.set(T,L,b,r),this}var B=Math.sqrt((i-o)*(i-o)+(v-s)*(v-s)+(R-D)*(R-D));return Math.abs(B)<.001&&(B=1),this.x=(i-o)/B,this.y=(v-s)/B,this.z=(R-D)/B,this.w=Math.acos((u+d+H-1)/2),this},min:function(C){return this.x=Math.min(this.x,C.x),this.y=Math.min(this.y,C.y),this.z=Math.min(this.z,C.z),this.w=Math.min(this.w,C.w),this},max:function(l){return this.x=Math.max(this.x,l.x),this.y=Math.max(this.y,l.y),this.z=Math.max(this.z,l.z),this.w=Math.max(this.w,l.w),this},clamp:function(O,g){return this.x=Math.max(O.x,Math.min(g.x,this.x)),this.y=Math.max(O.y,Math.min(g.y,this.y)),this.z=Math.max(O.z,Math.min(g.z,this.z)),this.w=Math.max(O.w,Math.min(g.w,this.w)),this},clampScalar:function(){var o,x;return function(q,c){return o===A&&(o=new Op,x=new Op),o.set(q,q,q,q),x.set(c,c,c,c),this.clamp(o,x)}}(),clampLength:function(j,X){var i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(j,Math.min(X,i)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(g){return this.x*g.x+this.y*g.y+this.z*g.z+this.w*g.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w
},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(T){return this.normalize().multiplyScalar(T)},lerp:function(w,d){return this.x+=(w.x-this.x)*d,this.y+=(w.y-this.y)*d,this.z+=(w.z-this.z)*d,this.w+=(w.w-this.w)*d,this},lerpVectors:function(Y,A,L){return this.subVectors(A,Y).multiplyScalar(L).add(Y)},equals:function(v){return v.x===this.x&&v.y===this.y&&v.z===this.z&&v.w===this.w},fromArray:function(c,S){return S===A&&(S=0),this.x=c[S],this.y=c[S+1],this.z=c[S+2],this.w=c[S+3],this},toArray:function(L,p){return L===A&&(L=[]),p===A&&(p=0),L[p]=this.x,L[p+1]=this.y,L[p+2]=this.z,L[p+3]=this.w,L},fromBufferAttribute:function(G,e){return this.x=G.getX(e),this.y=G.getY(e),this.z=G.getZ(e),this.w=G.getW(e),this}});var Ai=L.Math.Vector3=function(b,N,F){b===A?(this.x=0,this.y=0,this.z=0):"object"==typeof b?this.copy(b):this.set(b,N==A?b:N,F==A?b:F)},Ah=L.Math.Vector3;U.assign(Ai.prototype,{isNaN:function(){return isNaN(this.x)||isNaN(this.y)||isNaN(this.z)},set:function(T,k,p){return this.x=T,this.y=k,this.z=p,this},equals:function(V){return V&&this.x===V.x&&this.y===V.y&&this.z===V.z},setScalar:function(F){return this.x=F,this.y=F,this.z=F,this},setX:function(Z){return this.x=Z,this},setY:function(v){return this.y=v,this},setZ:function(B){return this.z=B,this},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(b){return b.x===A?(this.x=b[0],this.y=b[1],this.z=b[2]):(this.x=b.x,this.y=b.y,this.z=b.z||0),this},add:function(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this},addScalar:function(c){return this.x+=c,this.y+=c,this.z+=c,this},addVectors:function(T,v){return this.x=T.x+v.x,this.y=T.y+v.y,this.z=T.z+v.z,this},addScaledVector:function(K,q){return this.x+=K.x*q,this.y+=K.y*q,this.z+=K.z*q,this},sub:function(K){return this.x-=K.x,this.y-=K.y,this.z-=K.z,this},subScalar:function(C){return this.x-=C,this.y-=C,this.z-=C,this},subVectors:function(O,D){return this.x=O.x-D.x,this.y=O.y-D.y,this.z=O.z-D.z,this},divide:function(S){return this.x/=S.x,this.y/=S.y,this.z/=S.z,this},multiply:function(r){return this.x*=r.x,this.y*=r.y,this.z*=r.z,this},multiplyScalar:function(W){return this.x*=W,this.y*=W,this.z*=W,this},divideScalar:function(e){if(0!==e){var u=1/e;this.x*=u,this.y*=u,this.z*=u}else this.x=0,this.y=0,this.z=0;return this},distanceTo:function(k){return Math.sqrt(this.distanceToSquared(k))},distanceToSquared:function(t){var D=this.x-t.x,X=this.y-t.y,T=this.z-t.z;return D*D+X*X+T*T},distanceToSquared2:function(S){var i=this.x-S[0],X=this.y-S[1],Q=this.z-S[2];return i*i+X*X+Q*Q},divideVectors:function(L,x){return this.x=L.x/x.x,this.y=L.y/x.y,this.z=L.z/x.z,this},multiplyVectors:function(J,N){return this.x=J.x*N.x,this.y=J.y*N.y,this.z=J.z*N.z,this},transformDirection:function(d){var H=this.x,f=this.y,e=this.z,T=d.el;return this.x=T[0]*H+T[4]*f+T[8]*e,this.y=T[1]*H+T[5]*f+T[9]*e,this.z=T[2]*H+T[6]*f+T[10]*e,this.normalize()},applyAxisAngle:function(){var q=new er;return function(u,G){return this.applyQuaternion(q.setFromAxisAngle(u,G))}}(),applyEuler:function(){var I=new er;return function(h){return this.applyQuaternion(I.setFromEuler(h))}}(),applyQuaternion:function(T){var E=this.x,h=this.y,X=this.z,v=T._x,D=T._y,n=T._z,K=T._w,F=K*E+D*X-n*h,t=K*h+n*E-v*X,N=K*X+v*h-D*E,z=-v*E-D*h-n*X;return this.x=F*K+z*-v+t*-n-N*-D,this.y=t*K+z*-D+N*-v-F*-n,this.z=N*K+z*-n+F*-D-t*-v,this},applyMatrix4:function(x){var d=this.x,n=this.y,Z=this.z,M=x.el,P=1/(M[3]*d+M[7]*n+M[11]*Z+M[15]);return this.x=(M[0]*d+M[4]*n+M[8]*Z+M[12])*P,this.y=(M[1]*d+M[5]*n+M[9]*Z+M[13])*P,this.z=(M[2]*d+M[6]*n+M[10]*Z+M[14])*P,this},applyMatrix3:function(x){var g=this.x,z=this.y,Y=this.z,Q=x.el;return this.x=Q[0]*g+Q[3]*z+Q[6]*Y,this.y=Q[1]*g+Q[4]*z+Q[7]*Y,this.z=Q[2]*g+Q[5]*z+Q[8]*Y,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},reflect:function(){var w=new Ai;return function(r){return this.sub(w.copy(r).multiplyScalar(2*this.dot(r)))}}(),dot:function(j){return this.x*j.x+this.y*j.y+this.z*j.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){var $=this.length();return $?this.multiplyScalar(1/$):this},setLength:function(X){return this.normalize().multiplyScalar(X)},fromArray:function(E,f){return f===A&&(f=0),this.x=E[f],this.y=E[f+1],this.z=E[f+2],this},toArray:function(B,d){return B===A&&(B=[0,0,0]),d===A&&(d=0),B[d]=this.x,B[d+1]=this.y,B[d+2]=this.z,B},cross:function(c){return this.crossVectors(this,c)},angleTo:function(m){var q=this.dot(m)/Math.sqrt(this.lengthSq()*m.lengthSq());return q>1||-1>q?0:Math.acos(q)},lerp:function(I,Z){return this.x+=(I.x-this.x)*Z,this.y+=(I.y-this.y)*Z,this.z+=(I.z-this.z)*Z,this},lerpVectors:function(I,p,E){return this.subVectors(p,I).multiplyScalar(E).add(I)},crossVectors:function(A,T){var c=A.x,t=A.y,z=A.z,$=T.x,g=T.y,H=T.z;return this.x=t*H-z*g,this.y=z*$-c*H,this.z=c*g-t*$,this},min:function(B){return this.x=Math.min(this.x,B.x),this.y=Math.min(this.y,B.y),this.z=Math.min(this.z,B.z),this},max:function(i){return this.x=Math.max(this.x,i.x),this.y=Math.max(this.y,i.y),this.z=Math.max(this.z,i.z),this},setFromMatrixPosition:function(G){return this.setFromMatrixColumn(G,3)},setFromMatrixScale:function(r){var E=this.setFromMatrixColumn(r,0).length(),s=this.setFromMatrixColumn(r,1).length(),a=this.setFromMatrixColumn(r,2).length();return this.x=E,this.y=s,this.z=a,this},setFromMatrixColumn:function(L,F){return this.fromArray(L.el,4*F)}}),Ai.UP=new Ai(0,1,0),Ai.AxisX=new Ai(1,0,0),Ai.AxisY=new Ai(0,1,0),Ai.AxisZ=new Ai(0,0,1);var lm=L.Math.Vector2=function(r,o,H){"object"==typeof r&&(r.x!=A?(o=r.y,H=r.e,r=r.x):(H=r[2],o=r[1],r=r[0])),this.set(r||0,o||0,H)};lm.prototype={},lm.prototype.constructor=lm;var vr=lm;U.defineProperties(lm.prototype,{width:{get:function(){return this.x},set:function(y){this.x=y}},height:{get:function(){return this.y},set:function(N){this.y=N}}}),lm.prototype.clone=function(){return new lm(this.x,this.y,this.e)},lm.prototype.copy=function(I){return this.set(I.x,I.y,I.e),this},lm.prototype.equals=function(D){return D.x===this.x&&D.y===this.y&&D.e===this.e},lm.prototype.set=function(x,P,u){return this.x=x||0,this.y=P||(0!==P?this.x:0),u!=A&&(this.e=u),this},lm.prototype.setScalar=function(l){return this.x=l,this.y=l,this.e=l,this},lm.prototype.setX=function(Y){return this.x=Y||0,this},lm.prototype.setY=function(y){return this.y=y||0,this},lm.prototype.setE=function(n){return this.e=n||0,this},lm.prototype.add=function(k){return this.x+=k.x,this.y+=k.y,this},lm.prototype.addVectors=function(Q,h){return this.x=Q.x+h.x,this.y=Q.y+h.y,this},lm.prototype.addScalar=function(G){return this.x+=G,this.y+=G,this},lm.prototype.addScaledVector=function(P,_){return this.x+=P.x*_,this.y+=P.y*_,this},lm.prototype.sub=function(D){return this.x-=D.x,this.y-=D.y,this},lm.prototype.subScalar=function(W){return this.x-=W,this.y-=W,this},lm.prototype.subVectors=function(z,V){return this.x=z.x-V.x,this.y=z.y-V.y,this},lm.prototype.multiply=function(d){return this.x*=d.x,this.y*=d.y,this},lm.prototype.multiplyScalar=function(P){return this.x*=P,this.y*=P,this},lm.prototype.divide=function(d){return this.x/=d.x,this.y/=d.y,this},lm.prototype.divideScalar=function(g){return this.multiplyScalar(1/g)},lm.prototype.min=function(C){return this.x=Math.min(this.x,C.x),this.y=Math.min(this.y,C.y),this},lm.prototype.max=function(C){return this.x=Math.max(this.x,C.x),this.y=Math.max(this.y,C.y),this},lm.prototype.fromArray=function(V,i){return i===A&&(i=0),this.x=V[i],this.y=V[i+1],this},lm.prototype.clamp=function(x,V){return this.x=Math.max(x.x,Math.min(V.x,this.x)),this.y=Math.max(x.y,Math.min(V.y,this.y)),this},lm.prototype.clampScalar=function(){var P,R;return function(Y,G){return P===A&&(P=new lm,R=new lm),P.set(Y,Y),R.set(G,G),this.clamp(P,R)}}(),lm.prototype.clampLength=function(I,M){var x=this.length();return this.multiplyScalar(Math.max(I,Math.min(M,x))/x)},lm.prototype.dot=function(R){return this.x*R.x+this.y*R.y},lm.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},lm.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},lm.prototype.normalize=function(){return this.divideScalar(this.length())},lm.prototype.angle=function(){var l=Math.atan2(this.y,this.x);return 0>l&&(l+=2*Math.PI),l},lm.prototype.distanceTo=function(U){return Math.sqrt(this.distanceToSquared(U))},lm.prototype.distanceToSquared=function(P){var F=this.x-P.x,w=this.y-P.y;return F*F+w*w},lm.prototype.isNearEnough=function(F){return this.distanceToSquared(F)<1e-8},lm.prototype.setLength=function(u){var z=this.length();return z?this.multiplyScalar(u/z):this},lm.prototype.lerp=function(m,n){return this.x+=(m.x-this.x)*n,this.y+=(m.y-this.y)*n,"number"==typeof m.e&&"number"==typeof this.e&&(this.e+=(m.e-this.e)*n),this},lm.prototype.lerpVectors=function(m,M,E){return this.subVectors(M,m).multiplyScalar(E).add(m)},lm.prototype.rotateAround=function(j,l){var a=j?j.x:0,N=j?j.y:0,M=Math.cos(l),W=Math.sin(l),k=this.x-a,I=this.y-N;return this.x=k*M-I*W+a,this.y=k*W+I*M+N,this};var dd=L.Math.Matrix3=function(){this.el=[1,0,0,0,1,0,0,0,1]};U.assign(dd.prototype,{isMatrix3:!0,set:function(H,h,K,e,Y,u,z,L,b){var X=this.el;return X[0]=H,X[1]=e,X[2]=z,X[3]=h,X[4]=Y,X[5]=L,X[6]=K,X[7]=u,X[8]=b,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.el)},copy:function(H){var g=this.el,x=H.el;return g[0]=x[0],g[1]=x[1],g[2]=x[2],g[3]=x[3],g[4]=x[4],g[5]=x[5],g[6]=x[6],g[7]=x[7],g[8]=x[8],this},setFromMatrix4:function(u){var K=u.el;return this.set(K[0],K[4],K[8],K[1],K[5],K[9],K[2],K[6],K[10]),this},applyToBufferAttribute:function(){var Y=new Ai;return function(e){for(var Q=0,o=e.count;o>Q;Q++)Y.x=e.getX(Q),Y.y=e.getY(Q),Y.z=e.getZ(Q),Y.applyMatrix3(this),e.setXYZ(Q,Y.x,Y.y,Y.z);return e}}(),multiply:function(u){return this.multiplyMatrices(this,u)},premultiply:function(M){return this.multiplyMatrices(M,this)},multiplyMatrices:function(t,B){var l=t.el,h=B.el,i=this.el,u=l[0],r=l[3],L=l[6],E=l[1],d=l[4],s=l[7],M=l[2],S=l[5],R=l[8],z=h[0],N=h[3],c=h[6],W=h[1],k=h[4],x=h[7],o=h[2],a=h[5],n=h[8];return i[0]=u*z+r*W+L*o,i[3]=u*N+r*k+L*a,i[6]=u*c+r*x+L*n,i[1]=E*z+d*W+s*o,i[4]=E*N+d*k+s*a,i[7]=E*c+d*x+s*n,i[2]=M*z+S*W+R*o,i[5]=M*N+S*k+R*a,i[8]=M*c+S*x+R*n,this},multiplyScalar:function(x){var E=this.el;return E[0]*=x,E[3]*=x,E[6]*=x,E[1]*=x,E[4]*=x,E[7]*=x,E[2]*=x,E[5]*=x,E[8]*=x,this},determinant:function(){var Z=this.el,i=Z[0],U=Z[1],d=Z[2],N=Z[3],c=Z[4],u=Z[5],V=Z[6],I=Z[7],n=Z[8];return i*c*n-i*u*I-U*N*n+U*u*V+d*N*I-d*c*V},getInverse:function(N){var g=N.el,D=this.el,U=g[0],M=g[1],_=g[2],t=g[3],F=g[4],p=g[5],R=g[6],Z=g[7],A=g[8],V=A*F-p*Z,z=p*R-A*t,H=Z*t-F*R,y=U*V+M*z+_*H;if(0===y)return this.identity();var J=1/y;return D[0]=V*J,D[1]=(_*Z-A*M)*J,D[2]=(p*M-_*F)*J,D[3]=z*J,D[4]=(A*U-_*R)*J,D[5]=(_*t-p*U)*J,D[6]=H*J,D[7]=(M*R-Z*U)*J,D[8]=(F*U-M*t)*J,this},transpose:function(){var F,Y=this.el;return F=Y[1],Y[1]=Y[3],Y[3]=F,F=Y[2],Y[2]=Y[6],Y[6]=F,F=Y[5],Y[5]=Y[7],Y[7]=F,this},getNormalMatrix:function(w){return this.setFromMatrix4(w).getInverse(this).transpose()},transposeIntoArray:function(X){var K=this.el;return X[0]=K[0],X[1]=K[3],X[2]=K[6],X[3]=K[1],X[4]=K[4],X[5]=K[7],X[6]=K[2],X[7]=K[5],X[8]=K[8],this},setUvTransform:function(K,o,Z,x,y,e,L){var G=Math.cos(y),s=Math.sin(y);this.set(Z*G,Z*s,-Z*(G*e+s*L)+e+K,-x*s,x*G,-x*(-s*e+G*L)+L+o,0,0,1)},scale:function(w,t){var q=this.el;return q[0]*=w,q[3]*=w,q[6]*=w,q[1]*=t,q[4]*=t,q[7]*=t,this},rotate:function(N){var Z=Math.cos(N),p=Math.sin(N),z=this.el,C=z[0],f=z[3],F=z[6],R=z[1],s=z[4],E=z[7];return z[0]=Z*C+p*R,z[3]=Z*f+p*s,z[6]=Z*F+p*E,z[1]=-p*C+Z*R,z[4]=-p*f+Z*s,z[7]=-p*F+Z*E,this},translate:function(r,n){var W=this.el;return W[0]+=r*W[2],W[3]+=r*W[5],W[6]+=r*W[8],W[1]+=n*W[2],W[4]+=n*W[5],W[7]+=n*W[8],this},equals:function(F){for(var L=this.el,D=F.el,q=0;9>q;q++)if(L[q]!==D[q])return!1;return!0},fromArray:function(R,t){t===A&&(t=0);for(var u=0;9>u;u++)this.el[u]=R[u+t];return this},toArray:function(n,P){n===A&&(n=[]),P===A&&(P=0);var g=this.el;return n[P]=g[0],n[P+1]=g[1],n[P+2]=g[2],n[P+3]=g[3],n[P+4]=g[4],n[P+5]=g[5],n[P+6]=g[6],n[P+7]=g[7],n[P+8]=g[8],n}});var uk=L.Math.Plane=function(E,V){this.normal=E!==A?E:new Ai(1,0,0),this.constant=V!==A?V:0};U.assign(uk.prototype,{set:function(q,j){return this.normal.copy(q),this.constant=j,this},setComponents:function(q,I,r,C){return this.normal.set(q,I,r),this.constant=C,this},setFromNormalAndCoplanarPoint:function(n,j){return this.normal.copy(n),this.constant=-j.dot(this.normal),this},setFromCoplanarPoints:function(){var B=new Ai,n=new Ai;return function(o,l,g){var d=B.subVectors(g,l).cross(n.subVectors(o,l)).normalize();return this.setFromNormalAndCoplanarPoint(d,o),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(q){return this.normal.copy(q.normal),this.constant=q.constant,this},normalize:function(){var h=1/this.normal.length();return this.normal.multiplyScalar(h),this.constant*=h,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(f){return this.normal.dot(f)+this.constant},distanceToSphere:function(k){return this.distanceToPoint(k.center)-k.radius},projectPoint:function(S,W){return W===A&&(W=new Ai),W.copy(this.normal).multiplyScalar(-this.distanceToPoint(S)).add(S)},intersectLine:function(){var I=new Ai;return function(g,e){e===A&&(e=new Ai);var W=g.delta(I),L=this.normal.dot(W);if(0===L)return 0===this.distanceToPoint(g.start)?e.copy(g.start):A;var j=-(g.start.dot(this.normal)+this.constant)/L;return 0>j||j>1?A:e.copy(W).multiplyScalar(j).add(g.start)}}(),intersectsLine:function(E){var G=this.distanceToPoint(E.start),k=this.distanceToPoint(E.end);return 0>G&&k>0||0>k&&G>0},intersectsBox:function(Y){return Y.intersectsPlane(this)},intersectsSphere:function(q){return q.intersectsPlane(this)},coplanarPoint:function(m){return m===A&&(m=new Ai),m.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var d=new Ai,t=new dd;return function(N,M){var L=M||t.getNormalMatrix(N),H=this.coplanarPoint(d).applyMatrix4(N),v=this.normal.applyMatrix3(L).normalize();return this.constant=-H.dot(v),this}}(),translate:function(u){return this.constant-=u.dot(this.normal),this},equals:function(W){return W.normal.equals(this.normal)&&W.constant===this.constant}});var fj=L.Math.Ray=function(b,r){this.origin=b!==A?b.clone():new Ai,this.direction=r!==A?r.clone():new Ai};U.assign(fj.prototype,{set:function(Y,o){return this.origin.copy(Y),this.direction.copy(o),this},clone:function(){return(new this.constructor).copy(this)},copy:function(n){return this.origin.copy(n.origin),this.direction.copy(n.direction),this.maxHitLen=n.maxHitLen,this},at:function(v,X){var t=X||new Ai;return t.copy(this.direction).multiplyScalar(v).add(this.origin)},setMaxHitLength:function(s){this.maxHitLen=s},lookAt:function(S){return this.direction.copy(S).sub(this.origin).normalize(),this},applyMatrix4:function(M){var t=this.maxHitLen;if(t){var w=this.direction.clone().multiplyScalar(t).add(this.origin);w.applyMatrix4(M)}return this.origin.applyMatrix4(M),this.direction.transformDirection(M),t&&(this.maxHitLen=this.origin.distanceTo(w)),this},distanceToPlane:function(n){var F=n.normal.dot(this.direction);if(0===F)return 0===n.distanceToPoint(this.origin)?0:null;var G=-(this.origin.dot(n.normal)+n.constant)/F;return G>=0?G:null},intersectPlane:function(V,O){var R=this.distanceToPlane(V);return null===R?null:this.at(R,O)},intersectSphere:function(){var b=new Ai;return function(U,y){b.subVectors(U.center,this.origin);var H=b.dot(this.direction),t=b.dot(b)-H*H,Z=U.radius*U.radius;if(t>Z)return null;var g=Math.sqrt(Z-t),K=H-g,s=H+g;return 0>K&&0>s?null:0>K?this.at(s,y):this.at(K,y)}}(),intersectEllipsoid:function(){var E=new Ai,s=new Ai;return function(R,u){E.subVectors(R.center,this.origin),E.divide(R.radius),s.divideVectors(this.direction,R.radius);var t=s.lengthSq(),c=E.dot(s),n=E.dot(E)*t-c*c;if(n>t)return null;var G=Math.sqrt(t-n),F=(c-G)/t,$=(c+G)/t;return 0>F&&0>$?null:0>F?this.at($,u):this.at(F,u)}}(),intersectBox:function(r,B){var x,I,e,t,N,n,o=1/this.direction.x,C=1/this.direction.y,L=1/this.direction.z,k=this.origin;if(o>=0?(x=(r.min.x-k.x)*o,I=(r.max.x-k.x)*o):(x=(r.max.x-k.x)*o,I=(r.min.x-k.x)*o),C>=0?(e=(r.min.y-k.y)*C,t=(r.max.y-k.y)*C):(e=(r.max.y-k.y)*C,t=(r.min.y-k.y)*C),x>t||e>I)return null;if((e>x||x!==x)&&(x=e),(I>t||I!==I)&&(I=t),L>=0?(N=(r.min.z-k.z)*L,n=(r.max.z-k.z)*L):(N=(r.max.z-k.z)*L,n=(r.min.z-k.z)*L),x>n||N>I)return null;if((N>x||x!==x)&&(x=N),(I>n||I!==I)&&(I=n),0>I)return null;var V=x>=0?x:I,w=this.maxHitLen;return w&&V>w?null:this.at(V,B)},intersectTriangle:function(){var Z=new Ai,d=new Ai,g=new Ai,j=new Ai;return function(w,t,P,X,k){d.subVectors(t,w),g.subVectors(P,w),j.crossVectors(d,g);var W,Q=this.direction.dot(j);if(Q>0){if(X)return null;W=1}else{if(!(0>Q))return null;W=-1,Q=-Q}Z.subVectors(this.origin,w);var G=W*this.direction.dot(g.crossVectors(Z,g));if(0>G)return null;var n=W*this.direction.dot(d.cross(Z));if(0>n||G+n>Q)return null;var q=-W*Z.dot(j);if(0>q)return null;var L=q/Q,$=this.maxHitLen;return $&&L>$?null:this.at(L,k)}}()});var Ng=L.Math.Box3=function(L,u){this.min=L!==A?L:new Ai(1/0,1/0,1/0),this.max=u!==A?u:new Ai(-1/0,-1/0,-1/0)};U.assign(Ng.prototype,{set:function(X,i){return this.min.copy(X),this.max.copy(i),this},setFromArray:function(t){for(var N=1/0,P=1/0,g=1/0,U=-1/0,o=-1/0,X=-1/0,u=0,R=t.length;R>u;u+=3){var O=t[u],a=t[u+1],F=t[u+2];N>O&&(N=O),P>a&&(P=a),g>F&&(g=F),O>U&&(U=O),a>o&&(o=a),F>X&&(X=F)}return this.min.set(N,P,g),this.max.set(U,o,X),this},setFromPoints:function($){this.makeEmpty();for(var X=0,v=$.length;v>X;X++)this.expandByPoint($[X]);return this},clone:function(){return(new this.constructor).copy(this)},intersectsBox:function(x){return x.max.x<this.min.x||x.min.x>this.max.x||x.max.y<this.min.y||x.min.y>this.max.y||x.max.z<this.min.z||x.min.z>this.max.z?!1:!0},copy:function(R){return this.min.copy(R.min),this.max.copy(R.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},expandByPoint:function(x){return this.min.min(x),this.max.max(x),this},expandByBox:function(q){return this.min.min(q.min),this.max.max(q.max),this},applyMatrix4:function(){var O=[new Ai,new Ai,new Ai,new Ai,new Ai,new Ai,new Ai,new Ai];return function(v){return this.isEmpty()?this:(O[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(v),O[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(v),O[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(v),O[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(v),O[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(v),O[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(v),O[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(v),O[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(v),this.setFromPoints(O),this)}}()});var fr=L.Math.Sphere=function(k,_){this.center=k!==A?k:new Ai,this.radius=_!==A?_:0};U.assign(fr.prototype,{set:function(v,O){return this.center.copy(v),this.radius=O,this},setFromPoints:function(){var f=new Ng;return function(R,F){var z=this.center;F!==A?z.copy(F):f.setFromPoints(R).getCenter(z);for(var W=0,d=0,Y=R.length;Y>d;d++)W=Math.max(W,z.distanceToSquared(R[d]));return this.radius=Math.sqrt(W),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(F){return this.center.copy(F.center),this.radius=F.radius,this},empty:function(){return this.radius<=0},containsPoint:function(R){return R.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(j){return j.distanceTo(this.center)-this.radius},intersectsSphere:function(P){var A=this.radius+P.radius;return P.center.distanceToSquared(this.center)<=A*A},intersectsBox:function(V){return V.intersectsSphere(this)},intersectsPlane:function(R){return Math.abs(R.distanceToPoint(this.center))<=this.radius},clampPoint:function(E,Q){var l=this.center.distanceToSquared(E);return Q===A&&(Q=new Ai),Q.copy(E),l>this.radius*this.radius&&(Q.sub(this.center).normalize(),Q.multiplyScalar(this.radius).add(this.center)),Q},getBoundingBox:function(z){return z===A&&(z=new Ng),z.set(this.center,this.center),z.expandByScalar(this.radius),z},applyMatrix4:function(d){return this.center.applyMatrix4(d),this.radius=this.radius*d.getMaxScaleOnAxis(),this},translate:function(I){return this.center.add(I),this},equals:function(C){return C.center.equals(this.center)&&C.radius===this.radius}});var Ib=L.Math.Frustum=function(o,r,e,v,t,f){this.planes=[o!==A?o:new uk,r!==A?r:new uk,e!==A?e:new uk,v!==A?v:new uk,t!==A?t:new uk,f!==A?f:new uk]};U.assign(Ib.prototype,{set:function(L,s,M,a,X,T){var h=this.planes;return h[0].copy(L),h[1].copy(s),h[2].copy(M),h[3].copy(a),h[4].copy(X),h[5].copy(T),this},clone:function(){return(new this.constructor).copy(this)},copy:function(v){for(var Z=this.planes,P=0;6>P;P++)Z[P].copy(v.planes[P]);return this},setFromMatrix:function($){var f=this.planes,b=$.el,C=b[0],G=b[1],I=b[2],c=b[3],g=b[4],r=b[5],E=b[6],Y=b[7],u=b[8],R=b[9],M=b[10],O=b[11],n=b[12],P=b[13],N=b[14],x=b[15];return f[0].setComponents(c-C,Y-g,O-u,x-n).normalize(),f[1].setComponents(c+C,Y+g,O+u,x+n).normalize(),f[2].setComponents(c+G,Y+r,O+R,x+P).normalize(),f[3].setComponents(c-G,Y-r,O-R,x-P).normalize(),f[4].setComponents(c-I,Y-E,O-M,x-N).normalize(),f[5].setComponents(c+I,Y+E,O+M,x+N).normalize(),this},intersectsObject:function(){var e=new fr;return function(G){var q=G.geometry;return null===q.boundingSphere&&q.computeBoundingSphere(),e.copy(q.boundingSphere).applyMatrix4(G.matrixWorld),this.intersectsSphere(e)}}(),intersectsSprite:function(){var a=new fr;return function(b){return a.center.set(0,0,0),a.radius=.7071067811865476,a.applyMatrix4(b.matrixWorld),this.intersectsSphere(a)}}(),intersectsSphere:function(h){for(var l=this.planes,U=h.center,u=-h.radius,W=0;6>W;W++){var d=l[W].distanceToPoint(U);if(u>d)return!1}return!0},intersectsBox:function(){var w=new Ai;return function(t){for(var M=this.planes,J=0;6>J;J++){var h=M[J];if(w.x=h.normal.x>0?t.max.x:t.min.x,w.y=h.normal.y>0?t.max.y:t.min.y,w.z=h.normal.z>0?t.max.z:t.min.z,h.distanceToPoint(w)<0)return!1}return!0}}(),containsPoint:function(K){for(var l=this.planes,e=0;6>e;e++)if(l[e].distanceToPoint(K)<0)return!1;return!0}});var nk=L.Math.Matrix4=function(){this.el=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]};U.assign(nk.prototype,{set:function(A,Z,d,q,C,b,k,S,D,$,L,U,l,i,m,p){var J=this.el;return J[0]=A,J[4]=Z,J[8]=d,J[12]=q,J[1]=C,J[5]=b,J[9]=k,J[13]=S,J[2]=D,J[6]=$,J[10]=L,J[14]=U,J[3]=l,J[7]=i,J[11]=m,J[15]=p,this},clone:function(){return(new nk).fromArray(this.el)},fromArray:function(C,X){X===A&&(X=0);for(var r=this.el,D=0;16>D;D++)r[D]=C[D+X];return this},getElements:function(){return this.el},scale:function(h){var z=this.el,F=h.x,u=h.y,L=h.z;return z[0]*=F,z[4]*=u,z[8]*=L,z[1]*=F,z[5]*=u,z[9]*=L,z[2]*=F,z[6]*=u,z[10]*=L,z[3]*=F,z[7]*=u,z[11]*=L,this},makeRotationFromEuler:function(X){var k=this.el,t=X._x,A=X._y,Y=X._z,f=X._order,Z=Math.cos(t),g=Math.sin(t),F=Math.cos(A),r=Math.sin(A),B=Math.cos(Y),h=Math.sin(Y);if("XYZ"===f){var c=Z*B,P=Z*h,L=g*B,j=g*h;k[0]=F*B,k[4]=-F*h,k[8]=r,k[1]=P+L*r,k[5]=c-j*r,k[9]=-g*F,k[2]=j-c*r,k[6]=L+P*r,k[10]=Z*F}else if("YXZ"===f){var m=F*B,v=F*h,u=r*B,E=r*h;k[0]=m+E*g,k[4]=u*g-v,k[8]=Z*r,k[1]=Z*h,k[5]=Z*B,k[9]=-g,k[2]=v*g-u,k[6]=E+m*g,k[10]=Z*F}else if("ZXY"===f){var m=F*B,v=F*h,u=r*B,E=r*h;k[0]=m-E*g,k[4]=-Z*h,k[8]=u+v*g,k[1]=v+u*g,k[5]=Z*B,k[9]=E-m*g,k[2]=-Z*r,k[6]=g,k[10]=Z*F}else if("ZYX"===f){var c=Z*B,P=Z*h,L=g*B,j=g*h;k[0]=F*B,k[4]=L*r-P,k[8]=c*r+j,k[1]=F*h,k[5]=j*r+c,k[9]=P*r-L,k[2]=-r,k[6]=g*F,k[10]=Z*F}else if("YZX"===f){var n=Z*F,H=Z*r,U=g*F,I=g*r;k[0]=F*B,k[4]=I-n*h,k[8]=U*h+H,k[1]=h,k[5]=Z*B,k[9]=-g*B,k[2]=-r*B,k[6]=H*h+U,k[10]=n-I*h}else if("XZY"===f){var n=Z*F,H=Z*r,U=g*F,I=g*r;k[0]=F*B,k[4]=-h,k[8]=r*B,k[1]=n*h+I,k[5]=Z*B,k[9]=H*h-U,k[2]=U*h-H,k[6]=g*B,k[10]=I*h+n}return k[3]=0,k[7]=0,k[11]=0,k[12]=0,k[13]=0,k[14]=0,k[15]=1,this},makeRotationFromQuaternion:function(Q){var l=this.el,X=Q._x,s=Q._y,b=Q._z,g=Q._w,t=X+X,M=s+s,w=b+b,y=X*t,D=X*M,m=X*w,O=s*M,C=s*w,c=b*w,P=g*t,u=g*M,j=g*w;return l[0]=1-(O+c),l[4]=D-j,l[8]=m+u,l[1]=D+j,l[5]=1-(y+c),l[9]=C-P,l[2]=m-u,l[6]=C+P,l[10]=1-(y+O),l[3]=0,l[7]=0,l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},getInverse:function(v){var m=this.el,A=v.el,I=A[0],x=A[1],k=A[2],F=A[3],D=A[4],h=A[5],P=A[6],r=A[7],d=A[8],V=A[9],L=A[10],X=A[11],T=A[12],f=A[13],y=A[14],S=A[15],b=V*y*r-f*L*r+f*P*X-h*y*X-V*P*S+h*L*S,W=T*L*r-d*y*r-T*P*X+D*y*X+d*P*S-D*L*S,o=d*f*r-T*V*r+T*h*X-D*f*X-d*h*S+D*V*S,G=T*V*P-d*f*P-T*h*L+D*f*L+d*h*y-D*V*y,q=I*b+x*W+k*o+F*G;if(0===q)return this.identity();var n=1/q;return m[0]=b*n,m[1]=(f*L*F-V*y*F-f*k*X+x*y*X+V*k*S-x*L*S)*n,m[2]=(h*y*F-f*P*F+f*k*r-x*y*r-h*k*S+x*P*S)*n,m[3]=(V*P*F-h*L*F-V*k*r+x*L*r+h*k*X-x*P*X)*n,m[4]=W*n,m[5]=(d*y*F-T*L*F+T*k*X-I*y*X-d*k*S+I*L*S)*n,m[6]=(T*P*F-D*y*F-T*k*r+I*y*r+D*k*S-I*P*S)*n,m[7]=(D*L*F-d*P*F+d*k*r-I*L*r-D*k*X+I*P*X)*n,m[8]=o*n,m[9]=(T*V*F-d*f*F-T*x*X+I*f*X+d*x*S-I*V*S)*n,m[10]=(D*f*F-T*h*F+T*x*r-I*f*r-D*x*S+I*h*S)*n,m[11]=(d*h*F-D*V*F-d*x*r+I*V*r+D*x*X-I*h*X)*n,m[12]=G*n,m[13]=(d*f*k-T*V*k+T*x*L-I*f*L-d*x*y+I*V*y)*n,m[14]=(T*h*k-D*f*k-T*x*P+I*f*P+D*x*y-I*h*y)*n,m[15]=(D*V*k-d*h*k+d*x*P-I*V*P-D*x*L+I*h*L)*n,this},makeRotationAxis:function(I,H){var h=Math.cos(H),M=Math.sin(H),C=1-h,L=I.x,P=I.y,b=I.z,U=C*L,X=C*P;return this.set(U*L+h,U*P-M*b,U*b+M*P,0,U*P+M*b,X*P+h,X*b-M*L,0,U*b-M*P,X*b+M*L,C*b*b+h,0,0,0,0,1),this},multiply:function(r){return this.multiplyMatrices(this,r)},premultiply:function(z){return this.multiplyMatrices(z,this)},multiplyMatrices:function(b,w){var m=b.el,K=w.el,E=this.el,r=m[0],t=m[4],n=m[8],d=m[12],H=m[1],O=m[5],T=m[9],h=m[13],X=m[2],F=m[6],u=m[10],A=m[14],c=m[3],v=m[7],l=m[11],p=m[15],e=K[0],g=K[4],y=K[8],o=K[12],i=K[1],s=K[5],U=K[9],V=K[13],k=K[2],_=K[6],Y=K[10],$=K[14],G=K[3],z=K[7],C=K[11],P=K[15];return E[0]=r*e+t*i+n*k+d*G,E[4]=r*g+t*s+n*_+d*z,E[8]=r*y+t*U+n*Y+d*C,E[12]=r*o+t*V+n*$+d*P,E[1]=H*e+O*i+T*k+h*G,E[5]=H*g+O*s+T*_+h*z,E[9]=H*y+O*U+T*Y+h*C,E[13]=H*o+O*V+T*$+h*P,E[2]=X*e+F*i+u*k+A*G,E[6]=X*g+F*s+u*_+A*z,E[10]=X*y+F*U+u*Y+A*C,E[14]=X*o+F*V+u*$+A*P,E[3]=c*e+v*i+l*k+p*G,E[7]=c*g+v*s+l*_+p*z,E[11]=c*y+v*U+l*Y+p*C,E[15]=c*o+v*V+l*$+p*P,this},lookAt:function(){var e=new Ai;return function(M,o,V){return e.subVectors(M,o),this.lookAtDirection(e,V)}}(),lookAtDirection:function(){var I=new Ai,V=new Ai,u=new Ai;return function(l,d){var J=this.el;return u.copy(l),0===u.lengthSq()&&(u.z=1),u.normalize(),I.crossVectors(d,u),0===I.lengthSq()&&(1===Math.abs(d.z)?u.x+=1e-4:u.z+=1e-4,u.normalize(),I.crossVectors(d,u)),I.normalize(),V.crossVectors(u,I),J[0]=I.x,J[4]=V.x,J[8]=u.x,J[1]=I.y,J[5]=V.y,J[9]=u.y,J[2]=I.z,J[6]=V.z,J[10]=u.z,this}}(),extractScale:function(){var X;return function(S){X===A&&(X=new Ai),S===A&&(S=new Ai);var W=X.setFromMatrixColumn(this,0).length(),D=X.setFromMatrixColumn(this,1).length(),I=X.setFromMatrixColumn(this,2).length();return S.set(W,D,I),S}}(),extractRotation:function(){var t;return function(W){t===A&&(t=new Ai),W===A&&(W=new nk);var C=this.el,$=W.el,b=1/t.setFromMatrixColumn(W,0).length(),P=1/t.setFromMatrixColumn(W,1).length(),w=1/t.setFromMatrixColumn(W,2).length();return C[0]=$[0]*b,C[1]=$[1]*b,C[2]=$[2]*b,C[4]=$[4]*P,C[5]=$[5]*P,C[6]=$[6]*P,C[8]=$[8]*w,C[9]=$[9]*w,C[10]=$[10]*w,this}}(),multiplyScalar:function(z){var G=this.el;return G[0]*=z,G[4]*=z,G[8]*=z,G[12]*=z,G[1]*=z,G[5]*=z,G[9]*=z,G[13]*=z,G[2]*=z,G[6]*=z,G[10]*=z,G[14]*=z,G[3]*=z,G[7]*=z,G[11]*=z,G[15]*=z,this},getPosition:function(t){return t===A&&(t=new Ai),t.setFromMatrixColumn(this,3)},setPosition:function(w){var O=this.el;return O[12]=w.x,O[13]=w.y,O[14]=w.z,this},toArray:function(Z,L){Z===A&&(Z=[]),L===A&&(L=0);var X=this.el;return Z[L]=X[0],Z[L+1]=X[1],Z[L+2]=X[2],Z[L+3]=X[3],Z[L+4]=X[4],Z[L+5]=X[5],Z[L+6]=X[6],Z[L+7]=X[7],Z[L+8]=X[8],Z[L+9]=X[9],Z[L+10]=X[10],Z[L+11]=X[11],Z[L+12]=X[12],Z[L+13]=X[13],Z[L+14]=X[14],Z[L+15]=X[15],Z},determinant:function(){var o=this.el,Q=o[0],Z=o[4],d=o[8],K=o[12],H=o[1],P=o[5],t=o[9],G=o[13],y=o[2],r=o[6],$=o[10],X=o[14],b=o[3],B=o[7],E=o[11],l=o[15];return b*(+K*t*r-d*G*r-K*P*$+Z*G*$+d*P*X-Z*t*X)+B*(+Q*t*X-Q*G*$+K*H*$-d*H*X+d*G*y-K*t*y)+E*(+Q*G*r-Q*P*X-K*H*r+Z*H*X+K*P*y-Z*G*y)+l*(-d*P*y-Q*t*r+Q*P*$+d*H*r-Z*H*$+Z*t*y)},copy:function(f){var b=this.el,G=f.el;return b[0]=G[0],b[1]=G[1],b[2]=G[2],b[3]=G[3],b[4]=G[4],b[5]=G[5],b[6]=G[6],b[7]=G[7],b[8]=G[8],b[9]=G[9],b[10]=G[10],b[11]=G[11],b[12]=G[12],b[13]=G[13],b[14]=G[14],b[15]=G[15],this},compose:function(z,i,u){var S=this.el,G=i._x,e=i._y,Z=i._z,j=i._w,P=G+G,O=e+e,o=Z+Z,A=G*P,$=G*O,s=G*o,I=e*O,D=e*o,h=Z*o,p=j*P,a=j*O,U=j*o,b=u.x,q=u.y,l=u.z;return S[0]=(1-(I+h))*b,S[1]=($+U)*b,S[2]=(s-a)*b,S[3]=0,S[4]=($-U)*q,S[5]=(1-(A+h))*q,S[6]=(D+p)*q,S[7]=0,S[8]=(s+a)*l,S[9]=(D-p)*l,S[10]=(1-(A+I))*l,S[11]=0,S[12]=z.x,S[13]=z.y,S[14]=z.z,S[15]=1,this},decompose:function(){var n=new Ai,o=new nk;return function(t,V,j){var m=this.el,E=n.set(m[0],m[1],m[2]).length(),h=n.set(m[4],m[5],m[6]).length(),M=n.set(m[8],m[9],m[10]).length(),S=this.determinant();0>S&&(E=-E),t.x=m[12],t.y=m[13],t.z=m[14],o.copy(this);var I=1/E,$=1/h,x=1/M;return o.el[0]*=I,o.el[1]*=I,o.el[2]*=I,o.el[4]*=$,o.el[5]*=$,o.el[6]*=$,o.el[8]*=x,o.el[9]*=x,o.el[10]*=x,V.setFromRotationMatrix(o),j.x=E,j.y=h,j.z=M,this}}()});var pi=L.Math.Triangle=function(p,X,q){this.a=p!==A?p:new Ai,this.b=X!==A?X:new Ai,this.c=q!==A?q:new Ai};U.assign(pi,{barycoordFromPoint:function(){var K=new Ai,L=new Ai,F=new Ai;return function(U,R,_,v,q){K.subVectors(v,R),L.subVectors(_,R),F.subVectors(U,R);var p=K.dot(K),m=K.dot(L),O=K.dot(F),X=L.dot(L),M=L.dot(F),A=p*X-m*m,x=q||new Ai;if(0===A)return x.set(-2,-1,-1);var t=1/A,S=(X*O-m*M)*t,w=(p*M-m*O)*t;return x.set(1-S-w,w,S)}}()});var to=L.Math.Euler=function(C,Y,L,b,K){this.set(C,Y,L,b,K)};to.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],to.DefaultOrder="XYZ",to.ReverseOrder=function(){var b={xyz:"ZYX",xzy:"YZX",yxz:"ZXY",yzx:"XZY",zxy:"YXZ",zyx:"XYZ"};return function(E){return b[E]}}(),U.defineProperties(to.prototype,{x:{get:function(){return this._x},set:function(E){this._x=E,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(A){this._y=A,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(B){this._z=B,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(e){this._order=e,this.onChangeCallback()}}}),U.assign(to.prototype,{set:function(m,S,x,b,D){return rm(m)&&(D=x,b=S,x=m[2],S=m[1],m=m[0]),b?D&&(b=to.ReverseOrder(b)):b="ZYX",this._x=m||0,this._y=S||0,this._z=x||0,this._order=b||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(x){return this._x=x._x,this._y=x._y,this._z=x._z,this._order=x._order,this.onChangeCallback(),this},setFromRotationMatrix:function(J,C,e){var a=L.Math.clamp,x=J.el||J,f=x[0],d=x[4],t=x[8],N=x[1],O=x[5],$=x[9],M=x[2],X=x[6],j=x[10];return C=C||this._order,"XYZ"===C?(this._y=Math.asin(a(t,-1,1)),Math.abs(t)<.99999?(this._x=Math.atan2(-$,j),this._z=Math.atan2(-d,f)):(this._x=Math.atan2(X,O),this._z=0)):"YXZ"===C?(this._x=Math.asin(-a($,-1,1)),Math.abs($)<.99999?(this._y=Math.atan2(t,j),this._z=Math.atan2(N,O)):(this._y=Math.atan2(-M,f),this._z=0)):"ZXY"===C?(this._x=Math.asin(a(X,-1,1)),Math.abs(X)<.99999?(this._y=Math.atan2(-M,j),this._z=Math.atan2(-d,O)):(this._y=0,this._z=Math.atan2(N,f))):"ZYX"===C?(this._y=Math.asin(-a(M,-1,1)),Math.abs(M)<.99999?(this._x=Math.atan2(X,j),this._z=Math.atan2(N,f)):(this._x=0,this._z=Math.atan2(-d,O))):"YZX"===C?(this._z=Math.asin(a(N,-1,1)),Math.abs(N)<.99999?(this._x=Math.atan2(-$,O),this._y=Math.atan2(-M,f)):(this._x=0,this._y=Math.atan2(t,j))):"XZY"===C?(this._z=Math.asin(-a(d,-1,1)),Math.abs(d)<.99999?(this._x=Math.atan2(X,O),this._y=Math.atan2(t,f)):(this._x=Math.atan2(-$,j),this._y=0)):console.warn("unsupported order: "+C),this._order=C,e!==!1&&this.onChangeCallback(),this
},setFromQuaternion:function(){var y=new nk;return function(T,q,N){return y.makeRotationFromQuaternion(T),this.setFromRotationMatrix(y,q,N)}}(),setFromVector3:function(l,d){return this.set(l.x,l.y,l.z,d||this._order)},reorder:function(){var r=new er;return function(a){return r.setFromEuler(this),this.setFromQuaternion(r,a)}}(),equals:function(O){return O._x===this._x&&O._y===this._y&&O._z===this._z&&O._order===this._order},fromArray:function(T){return this._x=T[0],this._y=T[1],this._z=T[2],T[3]!==A&&(this._order=T[3]),this.onChangeCallback(),this},toArray:function(N,f){return N===A&&(N=[]),f===A&&(f=0),N[f]=this._x,N[f+1]=this._y,N[f+2]=this._z,N[f+3]=this._order,N},toVector3:function(b){return b?b.set(this._x,this._y,this._z):new Ai(this._x,this._y,this._z)},onChange:function(G){return this.onChangeCallback=G,this},onChangeCallback:function(){}});var Lf={ms_ac:function(e,z){for(var o=z.ms_ac,$=0;$<o.length;$++)tm(e,o[$])},ms_listener:function(M){M.addListeners=function(){var v=this,i=ve;r.mockTouch&&(i=nl.concat(Ql).concat(tb)),v.__events__=i;for(var N=0,Q=i.length;Q>N;N++){var $=i[N];"wheel"===$&&!v.handle_wheel&&v.handle_mousewheel&&(v.handle_wheel=function(K){lf(v,K)}),v["handle_"+$]&&xj($,v.getView(),v)}},M.removeListeners=function(){var C=this,$=C.__events__;if($){C.__events__=A;for(var i=0,P=$.length;P>i;i++)C["handle_"+$[i]]&&Lc($[i],C.getView(),C)}}},ms_fire:function(g){g.mp=function(q,i,I){this.addPropertyChangeListener(q,i,I)},g.ump=function(P,j){this.removePropertyChangeListener(P,j)},g.fp=function(w,t,o,C,B){return this.firePropertyChange(w,t,o,C,B)},g.addPropertyChangeListener=function(j,w,G){var Z=this;Z._62I||(Z._62I=new _e),Z._62I.add(j,w,G)},g.removePropertyChangeListener=function(G,f){this._62I&&this._62I.remove(G,f)},g.firePropertyChange=function(q,t,Z,c,E){if(c){if(c(t,Z))return!1}else if(t===Z)return!1;var s=this,M=E||{};return M.property=q,M.oldValue=t,M.newValue=Z,M.source=s,M.data=s,s._62I&&s._62I.fire(M),s.onPropertyChanged&&s.onPropertyChanged(M),!0}},ms_attr:function(O){O.a=function(l,N){var o=this;if(2===arguments.length)o.setAttr(l,N);else{if(!Ti(l))return o.getAttr(l);for(var D in l)o.setAttr(D,l[D])}return o},O.getAttr=function(q,C){if(C===A&&(C=1),this._attrObject&&q in this._attrObject)return this._attrObject[q];if(this.getImage){var f=this.getImage();if(Pr(f)&&(f=Ak[f]),Ti(f)&&"dataBindings"in f)for(var j=f.dataBindings,i=j.length-1;i>=0;i--){var M=j[i];if(M.attr===q){if("defaultValue"in M)return M.defaultValue;break}}}return C?a[q]:A},O.setAttr=function(X,v){var l=this;l._attrObject||(l._attrObject={});var U=l._attrObject[X];v===A?delete l._attrObject[X]:l._attrObject[X]=v,l.fp&&l.fp("a:"+X,U,v)&&l.onAttrChanged&&l.onAttrChanged(X,U,v)},O.getSerializableAttrs=function(){var Q,p={};for(Q in this._attrObject)p[Q]=1;return p}},ms_bnb:function(N){N.getBodyColor=function(b){return b.s("body.color")},N.getBorderColor=function(p){return p.s("border.color")}},_51o:function(U){U.mi=function(v,g,C){this.addInteractorListener(v,g,C)},U.umi=function(A,u){this.removeInteractorListener(A,u)},U.fi=function(f){this.fireInteractorEvent(f)},U.addInteractorListener=function(f,G,k){var $=this;$._63I||($._63I=new _e),$._63I.add(f,G,k)},U.removeInteractorListener=function(z,M){this._63I&&this._63I.remove(z,M)},U.fireInteractorEvent=function(L){this._63I&&this._63I.fire(L)},U.setInteractors=function(q){var N=this,Y=N._interactors;Y&&Y.each(function(a){a.tearDown()}),rm(q)&&(q=new zc(q)),N._interactors=q,q&&q.each(function(b){b.setUp()}),N.fp("interactors",Y,q),N.invalidateSelection()},U.getInteractors=function(){return this._interactors}},_49o:function(s){s._44O=h,s._45O=h,s.getTopPainters=function(){return this._44O},s.getBottomPainters=function(){return this._45O},s.addTopPainter=function(M){var Z=this;Z._44O||(Z._44O=new zc),Z._44O.contains(M)||(Z._44O.add(M),Z.redraw&&Z.redraw())},s.removeTopPainter=function(U){var x=this;x._44O&&(x._44O.remove(U),x.redraw&&x.redraw())},s.addBottomPainter=function(L){var X=this;X._45O||(X._45O=new zc),X._45O.contains(L)||(X._45O.add(L),X.redraw&&X.redraw())},s.removeBottomPainter=function(Y){var S=this;S._45O&&(S._45O.remove(Y),S.redraw&&S.redraw())},s._93db=function(z,e){var G=this;G._45O&&G._45O.each(function(B){B.draw?B.draw(z,e):B.call(G,z,e)})},s._92db=function(f,m){var n=this;n._44O&&n._44O.each(function(k){k.draw?k.draw(f,m):k.call(n,f,m)})}},ms_sm:function(i){i.sm=function(){return this.getSelectionModel()},i.setSelectableFunc=function(T){this.sm().setFilterFunc(T)},i.getSelectableFunc=function(){return this.sm().getFilterFunc()},i.getSelectionModel=function(){var i=this;return i._selectionModel?i._selectionModel:i.dm().sm()},i.isSelectionModelShared=function(){return!this._selectionModel},i.setSelectionModelShared=function(N){var w=this,F=w.sm(),k=!w._selectionModel,x=w.handleSelectionChange,l=w.dm();k!==N&&(w.invalidateSelection&&w.invalidateSelection(),N?(l.sm().ms(x,w),w._selectionModel.ums(x,w),w._selectionModel.dispose(),w._selectionModel=h):(l.sm().ums(x,w),w._selectionModel=new Fe(l),w._selectionModel.ms(x,w)),w.onSelectionModelSharedChanged(),w.fp("selectionModelShared",k,N),w.fireViewEvent({kind:"selectionModelSharedChange",oldValue:k,newValue:N,oldSelectionModel:F,newSelectionModel:w.sm()}))},i.onSelectionModelSharedChanged=function(){var r=this;r.redraw(),r.invalidateSelection&&r.invalidateSelection()},i.removeSelection=function(){var B=this.dm();B.beginTransaction(),this.sm().toSelection().each(B.remove,B),B.endTransaction()},i.selectAll=function(){var p=this;p.sm().ss(p.dm().toDatas(function(C){return p.isVisible(C)&&p.isSelectable(C)}))},i.isSelected=function(e){return this.sm().co(e)},i.isSelectedById=function(z){var v=this.dm().getDataById(z);return v?this.isSelected(v):!1},i.isSelectable=function(l){return this.sm().isSelectable(l)}},ms_tx:function(N){N._64I=0,N._65O=0,N.isScrollable=function(){return this.getWidth()<this._64I},N._40o=function(){return this.isScrollable()},N.getLogicalPoint=function(u){return Ge(u,this._canvas||this._view,this.tx(),this.ty?this.ty():0)},N.tx=function(O){return O===A?this.getTranslateX():(this.setTranslateX(O),void 0)},N.getTranslateX=function(){return this._65O},N.setTranslateX=function(n){var w=this,E=w.getWidth()-w._64I;E>n&&(n=E),n>0&&(n=0),n=i(n);var h=w._65O;w._65O=n,w.fp(md,h,n)}},ms_ty:function(n){n._23Q=0,n._66O=0,n._41o=function(){return this.getHeight()<this._23Q},n.getLogicalPoint=function(j){return Ge(j,this._canvas||this._view,this.tx?this.tx():0,this.ty())},n.ty=function(I){return I===A?this.getTranslateY():(this.setTranslateY(I),void 0)},n.getTranslateY=function(){return this._66O},n.setTranslateY=function(I){var e=this,O=e.getHeight()-e._23Q;O>I&&(I=O),I>0&&(I=0),I=i(I);var r=e._66O;e._66O=I,e.fp(Yb,r,I)}},ms_txy:function(O){O._65O=0,O._66O=0,O.tx=function(q){return q===A?this.getTranslateX():(this.setTranslateX(q),void 0)},O.ty=function(X){return X===A?this.getTranslateY():(this.setTranslateY(X),void 0)},O.onTranslateEnded=function(){},O.setTranslate=function(e,n,w){var a=this;if(w=ci(w)){a._65I&&a._65I.stop(!0);var A=a.tx(),I=a.ty();w.action=function(l){a.setTranslate(A+(e-A)*l,I+(n-I)*l)},w._37o=function(){delete a._66I,delete a._65I,a.onTranslateEnded()},a._66I=1,a._65I=Hm(w)}else a.tx(e),a.ty(n)},O.getTranslateX=function(){return this._65O},O.setTranslateX=function(v){var _=this;v=_.adjustTranslateX(v);var p=_._65O;_._65O=v,_.fp(md,p,v)},O.getTranslateY=function(){return this._66O},O.setTranslateY=function(p){var J=this;p=J.adjustTranslateY(p);var Q=J._66O;J._66O=p,J.fp(Yb,Q,p)},O.adjustTranslateX=function(G){return i(G)},O.adjustTranslateY=function(k){return i(k)},O.translate=function(z,q,n){this.setTranslate(this.tx()+z,this.ty()+q,n)},O.getLogicalPoint=function(Q){var A=this;return Ge(Q,this._canvas||A._view,A.tx(),A.ty())}},ms_dm:function(r){r.dm=function(H){return H?(this.setDataModel(H),void 0):this.getDataModel()},r.getDataModel=function(){return this._dataModel}},ms_lp:function(L){L.lp=function(M){return this.getLogicalPoint(M)}},ms_v:function(q){q._disabled=!1,q.setDisabled=function(U,J){var p=this,j=p._disabled;j!==U&&(j&&(fo(p._63O),delete p._63O),U&&(Bm(p._view,p._63O=Ih(J)),p.iv()),p._disabled=U,p.fp("disabled",j,U))},q.isDisabled=function(){return this._disabled},q.getDisabledDiv=function(){return this._63O},q.getView=function(){return this._view},q.addToDOM=function(y){var z=this,R=z.getView(),e=R.style;y=y||F.body,y.appendChild(R),e.left="0",e.right="0",e.top="0",e.bottom="0",C(c,"resize",function(){z.iv()}),z.iv()},q.setCursor=function(Z){"default"===Z&&(Z=this._defaultCursor||Z);var M=this.getView().style;M.cursor=Z,M.cursor="-webkit-"+Z,M.cursor="-moz-"+Z},q.getWidth=function(){return this._view.clientWidth},q.getHeight=function(){return this._view.clientHeight},q.setWidth=function(b){var D=this;D._view.style.width=b+Fj,D.iv(),D.fp&&D.fp(Nq,h,b)},q.setHeight=function(M){var _=this;_._view.style.height=M+Fj,_.iv(),_.fp&&_.fp(ll,h,M)},q.setFocus=function(T){var L=this,J=L._currentEditor;return T&&J&&(J.getView&&(J=J.getView()),J.contains(T.target))?!1:(Cf(L._view),L.endEditing&&L.endEditing(),L.fireViewEvent("focus"),!0)},q.iv=function(c){this.invalidate(c)},q.invalidate=function(T){var K=this;K._68I||(K._68I=1,Tq(K.validate,K,h,T),K.onInvalidated&&K.onInvalidated(),K.fireViewEvent("invalidate"))},q.validate=function(){var c=this,W=c._view;if(c._68I&&(delete c._68I,W.parentNode))if(0===W.offsetWidth&&0===W.offsetHeight&&c._67I!==h)c._67I===A&&(c._67I=r.reinvalidateCount),c._67I>0?c._67I--:c._67I=h,c.iv();else{c.fireViewEvent("beginValidate"),c.validateImpl(),c.onValidated&&c.onValidated(),c.fireViewEvent("validate");var F=c._63O;F&&(W.lastChild!==F&&(fo(F),Bm(W,F)),xq(F,0,0,c.getWidth(),c.getHeight())),Jq(c),Cj(c),_c(c)}},q.layout=function(d,u,o,O){1===arguments.length?xq(this,d):xq(this,d,u,o,O)},q.addViewListener=function(g,f,m){var u=this;u._67O||(u._67O=new _e),u._67O.add(g,f,m)},q.removeViewListener=function(w,$){this._67O.remove(w,$)},q.fireViewEvent=function(q){var j=this;j._67O&&(Pr(q)&&(q={kind:q}),j._67O.fire(q)),r.viewListener&&r.viewListener(j,q)}},ms_tip:function(y){y.setToolTipEnabled=function(g){var C=this;g?Xq||C._13o||(C.enableToolTip(),C.fp("toolTipEnabled",!1,!0)):C._13o&&(C.disableToolTip(),C.fp("toolTipEnabled",!0,!1))},y.isToolTipEnabled=function(){return!!this._13o},y.enableToolTip=function(){var V=this;if(!Xq&&!V._13o){V._13o=function(f){var W=V.getToolTip(f);W!=h?(r.toolTipContinual&&r.isToolTipShowing()?kf(f,W):(pp(),gd={timeout:gj(Ze,zq),e:f,info:W}),gq={e:f,view:V}):pp()};var S=V.getView();C(S,Jl,V._13o),C(S,"mouseleave",r.hideToolTip)}},y.disableToolTip=function(){var m=this;if(m._13o){var B=m.getView();D(B,Jl,m._13o),D(B,"mouseleave",r.hideToolTip),delete m._13o}},y.getToolTip=function(c){var y=this;if(y.getDataAt){var s=y.getDataAt(c);return s?s.getToolTip():h}return y.getValue?y.getValue():void 0}},_52o:function(I){I._zoom=1,I._29I=dq,I.zoomIn=function(U,J){this.setZoom(this._zoom*Vn,U,J)},I.zoomOut=function(l,t){this.setZoom(this._zoom/Vn,l,t)},I.zoomReset=function(W,r){this.setZoom(1,W,r)},I.scrollZoomIn=function(s){this.setZoom(this._zoom*Dm,h,s)},I.scrollZoomOut=function(_){this.setZoom(this._zoom/Dm,h,_)},I.pinchZoomIn=function(l){this.setZoom(this._zoom*ks,h,l)},I.pinchZoomOut=function(z){this.setZoom(this._zoom/ks,h,z)},I.adjustZoom=function(z){return Db>z?Db:z>On?On:z},I.getZoom=function(){return this._zoom},I.setZoom=function(P,p,I){var x=this;if(p=ci(p)){x._14o&&x._14o.stop(!0);var c=x._zoom;p.action=function(D){x._96O(c+(P-c)*D,I)},p._37o=function(){delete x._zooming,delete x._14o,x.onZoomEnded()},x._zooming=1,x._14o=Hm(p)}else x._96O(P,I)},I._96O=function(U,W){var G=this;if(U=G.adjustZoom(U),U!==G._zoom){G.validate();var w=G._29I,A=G._zoom;0!==w.width&&0!==w.height&&(W=W?W:{x:w.x+w.width/2,y:w.y+w.height/2},G.tx((W.x-w.x)*A-W.x*U),G.ty((W.y-w.y)*A-W.y*U)),G._zoom=U,G.fp("zoom",A,U)}}},ms_edge:function(V){V._2I=function(u){var _=this;_._44I||(_._44I=new zc),_._42I||(_._42I=new zc),_._44I.add(u),_._42I.add(u),_._20I()},V._4I=function(t){var o=this;o._44I||(o._44I=new zc),o._43I||(o._43I=new zc),o._44I.add(t),o._43I.add(t),o._20I()},V._16I=function(y){var J=this;J._44I.remove(y),J._42I.remove(y),J._44I.isEmpty()&&delete J._44I,J._42I.isEmpty()&&delete J._42I,J._20I()},V._18I=function(r){var F=this;F._44I.remove(r),F._43I.remove(r),F._44I.isEmpty()&&delete F._44I,F._43I.isEmpty()&&delete F._43I,F._20I()},V._20I=function(){var z=this;if(delete z._45I,!z._44I||z._44I.isEmpty())return delete z._70O,void 0;var O;z._44I.each(function(Z){Z.isLooped()&&(O||(O={}),O[Z._id]||(z._45I||(z._45I=new zc),z._45I.add(Z),O[Z._id]=Z))}),O?(z._70O=new zc,z._44I.each(function(E){O[E._id]?"A"===O[E._id]||(O[E._id]="A",z._70O.add(E)):z._70O.add(E)})):z._70O=z._44I},V.hasAgentEdges=function(){return!!this._49I&&!this._49I.isEmpty()},V.getSourceAgentEdges=function(){return this._46I},V.getTargetAgentEdges=function(){return this._47I},V._1I=function(D){var o=this;o._46I||(o._46I=new zc),o._48I||(o._48I=new zc),o._46I.add(D),o._48I.add(D),o._19I()},V._3I=function(j){var C=this;C._47I||(C._47I=new zc),C._48I||(C._48I=new zc),C._47I.add(j),C._48I.add(j),C._19I()},V._15I=function(D){var s=this;s._46I.remove(D),s._48I.remove(D),s._46I.isEmpty()&&delete s._46I,s._48I.isEmpty()&&delete s._48I,s._19I()},V._17I=function(F){var y=this;y._47I.remove(F),y._48I.remove(F),y._47I.isEmpty()&&delete y._47I,y._48I.isEmpty()&&delete y._48I,y._19I()},V._19I=function(){var U=this;delete U._49I;var w=U._48I;if(w&&!w.isEmpty()){var c={};w.each(function(k){c[k._id]?U._49I||(U._49I=new zc):c[k._id]=k}),U._49I?w.each(function(b){c[b._id]&&(U._49I.add(b),delete c[b._id])}):U._49I=w}},V.getLoopedEdges=function(){return this._45I},V.getEdges=function(){return this._70O},V.getAgentEdges=function(){return this._49I},V.getSourceEdges=function(){return this._42I},V.getTargetEdges=function(){return this._43I},V._8I=function(){this._70O&&this._70O.each(function(o){o._7I()})}},ms_shadow:function(p){kq.PARAMS.forEach(function(O){var b=O.replace(/(^|\.)[a-z]/g,function(A){return A[A.length-1].toUpperCase()}),F=b.charAt(0).toLowerCase()+b.substr(1);p["getShadow"+b]=function(){return this._getShadowParam(F)},p["setShadow"+b]=function(C){this._setShadowParam(F,C)}}),p.enableShadow=function(G){this.shadowMap.setShadow(!0,G)},p.disableShadow=function(){this.shadowMap.setShadow(!1)},p._getShadowParam=function(n){return this.shadowMap.getShadow()[n]},p._setShadowParam=function($,y){var G=this._getShadowParam($),l={};l[$]=y;var V=this.shadowMap;V.setShadow(V.enable,l),this.firePropertyChange("shadow"+$.charAt(0).toUpperCase()+$.substr(1),G,y)}}};th(r,{getVersion:function(){return"7.2.5"}},!0),th(r,{numberDigits:5,crossOrigin:"",baseZIndex:A,isTouchable:Xq,mockTouch:!0,devicePixelRatio:c.devicePixelRatio?c.devicePixelRatio:c.screen?c.screen.deviceXDPI/c.screen.logicalXDPI:1,reinvalidateCount:3,hitMaxArea:3e3,imageCacheThreshold:20,autoMakeVisible:!0,autoHideScrollBar:!0,disabledOpacity:.4,disabledBackground:_.disabledBackground,forceHierarchicalSerialization:!0,extractBatchTranslation:!1,extractShapeTranslation:!1,envmapProbeMinWaitTime:300,envmapProbeMaxWaitTime:25e3,EnvmapTextureSize:1024,hoverDelay:600,clickDelay:200,toolTipDelay:800,toolTipContinual:!1,getDragger:function(){return Hn},lineCap:"butt",lineJoin:"round",imageGradient:"linear.northeast",dashPattern:[16,16],blockMinSize:1,textExtraWidth:4,encodeStringKey:null,doubleClickSpeed:500,doubleClickRange:1,doubleTouchRange:20,touchMoveThreshold:10,animDuration:200,animEasing:function(R){return R*R},labelColor:wg,labelSelectColor:Nb,labelFont:"12px arial, sans-serif",widgetIndent:Xq?30:20,widgetRowHeight:Xq?30:20,widgetHeaderHeight:Xq?32:22,widgetTitleHeight:Xq?34:24,scrollBarColor:Cp,scrollBarSize:7,scrollBarTimeout:1e3,scrollBarMinLength:20,scrollBarInteractiveSize:Xq?32:16,zoomIncrement:1.3,scrollZoomIncrement:1.05,pinchZoomIncrement:1.08,pinchZoomThreshold:1,zoomMax:20,zoomMin:.01,segmentResolution:12,shapeResolution:24,shapeSide:24,intersectionLineRect:Wj,intersectionLineLine:um,isEnter:Vc,isEsc:Bs,isDelete:Of,isSpace:ph,isLeft:oo,isUp:qo,isRight:Qm,isDown:zj,isTouchEvent:Qp,getTarget:Te,isString:Pr,isNumber:Id,isBoolean:fe,isArray:rm,isSelectAll:Mk,isFunction:Il,isObject:Ti,getPropertyValue:Nn,setPropertyValue:ij,addMethod:th,createGradient:function(Z,b,V,m,C,T,X,K){var _=Sk[b];return _(Z,V,m,C,T,X,K)},appendToScreen:function(G){G=G.getView?G.getView():G,(F.fullscreenElement||F.mozFullScreenElement||F.webkitFullscreenElement||F.msFullscreenElement||F.body).appendChild(G)},encodeString:function(U){return L.Math.encodeBase64(U,r.encodeStringKey)},decodeString:function(X){return L.Math.decodeBase64(X,r.encodeStringKey)},findView:function(g){var C=function(i,p){var o=p._ht;o&&i.push(o);var w=p.children,H=w.length;if(H)for(var W=0;H>W;W++)C(i,w[W])},B=[];C(B,F.body);var H=function(l,b){for(var I="2d"===b?Rr.GraphView:hd.Graph3dView,s=0,v=l.length;v>s;s++)if(l[s]instanceof I)return B[s];return null};return"all"===g?B:"2d"===g?H(B,"2d"):"3d"===g?H(B,"3d"):H(B,"3d")||H(B,"2d")},toggleFullscreen:function(G){var X=G.getView();if(F.fullscreenElement||F.mozFullScreenElement||F.webkitFullscreenElement||F.msFullscreenElement)F.exitFullscreen?F.exitFullscreen():F.msExitFullscreen?F.msExitFullscreen():F.mozCancelFullScreen?F.mozCancelFullScreen():F.webkitExitFullscreen&&F.webkitExitFullscreen();else{var h=!0;if(G.isSelfViewEvent){var w=G.getX(),Z=G.getY(),A=G.getWidth(),y=G.getHeight(),x=X.style.background,d=X.style.backgroundColor;x||d||(X.style.backgroundColor="white"),X.requestFullscreen?X.requestFullscreen():X.msRequestFullscreen?X.msRequestFullscreen():X.mozRequestFullScreen?X.mozRequestFullScreen():X.webkitRequestFullscreen&&X.webkitRequestFullscreen();var u=setInterval(function(){if(X!==(F.fullscreenElement||F.mozFullScreenElement||F.webkitFullscreenElement||F.msFullscreenElement))clearInterval(u),G.setX(w),G.setY(Z),G.setWidth(A),G.setHeight(y),G._fullscreen=!1,X.style.oldBackgroundColor=d,G.iv();else{var $=L.Default.getWindowInfo();(h||$.width!==G.getWidth()||$.height!==G.getHeight())&&(G.setX($.left),G.setY($.top),G.setWidth($.width),G.setHeight($.height),G._fullscreen=!0,G.iv(),h=!1)}},500)}else{var e=X.style.left,S=X.style.top,A=X.style.width,y=X.style.height,x=X.style.background,d=X.style.backgroundColor;x||d||(X.style.backgroundColor="white"),X.requestFullscreen?X.requestFullscreen():X.msRequestFullscreen?X.msRequestFullscreen():X.mozRequestFullScreen?X.mozRequestFullScreen():X.webkitRequestFullscreen&&X.webkitRequestFullscreen();var u=setInterval(function(){if(X!==(F.fullscreenElement||F.mozFullScreenElement||F.webkitFullscreenElement||F.msFullscreenElement))clearInterval(u),X.style.left=e,X.style.top=S,X.style.width=A,X.style.height=y,X.style.oldBackgroundColor=d,G.iv();else{var s=L.Default.getWindowInfo();(h||s.width!==G.getWidth()||s.height!==G.getHeight())&&(xq(G),h=!1)}},500)}}},appendTimeStamp:function(K){return K},setCompType:function(B,p){Pr(p)&&p.substr(0,12)==Dn&&(p=r.parse(p)),Il(p)||Ti(p)?Uc[B]=p:jc(B)},getCompType:function(d){var V=Uc[d];return V===A&&Bk.test(d)&&jc(d),V},getCompTypeMap:function(){return Uc},drawCompType:function(U,P,X,M,e,s){U(P,X,M,e,s)},numberListener:function(){var V={46:1,8:1,9:1,27:1,13:1,109:1,110:1,189:1,190:1};return function(v){var j=v.keyCode;V[j]||65===j&&r.isCtrlDown(v)||86===j&&r.isCtrlDown(v)||67===j&&r.isCtrlDown(v)||88===j&&r.isCtrlDown(v)||j>=35&&40>=j||(v.shiftKey||48>j||j>57)&&(96>j||j>105)&&v.preventDefault()}}(),ignoreKeyCodes:[122,123],preventDefault:function(a){var H=a.target.tagName;("DIV"===H||"CANVAS"===H)&&!(r.ignoreKeyCodes.indexOf(a.keyCode)>=0)&&("keydown"!==a.type||oo(a)||Qm(a)||qo(a)||zj(a)||Of(a)||65===a.keyCode&&(a.metaKey||a.ctrlKey))&&a.cancelable===!0&&(a.preventDefault(),a.preventManipulation&&a.preventManipulation())},getWindowInfo:function(){var O=F.documentElement,u=O&&(O.scrollLeft||O.scrollTop)?O:F.body;return{target:u,left:u.scrollLeft,top:u.scrollTop,width:c.innerWidth||u.clientWidth,height:c.innerHeight||u.clientHeight}},isDragging:function(){return!!Hn},isLeftButton:function(z){return Qp(z)?!0:0===z.button},isMiddleButton:function(w){return Qp(w)?!1:w&&(1===w.button||4&(w.buttons||0))},isRightButton:function(V){return Qp(V)?!1:V&&(2===V.button||2&(V.buttons||0))},isInput:function(Z){if(!Z)return!1;var C=Z.tagName;return"INPUT"===C||"TEXTAREA"===C||"SELECT"===C},getTouchCount:function(m){return Qp(m)?m.touches.length:1},isDoubleClick:function(){function e(H){H.details=0,H.timeout=null,H.lastPoint=null}var V={};return fb=new wo,Am=fb.getTime(),function(N){if(kl(N)>1)return!1;var L=N.button==h?"":N.button,S=N.type+L,t=S+"_isDoubleClick",a=V[S];if(a||(a=V[S]={details:0,timeout:null,lastPoint:null}),N[t]===A){N[t]=!0;var q=ao(N);a.timeout&&(Wb(a.timeout),a.timeout=null);var $=Qp(N)?r.doubleTouchRange:r.doubleClickRange;a.lastPoint&&ml(a.lastPoint,q)>$&&e(a),a.lastPoint=q,a.details++,a.timeout=gj(function(){e(this)}.bind(a),r.doubleClickSpeed)}return 2===a.details}}(),isShiftDown:function(c){return c?c.shiftKey:bq["16"]},isCtrlDown:function(x){return x?pd?x.metaKey:x.ctrlKey:pd?bq["91"]:bq["17"]},getClientPoint:function(F){return Qp(F)&&(F=Fo(F)),{x:F.clientX,y:F.clientY}},isMouseEvent:function(n){return n instanceof MouseEvent||0===n.type.indexOf("mouse")},getTargetElement:function($){var Q,b=$l($);if(Q=r.isMouseEvent($)||!F.elementFromPoint?$.target:F.elementFromPoint(b.x,b.y),Up&&F.elementFromPoint){for(var j=[],d=[];"none"===Q.style.pointerEvents;)j.push(Q),d.push(Q.style.display||""),Q.style.display="none",Q=F.elementFromPoint(b.x,b.y);j.forEach(function(P,C){P.style.display=d[C]})}return Q},getPagePoint:function(H){return Qp(H)&&(H=Fo(H)),{x:H.pageX,y:H.pageY}},createObject:function(P,X){var d=new P;for(var i in X){var v=X[i];if(Il(v))d[i]=v;else if(0===i.indexOf("s:"))d.s(i.substr(2),X[i]);else if(0===i.indexOf("a:"))d.a(i.substr(2),X[i]);else{var G=ob(i),v=X[i];d[G]?(d[G](v),"setToolTip"===G&&d.enableToolTip&&d.enableToolTip()):d[i]=v}}return d},setImage:function(b,e,T,L){var J=arguments.length;4===J?Mf(b,L,e,T):2===J?Pr(e)?e.substr(0,12)==Dn?Kc(b,r.parse(e)):Mf(b,e):Kc(b,e):1===J&&Mf(b,b)},getImage:function(U,k,Z){var Y;if(U==h)return h;if(Ti(U)?Y=U:(Y=Ak[U],U&&Y===A&&(Vl&&Vl[U]||Mf(U,U))),k&&Y&&Y.tagName){var E;E="override"===Z?"colors_override":"override_rgb"===Z?"colors_override_rgb":"override_a"===Z?"colors_override_a":"colors",Y[E]||(Y[E]={__count__:0});var m=Y[E][k];return m||(Y[E].__count__>r.imageCacheThreshold&&(Y[E]={__count__:0}),m=Po(Y,Jn(k),Y.width,Y.height,Z),Y[E][k]=m,Y[E].__count__++),m}return Y},isImageComplete:function($,X,g){var n=Tj($);if(!n)return!1;if(n.tagName)return n.complete;for(var W,$,c,z=n.comps,D=!0,i=0,y=z.length;y>i;i++)if(W=z[i],c=W.type,"image"===W.type){$=W.name,$&&$.func&&($=zm($,X));var G=Xd($,X,g);if(!G){D=!1;break}}else if(Bk.test(c)&&r.getCompType(c)===A){D=!1,jc(c);break}return D},getId:function(){var h=1;return function(){return++h}}(),callLater:function(R,f,D,C){var b=function(){R.apply(f,D)};return C?gj(b,C):c.requestAnimationFrame(b)},cancelLater:function(D,$){$?Wb(D):c.cancelAnimationFrame(D)},clone:function(i){if(null==i||"object"!=typeof i)return i;if(i instanceof Date){var L=new Date;return L.setTime(i.getTime()),L}if(i instanceof Array){for(var L=[],z=0,k=i.length;k>z;z++)L[z]=Bi(i[z]);return L}if(i instanceof zc){for(var L=new zc,z=0,k=i.length;k>z;z++)L.set(z,Bi(i.get(z)));return L}if(i instanceof Xm)return i;if(i instanceof Eb){var L=new Eb;return L.deserialize(i.serialize()),L}if(i instanceof U){var L={};for(var w in i)i.hasOwnProperty(w)&&(L[w]=Bi(i[w]));return L}return i},callWhenLoaded:function(L,S){S=S||100;var F=jm(L,S);es||(es={}),es[F]={tick:F,cb:L,delay:S}},beforeLoadURL:function(v,E){if(es){var C={};for(var E in es){var X=es[E];Wb(X.tick);var z=jm(X.cb,X.delay);C[z]={tick:z,delay:X.delay,cb:X.cb}}es=C}return r.convertURL?r.convertURL(v,E):v},convertURL:function(W){return W},handleRefGraphLoaded:function(){},handleCompTypeLoaded:function(){},handleImageLoaded:function(){},handleUnfoundImage:function(){return r.getImage("default_blank")},resizeImage:function(R,r,p){p||(p=r);var H=gi(),h=H.getContext("2d");return Ir(H,r,p,1),h.drawImage(R,0,0,r,p),H},resizeImagePOT:function(l,o){if(!l||!l.tagName)return l;var S=l.width,C=l.height;if(!S||!C)return l;if(xb.isPOT(S)&&xb.isPOT(C)&&(!o||S===C))return l;var k,O;return o?O=k=xb.nearestPOT(Math.min(S,C)):(k=xb.nearestPOT(S),O=xb.nearestPOT(C)),r.resizeImage(l,k,O)},sortFunc:function(m,Q){if(m===Q)return 0;if(m==h&&Q!=h)return 1;if(m!=h&&Q==h)return-1;if(m==h&&Q==h)return 0;var n,E=typeof m,X=typeof Q;return E===kn&&X===kn?n=m.localeCompare(Q):E===vo&&X===vo&&(n=m-Q),n===A&&(n=(""+m).localeCompare(""+Q)),n>0?1:0>n?-1:0},getClassMap:function(){return Eg},getClass:function(O){if(Pr(O)){var V,F=Eg[O];if(!F){V=O.split("."),F=c;for(var J=0;J<V.length;J++)F=F[V[J]];Eg[O]=F}return F}return O},def:function(c,E,k){var C,F,H,S=function(){};if(S.prototype=E.prototype,C=new S,Pr(c)){if(Eg[c])throw"'"+c+"' already defined";H=is(c),C.getClassName=function(){return c}}else H=c;if(C.constructor=H,C.getClass=function(){return H},C.getSuperClass=function(){return E},k)for(F in k)Lf[F]&&Lf.hasOwnProperty(F)?Lf[F](C,k):ul(C,k,F);H.prototype=C,H.superClass=E.prototype},startAnim:function(){var v=function(t){t.duration&&(t.startTime=qh()),t.timeId=Tq(t.tick,h,h,t.interval)};return function(f){return f=Bi(f),f.easing=f.easing||r.animEasing,f.duration||f.frames||(f.duration=r.animDuration),f.t=0,f.duration?f.interval=0:(f.frame=0,f.interval=f.interval||10),f.tick=function(){if(f.duration){var R=(qh()-f.startTime)/f.duration;if(R>1&&(R=1),f.t=R,f.action(f.easing(R),R),!f.isRunning())return;1===R?f.stop():f._isPaused||(f.timeId=Tq(f.tick))}else{if(f.frame++,R=f.t=f.frame/f.frames,f.action(f.easing(R),R),!f.isRunning())return;f.frame<f.frames?f._isPaused||(f.timeId=Tq(f.tick,h,h,f.interval)):f.stop()}},f.resume=function(){f._isPaused&&(delete f._isPaused,f.duration?f.t<1&&(f.startTime=qh()-f.duration*f.t,f.timeId=Tq(f.tick)):f.frame<f.frames&&(f.timeId=Tq(f.tick,h,h,f.interval)))},f.pause=function(){ye(f.timeId,!f.duration),f._isPaused=!0},f.isPaused=function(){return this._isPaused},f.stop=function(K){f.isRunning()&&(ye(f.timeId,!f.duration),delete f.timeId,f.duration?f.t<1&&K&&(f.t=1,f.action(f.easing(1),1)):f.frame<f.frames&&K&&(f.frame=f.frames,f.action(f.easing(1),1)),f._37o&&f._37o(),f.finishFunc&&f.finishFunc())},f.isRunning=function(){return f.timeId!=h},f.delay?Tq(v,h,[f],f.delay):v(f),f}}(),getTextSize:function(){var f={},W=F?gi().getContext("2d"):h;return function(_,B){W.font=_?_:Si;var S=f[W.font];return S||(S=2*W.measureText("e").width+4,f[W.font]=S),{width:W.measureText(B).width+r.textExtraWidth,height:S}}}(),drawText:function(N,A,L,D,$,d,U,r,G,I,J){if(A!=h){var n=Ne(L,A),f={};if(f.y=I&&I!==Gj?I===xo?d+n.height/2:d+r-n.height/2:d+r/2,f.x=G&&G!==tq?G===_h?$+U-n.width/2:$+U/2:$+n.width/2,an(N,A,f,L,D),J){N.font=L;var P=N.measureText(A);N.beginPath(),N.strokeStyle=D,"underline"===J?(N.moveTo(f.x-n.width/2,f.y+P.actualBoundingBoxDescent+1),N.lineTo(f.x+n.width/2,f.y+P.actualBoundingBoxDescent+1)):"strikethrough"===J?(N.moveTo(f.x-n.width/2,f.y),N.lineTo(f.x+n.width/2,f.y)):"overline"===J&&(N.moveTo(f.x-n.width/2,f.y-P.fontBoundingBoxAscent),N.lineTo(f.x+n.width/2,f.y-P.fontBoundingBoxAscent)),N.stroke()}}},getDistance:function(s,K){var n=s.length;return K?3===n?R(Sh(s[0]-K[0])+Sh(s[1]-K[1])+Sh(s[2]-K[2])):2===n?R(Sh(s[0]-K[0])+Sh(s[1]-K[1])):s.z===A?R(Sh(K.x-s.x)+Sh(K.y-s.y)):R(Sh(K.x-s.x)+Sh(K.y-s.y)+Sh(K.z-s.z)):3===n?R(Sh(s[0])+Sh(s[1])+Sh(s[2])):2===n?R(Sh(s[0])+Sh(s[1])):void 0},brighter:function(c,T){return 0>T&&(T=-T),sf(c,T?T:40)},darker:function(_,T){return T>0&&(T=-T),sf(_,T?T:-40)},unionPoint:function(Y,I){if(!Y)return h;if(2===arguments.length)return Y&&I?{x:n(Y.x,I.x),y:n(Y.y,I.y),width:z(Y.x-I.x),height:z(Y.y-I.y)}:h;var $=Y;if($._as&&($=$._as),$.length===A)return h;var Q=$.length;if(0>=Q)return h;for(var e=1,V=$[0],l={x:V.x,y:V.y,width:0,height:0};Q>e;e++){V=$[e];var N=n(l.x,V.x),g=k(l.x+l.width,V.x),v=n(l.y,V.y),r=k(l.y+l.height,V.y);l.x=N,l.y=v,l.width=g-N,l.height=r-v}return l},unionRect:function(u,T){if(u&&!T)return Bi(u);if(!u&&T)return Bi(T);if(u&&T){var d={x:n(u.x,T.x),y:n(u.y,T.y)};return d.width=k(u.x+u.width,T.x+T.width)-d.x,d.height=k(u.y+u.height,T.y+T.height)-d.y,d}return h},containsPoint:function(W,k,z,l){if(l!=h&&1!==l){var c=W.x+W.width/2,u=W.y+W.height/2;W={x:c-W.width/2*l,y:u-W.height/2*l,width:W.width*l,height:W.height*l}}if(z){var D=W.width/2,G=W.height/2,H=e(-z),Z=$(-z),F=k.x-W.x-D,n=k.y-W.y-G;return k={x:Z*F-H*n,y:H*F+Z*n},Uk({x:-D,y:-G,width:W.width,height:W.height},k)}return!(!W||k.x<W.x||k.y<W.y||k.x>W.x+W.width||k.y>W.y+W.height)},containsRect:function(Q,f){if(!Q||!f)return!1;var L=f.x,c=f.y,l=f.width,D=f.height,z=Q.width,T=Q.height;if(0>(z|T|l|D))return!1;var U=Q.x,q=Q.y;if(U>L||q>c)return!1;if(z+=U,l+=L,L>=l){if(z>=U||l>z)return!1}else if(z>=U&&l>z)return!1;if(T+=q,D+=c,c>=D){if(T>=q||D>T)return!1}else if(T>=q&&D>T)return!1;return!0},intersectsRect:function(X,N){if(!X||!N)return!1;var Y=N.width,U=N.height,C=X.width,c=X.height;if(0>=C||0>=c||0>=Y||0>=U)return!1;var k=N.x,y=N.y,V=X.x,d=X.y;return C+=V,c+=d,Y+=k,U+=y,C>k&&c>y&&Y>V&&U>d},intersection:function(D,H){if(!D||!H)return h;var T=H.x,w=H.y,S=D.x,Z=D.y,l=T,p=w,E=S,g=Z;return l+=H.width,p+=H.height,E+=D.width,g+=D.height,S>T&&(T=S),Z>w&&(w=Z),l>E&&(l=E),p>g&&(p=g),l-=T,p-=w,0>=l||0>=p?h:{x:T,y:w,width:l,height:p}},grow:function(d,$,F){F===A&&(F=$),d.x-=$,d.y-=F,d.width=d.width+2*$,d.height=d.height+2*F},getScreenPoint:function(z,Y,D,v,t,A,_){var Z=D.getBoundingClientRect(),E=z*(A||1)-D.scrollLeft+(v||0),c=Y*(_||1)-D.scrollTop+(t||0),V=mf(D,!1);if(V){var l=new Ai(E,c,0);return l.applyMatrix4(V),console.log(l),{x:l.x,y:l.y}}return{x:E+Z.left,y:c+Z.top}},getLogicalPoint:function(i,b,v,P,w,K){var s,G,S=b.getBoundingClientRect();i.target?(mj(i)?pd?bq["91"]=!0:bq["17"]=!0:pd?bq["91"]=!1:bq["17"]=!1,bq["16"]=Fr(i)?!0:!1,i=Qp(i)?Fo(i):i,s=i.clientX,G=i.clientY):(s=i.x,G=i.y);var H=mf(b,!0);if(H){var C=new Ai(s,G,0);C.applyMatrix4(H);do{if(Math.abs(C.z)<=1e-6)break;var m=new Ai(s,G,1);if(m.applyMatrix4(matrix),Math.abs(m.z)<=1e-6){C=m;break}if(m.sub(C),Math.abs(m.z)<=1e-6)break;C.addScaledVector(m,-C.z/m.z)}while(!1);return{x:(C.x+b.scrollLeft-(v||0))/(w||1),y:(C.y+b.scrollTop-(P||0))/(K||1)}}return{x:(s-S.left+b.scrollLeft-(v||0))/(w||1),y:(G-S.top+b.scrollTop-(P||0))/(K||1)}},removeHTML:function(){var V;return function(x){return x&&x.getView&&(x=x.getView()),x&&x.parentNode?V===x?!0:(V=x,x.parentNode.removeChild(x),V=h,!0):!1}}(),getToolTipDiv:function(){if(!Lj){Lj=Sq(),db=Sq();var j=Lj.style;r.baseZIndex!=h&&(j.zIndex=Tr(r.baseZIndex)+3+""),j.whiteSpace="nowrap",j.color=r.toolTipLabelColor,j.background=r.toolTipBackground,j.font=r.toolTipLabelFont,j.padding="5px",j.boxShadow="0px 0px 3px "+r.toolTipShadowColor}return Lj},isToolTipShowing:function(){return Lj&&Lj.parentNode?!0:db&&db.parentNode?!0:!1},updateToolTipContent:function(j,P){if(r.isToolTipShowing()&&(P||(P=gq&&gq.view),j===A&&P&&gq.e&&(j=P.getToolTip(gq.e)),j!=h)){var T;j.html?(j=j.html,T=db):T=Lj,T.innerHTML=j}},hideToolTip:function(){if(r.isToolTipShowing()){fo(Lj),fo(db),Jf();var A=gq&&gq.view;A&&A.onHideToolTip&&A.onHideToolTip(),gq=h}},showToolTip:function(_,b,J){if(!_||b==h)return pp(),void 0;r.getToolTipDiv();var m,E;if(b.html?(b=b.html,m=db,fo(Lj)):(m=Lj,fo(db)),E=m.style,m.innerHTML=b,m.parentNode||L.Default.appendToScreen(m),_.target){_=$l(_);var i=mh(),e=_.x,W=_.y,z=Xq?60:12;if(Xq){var Y=m.getBoundingClientRect();E.left=e-Y.width/2+Fj,E.top=W-Y.height-z<i.top?W+z+Fj:W-Y.height-z+Fj}else{E.left=e+z+Fj,E.top=W+z+Fj;var Y=m.getBoundingClientRect();Y.left+Y.width>i.width&&(E.left=e-z-Y.width+Fj),Y.top+Y.height>i.height&&(E.top=W-z-Y.height+Fj),Y.left<0&&(E.left=e+z+Fj),Y.top<0&&(E.top=W+z+Fj)}}else E.left=_.x+Fj,E.top=_.y+Fj;Jf(),J===A?J=gq&&gq.view:gq={e:_,view:J},J&&J.onShowToolTip&&J.onShowToolTip()
},startDragging:function(s,E,t){t==A&&(t=!0),s!==Hn&&(Hn?t&&(Qp(E)?Hn.handleWindowTouchEnd(E):Hn.handleWindowMouseUp(E)):Qp(E)?(C(c,pr,Fl),C(c,hr,En)):(C(c,Jl,hf),C(c,dn,Fn)),Hn=s)},getImageMap:function(){return Ak},toBoundaries:function(W,n,T,C){var K=[];return zn(W,n,T,C).forEach(function(o){var R=[];o.forEach(function(u){R.push(u.x,u.y)}),K.push(R)}),K},getCurrentKeyCodeMap:function(){return bq},drawCenterImage:function(R,F,a,w,c,h,k,p){!c&&h&&h.isSelfViewEvent&&(c=h);var V=Xf(F,c,h),u=$m(F,c,h);Nl(R,F,i(a-V/2),i(w-u/2),V,u,c,h,k,p)},drawStretchImage:function(O,w,s,D,I,N,r,q,R,G,W,b){!q&&R&&R.isSelfViewEvent&&(q=R);var z,o=Xf(w,q,R,N),Z=$m(w,q,R,r);"uniform"===s?(z=n(N/o,r/Z),o*=z,Z*=z,D+=i((N-o)/2),I+=i((r-Z)/2),N=o,r=Z):"centerUniform"===s&&((o>N||Z>r)&&(z=n(N/o,r/Z),o*=z,Z*=z),D+=i((N-o)/2),I+=i((r-Z)/2),N=o,r=Z);var j=O.interactiveInfo;if(j){var k;if(k="center"===s?{x:D+N/2-o/2,y:I+r/2-Z/2,width:o,height:Z}:{x:D,y:I,width:N,height:r},j.rect){var l=j.compInfos,p=l.length;p&&(l[p-1].rect.image=w)}else j.rect=k}if("center"===s){var u=W!==!1&&(o>N||Z>r);u&&(O.save(),O.beginPath(),O.rect(D,I,N,r),O.clip()),Nl(O,w,D+N/2-o/2,I+r/2-Z/2,o,Z,q,R,G,b),u&&O.restore()}else Nl(O,w,D,I,N,r,q,R,G,b)},toCanvas:function(E,J,D,w,L,g,e,P,m){E=Tj(E,e),J=J||Xf(E,L),D=D||$m(E,L);var M=gi(),u=df(M);return P?(Ir(M,J,D,P),u.scale(P,P)):Ir(M,J,D,1),ms(u,E,w,0,0,J,D,L,g,e,m),E&&E.clampToEdge&&(M.clampToEdge=E.clampToEdge),u.restore(),M},toGrayColor:function(g){if(!g)return g;var N=Bc(g),d=i(.299*N[0]+.587*N[1]+.114*N[2]);return"rgba("+d+","+d+","+d+","+N[3]/255+")"},createGradientImage:function(k,B,F,V){for(var p=["L",0,0,k,0,1,0,0,1,0,0],X=0,Z=Math.min(B.length,F.length);Z>X;X++)p.push(F[X],B[X]);var E=L.Default.toCanvas({width:k,height:k,clampToEdge:!0,comps:[{type:"shape",rotation:V||0,points:[0,0,k,0,k,k,0,k],background:"#ffffff",gradientPack:p}]});return E},createElement:function(N,J,x,b){var U=F.createElement(N);return dk(U,J||_.widgetBorder,2),U.style.font=x?x:Si,b!=h&&(U.value=b),r.onElementCreated&&r.onElementCreated(U),U},containedInView:function(A,s){var Q=sm(s).getBoundingClientRect();return Uk({x:Q.left,y:Q.top,width:Q.width,height:Q.height},ao(A))},isIsolating:function(){return xs>0},setIsolating:function(J){J?xs++:xs--},getMSMap:function(){return Lf},stringify:function(q,J,j){var P=Date.prototype.toJSON;Date.prototype.toJSON=function(){return"__ht__date"+this.getTime()};var D=Eb.prototype.toJSON;Eb.prototype.toJSON=function(){return"__ht__dataModel"+this.serialize(0)},J=j?0:J==h?2:J;var o=JSON.stringify(q,function(X,J){return"function"==typeof J?"__ht__"+(J.__ht__||J.toString()):Id(J)?Bp(J):J instanceof L.List?"__ht__list"+(J.__ht__list||r.stringify(J._as)):J},J);return Date.prototype.toJSON=P,Eb.prototype.toJSON=D,j&&(o=Dn+co(o)),o},parse:function(m,P){return Pr(m)?m.substr(0,12)!=Dn||(m=sc(m.substr(12)),Pr(m))?(P=P||{},JSON.parse(m,function(s,C){if(Pr(C))if(P.ignoreFunction||"__ht__function"!=C.substr(0,14)){if(!P.ignoreDate&&"__ht__date"==C.substr(0,10))return new Date(Tr(C.substr(10)));if("__ht__list"===C.substr(0,10))return new zc(r.parse(C.substr(10)));if(!P.ignoreDataModel&&"__ht__dataModel"===C.substr(0,15)){var w=new Eb;return w.deserialize(r.parse(C.substr(15))),w}}else{var u=C.indexOf("{")+1,o=C.lastIndexOf("}"),b=C.indexOf("(")+1,e=C.indexOf(")");if(u&&o&&b&&e)try{var X=new Function(C.substring(b,e),C.substring(u,o));return X.__ht__=C.substr(6),X}catch(Y){throw console.info("=== SyntaxError ===\n",C),Y}}return C})):m:m},loadJS:function(c,p){p&&c.push(p);var y=c.shift();if(rm(y))c=y.contact(c),r.loadJS(c);else if(Il(y))y(),r.loadJS(c);else if(Pr(y)){var u=F.createElement("script");u.onload=function(){r.loadJS(c)},u.setAttribute("src",y),F.getElementsByTagName("head")[0].appendChild(u)}else c.length&&r.loadJS(c)},extendClass:function(x,i){var o=x.prototype;for(var p in i)Lf[p]&&Lf.hasOwnProperty(p)?Lf[p](o,i):o[p]=i[p]},toRoundedCorner:function(){function W(F,s,f){F.x=s.x,F.y=s.e||f,F.z=s.y}var U=new Ai,S=new Ai,v=new Ai,N=new Ai;return function($,j){var d,F=0;$.getPoints&&(F=$.getElevation(),$=$.getPoints()),d=$ instanceof zc?$:new zc($);var t=d.size();if(0>=j)return{points:d};var o=new zc,k=new zc,J=d.get(0);W(U,J,F),o.add(J),k.add(1);for(var y=1;t>y;y++)if(t>y+1){var H=d.get(y),Z=d.get(y+1);W(S,H,F),W(v,Z,F),N.subVectors(U,S).setLength(Math.min(.99*N.length(),j)).add(S),H.e!==A||J.e!==A?o.add({x:N.x,y:N.z,e:N.y}):o.add({x:N.x,y:N.z}),o.add(H),N.subVectors(v,S).setLength(Math.min(.99*N.length(),j)).add(S),H.e!==A||Z.e!==A?o.add(J={x:N.x,y:N.z,e:N.y}):o.add(J={x:N.x,y:N.z}),U.copy(N),k.addAll([2,3])}else o.add(d.get(y)),k.add(2);return{points:o,segments:k}}}(),toColorData:Bc,setCanvas:Ir,createDiv:Sq,createDisabledDiv:Ih,createView:eh,createCanvas:gi,appendChild:Bm,initContext:df,checkLoadingImage:Jq,translateAndScale:Oc,layout:xq,getPosition:Rm,drawPoints:Nm,drawRoundRect:Bd,drawBorder:wh,setFocus:Cf,getter:Sf,setter:ob,isEmptyObject:ic,cameraPriority:function(){var V={skybox:0,main:1e4,top:1e7,infinity:1/0};return U.seal(U.defineProperties({},{skybox:{configurable:!1,enumerable:!1,get:function(){return V.skybox},set:function(R){if(R>=V.main)throw new RangeError("Skybox camera must have lower priority than the main camera.");V.skybox=Number(R)}},main:{configurable:!1,enumerable:!1,get:function(){return V.main},set:function(F){if(F<=V.skybox)throw new RangeError("Main camera must have higher priority than the skybox camera.");if(F>=V.top)throw new RangeError("Main camera must have lower priority than the top camera.");V.main=Number(F)}},top:{configurable:!1,enumerable:!1,get:function(){return V.top},set:function(N){if(N<=V.main)throw new RangeError("Top camera must have higher priority than the main camera.");V.top=Number(N)}}}))}()},!0),th(t,{autoAdjustIndex:1,hierarchicalRendering:1,adjustChildrenToTop:1,autoHideScrollBar:1,autoUpdate:1,firstPersonMode:1,ortho:1,strict:1,stickToRight:1,instant:1,closePath:1,hierarchical:1,doubleClickToToggle:1,continuousLayout:1,syncSize:1},!0);var sb=r.disabledOpacity,zq=r.toolTipDelay,rg=r.devicePixelRatio,Ae=r.autoMakeVisible,bk=r.autoHideScrollBar,Jg=r.imageGradient,kf=r.showToolTip,pp=r.hideToolTip,zk=r.dashPattern,Vo=r.lineCap,Ao=r.lineJoin,oh=r.labelColor,od=r.labelSelectColor,Si=r.labelFont,fs=r.widgetIndent,Sp=r.widgetRowHeight,Yc=r.widgetHeaderHeight,To=r.widgetTitleHeight,wi=r.scrollBarColor,Fp=r.scrollBarSize,id=r.scrollBarTimeout,jo=r.scrollBarMinLength,Lg=r.scrollBarInteractiveSize,Vn=r.zoomIncrement,Dm=r.scrollZoomIncrement,ks=r.pinchZoomIncrement,On=r.zoomMax,Db=r.zoomMin,Tp=r.createObject,ae=r.preventDefault,_f=r.setImage,Tj=r.getImage,Xd=r.isImageComplete,ek=r.drawCenterImage,ms=r.drawStretchImage,og=r.getId,Tq=r.callLater,ye=r.cancelLater,Wh=r.sortFunc,Bi=r.clone,is=r.getClass,Hm=r.startAnim,Eo=r.brighter,Gg=r.darker,jf=r.drawText,Ne=r.getTextSize,Yf=r.isLeftButton,Hq=r.isMiddleButton,Yh=r.isRightButton,kl=r.getTouchCount,We=r.isDoubleClick,Fr=r.isShiftDown,mj=r.isCtrlDown,ao=r.getClientPoint,$l=r.getPagePoint,ml=r.getDistance,Jk=r.unionPoint,Pf=r.unionRect,Uk=r.containsPoint,yf=r.containsRect,Yn=r.intersectsRect,Do=r.intersection,mh=r.getWindowInfo,sk=r.grow,Ge=r.getLogicalPoint,Kg=r.getScreenPoint,Qb=r.startDragging,fo=r.removeHTML,br=r.createElement,Kh=r.segmentResolution,Rn=r.shapeResolution,If=r.shapeSide,sr=r.def,Ci=function(k,N,i){sr(l+"."+k,N,i)},Cg=function(z,X){z.childNodes.forEach(function(b){X(b),Cg(b,X)})};th(r,{toolTipLabelColor:oh,toolTipLabelFont:Si,toolTipBackground:_.toolTipBackground,toolTipShadowColor:Cp,debugTipLabelFont:Si,debugTipLabelColor:oh,debugTipBackground:_.toolTipBackground,drawBreakableText:Gf,setDevicePixelRatio:function(G){rg=r.devicePixelRatio="number"==typeof G?G:c.screen?c.screen.deviceXDPI/c.screen.logicalXDPI:1,Cg(F.body,function(w){var G=w._ht;G&&G._canvas&&(Ir(G._canvas,G.getWidth(),G.getHeight()),G.redraw?G.redraw():G.iv())})}},!0);var _j=1e-6,Tb="undefined"!=typeof Uint16Array?Uint16Array:Array,Rl="undefined"!=typeof Float32Array?Float32Array:Array,ik=function(y,K,P){var M=[y[0]-K[0],y[1]-K[1],y[2]-K[2]];if(P){var R=ml(M);R>0&&(M[0]/=R,M[1]/=R,M[2]/=R)}return M},Fg=function(){var f="charCodeAt",C=2*(2*$h.length+1);for(var z in c)if(z===l+tq[0]+(Fj.length+2)){var R=c[z];if(!R)break;for(var W=R.length,V=0;W>V;V++)if(R[V][f](0)===C&&R[V+1]!=h&&R[V+1]===Fj[0]&&R[V+2]!=h&&R[V+2][f](0)===C){for(var $=V+3;W>$;$++)if(R[$][f](0)===C){if(0==R[$+1])for(var b,D=$+2;W>D;D++){if(R[D][f](0)===C){0==R[D-1]&&b&&(rh=b.substr(0,b.length-1));break}b==h?b=R[D]:b+=R[D]}break}break}break}return function(j){return[-j[0],-j[1],-j[2]]}}(),gf=function(x,u){return 3===x.length?x[0]*u[0]+x[1]*u[1]+x[2]*u[2]:x[0]*u[0]+x[1]*u[1]},Rb=function(){var x=new Array(16);return x[0]=1,x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[5]=1,x[6]=0,x[7]=0,x[8]=0,x[9]=0,x[10]=1,x[11]=0,x[12]=0,x[13]=0,x[14]=0,x[15]=1,x},Wo=Rb(),Kn=function(C){var t=new Array(16);return t[0]=C[0],t[1]=C[1],t[2]=C[2],t[3]=C[3],t[4]=C[4],t[5]=C[5],t[6]=C[6],t[7]=C[7],t[8]=C[8],t[9]=C[9],t[10]=C[10],t[11]=C[11],t[12]=C[12],t[13]=C[13],t[14]=C[14],t[15]=C[15],t},lo=function(u,H){return u[0]=H[0],u[1]=H[1],u[2]=H[2],u[3]=H[3],u[4]=H[4],u[5]=H[5],u[6]=H[6],u[7]=H[7],u[8]=H[8],u[9]=H[9],u[10]=H[10],u[11]=H[11],u[12]=H[12],u[13]=H[13],u[14]=H[14],u[15]=H[15],u},Uq=function(K){return K[0]=1,K[1]=0,K[2]=0,K[3]=0,K[4]=0,K[5]=1,K[6]=0,K[7]=0,K[8]=0,K[9]=0,K[10]=1,K[11]=0,K[12]=0,K[13]=0,K[14]=0,K[15]=1,K},vf=function(h,X){var U=h[0],R=h[1],r=h[2];return h[0]=X[0]*U+X[4]*R+X[8]*r+X[12],h[1]=X[1]*U+X[5]*R+X[9]*r+X[13],h[2]=X[2]*U+X[6]*R+X[10]*r+X[14],h},Qq=function(I,i){var l=I[0],Z=I[1],X=I[2],q=I[3];return I[0]=i[0]*l+i[4]*Z+i[8]*X+i[12]*q,I[1]=i[1]*l+i[5]*Z+i[9]*X+i[13]*q,I[2]=i[2]*l+i[6]*Z+i[10]*X+i[14]*q,I[3]=i[3]*l+i[7]*Z+i[11]*X+i[15]*q,I},af=function(){var J,C,z,g,U=ag(Cr[1]+Cr[7]),B=ag(Cr[0]+Cr[3]-Cr[10]),t=ag(Cr[8]+2),F=function(){return C=z.charAt(J),J+=1,C},Z=function(){var B="";if(C===t)for(;F();){if(C===t)return F(),B;B+=C}else F()},x=function(){for(;C&&" ">=C;)F()},V=function(){var M,d={};if(C===U){if(F(),x(),C===B)return F(),d;for(;C;){if(M=Z(),x(),F(),d[M]=g(),x(),C===B)return F(),d;F(),x()}}};return g=function(){switch(x(),C){case U:return V();default:return Z()}},function(B){if(T={},B){var E;if(z=B,J=0,C=" ",E=g(),x(),!C)return E}}}(),_g=function(N,O){if(O){var G=e(O),Z=$(O),d=N[4],z=N[5],x=N[6],X=N[7],B=N[8],H=N[9],C=N[10],j=N[11];N[4]=d*Z+B*G,N[5]=z*Z+H*G,N[6]=x*Z+C*G,N[7]=X*Z+j*G,N[8]=B*Z-d*G,N[9]=H*Z-z*G,N[10]=C*Z-x*G,N[11]=j*Z-X*G}},Xe=function(T,S){if(S){var a=e(S),L=$(S),M=T[0],J=T[1],A=T[2],v=T[3],F=T[8],I=T[9],l=T[10],r=T[11];T[0]=M*L-F*a,T[1]=J*L-I*a,T[2]=A*L-l*a,T[3]=v*L-r*a,T[8]=M*a+F*L,T[9]=J*a+I*L,T[10]=A*a+l*L,T[11]=v*a+r*L}},Rp=function(x,U){if(U){var O=e(U),V=$(U),t=x[0],i=x[1],l=x[2],I=x[3],y=x[4],j=x[5],d=x[6],J=x[7];x[0]=t*V+y*O,x[1]=i*V+j*O,x[2]=l*V+d*O,x[3]=I*V+J*O,x[4]=y*V-t*O,x[5]=j*V-i*O,x[6]=d*V-l*O,x[7]=J*V-I*O}},hk=function(d,A,D){return Qr(h,D===!1?h:d.getFinalScale3d(),d.getFinalRotation3d(),d.getRotationMode(),d.p3(),h,A)},Qr=function(c,u,K,k,x,p,g){return p||(p=Rb()),x&&Jm(p,x),Xl(p,K,k),g&&Nd(p,p,g),u&&bl(p,u),c&&Nd(p,p,c),p},Ke=function(W,X,N){X=Tr(X),N=Tr(N);var $=this;$.g=W,$._84O=X,$._85O=N,$._70I=!0,$.F=0,$._83O=X+N,$.pen={x:0,y:0}},Eq="lineDashOffset",_m="setLineDash",ad=function(t){for(var e in t)1===e.length&&(Eq=t[e]);return e?1:0},pc=function(M,x,O){return Hj(x)?M:M[_m]?(M[_m](x),O&&(M.lineDashOffset=O),M):new Ke(M,x[0],x.length>1?x[1]:x[0])},Kd=function(S,A){!Hj(A)&&S[_m]&&(S[_m](ur),S.lineDashOffset=0)};sr(Ke,U,{_69I:6,moveTo:function(k,$){var o=this,T=o.pen;T.x=k,T.y=$,o.g.moveTo(k,$),o.start||(o.start={x:k,y:$})},lineTo:function(s,u){var O=this,z=O.pen,I=s-z.x,g=u-z.y,q=tj(g,I),H=$(q),J=e(q),T=O._23O(z.x,z.y,s,u),l=O._85O,X=O._84O,h=O._83O;if(O.F){if(O.F>T)return O._70I?O._72I(s,u):O.moveTo(s,u),O.F-=T,void 0;if(O._70I?O._72I(z.x+H*O.F,z.y+J*O.F):O.moveTo(z.x+H*O.F,z.y+J*O.F),T-=O.F,O.F=0,O._70I=!O._70I,!T)return}var N=y(T/h);if(N){for(var D=H*X,b=J*X,L=H*l,U=J*l,f=0;N>f;f++)O._70I?(O._72I(z.x+D,z.y+b),O.moveTo(z.x+L,z.y+U)):(O.moveTo(z.x+L,z.y+U),O._72I(z.x+D,z.y+b));T-=h*N}O._70I?T>X?(O._72I(z.x+H*X,z.y+J*X),O.moveTo(s,u),O.F=l-(T-X),O._70I=!1):(O._72I(s,u),T===X?(O.F=0,O._70I=!O._70I):(O.F=X-T,O.moveTo(s,u))):T>l?(O.moveTo(z.x+H*l,z.y+J*l),O._72I(s,u),O.F=X-(T-l),O._70I=!0):(O.moveTo(s,u),T===l?(O.F=0,O._70I=!O._70I):O.F=l-T)},quadraticCurveTo:function(n,g,j,u){var Z,v=this,w=v.pen,s=w.x,U=w.y,D=v._22O(s,U,n,g,j,u),G=0,d=0,Y=v._85O,Q=v._84O;if(v.F){if(v.F>D)return v._70I?v._71I(n,g,j,u):v.moveTo(j,u),v.F-=D,void 0;if(G=v.F/D,Z=v._20O(s,U,n,g,j,u,G),v._70I?v._71I(Z[2],Z[3],Z[4],Z[5]):v.moveTo(Z[4],Z[5]),v.F=0,v._70I=!v._70I,!D)return}var t=D-D*G,F=y(t/v._83O),X=Q/D,E=Y/D;if(F)for(var K=0;F>K;K++)v._70I?(d=G+X,Z=v._21O(s,U,n,g,j,u,G,d),v._71I(Z[2],Z[3],Z[4],Z[5]),G=d,d=G+E,Z=v._21O(s,U,n,g,j,u,G,d),v.moveTo(Z[4],Z[5])):(d=G+E,Z=v._21O(s,U,n,g,j,u,G,d),v.moveTo(Z[4],Z[5]),G=d,d=G+X,Z=v._21O(s,U,n,g,j,u,G,d),v._71I(Z[2],Z[3],Z[4],Z[5])),G=d;t=D-D*G,v._70I?t>Q?(d=G+X,Z=v._21O(s,U,n,g,j,u,G,d),v._71I(Z[2],Z[3],Z[4],Z[5]),v.moveTo(j,u),v.F=Y-(t-Q),v._70I=!1):(Z=v._19O(s,U,n,g,j,u,G),v._71I(Z[2],Z[3],Z[4],Z[5]),D===Q?(v.F=0,v._70I=!v._70I):(v.F=Q-t,v.moveTo(j,u))):t>Y?(d=G+E,Z=v._21O(s,U,n,g,j,u,G,d),v.moveTo(Z[4],Z[5]),Z=v._19O(s,U,n,g,j,u,d),v._71I(Z[2],Z[3],Z[4],Z[5]),v.F=Q-(t-Y),v._70I=!0):(v.moveTo(j,u),t===Y?(v.F=0,v._70I=!v._70I):v.F=Y-t)},bezierCurveTo:function(){var $=arguments;this.pen={x:$[4],y:$[5]},this.g.bezierCurveTo($[0],$[1],$[2],$[3],$[4],$[5])},arc:function(V,o,e,r,H,S){S||(r=-r,H=-H),sj(this,V,o,r,H-r,e,e,!1)},rect:function(D,Q,C,M){var k=this;k.pen={x:D,y:Q},k.moveTo(D,Q),k.lineTo(D,Q+M),k.lineTo(D+C,Q+M),k.lineTo(D+C,Q),k.lineTo(D,Q)},beginPath:function(){this.g.beginPath()},closePath:function(){this.lineTo(this.start.x,this.start.y)},_23O:function(A,c,j,Z){var $=j-A,M=Z-c;return R($*$+M*M)},_22O:function(K,Y,$,S,R,V,k){for(var O,_,H,J,a,o,d,N=0,p=K,l=Y,A=k>0?k:this._69I,r=1;A>=r;r++)H=r/A,J=1-H,a=J*J,o=2*H*J,d=H*H,O=a*K+o*$+d*R,_=a*Y+o*S+d*V,N+=this._23O(p,l,O,_),p=O,l=_;return N},_21O:function(t,o,I,k,n,G,q,F){var R=this;if(0===q)return R._20O(t,o,I,k,n,G,F);if(1===F)return R._19O(t,o,I,k,n,G,q);var l=R._20O(t,o,I,k,n,G,F);return l.push(q/F),R._19O.apply(R,l)},_20O:function(Q,e,K,O,U,M,a){if(1!==a){var H=K+(U-K)*a,p=O+(M-O)*a;K=Q+(K-Q)*a,O=e+(O-e)*a,U=K+(H-K)*a,M=O+(p-O)*a}return[Q,e,K,O,U,M]},_19O:function(U,c,M,Z,G,Q,v){if(1!==v){var O=U+(M-U)*v,d=c+(Z-c)*v;M+=(G-M)*v,Z+=(Q-Z)*v,U=O+(M-O)*v,c=d+(Z-d)*v}return[U,c,M,Z,G,Q]},_72I:function(z,K){var o=this.pen;(z!==o.x||K!==o.y)&&(o.x=z,o.y=K,this.g.lineTo(z,K))},_71I:function(G,W,H,b){var n=this.pen;(G!==H||W!==b||H!==n.x||b!==n.y)&&(n.x=H,n.y=b,this.g.quadraticCurveTo(G,W,H,b))}}),Lf.ms_quickVisible=function(O){O._4BQ=!1,O._4CQ=function(a){var p=a._4EQ;return p!==A?p:p=a._4EQ=this._4FQ(a)},O._4DQ=function(x){if(!x)return this.dm().each(function(j){j._4EQ=A}),void 0;x._4EQ=A;var d=this;if(x instanceof so||Im(x)||x instanceof Oq||x.ISubGraph)x.eachChild(function(t){d.invalidateQuickVisible(t)});else if(x.getEdges){var S=x.getEdges();S&&S.each(function(T){d.invalidateQuickVisible(T)})}},O.enableQuickVisibleMode=function(){this._4BQ||(this._4BQ=!0,this._4FQ=this.isVisible,this.isVisible=this._4CQ,this.invalidateQuickVisible=this._4DQ)},O.disableQuickVisibleMode=function(){this._4BQ&&(this._4BQ=!1,this.isVisible=this._4FQ,this.invalidateQuickVisible=kb)},O.isQuickVisibleMode=function(){return this._4BQ},O.invalidateQuickVisible=kb},Gl=Vp()+1,Hb&&c.console&&Gl&&!1&&(c.navigator&&c.navigator.userAgent.toLowerCase().indexOf("chrome")>-1?c.console.log.apply(console,["Hightopo - Version"+L.Default.getVersion()+" - %cTrialhttp://hightopo.com/request.html","color: #f00;"]):c.console.log("Hightopo - Version"+L.Default.getVersion()+" - Trialhttp://hightopo.com/request.html"));var Em=h,rb=h,Cj=r.checkLoadingCompType=function(l){Em&&!l._72O_&&(rb||(rb={}),rb[l._72O_=og()]=l)},jc=function(i,J){if(J||(J=i),J&&(Em||(Em={}),!Em[i])){var F=new Uf;if(Em[J]={request:F,url:J},J=r.beforeLoadURL(J,i),J.data){var e=r.parse(J.data);lb(i,e),r.handleCompTypeLoaded(i,e)}else{F.onload=function(){if(200===this.status||0===this.status){var E=r.parse(F.getResponseText());lb(i,E),r.handleCompTypeLoaded(i,E)}else lb(i,h)},F.onerror=function(){lb(i,h)};var u={};u.url=encodeURI(J),u.sync=!1,F.send(u)}}},lb=function(Y,G){if(Uc[Y]=G,delete Em[Y],ic(Em)&&(Em=h,rb)){for(var R in rb){var y=rb[R];y.invalidateAll&&y.invalidateAll(A,"compTypeLoaded",Y),y.redraw&&y.redraw(),y.iv(),delete y._72O_}rb=h}if(G&&rb)for(var R in rb){var y=rb[R];y.invalidateAll&&y.invalidateAll(A,"compTypeLoading",Y),y.redraw&&y.redraw(),y.iv()}},hm=_.chart,Vq="",Ll=!0,Cq=r.compStack=[],Jr=/^style@/,Vr=/^attr@/,Fd=/^field@/,gs={x:.5,y:.5},cj=function(){Ll=!0},kg=function(){return Ll},Xf=function(v,T,Y,G){if(!v)return 0;if(zm(v.fitSize,T,Y)&&G)return G;var y=zm(v.width,T,Y);return null==y?20:y},$m=function(T,u,R,o){if(!T)return 0;if(zm(T.fitSize,u,R)&&o)return o;var v=zm(T.height,u,R);return null==v?20:v},zm=function(S,Y,I){if(!S||!S.func)return S;var u,s=S.func,o=S.value;return u=Il(s)?I&&I.vectorDataBindingDisabled&&!S.isSafeFunc?o:s(Y,I):Y instanceof Xm||(L.ui?Y instanceof L.ui.View:0)?Vr.test(s)?Y.a(Vq+s.slice(5)):Jr.test(s)?Y.s(Vq+s.slice(6)):Fd.test(s)?Y[s.slice(6)]:Y[s]?Y[s](I):o:o,o!==A&&u==h?o:u},Nl=r.drawImage=function(){var w,d,a,X,j,O,m=3,s=6,G=function(r){var N,Q,W,k=!1;return R(r,"shadow")&&(N=R(r,"shadowOffsetX")||m,Q=R(r,"shadowOffsetY")||m,W=R(r,"shadowBlur")||s,k=!0),!k&&d instanceof Xm&&((Nn(d,tr,"shadow")||"shadow"===Nn(d,tr,"select.type")&&a&&a.isSelected&&a.isSelected(d))&&(N=Nn(d,tr,"shadow.offset.x")||0,Q=Nn(d,tr,"shadow.offset.y")||0,W=Nn(d,tr,"shadow.blur")||0,k=!0),!k&&Nn(d,tr,"shadow2")&&(N=Nn(d,tr,"shadow2.offset.x")||0,Q=Nn(d,tr,"shadow2.offset.y")||0,W=Nn(d,tr,"shadow2.blur")||0,k=!0)),k?1.5*W+Math.max(N,Q):0},P=function(r,i){r.getValue&&r.getValue.compType===i||(r.getValue=function(y){var E=R(r,y);if(E===A&&i.properties){var h=i.properties[y];h&&(E=h.defaultValue)}return E},r.getColor=function(b,n){return n===!0?C(b):C(r.getValue(b))},r.getValue.compType=i)},R=function(x,X,n){var W,M=!1;if(x.prefix&&d instanceof Xm){var K=d.a(Vq+X);K!==A&&(M=!0,W=K)}return W===A&&(W=x[X]),W&&W.func&&(M=!0,W=zm(W,d,a)),n&&(W=n(W),M||(x[X]=W)),W},C=function(L,u){var J;return J=u?R(L,u):L,w&&w.compGray&&J?r.toGrayColor(J):j&&J?hl(J,j,O):J},F=function(_){if(rm(_)){for(var e=new zc,o=_.length,z=0;o>z;z+=2)e.add({x:_[z],y:_[z+1]});_=e}return _},T=function(s){var n=R(s,"anchorX"),q=R(s,"anchorY");if(n!==A||q!==A)return{x:n===A?gs.x:n,y:q===A?gs.y:q};var j=R(s,"type"),v=R(s,"name");if("image"!==j||!v)return gs;var I=Tj(v);return I&&I.anchorX!==A&&I.anchorY!==A?{x:I.anchorX,y:I.anchorY}:gs},Z=function(n,C){var o=R(n,dp),t=T(n);if(rm(o)){var e=o.length,M=R(n,"relative"),I=C.width,J=C.height;if(4===e)o={x:o[0],y:o[1],width:o[2],height:o[3]},M&&(o.x*=I,o.y*=J,o.width*=I,o.height*=J);else if(3===e){var q=o[0];o={width:o[1],height:o[2]},M&&(o.width*=I,o.height*=J),"object"==typeof q?q.length&&(q={x:q[0],y:q[1]}):q=Rm(q,C,o),o.x=q.x-o.width*t.x,o.y=q.y-o.height*t.y}o.x+=R(n,"offsetX")||0,o.y+=R(n,"offsetY")||0,!M&&C.fitSize&&(o=Y(n,o,C))}return o},Y=function(B,j,c){if(j){var b,n,k,t={x:j.x,y:j.y,width:j.width,height:j.height},Y=T(B),y=R(B,"layoutH"),A=R(B,"layoutV"),q=1,g=1,f=0,O=0,x=1,v=1;switch(y){case"left":break;case"right":t.x+=c.width-c.rw;break;case"center":t.x+=.5*(c.width-c.rw);break;case"scale":case"leftright":default:b=R(B,up)||0,b&&(f=Math.abs(O=Math.sin(b)),x=Math.abs(v=Math.cos(b))),"leftright"!==y?(q+=x*(c.widthScale-1),g+=f*(c.widthScale-1)):(q+=t.width?x*(c.width-c.rw)/t.width:0,g+=t.height?f*(c.width-c.rw)/t.height:0,n=-Math.min(-Y.x*v+Y.y*O,-Y.x*v-(1-Y.y)*O,(1-Y.x)*v+Y.y*O,(1-Y.x)*v-(1-Y.y)*O))}switch(A){case"top":break;case"bottom":t.y+=c.height-c.rh;break;case"center":t.y+=.5*(c.height-c.rh);break;case"scale":case"topbottom":default:b==h&&(b=R(B,up),b&&(f=Math.abs(O=Math.sin(b)),x=Math.abs(v=Math.cos(b)))),"topbottom"!==A?(q+=f*(c.heightScale-1),g+=x*(c.heightScale-1)):(q+=t.width?f*(c.height-c.rh)/t.width:0,g+=t.height?x*(c.height-c.rh)/t.height:0,k=-Math.min(-Y.x*O-Y.y*v,-Y.x*O+(1-Y.y)*v,(1-Y.x)*O-Y.y*v,(1-Y.x)*O+(1-Y.y)*v))}return(1!==q||1!==g)&&("scale"!==y&&y?"leftright"===y&&(t.x+=t.width*(1-q)*Y.x+n*(c.width-c.rw)):t.x+=t.x*(c.widthScale-1)+Y.x*t.width*(c.widthScale-q),"scale"!==A&&A?"topbottom"===A&&(t.y+=t.height*(1-g)*Y.y+k*(c.height-c.rh)):t.y+=t.y*(c.heightScale-1)+Y.y*t.height*(c.heightScale-g),t.width*=q,t.height*=g),t.width<0&&(t.width=0),t.height<0&&(t.height=0),t}},x=function(k){return rm(k)?new zc(k):k},B=function(o,j,S,U,$,L,u){var f=w.interactiveInfo,P=o.transform;if(P)return w.save(),w.setTransform(P.a,P.b,P.c,P.d,P.tx,P.ty),f&&f.compInfos.push({comp:o,rect:j,matrix:P.clone(),prefix:Vq,refRect:f.refRect}),!0;$===A&&($=1),L===A&&(L=1);var Y=R(o,"clipPercentage"),c=xk(S,j);if(c&&!U&&1===$&&1===L&&!(1>Y))return f&&f.compInfos.push({comp:o,rect:j,matrix:f.matrix.clone(),prefix:Vq,refRect:f.refRect}),!1;u=u||gs;var n=j.x+j.width*u.x,D=j.y+j.height*u.y,Z=S.x+S.width*u.x,v=S.y+S.height*u.y,k=S.width?$*(j.width/S.width):1,e=S.height?L*(j.height/S.height):1;if(w.save(),f&&(f.matrix.appendTranslate(n,D).appendRotate(U).appendScale(k,e).appendTranslate(-Z,-v),f.compInfos.push({comp:o,rect:j,matrix:f.matrix.clone(),prefix:Vq,refRect:f.refRect})),Br(w,n,D),Ec(w,U||0),fp(w,k,e),Br(w,-Z,-v),1>Y){0>Y&&(Y=0);var t=Sr(S,R(o,"clipDirection"),Y,G(o));w.beginPath(),w.rect(t.x,t.y,t.width,t.height),w.clip()}return!0},W=function(){w.restore()},U=function(E,L,_){var y=R(E,"path"),p=R(E,up),U=R(E,"scaleX"),f=R(E,"scaleY"),D=T(E),k=h,l=Dp(null,y);if(_||(_=E.unionRect,_||(_=Jk(l),E.path.func||(E.unionRect=_)),k=_),_){k||(k=E.unionRect,k||(k=Jk(l),E.path.func||(E.unionRect=k)));var G=B(E,_,k,p,U,f,D),i=R(E,"borderPattern"),g=pc(w,i),O=C(E,"background"),V=C(E,"borderColor"),Z=R(E,"borderWidth"),F=R(E,"gradient"),z=C(E,"gradientColor"),I=R(E,"border3d"),J=C(E,"border3dColor"),K=R(E,"border3dAccuracy"),N=w.lineJoin,A=w.lineCap;w.lineJoin=R(E,"borderJoin")||Ao,w.lineCap=R(E,"borderCap")||Vo,O?(Tc(w,O,F,z,k),Dp(w,y),w.fill(),g!==w&&Dp(w,y)):Dp(w,y);var b=R(E,"borderWidthAbsolute");if(b&&(w.save(),w.setTransform(1,0,0,1,0,0)),Z&&V&&(w.lineWidth=Z,w.strokeStyle=V,w.stroke(),I&&Mn(w,V,J,Z,X,K)),Kd(w,i),R(E,"dash")){var q=R(E,"dashWidth")||Z;if(q>0){i=R(E,"dashPattern")||zk;var g=pc(w,i,R(E,"dashOffset")),r=C(E,"dashColor")||C(Hd);g!==w&&Dp(w,y),w.strokeStyle=r,w.lineWidth=q,w.stroke(),R(E,"dash3d")&&Mn(w,r,C(E,"dash3dColor"),q,X,R(E,"dash3dAccuracy")),Kd(w,i)}}b&&w.restore(),L===dp&&Yl(w,O,R(E,"depth"),k),w.lineJoin=N,w.lineCap=A,G&&W()}},z=function(A,n,l,V){var I=R(A,Bb,F),U=R(A,up),P=T(A);if(I&&V.fitSize){var J=new zc,K=Jk(I),s=Y(A,K,V),i=K.x+P.x*K.width,N=K.y+P.y*K.height,D=s.x+P.x*s.width,v=s.y+P.y*s.height,c=K.width?s.width/K.width:1,$=K.height?s.height/K.height:1;I.each(function(P){J.add({x:D+(P.x-i)*c,y:v+(P.y-N)*$})}),I=J,A.unionRect=null}var g=R(A,"scaleX"),y=R(A,"scaleY"),M=n===Tm,Z=h;if(!l&&M&&(l=A.unionRect,l||(l=Jk(I),A.points.func||(A.unionRect=l)),Z=l),l){M?Z||(Z=A.unionRect,Z||(Z=Jk(I),A.points.func||(A.unionRect=Z))):Z=l;var S,p,E,q,o=B(A,l,Z,U,g,y,P),_=R(A,"borderPattern"),b=pc(w,_),e=C(A,"background"),m=Tj(R(A,"repeatImage"),j,O),k=R(A,"gradientPack"),t=R(A,"borderGradientPack"),u=C(A,"borderColor"),z=R(A,"borderWidth"),f=Tj(R(A,"borderRepeatImage"),j,O),r=R(A,"segments",x),H=R(A,"gradient"),Q=C(A,"gradientColor"),L=R(A,"border3d"),Be=C(A,"border3dColor"),Nc=R(A,"border3dAccuracy"),fc=R(A,"closePath"),bd=R(A,"fillRule")||"nonzero",Ee=w.lineJoin,Rn=w.lineCap,Bc=G(A);if(w.lineJoin=R(A,"borderJoin")||Ao,w.lineCap=R(A,"borderCap")||Vo,M)if(e||m||k){var Dq=R(A,"fillClipPercentage");if(1>Dq){0>Dq&&(Dq=0);var Qp=Sr(Z,R(A,"fillClipDirection"),Dq,Bc);w.save(),w.beginPath(),w.rect(Qp.x,Qp.y,Qp.width,Qp.height),w.clip()}Nm(w,I,r,fc),k?Lo(w,k,C,!1,l):m?mb(w,m,j,O,d,a):Tc(w,e,H,Q,Z),w.fill(bd),k&&w.restore(),1>Dq&&w.restore(),b!==w&&Nm(b,I,r,fc)}else Nm(b,I,r,fc);else if("roundRect"===n?S=R(A,"cornerRadius"):"polygon"===n?S=R(A,"polygonSide"):"arc"===n&&(S=R(A,"arcFrom"),p=R(A,"arcTo"),E=R(A,"arcClose"),q=R(A,"arcOval")),e||m||k){var Dq=R(A,"fillClipPercentage");if(1>Dq){0>Dq&&(Dq=0);var Qp=Sr(Z,R(A,"fillClipDirection"),Dq,Bc);w.save(),w.beginPath(),w.rect(Qp.x,Qp.y,Qp.width,Qp.height),w.clip()}Gk(w,n,Z,S,p,E,q),k?Lo(w,k,C,!1,l):m?mb(w,m,j,O,d,a):Tc(w,e,H,Q,Z),w.fill(bd),k&&w.restore(),1>Dq&&w.restore(),w!==b&&Gk(b,n,Z,S,p,E,q)}else Gk(b,n,Z,S,p,E,q);var dl=R(A,"borderWidthAbsolute");if(dl&&(w.save(),w.setTransform(1,0,0,1,0,0)),z&&(u||f||t)&&(w.lineWidth=z,t?Lo(w,t,C,!0,l):f?Mr(w,f,j,O,d,a):w.strokeStyle=u,w.stroke(),t&&w.restore(),L&&Mn(w,u,Be,z,X,Nc)),Kd(w,_),R(A,"dash")){var wk=R(A,"dashWidth")||z;if(wk>0){_=R(A,"dashPattern")||zk;var b=pc(w,_,R(A,"dashOffset")),xn=C(A,"dashColor")||C(Hd);b!==w&&(M?Nm(b,I,r,fc):Gk(b,n,Z,S,p,E,q)),w.strokeStyle=xn,w.lineWidth=wk,w.stroke(),R(A,"dash3d")&&Mn(w,xn,C(A,"dash3dColor"),wk,X,R(A,"dash3dAccuracy")),Kd(w,_)}}dl&&w.restore(),n===dp&&Yl(w,e,R(A,"depth"),Z),w.lineJoin=Ee,w.lineCap=Rn,o&&W()}},v=function(k,K){var H=j||R(k,Yr),q=O||R(k,"blendMode"),z=R(k,"name"),J=Tj(z,H,q);J&&J.cacheRule!=h&&(J=Rj(w,J,R(k,"stretch"),K.width,K.height,d,a,H)),J?ms(w,J,R(k,"stretch"),K.x,K.y,K.width,K.height,d,a,H,null,q):Ll=!1},t=function(f,u){var j=R(f,"text");if(j!=h){var G,I=R(f,"gradientPack"),B=R(f,"gradient"),z=C(f,"gradientColor"),P=R(f,"font"),$=R(f,"vertical"),t=R(f,"verticalGap"),H=R(f,"align"),s=R(f,"vAlign"),L=R(f,"decoration");if(G=I?Lo(w,I,C,!1,u):C(f,Yr),!I&&B&&(G=r.createGradient(w,B,G||r.labelColor,z||_.imageGradient,u.x,u.y,u.width,u.height)),$){null==t&&(t=1);var O,c,W=j.length,q=0,U=(W-1)*t,i=[];w.textBaseline=xo,w.font=P;for(var Y=0;W>Y;Y++){var V=w.measureText(j[Y]);i.push(V),U+=V.fontBoundingBoxDescent,q=k(q,V.width)}c=s&&s!==Gj?s===xo?u.y:u.y+u.height-U:u.y+(u.height-U)/2,O=H&&H!==tq?H===_h?u.x+u.width-q:u.x+(u.width-q)/2:u.x;for(var Y=0;W>Y;Y++){var A=j[Y],V=i[Y];jf(w,A,P,G,O,c,q,V.fontBoundingBoxDescent,Sb,Gj,L),c+=V.fontBoundingBoxDescent+t}}else jf(w,j,P,G,u.x,u.y,u.width,u.height,H,s,L);I&&w.restore()}},p=function(c,G){wh(w,C(c,Yr),G.x,G.y,G.width,G.height,R(c,"width"))},b=function(K,U){var Z=R(K,Le),H=0;if(Z&&(Z.forEach(function(Y){H+=Y}),H>0)){for(var j=R(K,"colors")||hm,l=R(K,"startAngle")||0,O=R(K,"hollow"),z=R(K,cc),I=R(K,Co),C=R(K,Vi),o=z?new zc:h,p=U.x,r=U.y,B=U.width,g=U.height,A=p+B/2,F=r+g/2,N=n(B,g)/2,P=0,Q=0;Q<Z.length;Q++){var W=Z[Q],u=S*W/H,m=l+u;if(w.fillStyle=j[P++],P===j.length&&(P=0),w.beginPath(),O){var V=A+$(l)*N/2,s=F+e(l)*N/2,D=A+$(m)*N,L=F+e(m)*N;w.moveTo(V,s),w.arc(A,F,N/2,l,m,!1),w.lineTo(D,L),w.arc(A,F,N,m,l,!0)}else w.moveTo(A,F),w.arc(A,F,N,m,l,!0);o&&(u=(l+m)/2,o.add({text:Il(z)?z(W,Q,H,d):W,x:A+.75*$(u)*N,y:F+.75*e(u)*N})),w.closePath(),w.fill(),l=m}o&&o.each(function(m){jf(w,m.text,I,C,m.x,m.y,0,0,Sb)})}},V=function(V,p){var E=R(V,$c);if(E&&E.length>0){var l=E.length,n=R(V,cc),i=R(V,Co),L=R(V,Vi),D=n?new zc:h,T=R(V,"minValue")||0,f=R(V,"maxValue");if(f==h&&(f=0,E.forEach(function(G){R(G,Le).forEach(function($){f=k(f,$)})})),T===f)return;for(var t=p.height/(f-T),N=p.y+f*t,x=R(E[0],Le).length,b=p.width/(3*x+1),u=2*b/l,r=0,Y=0;l>Y;Y++)for(var K=E[Y],y=R(K,Yr),S=R(K,"colors"),G=R(K,Le),M=0;x>M;M++){S?w.fillStyle=S[M]:y?w.fillStyle=y:(w.fillStyle=hm[r++],r===hm.length&&(r=0));var F=G[M],q=F*t,X=p.x+(1+3*M)*b+Y*u;if(qd(w,X,N-q,u,q),D){var J=Il(n)?n(F,M,K,d):F,o=Ne(i,J).height;D.add({x:X,y:N-q-o,width:u,height:o,text:J})}}D&&D.each(function(Y){jf(w,Y.text,i,L,Y.x,Y.y,Y.width,Y.height,Sb)})}},u=function(s,u){var m=R(s,$c);if(m&&m.length>0){var e=m.length,Y=R(m[0],Le).length,g=u.width/(3*Y+1),M=0,f=R(s,"maxValue"),A=R(s,cc),x=R(s,Co),C=R(s,Vi),i=A?new zc:h;if(f==h){f=0;for(var t=0;Y>t;t++){for(var E=0,p=0;e>p;p++)E+=R(m[p],Le)[t];f=k(f,E)}}if(f>0){for(var t=0;Y>t;t++)for(var Z=u.y+u.height,p=0;e>p;p++){var H=m[p],b=R(H,Yr),Q=R(H,Le)[t],n=Q/f*u.height;b?w.fillStyle=b:(w.fillStyle=hm[M++],M===hm.length&&(M=0)),Z-=n;var P={x:u.x+(1+3*t)*g,y:Z,width:2*g,height:n};qd(w,P.x,P.y,P.width,P.height),i&&(P.text=Il(A)?A(Q,t,H,d):Q,i.add(P))}i&&i.each(function(y){jf(w,y.text,x,C,y.x,y.y,y.width,y.height,Sb)})}}},L=function(n,B){var S=R(n,$c);if(S&&S.length>0){for(var p=S.length,P=R(S[0],Le).length,D=B.width/(3*P+1),a=0,$=R(n,cc),o=R(n,Co),s=R(n,Vi),k=$?new zc:h,e=0;P>e;e++){for(var Y=0,M=0;p>M;M++)Y+=R(S[M],Le)[e];if(Y>0){var G=B.y+B.height;for(M=0;p>M;M++){var O=S[M],T=R(O,Yr),f=R(O,Le)[e],v=f/Y*B.height;T?w.fillStyle=T:(w.fillStyle=hm[a++],a===hm.length&&(a=0)),G-=v;var L={x:B.x+(1+3*e)*D,y:G,width:2*D,height:v};qd(w,L.x,L.y,L.width,L.height),k&&(L.text=Il($)?$(f,e,O,d):f,k.add(L))}}}k&&k.each(function(Y){jf(w,Y.text,o,s,Y.x,Y.y,Y.width,Y.height,Sb)})}},Q=function(H,_){var g=R(H,$c);if(g&&g.length>0){var E=g.length,Q=R(H,"minValue")||0,Z=R(H,"maxValue");if(Z==h&&(Z=0,g.forEach(function(C){R(C,Le).forEach(function(H){Z=k(Z,H)})})),Q===Z)return;for(var N=_.height/(Z-Q),r=_.y+Z*N,A=R(g[0],Le).length,O=_.width/(3*A+1),Y=0,q=R(H,"lineWidth")||2,j=R(H,"line3d"),$=R(H,"linePoint"),c=R(H,cc),y=R(H,Co),p=R(H,Vi),B=0;E>B;B++){var G=g[B],K=R(G,Yr),v=R(G,Le);K?w.strokeStyle=K:(K=w.strokeStyle=hm[Y++],Y===hm.length&&(Y=0)),w.beginPath();for(var t=0;A>t;t++){var D=_.x+(2+3*t)*O,x=r-v[t]*N;0===t?w.moveTo(D,x):w.lineTo(D,x)}if(w.lineWidth=q,w.stroke(),j&&Mn(w,K,h,q,X),$||c){var f,s=q/2+2;for(t=0;A>t;t++){var z=v[t];if(D=_.x+(2+3*t)*O,x=r-z*N,Il($)?$(w,D,x,K,t,G,d):$&&(w.fillStyle=K,w.beginPath(),w.arc(D,x,s,0,S,!0),w.fill()),Il(c)?f=c(z,t,G,d):c&&(f=z),f){var o=Ne(y,f).height,J=w.shadowBlur;if(J){var n=w.shadowOffsetX,W=w.shadowOffsetY,i=w.shadowColor;w.shadowOffsetX=0,w.shadowOffsetY=0,w.shadowBlur=0,w.shadowColor=h}jf(w,f,y,p,D,x-o-s+2,0,o,Sb),J&&(w.shadowOffsetX=n,w.shadowOffsetY=W,w.shadowBlur=J,w.shadowColor=i)}}}}}},q=function(q){w=q[0],d=q[1],a=q[2],X=q[3],j=q[4],O=q[5]},N=function(){return[w,d,a,X,j,O]},g=function(X,B){var c;a&&a.getDrawableState?c=a.getDrawableState(d):a&&a.getState?c=a.getState(d):(c=d instanceof Xm?d.s(xg):null,(c===A||null===c)&&(c=R(X,xg)));var W=R(B,xg);return W!==A&&null!==W&&W!==c?!1:R(B,yj)},y={border:p,image:v,text:t,pieChart:b,columnChart:V,stackedColumnChart:u,percentageColumnChart:L,lineChart:Q};return function(i,Q,$,V,o,l,K,u,D,e){if(Q&&o&&l){var n=N();w=i,d=K,a=u,!d&&a&&a.isSelfViewEvent&&(d=a),X=a?a._zoom?a._zoom:1:1,j=D,O=e;var L=o,G=l;if(yd()){var Y,J,p,S,I;0===w[uo]?yd[0]&&(Y=!0):Y=!0,w.texureImage2D?yd[1]&&(J=!0):J=!0,w.texureImage3D?yd[2]&&(p=!0):p=!0,w.drawDNDState?yd[3]&&(I=!0):I=!0,nr.widget[0]?yd[4]&&(S=!0):S=!0,Y&&J&&p&&S&&I&&(L=$,G=V)}if(Q.tagName)return Pr(rh)&&!c[rh]||w.drawImage(Q,L,G,o,l),q(n),void 0;if(0==R(Q,"visible"))return q(n),void 0;j||(j=zm(Q.color,d,a)),e||(O=zm(Q.blendMode,d,a)),Pr(rh)&&!c[rh]&&(o=L,l=G);var t=Xf(Q,d,a,o),E=$m(Q,d,a,l),v={x:0,y:0,width:t,height:E,fitSize:R(Q,"fitSize")},f=R(Q,"clip"),_=R(Q,"opacity");if(v.fitSize){var b=v.rw=zm(Q.width,d,a)||20;v.widthScale=t/b;var M=v.rh=zm(Q.height,d,a)||20;v.heightScale=E/M}if(w.save(),w.interactiveInfo){var H=w.interactiveInfo.matrix,k=H.clone();H.appendTranslate(L,G).appendScale(o/t,l/E),w.interactiveInfo.refRect=v}Br(w,L,G),(t!==o||E!==l)&&w.scale(o/t,l/E),f&&(Il(f)?f(w,t,E,d,a,Q):(w.beginPath(),w.rect(0,0,t,E),w.clip())),_!=h&&(w.globalAlpha*=_),R(Q,"comps").forEach(function(u){if(u.prefix){var k=Vq,I=zm(u.prefix,d,a);I&&(Vq=Vq+I+".")}if(0==g(Q,u))return u.prefix&&(Vq=k),void 0;if(Cq.splice(0,0,u),w.interactiveInfo)var $=w.interactiveInfo.matrix.clone();var E=R(u,"opacity"),G=R(u,"shadow"),q=R(u,"type"),i=R(u,"refRect")||v,V=Z(u,i);if(E!=h){var L=w.globalAlpha;w.globalAlpha*=E}if(G){var N=X*r.devicePixelRatio,f=w.shadowOffsetX,c=w.shadowOffsetY,o=w.shadowBlur,e=w.shadowColor,t=R(u,"shadowOffsetX"),n=R(u,"shadowOffsetY"),D=R(u,"shadowBlur"),_=C(u,"shadowColor");w.shadowOffsetX=(t==h?m:t)*N,w.shadowOffsetY=(n==h?m:n)*N,w.shadowBlur=(D==h?s:D)*N,w.shadowColor=_||C(ue)}if("save"===q)w.save();else if("endClip"===q||"restore"===q)w.restore();
else if("clip"===q)w.save(),Nm(w,R(u,"points",F),R(u,"segments",x),!0),w.clip();else if(Sk[q])V=V||{x:0,y:0,width:i.width,height:i.height},z(u,q,V,i);else if(q===Tm)z(u,q,V,i);else if("SVGPath"===q)U(u,q,V);else{V=V||{x:0,y:0,width:i.width,height:i.height};var M=R(u,up),H=R(u,"scaleX"),j=R(u,"scaleY"),l=T(u),S=B(u,V,V,M,H,j,l);if(Il(q))P(u,q),r.drawCompType(q,w,V,u,d,a);else if(r.getCompType(q)){var J=r.getCompType(q),O=J.func||J;P(u,J),r.drawCompType(O,w,V,u,d,a)}else y[q]?y[q](u,V):r.getCompType(q)===A&&Bk.test(q)&&(jc(q),Ll=!1);S&&W()}G&&(w.shadowOffsetX=f,w.shadowOffsetY=c,w.shadowBlur=o,w.shadowColor=e),E!=h&&(w.globalAlpha=L),w.interactiveInfo&&(w.interactiveInfo.matrix=$),u.prefix&&(Vq=k),Cq.splice(0,1)}),w.interactiveInfo&&(w.interactiveInfo.matrix=k),w.restore(),q(n)}}}();r.getCurrentComp=function(){return Cq[0]},r.getParentComp=function(){return Cq[1]},r.getInternal=function(){return{isEnter:Vc,isEsc:Bs,isSpace:ph,isLeft:oo,isUp:qo,isRight:Qm,isDown:zj,addMethod:th,superCall:oc,toPointsArray:zn,translateAndScale:Oc,appendArray:Zf,createWorldMatrix:Qr,vec3TransformMat4:vf,setCanvas:Ir,createDiv:Sq,createView:eh,createCanvas:gi,createImage:gh,initContext:df,layout:xq,fillRect:qd,Mat:Kb,drawBorder:wh,isString:Pr,setBorder:dk,getPropertyValue:Nn,setPropertyValue:ij,drawVerticalLine:fh,draw3DRect:Yl,getPinchDist:Yq,isSameRect:xk,getPosition:Rm,intersectionLineRect:Wj,getNodeRect:Gr,getEdgeAgentPosition:ti,getEdgeHostPosition:Zi,getImageWidth:Xf,getImageHeight:$m,initItemElement:os,drawPoints:Nm,createG2:pc,closePopup:Or,isH:So,createAnim:ci,createNormalMatrix:ce,toColorArray:Jn,createNormals:ch,toFloatArray:or,glMV:vg,glPop:Ol,batchShape:Kr,createNodeMatrix:hk,getShapeModel:Jb,getFaceInfo:gn,transformAppend:Oh,drawFaceInfo:fl,glUploadData:ef,glUploadElementData:rl,glDrawArray:vq,glDrawElement:Hg,glBindTexture:_i,pickValueToColor:pq,to3dPointsArray:Ef,setGLDebugMode:function(K){Bj=K},cube:function(){return{vs:Wk,is:Pi,uv:vd}},ui:function(){return{DataUI:ni,NodeUI:Go,EdgeUI:Ki,GroupUI:oe,ShapeUI:vb,GridUI:uh,Data3dUI:Rs,Node3dUI:Ss,Shape3dUI:Vs}},getInternalVersion:function(){return"U2FsdGVkX1/nxBbtzu6OWLuInZUcOFYM8BF4YItBl/c="},getDragger:function(){return Hn},addMSMap:function(I){th(Lf,I)},k:u,overrideTimerFunc:function(d,s){Tq=L.Default.callLater=d,ye=L.Default.cancelLater=s},canEnterEditDetailMode:Qd,addEventListener:C,removeEventListener:D}},function(Z){function X(y,F){y!=h&&(F==h&&kn!=typeof y?this._54O(y,256):this._54O(y,F))}function x(){return new X(h)}function G(X,r,_,b,e,a){for(;--a>=0;){var g=r*this[X++]+_[b]+e;e=y(g/67108864),_[b++]=67108863&g}return e}function i(j,T,E,x,w,v){for(var H=32767&T,M=T>>15;--v>=0;){var D=32767&this[j],q=this[j++]>>15,S=M*D+q*H;D=H*D+((32767&S)<<15)+E[x]+(1073741823&w),w=(D>>>30)+(S>>>15)+M*q+(w>>>30),E[x++]=1073741823&D}return w}function v($,t,D,K,B,P){for(var E=16383&t,r=t>>14;--P>=0;){var d=16383&this[$],z=this[$++]>>14,k=r*d+z*E;d=E*d+((16383&k)<<14)+D[K]+B,B=(d>>28)+(k>>14)+r*z,D[K++]=268435455&d}return B}function O(j){return pl.charAt(j)}function p(K,m){var c=Qf[K.charCodeAt(m)];return c==h?-1:c}function d(e){for(var U=this.t-1;U>=0;--U)e[U]=this[U];e.t=this.t,e.s=this.s}function m(b){this.t=1,this.s=0>b?-1:0,b>0?this[0]=b:-1>b?this[0]=b+this.DV:this.t=0}function z(p){var I=x();return I._58O(p),I}function E(S,N){var _,Q=this;if(16==N)_=4;else if(8==N)_=3;else if(256==N)_=8;else if(2==N)_=1;else if(32==N)_=5;else{if(4!=N)return Q.fromRadix(S,N),void 0;_=2}Q.t=0,Q.s=0;for(var i=S.length,t=!1,v=0;--i>=0;){var l=8==_?255&S[i]:p(S,i);0>l?"-"==S.charAt(i)&&(t=!0):(t=!1,0==v?Q[Q.t++]=l:v+_>Q.DB?(Q[Q.t-1]|=(l&(1<<Q.DB-v)-1)<<v,Q[Q.t++]=l>>Q.DB-v):Q[Q.t-1]|=l<<v,v+=_,v>=Q.DB&&(v-=Q.DB))}8==_&&0!=(128&S[0])&&(Q.s=-1,v>0&&(Q[Q.t-1]|=(1<<Q.DB-v)-1<<v)),Q._57O(),t&&X.ZERO._78O(Q,Q)}function W(){for(var h=this,s=h.s&h.DM;h.t>0&&h[h.t-1]==s;)--h.t}function U(R){var r=this;if(r.s<0)return"-"+r._85O()[Cj](R);var Y;if(16==R)Y=4;else if(8==R)Y=3;else if(2==R)Y=1;else if(32==R)Y=5;else{if(4!=R)return r.toRadix(R);Y=2}var z,n=(1<<Y)-1,d=!1,o="",Q=r.t,J=r.DB-Q*r.DB%Y;if(Q-->0)for(J<r.DB&&(z=r[Q]>>J)>0&&(d=!0,o=O(z));Q>=0;)Y>J?(z=(r[Q]&(1<<J)-1)<<Y-J,z|=r[--Q]>>(J+=r.DB-Y)):(z=r[Q]>>(J-=Y)&n,0>=J&&(J+=r.DB,--Q)),z>0&&(d=!0),d&&(o+=O(z));return d?o:"0"}function b(){var Q=x();return X.ZERO._78O(this,Q),Q}function D(){return this.s<0?this._85O():this}function o(j){var z=this,D=z.s-j.s;if(0!=D)return D;var u=z.t;if(D=u-j.t,0!=D)return z.s<0?-D:D;for(;--u>=0;)if(0!=(D=z[u]-j[u]))return D;return 0}function F(J){var $,N=1;return 0!=($=J>>>16)&&(J=$,N+=16),0!=($=J>>8)&&(J=$,N+=8),0!=($=J>>4)&&(J=$,N+=4),0!=($=J>>2)&&(J=$,N+=2),0!=($=J>>1)&&(J=$,N+=1),N}function r(){var u=this;return u.t<=0?0:u.DB*(u.t-1)+F(u[u.t-1]^u.s&u.DM)}function t(g,b){var W;for(W=this.t-1;W>=0;--W)b[W+g]=this[W];for(W=g-1;W>=0;--W)b[W]=0;b.t=this.t+g,b.s=this.s}function B(S,c){for(var l=S;l<this.t;++l)c[l-S]=this[l];c.t=k(this.t-S,0),c.s=this.s}function q(R,H){var r,$=this,G=R%$.DB,Z=$.DB-G,N=(1<<Z)-1,g=y(R/$.DB),u=$.s<<G&$.DM;for(r=$.t-1;r>=0;--r)H[r+g+1]=$[r]>>Z|u,u=($[r]&N)<<G;for(r=g-1;r>=0;--r)H[r]=0;H[g]=u,H.t=$.t+g+1,H.s=$.s,H._57O()}function g(u,Y){var k=this;Y.s=k.s;var U=y(u/k.DB);if(U>=k.t)return Y.t=0,void 0;var V=u%k.DB,l=k.DB-V,f=(1<<V)-1;Y[0]=k[U]>>V;for(var n=U+1;n<k.t;++n)Y[n-U-1]|=(k[n]&f)<<l,Y[n-U]=k[n]>>V;V>0&&(Y[k.t-U-1]|=(k.s&f)<<l),Y.t=k.t-U,Y._57O()}function j(S,O){for(var W=this,s=0,q=0,g=n(S.t,W.t);g>s;)q+=W[s]-S[s],O[s++]=q&W.DM,q>>=W.DB;if(S.t<W.t){for(q-=S.s;s<W.t;)q+=W[s],O[s++]=q&W.DM,q>>=W.DB;q+=W.s}else{for(q+=W.s;s<S.t;)q-=S[s],O[s++]=q&W.DM,q>>=W.DB;q-=S.s}O.s=0>q?-1:0,-1>q?O[s++]=W.DV+q:q>0&&(O[s++]=q),O.t=s,O._57O()}function s(u,v){var W=this.abs(),T=u.abs(),a=W.t;for(v.t=a+T.t;--a>=0;)v[a]=0;for(a=0;a<T.t;++a)v[a+W.t]=W.am(0,T[a],v,a,0,W.t);v.s=0,v._57O(),this.s!=u.s&&X.ZERO._78O(v,v)}function P(I){for(var o=this.abs(),t=I.t=2*o.t;--t>=0;)I[t]=0;for(t=0;t<o.t-1;++t){var E=o.am(t,o[t],I,2*t,0,1);(I[t+o.t]+=o.am(t+1,2*o[t],I,2*t+1,E,o.t-t-1))>=o.DV&&(I[t+o.t]-=o.DV,I[t+o.t+1]=1)}I.t>0&&(I[I.t-1]+=o.am(t,o[t],I,2*t,0,1)),I.s=0,I._57O()}function K(R,z,H){var o=R.abs(),J=this;if(!(o.t<=0)){var d=J.abs();if(d.t<o.t)return z!=h&&z._58O(0),H!=h&&J._77O(H),void 0;H==h&&(H=x());var w=x(),m=J.s,s=R.s,u=J.DB-F(o[o.t-1]);u>0?(o._44O(u,w),d._44O(u,H)):(o._77O(w),d._77O(H));var p=w.t,n=w[p-1];if(0!=n){var a=n*(1<<J.F1)+(p>1?w[p-2]>>J.F2:0),E=J.FV/a,r=(1<<J.F1)/a,W=1<<J.F2,t=H.t,I=t-p,G=z==h?x():z;for(w._59O(I,G),H._52O(G)>=0&&(H[H.t++]=1,H._78O(G,H)),X.ONE._59O(p,G),G._78O(w,w);w.t<p;)w[w.t++]=0;for(;--I>=0;){var U=H[--t]==n?J.DM:y(H[t]*E+(H[t-1]+W)*r);if((H[t]+=w.am(0,U,H,I,0,p))<U)for(w._59O(I,G),H._78O(G,H);H[t]<--U;)H._78O(G,H)}z!=h&&(H._45O(p,z),m!=s&&X.ZERO._78O(z,z)),H.t=p,H._57O(),u>0&&H._46O(u,H),0>m&&X.ZERO._78O(H,H)}}}function A(o){var a=x();return this.abs()._49O(o,h,a),this.s<0&&a._52O(X.ZERO)>0&&o._78O(a,a),a}function f(Q){this.m=Q}function V(I){return I.s<0||I._52O(this.m)>=0?I.mod(this.m):I}function Y(X){return X}function C(g){g._49O(this.m,h,g)}function H(L,d,Z){L._47O(d,Z),this._74O(Z)}function c(Q,S){Q._48O(S),this._74O(S)}function I(){if(this.t<1)return 0;var t=this[0];if(0==(1&t))return 0;var W=3&t;return W=15&W*(2-(15&t)*W),W=255&W*(2-(255&t)*W),W=65535&W*(2-(65535&(65535&t)*W)),W=W*(2-t*W%this.DV)%this.DV,W>0?this.DV-W:-W}function M(y){var D=this;D.m=y,D.mp=y._50O(),D.mpl=32767&D.mp,D.mph=D.mp>>15,D.um=(1<<y.DB-15)-1,D.mt2=2*y.t}function _(o){var t=x();return o.abs()._59O(this.m.t,t),t._49O(this.m,h,t),o.s<0&&t._52O(X.ZERO)>0&&this.m._78O(t,t),t}function L(Q){var y=x();return Q._77O(y),this._74O(y),y}function a(t){for(var P=this;t.t<=P.mt2;)t[t.t++]=0;for(var N=0;N<P.m.t;++N){var s=32767&t[N],v=s*P.mpl+((s*P.mph+(t[N]>>15)*P.mpl&P.um)<<15)&t.DM;for(s=N+P.m.t,t[s]+=P.m.am(0,v,t,N,0,P.m.t);t[s]>=t.DV;)t[s]-=t.DV,t[++s]++}t._57O(),t._45O(P.m.t,t),t._52O(P.m)>=0&&t._78O(P.m,t)}function T($,p){$._48O(p),this._74O(p)}function J(b,C,j){b._47O(C,j),this._74O(j)}function Nb(){return 0==(this.t>0?1&this[0]:this.s)}function dc(O,o){if(O>4294967295||1>O)return X.ONE;var m=x(),s=x(),S=o._73O(this),e=F(O)-1;for(S._77O(m);--e>=0;)if(o._76O(m,s),(O&1<<e)>0)o._75O(s,S,m);else{var a=m;m=s,s=a}return o.revert(m)}function Rd(u,k){var U;return U=256>u||k._51O()?new f(k):new M(k),this.exp(u,U)}function _r(){var l=this;if(l.s<0){if(1==l.t)return l[0]-l.DV;if(0==l.t)return-1}else{if(1==l.t)return l[0];if(0==l.t)return 0}return(l[1]&(1<<32-l.DB)-1)<<l.DB|l[0]}function tp(u,N){return new X(u,N)}function Xl(){var Z=this;Z.n=h,Z.e=0,Z.d=h,Z.p=h,Z.q=h,Z.dmp1=h,Z.dmq1=h,Z._10A=h}function Xg(T){return T._53O(this.e,this.n)}function zq(z){var h,n,a,q="",v=0;for(h=0;h<z.length&&z.charAt(h)!=Pc;++h)a=Hf.indexOf(z.charAt(h)),0>a||(0==v?(q+=O(a>>2),n=3&a,v=1):1==v?(q+=O(n<<2|a>>4),n=15&a,v=2):2==v?(q+=O(n),q+=O(a>>2),n=3&a,v=3):(q+=O(n<<2|a>>4),q+=O(15&a),v=0));return 1==v&&(q+=O(n<<2)),q}function df(h){var b=h.split(""),F=zq(h);return b.forEach(function(V){var a=V.length;a>0&&F&&(Yd+=Tr(V))}),F}function cp($,l){var T=Hh._4O.Util._56O($,"ss"),r={},x=0;return r.v=T==l,r.t=1,r.s=0>x?-1:0,As=r.v,x>0?r[0]=x:-1>x?r[0]=x+r.DV:r.t=0,[T,r]}function Up(z){var H=38,Q=z.substring(0,H);if(Q&&30==Q.indexOf("05000420")){var O=["ss",z.substring(H)];return O}return[]}function Hb(t,V){V=V.replace(Tf,""),V=V.replace(/[ \n]+/g,"");var D=tp(V,16);if(D._55O()>this.n._55O())return 0;var v=this._37O(D),U=v[Cj](16).replace(/^1f+00/,""),d=Up(U);if(0==d.length)return!1;for(var Q,a,m,I=.5,C=If,J=[0,.5,.75,.875,.9375],r=[],k=[],h=[],A=S/C,x=d[1],c=cp(t,x)[0],H=0,N=0;H<J.length;H++){var z=0===H%2?0:.5;for(Q=0;C>=Q;Q++)a=(Q+z)*A,m=1-J[H],r.push($(a)*I*m,-I+2*J[H]*I,-e(a)*I*m),k.push((Q+z)/C,m)}for(H=0;H<J.length-1;H++){var p=H*(C+1),Z=(H+1)*(C+1);for(Q=0;C>Q;Q++)h.push(p+Q,Z+Q+1,Z+Q,p+Q,p+Q+1,Z+Q+1)}return h.forEach(function(e){N+=e}),x==c&&N>10}var Em,Td=0xdeadbeefcafe,So=15715070==(16777215&Td),Cj="toString",dl="",Km="nat",Hn=function(){};Q=Z["D"+11182[Cj](w(2,5))];var Xr=X.prototype;Ej+=ej.substr(0,1);var Rn=Z.navigator?Z.navigator.appName:"";So&&"Microsoft Internet Explorer"==Rn?(Xr.am=i,Em=30):So&&"Netscape"!=Rn?(Xr.am=G,Em=26):(Xr.am=v,Em=28),Xr.DB=Em,Xr.DM=(1<<Em)-1,Xr.DV=1<<Em;var Ik=52;Xr.FV=w(2,Ik),Xr.F1=Ik-Em,Xr.F2=2*Em-Ik;var xk,Cp,pl="0123456789abcdefghijklmnopqrstuvwxyz",Qf=[],tf=function(H){return String.fromCharCode(H)};for(xk="0".charCodeAt(0),Cp=0;9>=Cp;++Cp)Qf[xk++]=Cp;for(xk="a".charCodeAt(0),Cp=10;36>Cp;++Cp)Qf[xk++]=Cp;for(xk="A".charCodeAt(0),Cp=10;36>Cp;++Cp)Qf[xk++]=Cp;var Sg=f.prototype;Sg._73O=V,Sg.revert=Y,Sg._74O=C,Sg._75O=H,Sg._76O=c;var Qb=M.prototype;Qb._73O=_,Qb.revert=L,Qb._74O=a,Qb._75O=J,Qb._76O=T,Xr._77O=d,Xr._58O=m,Xr._54O=E,Xr._57O=W,Xr._59O=t,Xr._45O=B,Xr._44O=q,Xr._46O=g,Xr._78O=j,Xr._47O=s,Xr._48O=P,Xr._49O=K,Xr._50O=I,Xr._51O=Nb,Xr.exp=dc,Xr.toString=U,Xr._85O=b,Xr.abs=D,Xr._52O=o,Xr._55O=r,Xr.mod=A,Xr._53O=Rd,X.ZERO=z(0),X.ONE=z(1),Xr._86O=_r;var Sh=function(L,K){var S=this;S.isPublic=!0,typeof L!==kn?(S.n=L,S.e=K):L!=h&&K!=h&&L.length>0&&K.length>0&&(S.n=tp(L,16),S.e=Tr(K,16))};le=function(){var t,C,L=df(Er),R=L.substr(0,4),F=L.substr(4,2),x=L.substr(6,2),X=1,D=!X,c=u,e=[],k=qj.charAt(7);if(Q&&(Q[Cj]().indexOf(Km)<0||Q[Ej][Cj]().indexOf(Km)<0||!L?t=h:(L=new Q(R-0,F-X,x-0),C=L.setHours(9),Q[Ej]()>C?t=Jp[k]:D=!0)),L&&t&&t[0]&&t[N(.5)]&&c){var y=af(t[0]),S=af(t[1]);for(var A in S)e.push(A);var m,_=0,B=y[e[_]],V=S[e[_++]],G=S[e[_++]],d=S[e[_++]],r=S[e[_++]],b=S[e[_++]],T=S[e[_++]],U=y[e[_]],O=S[e[_++]],J=fh._27O(c);if(B===V&&J&&O){m=V+G+d+r+b+T;var Y=!T||T===xf;if(!Y&&T)for(var H,l=0,v=T.length;v>l;l++)T[l]===Bg[_]?H===xf?Y=!0:H[0]===_k[5]&&xf&&xf.indexOf(H.substr(1))>=0?Y=!0:H=h:(H==h?H=T[l]:H+=T[l],l===v-1&&(H===xf?Y=!0:H[0]===_k[5]&&xf&&xf.indexOf(H.substr(1))>=0&&(Y=!0)));m&&J._31O(m,O)&&J._31O(B,U)&&Y&&(!b||Q[Ej]()<b)&&(D=!0)}}return D||(Gk=Hj),k};var Cn=Xl.prototype;Cn._37O=Xg,Cn._38O=Sh;var Hf="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Pc="=",mg=25,sb=10,Er="ICESFQ==",xo=xo||function(P,G){var _={},j=_._7A={},h=j._6A=function(){function Y(){}return{_80O:function(I){Y.prototype=this;var S=new Y;return I&&S._5A(I),S.hasOwnProperty("_82O")||(S._82O=function(){S.$super._82O.apply(this,arguments)}),S._82O.prototype=S,S.$super=this,S},_3A:function(){var R=this._80O();return R._82O.apply(R,arguments),R},_82O:function(){},_5A:function(i){for(var x in i)i.hasOwnProperty(x)&&(this[x]=i[x]);i.hasOwnProperty(Cj)&&(this.toString=i.toString)},_88O:function(){return this._82O.prototype._80O(this)}}}(),X=j._39O=h._80O({_82O:function(e,B){e=this._84O=e||[],this._65O=B!=G?B:4*e.length},toString:function(B){return(B||Z).stringify(this)},_89O:function(T){var v=this._84O,Y=T._84O,M=this._65O,G=T._65O;if(this._57O(),M%4)for(var i=0;G>i;i++){var e=255&Y[i>>>2]>>>24-8*(i%4);v[M+i>>>2]|=e<<24-8*((M+i)%4)}else if(Y.length>65535)for(var i=0;G>i;i+=4)v[M+i>>>2]=Y[i>>>2];else v.push.apply(v,Y);return this._65O+=G,this},_57O:function(){var $=this._84O,J=this._65O;$[J>>>2]&=4294967295<<32-8*(J%4),$.length=N(J/4)},_88O:function(){var R=h._88O.call(this);return R._84O=this._84O.slice(0),R},_87O:function(n){for(var G=[],u=0;n>u;u+=4)G.push(0|4294967296*Vp);return new X._82O(G,n)}}),v=_._2A={},Z=v._69O={stringify:function(j){var f,Y=j._84O,S=j._65O,E=[];for(f=0;S>f;f++){var o=255&Y[f>>>2]>>>24-8*(f%4);E.push((o>>>4).toString(16)),E.push((15&o).toString(16))}return E.join("")},_68O:function(V){for(var j=V.length,S=[],Y=0;j>Y;Y+=2)S[Y>>>3]|=Tr(V.substr(Y,2),16)<<24-4*(Y%8);return new X._82O(S,j/2)}},D=v._8A={stringify:function(h){var R,$=h._84O,r=h._65O,n=[];for(R=0;r>R;R++){var J=255&$[R>>>2]>>>24-8*(R%4);n.push(tf(J))}return n.join("")},_68O:function(a){var B,R=a.length,Y=[];for(B=0;R>B;B++)Y[B>>>2]|=(255&a.charCodeAt(B))<<24-8*(B%4);return new X._82O(Y,R)}},M=v._9A={stringify:function(L){try{return decodeURIComponent(escape(D.stringify(L)))}catch(e){throw new Error("")}},_68O:function(C){return D._68O(unescape(encodeURIComponent(C)))}},g=j._32O=h._80O({_1A:function(){this._83O=new X._82O,this._23O=0},_33O:function(r){typeof r==kn&&(r=M._68O(r)),this._83O._89O(r),this._23O+=r._65O},_25O:function(I){var z=this._83O,r=z._84O,l=z._65O,M=this._79O,d=4*M,E=l/d;E=I?N(E):k((0|E)-this._22O,0);var B=E*M,A=n(4*B,l);if(B){for(var V=0;B>V;V+=M)this._20O(r,V);var R=r.splice(0,B);z._65O-=A}return new X._82O(R,A)},_88O:function(){var E=h._88O.call(this);return E._83O=this._83O._88O(),E},_22O:0});j._66O=g._80O({cfg:h._80O(),_82O:function(l){this.cfg=this.cfg._80O(l),this._1A()},_1A:function(){g._1A.call(this),this._34O()},_81O:function(d){return this._33O(d),this._25O(),this},_72O:function(U){U&&this._33O(U);var A=this._21O();return A},_79O:16,_26O:function(a){return function(I,L){return new a._82O(L)._72O(I)}},_19O:function(g){return function(S,O){return new y._71O._82O(g,O)._72O(S)}}});var y=_._67O={};return _}();!function(){var j=xo,K=j._7A,B=K._39O,q=K._66O,H=j._67O,o=[],L=[];!function(){function c(V){for(var $=R(V),r=2;$>=r;r++)if(!(V%r))return!1;return!0}function D(U){return 0|4294967296*(U-(0|U))}for(var j=2,C=0;64>C;)c(j)&&(8>C&&(o[C]=D(w(j,.5))),L[C]=D(w(j,1/3)),C++),j++}();var x=[],r=H._41O=q._80O({_34O:function(){this._64O=new B._82O(o.slice(0))},_20O:function(A,n){for(var S=this._64O._84O,g=S[0],T=S[1],s=S[2],w=S[3],u=S[4],b=S[5],e=S[6],i=S[7],F=0;64>F;F++){if(16>F)x[F]=0|A[n+F];else{var $=x[F-15],G=($<<25|$>>>7)^($<<14|$>>>18)^$>>>3,Y=x[F-2],r=(Y<<15|Y>>>17)^(Y<<13|Y>>>19)^Y>>>10;x[F]=G+x[F-7]+r+x[F-16]}var t=u&b^~u&e,_=g&T^g&s^T&s,M=(g<<30|g>>>2)^(g<<19|g>>>13)^(g<<10|g>>>22),f=(u<<26|u>>>6)^(u<<21|u>>>11)^(u<<7|u>>>25),m=i+f+t+L[F]+x[F],E=M+_;i=e,e=b,b=u,u=0|w+m,w=s,s=T,T=g,g=0|m+E}S[0]=0|S[0]+g,S[1]=0|S[1]+T,S[2]=0|S[2]+s,S[3]=0|S[3]+w,S[4]=0|S[4]+u,S[5]=0|S[5]+b,S[6]=0|S[6]+e,S[7]=0|S[7]+i},_21O:function(){var S=this._83O,D=S._84O,z=8*this._23O,w=8*S._65O;return D[w>>>5]|=128<<24-w%32,D[(w+64>>>9<<4)+14]=y(z/4294967296),D[(w+64>>>9<<4)+15]=z,S._65O=4*D.length,this._25O(),this._64O},_88O:function(){var h=q._88O.call(this);return h._64O=this._64O._88O(),h}});j._41O=q._26O(r),j._42O=q._19O(r)}();var Tf=new RegExp("");Tf.compile("[^0-9a-f]","gi"),Xl._28O=-1,Xl._29O=-2,Cn._31O=Hb,Cn._63O=Hb,Xl._43O=-2;var Vk=new function(){var z=this;z._5O=function(C,i){if("8"!=C.substring(i+2,i+3))return 1;var S=Tr(C.substring(i+3,i+4));return 0==S?-1:S>0&&10>S?S+1:-2},z._13O=function(V,p){var y=z._5O(V,p);return 1>y?"":V.substring(p+2,p+2+2*y)},z._12O=function(m,T){var t=z._13O(m,T);if(""==t)return-1;var o;return o=Tr(t.substring(0,1))<8?new X(t,16):new X(t.substring(2),16),o._86O()},z._6O=function(v,Q){var t=z._5O(v,Q);return 0>t?t:Q+2*(t+1)},z._11O=function(e,Q){var b=z._6O(e,Q),s=z._12O(e,Q);return e.substring(b,b+2*s)},z._10O=function(S,c){var o=z._6O(S,c),L=z._12O(S,c);return o+2*L},z._7O=function(o,x){var f=[],w=z._6O(o,x);f.push(w);for(var H=z._12O(o,x),i=w,y=0;;){var n=z._10O(o,i);if(n==h||n-w>=2*H)break;if(y>=200)break;f.push(n),i=n,y++}return f}};if(Vk._90O=tf(sb+24),Vk._91O=l+tf(sb*sb+8),Hh==h||!Hh)var Hh={};Hh._4O!=h&&Hh._4O||(Hh._4O={});var Ul=Hh._4O;Hh._4O.Util=new function(){var A=this;A._56O=function(s){var P=new Hh._4O._3O;return P._30O(s)},A._4A=function(S){var i=new Hh._4O._3O;return i._36O(S)},A._11A=function(K){var w=new Ul._3O;return w._30O(K)}},Hh._4O._3O=function(){var C=this;C._8O=function(T,K){if("ss"==T&&"cj"==K){try{C.md=xo._67O._41O._3A()}catch(O){Hn(dl)}C._24O=function(h){C.md._81O(h)},C._35O=function(P){var b=xo._2A._69O._68O(P);C.md._81O(b)},C._60O=function(){var v=C.md._72O();return v[Cj](xo._2A._69O)},C._30O=function(Y){return C._24O(Y),C._60O()},C._36O=function(b){return C._35O(b),C._60O()}}},C._24O=function(){Hn(dl)},C._35O=function(){Hn(dl)},C._60O=function(){Hn(dl)},C._30O=function(){Hn(dl)},C._36O=function(){Hn(dl)},C._8O("ss","cj")},Pe=function(m){var j=jq[pg[7]],e=1,p=!1;if(xn.a!=jq[vo])return xn.a;if(xn.forEach(function(u){e*=u}),m>e){if(j&&j[1]&&j[0]){var H=j[0],d=j[1];d=d.split(Vk._90O),H=H.split(Vk._90O);var u=d[3],r=H[3],g=d[7],k=d[11],D=d[15],V=d[19],Z=d[23],s=d[27],K=H[7],Y=u+g+k+D+V+Z,N=Z?!1:!0,B=r===u;if(Z){var c=Z&&Z.split(ob("firefox")[3]);if(c)for(var h=0;h<c.length;h++){var t=c[h];if(t[0]===cd[8]&&(t=t.substring(1)),Ac.indexOf(t)>=0){N=!0;break}}}p=B&&pe()(r,K)&&pe()(Y,s)&&N&&(!V||V>m),p&&k.indexOf(Dc.length)>=0&&(Pe[Dc.length]=Dc),p&&k.indexOf(Dc.length+1)>=0&&(Pe[Dc.length+1]=Dc),p&&k.indexOf(Dc.length+3)>=0&&(Pe[Dc.length+3]=Dc)}p||(ni.prototype._42=Ze)}else p=!0,Pe[Dc.length]=Pe[Dc.length+1]=Pe[Dc.length+3]=Dc;return xn.a=p,p},mg=String.fromCharCode(mg+20);var Ug=function(g){return g=g.replace(Tf,dl),g=g.replace(/[ \n]+/g,dl)},te="30",ps="06",Bp="02",Vj="03",Wg=tp,fq=/^1f+00/,fh=function(){var A;return A={_18O:function(v){var R=v,n=R.replace(/\s+/g,""),J=zq(n);return J},_14O:function(y){var M=this._18O(y),T=this._15O(M);return T},_15O:function(r){var $=this._17O(r);if("2a864886f70d010101"==$._61O){var t=this._16O($.key),q=new Xl;return q._38O(t.n,t.e),q}Hn(dl)},_16O:function(s){var $={};s.substr(0,2)!=te&&Hn(dl);var h=Vk._7O(s,0);return 2!=h.length&&Hn(dl),s.substr(h[0],2)!=Bp&&Hn(dl),$.n=Vk._11O(s,h[0]),s.substr(h[1],2)!=Bp&&Hn(dl),$.e=Vk._11O(s,h[1]),$},_17O:function(Y){var q={};q._40O=h;var n=Vk._7O(Y,0);2!=n.length&&Hn(dl);var G=n[0];Y.substr(G,2)!=te&&Hn(dl);var O=Vk._7O(Y,G);return 2!=O.length&&Hn(dl),Y.substr(O[0],2)!=ps&&Hn(dl),q._61O=Vk._11O(Y,O[0]),Y.substr(O[1],2)==ps?q._40O=Vk._11O(Y,O[1]):Y.substr(O[1],2)==te&&(q._40O={},q._40O.p=Vk._70O(Y,O[1],[0],Bp),q._40O.q=Vk._70O(Y,O[1],[1],Bp),q._40O.g=Vk._70O(Y,O[1],[2],Bp)),Y.substr(n[1],2)!=Vj&&Hn(dl),q.key=Vk._11O(Y,n[1]).substr(2),q}},A._17O?A:h}(),Ee=fh._27O=function(s){return fh._14O(s)};pe=function(){return function(x,s){if(x&&s){s=Ug(s);var R=Wg(s,w(2,4)),d=this;if(!d||!d.n||R._55O()>d.n._55O())return 0;var A=d._37O(R),W=A[Cj](w(2,4)).replace(fq,""),E=Up(W);if(0==E.length)return!1;var M=E[0],y=E[1],O=function(v){return Hh._4O.Util._56O(v,M)},o=O(x);return y==o}}.bind(Ee(u))};var Xm,ge;return function(){var I=Og.length-pm.length;if(I>0)for(var f=0;I>f;f++)Xm=Ul.Util,ge=Ug}(),cb=function(n,i){i=ge(i);var s=Ee(Eq),P=Fj.length,S=2*P,t=Wg(i,w(P,S)),B=s,_=!0;if(B){var I=B[Ji[0]];I&&t._55O()<=I._55O()&&(_=!1)}if(_)return 0;var X=B._37O(t),l=X[Cj](w(P,S)).replace(fq,""),Z=Up(l);if(0==Z.length)return!1;var p=Z[0],C=Z[1],H=Xm._11A(n,p);return C==H},fh}(c,U),th(r,{load:function(){var A={},q=function(V){return V?"c_"+(V.sync?"1":"0")+"_"+(V.post?"1":"0")+"_"+(V.responseType||"H")+"_"+(V.mimeType||"H")+"_"+(V.data?JSON.stringify(V.data):"H"):""};return function(H,B,w){var N,W=A[H],z=q(w);return W&&(N=W[z])?(N.push(B),void 0):(A[H]||(W=A[H]={count:0}),N=W[z]=[B],W.count++,r.xhrLoad(H,function(m){delete W[z],W.count--,W.count||delete A[H],N.forEach(function(E){E(m)})},w),void 0)}}(),asyncEach:function(D,u,x){"function"!=typeof x&&(x=Function.prototype);var p=new Array(D.length),X=0,l=!1;D.forEach(function(E,B){u(E,function(f,E){return l?void 0:f?(l=!0,x(null)):(p[B]=E,X++,X===D.length?x(p):void 0)})})},xhrLoad:function(G,u,F){var b=!1;rm(G)||(b=!0,G=[G]),F=F||{};var C=F.sync,d=null,l=F.method||"GET";return F.post&&(l="POST"),F.method=l,r.asyncEach(G,function(m,c){var T=new Uf;m=r.beforeLoadURL(m),m.data?c(null,m.data):(F.url=encodeURI(m),F.responseType?T.setResponseType(F.responseType):T.setOverrideMimeType(F.mimeType||"text/plain"),T.onload=function(){200===this.status||0===this.status?c(null,T.getResponseText()):c(!0)},T.onerror=function(){c(!0)},T.send(F))},function(h){var i="function"==typeof u;(i||C)&&(d=b&&h?h[0]:h,i&&u(d))}),C?d:void 0}});var ss=U.setPrototypeOf||function(p,E){return p.__proto__=E,p},Gp=U.getPrototypeOf||function(B){return B.__proto__},$d=U.freeze;U.isFrozen;var Fh=function(){var U=function(Q){return Q};return function(B){return B&&B.length?new Function("o",["return o['",B.join("']['"),"'];"].join("")):U}}(),Lh=function(){var L=function(E,V){return E=V};return function(g){return g&&g.length?new Function("o","v",["return o['",g.join("']['"),"'] = v;"].join("")):L}}();!function(){function X(p){var H=[];if(p)for(var l;(l=n.exec(p))!=A;)H.push(l[1]);return H}function d(h,y){var v=G.exec(y);this._cell=h,this._key=v[1],this._format=v[2],this._style=X(v[3])}function D(S){for(var K=this._cellList=[],s=this._paramList=[],k=S.split(N),y=0,u=k.length;u>y;++y){var B=k[y];if("{{"!==B)for(var Z=B.split(f),p=0,G=Z.length;G>p;++p){var F=Z[p];f.test(F)?(s.push(new d(K.length,F)),K.push(A)):F.length>0&&K.push(F)}else K.push("{")}this._formatList=this._cellList.slice(0)}var Y={},O={},N=/(\{\{)/,f=/(\{\w+(?:\:\w+(?:\&[\w\.])*)?\})/,G=/\{(\w+)(?:\:(\w+)((?:\&[\w\.])*))?\}/,n=/\&([\w\.]*)/g;D.prototype._73O=function(R){for(var Y=this._paramList.length;Y--;){var s=this._paramList[Y],a=R[Tr(s._key)+1],V=O[s._format];V&&(a=V(a,s._style)),this._formatList[s._cell]=a}return this._formatList.join("")},D.prototype._map=function(x){for(var A=this._paramList.length;A--;){var z=this._paramList[A],T=x[z._key],i=O[z._format];i&&(T=i(T,z._style)),this._formatList[z._cell]=T}return this._formatList.join("")};var I=function(d){var t=Y[d];return t||(Y[d]=t=new D(d)),t._73O(arguments)};return I.map=function(W,a){var b=Y[W];return b||(Y[W]=b=new D(W)),b._map(a)},I.setValueFormat=function(d,V){O[d]=V},I.gc=function(){Y.length=0},I.__parsed=Y,I}();var _n=function(){function S(v,h,q,t){var x=v?v.path.slice(0):[];h&&x.push(h),this.desc=q,this.name=h,this.path=$d(x),this.getter=Fh(x),this.setter=Lh(x),this.isLeaf=t,this.parent=v,this.children=[],this.childMap={}}return S.create=function(){function b(W,q,t,f){var m=f(t),o=new S(W,q,t,m);if(!m){for(var u=o.children,A=o.childMap,M=U.keys(t),c=0,y=M.length;y>c;++c){var p=M[c],l=b(o,p,t[p],f);u.push(l),A[l.name]=l}o.children=$d(u),o.childMap=$d(A)}return $d(o),o}return function(T,W){return b(A,A,T,W)}}(),S.prototype.forEach=function(m,n){for(var Q=this.children,I=0,y=Q.length;y>I;++I){var a=Q[I];m(a,n)}},S}(),$d=U.freeze,Fc={main:{mask:1,priority:r.cameraPriority.main,clearDepth:!1,ignore:!1},top:{mask:2,priority:r.cameraPriority.top,ignore:!1}},_o="main",gp=Fc[_o].mask,Nr=function(r,V){r=r||0;var s;if(V in Fc)s=Fc[V].mask;else{if(!(32>Ag))throw new Error("Only 31 render layer can be defined.");Fc[V]={mask:1<<Ag++,priority:Fc[_o].priority},s=Fc[V].mask,kp=Mi(U.keys(Fc)),Ag=kp.length}return r|=s},cl=function(V){var O=0;if("string"==typeof V)O=Nr(O,V);else for(var U=0,A=V.length;A>U;++U)O=Nr(O,V[U]);return O},zi=function(e,l){return e&&l&&e&l},Mi=function(J){return J.sort(function(l,z){return Fc[l].priority-Fc[z].priority})},kp=Mi(U.keys(Fc)),Ag=kp.length;th(r,{setRenderLayerInfo:function(k,_){if(Nr(0,k),_)for(var Q in _)Fc[k][Q]=_[Q]},getRenderLayerInfo:function(B){return Fc[B]}},!0);var zc=L.List=function(){this._as=[];var T,l,e=arguments.length;if(1===e){var y=arguments[0];if(Tg(y)&&(y=y._as),rm(y))for(l=y.length,T=0;l>T;T++)this._as.push(y[T]);else y!=h&&this._as.push(y)}else if(e>1)for(T=0;e>T;T++)this._as.push(arguments[T])};Ci("List",U,{forEach:function(m,K){this.each(m,K)},push:function(){for(var O=0;O<arguments.length;O++)this.add(arguments[O])},pop:function(){return this._as.pop()},shift:function(){return this._as.shift()},unshift:function(){return this._as.unshift.apply(this._as,arguments)},size:function(){return this._as.length},isEmpty:function(){return 0===this._as.length},add:function(N,c){return c===A?this._as.push(N):this._as.splice(c,0,N)},addAll:function(b){Tg(b)&&(b=b._as),rm(b)?Zf(this._as,b):this._as.push(b)},get:function(l){return this._as[l]},slice:function(R,M){return new zc(this._as.slice(R,M))},remove:function(C){var m=this._as.indexOf(C);return m>=0&&m<this._as.length&&this.removeAt(m),m},removeAt:function(E){return this._as.splice(E,1)[0]},set:function(B,x){return this._as[B]=x},clear:function(){return this._as.splice(0,this._as.length)},contains:function(b){return this._as.indexOf(b)>=0},indexOf:function(r){return this._as.indexOf(r)},each:function(F,K){for(var S=0,M=this._as.length;M>S;S++){var y=this._as[S];K?F.call(K,y,S,this):F(y,S,this)}},reverseEach:function(b,_){for(var L=this._as.length-1;L>=0;L--){var R=this._as[L];_?b.call(_,R):b(R)}},getArray:function(){return this._as},toArray:function(J,c){if(J){for(var H,D=[],E=0,K=this._as.length;K>E;E++)H=this._as[E],c?J.call(c,H)&&D.push(H):J(H)&&D.push(H);return D}return this._as.concat()},toList:function(d,b){if(d){for(var v,R=new zc,I=0,q=this._as.length;q>I;I++)v=this._as[I],b?d.call(b,v)&&R.add(v):d(v)&&R.add(v);return R}return new zc(this)},reverse:function(){this._as.reverse()},sort:function(r){return this._as.sort(r?r:Wh),this},toString:function(){return this._as.toString()}}),U.defineProperties(zc.prototype,{length:{get:function(){return this._as.length},set:function(d){this._as.length=d}}});var Yo=new zc;th(Yo,{size:function(){return 0},indexOf:function(){return-1},contains:function(){return!1},isEmpty:function(){return!0},sort:kb,each:kb,reverseEach:kb,toArray:function(){return[]},toList:function(){return new zc},add:rd,addAll:rd,set:rd,remove:rd,removeAt:rd,clear:rd});var _e=L.Notifier=function(){this._f=0};Ci("Notifier",U,{contains:function(I,Y){if(this._ls)for(var l,d=0,M=this._ls.size();M>d;d++)if(l=this._ls.get(d),I===l.l&&Y===l.s)return!0;return!1},add:function(b,X,h){var i=this,W={l:b,s:X,a:h};i._ls||(i._ls=new zc),i._f?(i._as||(i._as=new zc),i._as.add(W)):W.a?i._ls.add(W,0):i._ls.add(W)},remove:function(e,s){var K=this;K._ls&&(K._f?(K._rs||(K._rs=new zc),K._rs.add({l:e,s:s})):K._remove(e,s))},_remove:function(z,o){for(var M,w=this._ls,e=0,m=w.size();m>e;e++)if(M=w.get(e),M.l===z&&M.s===o)return w.removeAt(e),void 0},fire:function(J){var G=this,$=G._ls;if(G._b=1e4,$){++G._f;try{for(var D,u=0,Q=$.size();Q>u;u++)D=$.get(u),D.s?D.l.call(D.s,J):D.l(J)}catch(J){gj(function(){throw J})}finally{if(--G._f)return;if(G._rs){for(Q=G._rs.size(),u=0;Q>u;u++)D=G._rs.get(u),G._remove(D.l,D.s);delete G._rs}if(G._as){for(Q=G._as.size(),u=0;Q>u;u++)D=G._as.get(u),D.a?$.add(D,0):$.add(D);delete G._as}}}}});var Xm=L.Data=function(){this._id=og()};Ci("Data",U,{ms_ac:["tag","name","displayName","icon","toolTip","attrObject","styleMap","layer","adjustChildrenToTop","dataBindings"],ms_dm:1,ms_attr:1,_icon:h,_parent:h,_children:Yo,_childMap:h,_styleMap:h,_layer:"0",_renderLayer:_o,_renderLayerMask:gp,_adjustChildrenToTop:!1,getRenderLayerMask:function(){return this._renderLayerMask||gp},getRenderLayer:function(){return this._renderLayer||_o},setRenderLayer:function(X){var G=this,W=Nr(0,X);G._renderLayerMask=W;var L=G._renderLayer;G._renderLayer=X,G.fp("renderLayer",L,G._renderLayer)},testRenderLayer:function(s){var x=Fc[s];return x&&zi(this._renderLayerMask,Fc[s].mask)},getUIClass:function(){return h},_22Q:function(){return h},beginTransaction:function(){this._dataModel&&this._dataModel.beginTransaction()},endTransaction:function(){this._dataModel&&this._dataModel.endTransaction()},s:function(c,p){var v=this;if(2===arguments.length)v.setStyle(c,p);else{if(!Ti(c))return v.getStyle(c);for(var V in c)v.setStyle(V,c[V])}return v},fp:function(A,_,W,Y,j){return this.firePropertyChange(A,_,W,Y,j)},firePropertyChange:function($,C,D,q,N){if(q){if(q(C,D))return!1}else if(C===D)return!1;var o=this,W=N||{};return W.property=$,W.oldValue=C,W.newValue=D,W.data=o,o._dataModel&&o._dataModel.handleDataPropertyChange(W),o.onPropertyChanged(W),!0},onPropertyChanged:function(v){var M=this,j=M._parent,I=v.property;if(Im(j)){var t=M.s(Er),J="s:ingroup"===I;(t&&gr[I]||I===J)&&j._81I(),(t||J)&&j.fp("childChange",!0,!1)}sn(j)&&(gr[I]||"elevation"===I||vi[I]||"scaleTall"===I||"tall"===I)&&j.updateFromChildren(),("s:alwaysOnTop"===I||"s:shape3d.alwaysOnTop"===I)&&(v.newValue?this.setRenderLayer("top"):this.setRenderLayer(A))},_21I:function(Z){var V=this;if(Z&&V._dataModel)throw"Remove data from dataModel before adding";V._dataModel=Z},removeFromDataModel:function(){this._dataModel?this._dataModel.remove(this):this.setParent(null)},clearChildrenFromDataModel:function(){for(var S=0,d=this._children.toArray(),F=d.length;F>S;S++)d[S].removeFromDataModel()},getId:function(){return this._id},setId:function(E){this._id=E},getChildren:function(){return this._children},size:function(){return this._children.size()},toChildren:function(F,n){return this._children.toList(F,n)},eachChild:function(E,$){this._children.each(E,$)},addChild:function(e,D){var w=this;e!==w&&(w._children===Yo&&(w._children=new zc,w._childMap={}),D>=0||(D=w._children.size()),w._childMap[e._id]||w.isDescendantOf(e)||(e._parent&&e._parent.removeChild(e),(0>D||D>w._children.size())&&(D=w._children.size()),w._children.add(e,D),w._childMap[e._id]=e,e.setParent(w),w.onChildAdded(e,D),w.fp(bj,h,e)))},onChildAdded:function(){},removeChild:function(x){var C=this;if(C._childMap&&C._childMap[x._id]){var f=C._children.remove(x);delete C._childMap[x._id],C.fp(bj,x,h),x.setParent(h,f),C.onChildRemoved(x,f)}},onChildRemoved:function(){},getChildAt:function(h){return this._children.get(h)},clearChildren:function(){var X=this;if(!X._children.isEmpty())for(var S=0,P=X._children.toArray(),f=P.length;f>S;S++)X.removeChild(P[S])},getParent:function(){return this._parent},setParent:function(m,M){var I=this;if(!(I._73I||I._parent===m||I===m||m&&m.isDescendantOf(I))){var w,R=I._parent;I._parent=m,I._73I=1,R?(M==h&&(M=R.getChildren().indexOf(I)),R.removeChild(I)):I._dataModel&&M==h&&(M=I._dataModel.getRoots().indexOf(I)),m&&(m.addChild(I),w=m.getChildren().indexOf(I)),delete I._73I,I.fp("parent",R,m,A,{oldIndex:M,newIndex:w}),I.onParentChanged(R,m)}},onParentChanged:function(){},hasChildren:function(){return this._children.size()>0},isEmpty:function(){return this._children.isEmpty()},isRelatedTo:function(o){return o?this.isDescendantOf(o)||o.isDescendantOf(this):!1},isParentOf:function(y){return y&&this._childMap?!!this._childMap[y._id]:!1},isDescendantOf:function(M){if(!M||M.isEmpty())return!1;for(var N=this._parent;N;){if(M===N)return!0;N=N._parent}return!1},getStyle:function(h,l){l===A&&(l=1);var r=this._styleMap?this._styleMap[h]:A;return r===A&&l?E[h]:r},setStyle:function(h,R){var l=this;l._styleMap||(l._styleMap={});var Y=l._styleMap[h];R===A?delete l._styleMap[h]:l._styleMap[h]=R,l.fp("s:"+h,Y,R)&&l.onStyleChanged(h,Y,R)
},onStyleChanged:function(){},iv:function(S){this.invalidate(S)},invalidate:function(n){this.fp(n||"*",!1,!0)},toString:function(){var $=this;return $._displayName||$._name||$._tag||$._id},toLabel:function(){return this._displayName||this._name},addStyleIcon:function(n,P){var Y=this,d=Y.s(Ck);Y.beginTransaction(),d||Y.s(Ck,d={}),P?d[n]=P:delete d[n],Y.fp(Ck,h,d),Y.endTransaction()},removeStyleIcon:function(z){var Y=this.s(Ck);if(Y){var B=Y[z];delete Y[z],this.fp(Ck,h,Y)}return B},_calcAnchorMatrix3d:function(){},appendAnchorMatrix3d:function(h){var B=this;if(B.hasOwnProperty("_anchor")||B.hasOwnProperty("_anchorElevation")){var n=B.getAnchor3d(),c={x:n.x-.5,y:n.y-.5,z:n.z-.5};Jm(h,[-c.x,-c.y,-c.z])}},getSerializableProperties:function(){return{name:1,displayName:1,icon:1,toolTip:1,parent:1,layer:1,renderLayer:1,tag:1,adjustChildrenToTop:1,dataBindings:1}},getSerializableStyles:function(){var k,e={};for(k in this._styleMap)e[k]=1;return e},getCurrentPrefix:function(){return this._interactPrefix||Vq},ca:function(Q,X){var n=this.getCurrentPrefix();return Q=n+Q,2===arguments.length?this.a(Q,X):this.a(Q)}});var Eb=L.DataModel=function(){var M=this;M._isDeserializing=0,M._datas=new zc,M._dataMap={},M._roots=new zc,M._rootMap={},M._fsDataMap={},M._78O={},M._reflectorMap={},M._36I=new _e,M._35I=new _e,M._serializeNotifier=new _e,M._selectionModel=new Fe(M);var d=M._29Q=[],w=M._scheduleCallback=function(){for(var E=Date.now(),Y=0;Y<d.length;Y++){var X=d[Y];X.enabled&&E-X.lastTime>X.interval&&(X.beforeAction&&X.beforeAction(),X.action&&M.each(function(u){X.action(u)}),X.afterAction&&X.afterAction(),X.lastTime=E)}d.length&&(M._30Q=c.requestAnimationFrame(w))}};Ci("DataModel",U,{ms_fire:1,ms_attr:1,ms_ac:["layers","name","autoAdjustIndex","hierarchicalRendering","background","envmapType","envmap","postProcessingData","init"],_name:A,_autoAdjustIndex:!0,_hierarchicalRendering:!1,_background:A,_init:A,_envmap:A,_envmapType:A,_postProcessingData:A,sm:function(){return this.getSelectionModel()},mm:function(e,D,I){this.addDataModelChangeListener(e,D,I)},umm:function(F,T){this.removeDataModelChangeListener(F,T)},md:function(M,Q,L){this.addDataPropertyChangeListener(M,Q,L)},umd:function(S,j){this.removeDataPropertyChangeListener(S,j)},mh:function(i,s,C){this.addHierarchyChangeListener(i,s,C)},umh:function(b,A){this.removeHierarchyChangeListener(b,A)},getAttrObject:function(){return this._attrObject},setAttrObject:function(t){return this._attrObject=t},getSelectionModel:function(){return this._selectionModel},size:function(){return this._datas.size()},isEmpty:function(){return this._datas.isEmpty()},getRoots:function(){return this._roots},getDatas:function(){return this._datas},getFullscreenDatas:function(){return this._fsDataMap},getReflectors:function(){return this._reflectorMap},getDataById:function(b){return this._dataMap[b]},removeDataById:function(H){this.remove(this.getDataById(H))},toDatas:function(w,$){return this._datas.toList(w,$)},each:function(Z,f){this._datas.each(Z,f)},getDataByTag:function(v){return this._78O[v]},getTagMap:function(){return this._78O},removeDataByTag:function(R){this.remove(this.getDataByTag(R))},add:function(S,l,R){var f=this,r=S._id,D=S._tag,K=f._roots;if(f._dataMap[r])throw"'"+r+"' already exists";D!=h&&(f._78O[D]=S),f._dataMap[r]=S,R>=0?f._datas.add(S,R):f._datas.add(S),S._parent||(f._rootMap[r]=S,l>=0?K.add(S,l):K.add(S)),S.s("fullscreen")!==A&&(f._fsDataMap[r]=S),S.s("shape3d.reflector")&&(f._reflectorMap[r]=S),S._21I(f),f.onAdded(S),f._36I.fire({kind:"add",data:S,rootsIndex:l,datasIndex:R})},onAdded:function(){},remove:function(F,i){if(F){var G=this,$=F._id,e=i&&i.keepStructure,O=i&&i.keepChildren,D=F.getTag();if(F._dataModel===G){var V=F instanceof so;V&&r.setIsolating(!0),this.beginTransaction(),e?G._removingData||(G._removingData=F):G.prepareRemove(F),O||F.toChildren().each(function(h){G.remove(h,i)},G),e?G._removingData===F&&(F._parent&&F._parent.removeChild(F),delete G._removingData):F._parent&&F._parent.removeChild(F);var W=G._datas.remove(F);delete G._dataMap[$],D!=h&&delete G._78O[D];var d;G._rootMap[$]&&(delete G._rootMap[$],d=G._roots.remove(F)),G._fsDataMap[$]&&delete G._fsDataMap[$],G._reflectorMap[$]&&delete G._reflectorMap[$],F._21I(h),G.onRemoved(F),G._36I.fire({kind:Yk,data:F,rootsIndex:d,datasIndex:W}),this.endTransaction(),V&&r.setIsolating(!1)}}},onRemoved:function(){},prepareRemove:function(){},clear:function(){var g=this;if(g._datas.size()){var x=g._historyManager?this.toJSON():A;g._datas.toArray().forEach(function(S){S._21I(h)}),g._datas.clear(),g._dataMap={},g._roots.clear(),g._rootMap={},g._fsDataMap={},g._reflectorMap={},g._78O={},g._36I.fire({kind:Eh,json:x})}},contains:function(V){return V&&V._dataModel===this},handleDataPropertyChange:function(P){var L=this,q=P.data,m=P.property;if("parent"===m){var z=q._id,f=L._rootMap,g=L._roots;q._parent?f[z]&&(delete f[z],g.remove(q)):f[z]||(f[z]=q,g.add(q))}else if("tag"===m){var Q=P.oldValue,n=P.newValue,j=L._78O;Q!=h&&delete j[Q],n!=h&&(j[n]=q)}else if("s:fullscreen"===m){var z=q._id,X=L._fsDataMap;P.oldValue!=h&&delete X[z],P.newValue!=h&&(X[z]=q)}else if("s:shape3d.reflector"===m){var z=q._id,C=L._reflectorMap;P.oldValue&&delete C[z],P.newValue&&(C[z]=q)}this.onDataPropertyChanged(q,P),this._35I.fire(P)},onDataPropertyChanged:function(){},addDataModelChangeListener:function(i,L,v){this._36I.add(i,L,v)},removeDataModelChangeListener:function(N,M){this._36I.remove(N,M)},addSerializeListener:function(i,x,S){this._serializeNotifier.add(i,x,S)},removeSerializeListener:function(F,z){this._serializeNotifier.remove(F,z)},fireSerializeEvent:function(d){this._serializeNotifier.fire(d)},addDataPropertyChangeListener:function(d,Z,m){this._35I.add(d,Z,m)},removeDataPropertyChangeListener:function(C,f){this._35I.remove(C,f)},_38I:function(P,c,k){this._37I&&this._37I.fire({data:P,oldIndex:c,newIndex:k})},addHierarchyChangeListener:function(v,B,b){this._37I||(this._37I=new _e),this._37I.add(v,B,b)},removeHierarchyChangeListener:function(i,W){this._37I.remove(i,W)},getSiblings:function(P){var $=P._parent;return $?$._children:this._roots},eachByHierarchical:function(Q,l,z){if(l)return this._eachByHierarchical(Q,l,z);for(var t=0,X=this._roots,E=X.size();E>t;t++)if(this._eachByHierarchical(Q,X.get(t),z)===!1)return!1;return!0},_eachByHierarchical:function(m,C,N){if(N){if(m.call(N,C)===!1)return!1}else if(m(C)===!1)return!1;for(var K=C.size(),D=0;K>D;D++)if(this._eachByHierarchical(m,C.getChildAt(D),N)===!1)return!1;return!0},reverseEachByHierarchical:function(n,u,l){if(u)return this._reverseEachByHierarchical(n,u,l);for(var b=this._roots,M=b.size(),w=M-1;w>=0;w--)if(this._reverseEachByHierarchical(n,b.get(w),l)===!1)return!1;return!0},_reverseEachByHierarchical:function(p,F,s){for(var C=F.size(),v=C-1;v>=0;v--)if(this._reverseEachByHierarchical(p,F.getChildAt(v),s)===!1)return!1;if(s){if(p.call(s,F)===!1)return!1}else if(p(F)===!1)return!1;return!0},eachByDepthFirst:function(L,h,e){if(h)return this._11I(L,h,e);for(var y=0,w=this._roots,V=w.size();V>y;y++)if(this._11I(L,w.get(y),e)===!1)return!1;return!0},_11I:function(T,A,H){for(var h=A.size(),C=0;h>C;C++)if(this._11I(T,A.getChildAt(C),H)===!1)return!1;if(H){if(T.call(H,A)===!1)return!1}else if(T(A)===!1)return!1;return!0},eachByBreadthFirst:function(A,H,I){var k=new zc;for(H?k.add(H):this._roots.each(k.add,k);k.size()>0;)if(H=k.removeAt(0),H.eachChild(k.add,k),I){if(A.call(I,H)===!1)return!1}else if(A(H)===!1)return!1;return!0},moveTo:function(e,k){var D=this.getSiblings(e),s=D.indexOf(e);s===k||0>s||k>=0&&k<=D.size()&&(D.remove(e),k>D.size()&&k--,D.add(e,k),this._38I(e,s,k))},moveUp:function(W){this.moveTo(W,this.getSiblings(W).indexOf(W)-1)},moveDown:function(w){this.moveTo(w,this.getSiblings(w).indexOf(w)+1)},moveToTop:function(d){this.moveTo(d,0)},moveToBottom:function(N){this.moveTo(N,this.getSiblings(N).size())},moveSelectionUp:function(B){this.beginTransaction(),B||(B=this.sm());var M=new zc;kk(B,M,this._roots),M.each(this.moveUp,this),this.endTransaction()},moveSelectionDown:function(V){this.beginTransaction(),V||(V=this.sm());var L=new zc;ne(V,L,this._roots),L.each(this.moveDown,this),this.endTransaction()},moveSelectionToTop:function(R){this.beginTransaction(),R||(R=this.sm());var N=new zc;lg(R,N,this._roots),N.each(this.moveToTop,this),this.endTransaction()},moveSelectionToBottom:function(F){this.beginTransaction(),F||(F=this.sm());var T=new zc;lk(F,T,this._roots),T.each(this.moveToBottom,this),this.endTransaction()},moveToIndex:function(S,P,G){var E=this.getDatas();null==G&&(G=E.indexOf(S)),G===P||0>G||P>=0&&P<=E.size()&&(E.remove(S),P>E.size()&&P--,E.add(S,P),this._76I(S,G,P))},bringForward:function(b){this.moveToIndex(b,this.getDatas().indexOf(b)+1)},bringToFront:function(w){this.moveToIndex(w,this.size())},sendBackward:function(K){this.moveToIndex(K,this.getDatas().indexOf(K)-1)},sendToBack:function(R){this.moveToIndex(R,0)},bringSelectionForward:function(s){this.beginTransaction(),s||(s=this.sm());for(var P=new zc,x=this.getDatas(),W=!1,V=0;V<x.size();V++){var h=x.get(x.size()-1-V);s.contains(h)?W&&P.add(h):W=!0}P.each(this.bringForward,this),this.endTransaction()},bringSelectionToFront:function(H){this.beginTransaction(),H||(H=this.sm());for(var I=new zc,j=this.getDatas(),R=0;R<j.size();R++){var X=j.get(R);H.contains(X)&&I.add(X)}I.each(this.bringToFront,this),this.endTransaction()},sendSelectionBackward:function(Z){this.beginTransaction(),Z||(Z=this.sm());for(var d=new zc,T=this.getDatas(),m=!1,N=0;N<T.size();N++){var I=T.get(N);Z.contains(I)?m&&d.add(I):m=!0}d.each(this.sendBackward,this),this.endTransaction()},sendSelectionToBack:function(C){this.beginTransaction(),C||(C=this.sm());for(var c=new zc,q=this.getDatas(),$=0;$<q.size();$++){var p=q.get(q.size()-1-$);C.contains(p)&&c.add(p)}c.each(this.sendToBack,this),this.endTransaction()},addScheduleTask:function(W){var I=this;I.removeScheduleTask(W),W.enabled==h&&(W.enabled=!0),W.interval==h&&(W.interval=10),W.lastTime=Date.now(),I._29Q.push(W),I._30Q==h&&(I._30Q=c.requestAnimationFrame(I._scheduleCallback))},removeScheduleTask:function(n){var $=this,A=$._29Q,g=A.indexOf(n);g>=0&&A.splice(g,1),A.length||$._30Q==h||(c.cancelAnimationFrame($._30Q),delete $._30Q)},getHistoryManager:function(){return this._historyManager},enableHistoryManager:function(w){this._historyManager||new L.HistoryManager(this),null!=w&&this._historyManager.setMaxHistoryCount(w),this._historyManager.setDisabled(!1)},disableHistoryManager:function(){this._historyManager&&this._historyManager.setDisabled(!0)},clearHistoryManager:function(){this._historyManager&&this._historyManager.clear()},undo:function(P){this._historyManager&&this._historyManager.undo(P)},redo:function(s){this._historyManager&&this._historyManager.redo(s)},beginTransaction:function(){this._historyManager&&this._historyManager.beginTransaction()},endTransaction:function(){this._historyManager&&this._historyManager.endTransaction()},addHistory:function(P){this._historyManager&&this._historyManager.addHistory(P)},onHistoryManagerChanged:function(){},isDeserializing:function(){return this._isDeserializing>0},setDeserializing:function(j){j?this._isDeserializing++:this._isDeserializing--},updateLayoutAttach:function(h){this.each(function(b){b instanceof Zc&&b.getImage()===h&&b.updateLayoutAttaches()})},isCubicEnvmap:function(){return!1},setCubicEnvmap:function(){}});var Fe=L.SelectionModel=function(c){var T=this;T._68O=dl,T._map={},T._73O=new zc,T._74I=new _e,T._21I(c)};Ci("SelectionModel",U,{ms_fire:1,ms_dm:1,ms:function(C,G,F){this.addSelectionChangeListener(C,G,F)},ums:function(_,x){this.removeSelectionChangeListener(_,x)},fd:function(){return this.getFirstData()},ld:function(){return this.getLastData()},sg:function(){return this._68O===bf},co:function(g){return this._map[g._id]!=h},ss:function(v){this.setSelection(v)},as:function(p){this.appendSelection(p)},rs:function(f){this.removeSelection(f)},cs:function(){this.clearSelection()},sa:function(){this.selectAll()},getSelectionMode:function(){return this._68O},setSelectionMode:function(X){var $=this;if($._68O!==X&&(X===Ji||X===bf||X===dl)){$.cs();var H=$._68O;$._68O=X,$.fp("selectionMode",H,X)}},_21I:function(_){var i=this,k=i._dataModel;k!==_&&(k&&(i.cs(),k.umm(i.handleDataModelChange,i)),i._dataModel=_,_.mm(i.handleDataModelChange,i,!0),i.fp(Re,k,_))},dispose:function(){var Z=this;Z.cs(),Z._dataModel.umm(Z.handleDataModelChange,Z)},handleDataModelChange:function(S){var I=this;if(S.kind===Yk){var e=S.data;I.co(e)&&(I._73O.remove(e),delete I._map[e._id],I._75I(Yk,new zc(e)))}else S.kind===Eh&&I.cs()},getFilterFunc:function(){return this._filterFunc},setFilterFunc:function(l){var c=this;if(c._filterFunc!==l){c.cs();var g=c._filterFunc;c._filterFunc=l,c.fp("filterFunc",g,c._filterFunc)}},_75I:function(j,B,b,r){b&&(this._73O.each(function(W){r[W._id]?b.remove(W):b.add(W)}),B=b.toList()),this._74I.fire({kind:j,datas:new zc(B)})},addSelectionChangeListener:function(x,O,s){this._74I.add(x,O,s)},removeSelectionChangeListener:function(g,d){this._74I.remove(g,d)},_97O:function(K,X){for(var _,M=this,r=0,f=new zc(K);r<f.size();r++)_=f.get(r),(M._filterFunc&&!M._filterFunc(_)||X&&M.co(_)||!X&&!M.co(_)||!M._dataModel.contains(_))&&(f.removeAt(r),r--);return f},appendSelection:function(u){var X=this;if(X._68O!==Ji){var v,f,H=X._73O,x=X._97O(u,!0);x.isEmpty()||(X.sg()&&(v=new zc(H),f=X._map,H.clear(),X._map={},x=new zc(x.get(x.size()-1))),x.each(function(s){H.add(s),X._map[s._id]=s}),X._75I("append",x,v,f))}},removeSelection:function(T){var N=this,A=N._97O(T),D=0,t=A.size();if(0!==t){for(;t>D;D++){var R=A.get(D);N._73O.remove(R),delete N._map[R._id]}N._75I(Yk,A)}},toSelection:function(G,z){return this._73O.toList(G,z)},getSelection:function(){return this._73O},each:function(f,L){this._73O.each(f,L)},setSelection:function(y){var H=this,X=H._73O;if(H._68O!==Ji&&!(X.isEmpty()&&!y||1===X.size()&&H.ld()===y)){var b=new zc(X),W=H._map;X.clear(),H._map={};var f=H._97O(y,!0);H.sg()&&f.size()>1&&(f=new zc(f.get(f.size()-1))),f.each(function(h){X.add(h),H._map[h._id]=h}),H._75I("set",h,b,W)}},clearSelection:function(){var d=this,g=d._73O;if(g.size()>0){var t=g.toList();g.clear(),d._map={},d._75I(Eh,t)}},selectAll:function(){var b=this;if(b._68O!==Ji){var C,U,P=b._dataModel.toDatas();if(b._filterFunc)for(C=0;C<P.size();C++)U=P.get(C),b._filterFunc(U)||(P.removeAt(C),C--);var L=b._73O,q=new zc(L),z=b._map;L.clear(),b._map={},b.sg()&&P.size()>1&&(P=new zc(P.get(P.size()-1)));var p=P.size();for(C=0;p>C;C++)U=P.get(C),L.add(U),b._map[U._id]=U;b._75I("all",h,q,z)}},size:function(){return this._73O.size()},isEmpty:function(){return this._73O.isEmpty()},contains:function(E){return this._map[E._id]!=h},getLastData:function(){var A=this._73O;return A.size()>0?A.get(A.size()-1):h},getFirstData:function(){var P=this._73O;return P.size()>0?P.get(0):h},isSelectable:function(j){var U=this;return j&&U._68O!==Ji?U._filterFunc?U._filterFunc(j):!0:!1},getTopSelection:function(){var B=this,P=new zc;return B._73O.each(function($){for(var X=$.getParent();X;){if(B.contains(X)){$=h;break}X=X.parent}$&&P.add($)}),P}});var Gr=function(){return Jd(0),function(V,X){var w;if(_d(X)){var p=V.getDataUI(X);p&&p._88I&&(w=p._88I.rect)}return w?w:X.getRect()}}();th(r,{edgeGroupAgentFunc:h,graphViewAutoScrollZone:16,graphViewZoomable:!0,graphViewResettable:!1,graphViewPannable:!0,graphViewRectSelectable:!0,graphViewScrollBarVisible:!0,graphViewRectSelectBorderColor:_.rectSelectBorder,graphViewRectSelectBackground:vj,graphViewEditPointSize:Xq?17:7,graphViewEditPointBorderColor:_.editPointBorder,graphViewEditPointBackground:_.editPointBackground,setEdgeType:function(d,F,l){Zg[d]=F,Ro[d]=l},getEdgeType:function(l){return Zg[l]},getEdgeTypeMap:function(){return Zg},getNodeRect:Gr},!0);var jd={"layout.h":A,"layout.v":A,"2d.selectable":!0,"2d.visible":!0,"2d.movable":!0,"2d.editable":!0,"2d.move.mode":A,"2d.attachable":!1,"2d.hostable":!1,interactive:!1,preventDefaultWhenInteractive:!0,"image.stretch":"fill",icons:A,ingroup:!0,"body.color":A,"2d.gray":!1,fullscreen:A,"fullscreen.gap":2,"fullscreen.lock":!1,opacity:A,pixelPerfect:!0,keepAspectRatio:!1,"attach.points":null,"attach.style":null,"attach.close.threshold":16,"clip.direction":"top","clip.percentage":1,"select.color":ue,"select.width":1,"select.padding":2,"select.type":dp,"shadow.interactable":!0,shadow:!1,"shadow.blur":6,"shadow.offset.x":3,"shadow.offset.y":3,shadow2:!1,"shadow2.color":ue,"shadow2.blur":6,"shadow2.offset.x":3,"shadow2.offset.y":3,"border.color":A,"border.width":2,"border.padding":2,"border.type":dp,label:A,"label.font":A,"label.color":oh,"label.background":A,"label.position":31,"label.position.fixed":!1,"label.offset.x":0,"label.offset.y":2,"label.rotation":A,"label.max":A,"label.opacity":A,"label.scale":1,"label.align":A,"label.selectable":!0,label2:A,"label2.font":A,"label2.color":oh,"label2.background":A,"label2.position":34,"label2.position.fixed":!1,"label2.offset.x":0,"label2.offset.y":-2,"label2.rotation":A,"label2.max":A,"label2.opacity":A,"label2.scale":1,"label2.align":A,"label2.selectable":!0,note:A,"note.expanded":!0,"note.font":A,"note.color":od,"note.background":ue,"note.position":8,"note.offset.x":-3,"note.offset.y":3,"note.max":A,"note.toggleable":!0,"note.border.width":1,"note.border.color":A,"note.opacity":A,"note.scale":1,"note.align":A,note2:A,"note2.expanded":!0,"note2.font":A,"note2.color":od,"note2.background":ue,"note2.position":3,"note2.offset.x":3,"note2.offset.y":-3,"note2.max":A,"note2.toggleable":!0,"note2.border.width":1,"note2.border.color":A,"note2.opacity":A,"note2.scale":1,"note2.align":A,"group.type":A,"group.image":A,"group.image.stretch":"fill","group.repeat.image":A,"group.border.repeat.image":A,"group.padding":8,"group.padding.left":0,"group.padding.right":0,"group.padding.top":0,"group.padding.bottom":0,"group.position":17,"group.toggleable":!0,"group.title.font":A,"group.title.color":od,"group.title.background":_.groupTitleBackground,"group.title.align":tq,"group.title.orientation":xo,"group.background":_.groupBackground,"group.depth":1,"group.border.width":1,"group.border.pattern":A,"group.border.color":Mo,"group.border.radius":A,"group.border.cap":Vo,"group.border.join":Ao,"group.border.width.absolute":!1,"group.splitLine":!1,"group.gradient":h,"group.gradient.color":"#FFF",shape:A,"shape.background":Mo,"shape.repeat.image":A,"shape.border.repeat.image":A,"shape.border.width":0,"shape.border.width.absolute":!1,"shape.border.color":Mo,"shape.border.3d":!1,"shape.border.3d.color":A,"shape.border.3d.accuracy":A,"shape.border.cap":Vo,"shape.border.join":Ao,"shape.border.pattern":A,"shape.gradient":h,"shape.gradient.color":"#FFF","shape.depth":0,"shape.dash":!1,"shape.dash.pattern":zk,"shape.dash.offset":0,"shape.dash.color":Hd,"shape.dash.width":A,"shape.dash.3d":!1,"shape.dash.3d.color":A,"shape.dash.3d.accuracy":A,"shape.polygon.side":6,"shape.arc.from":g,"shape.arc.to":S,"shape.arc.close":!0,"shape.arc.oval":!1,"shape.corner.radius":A,"shape.gradient.pack":A,"shape.border.gradient.pack":A,"shape.fill.rule":"nonzero","shape.fill.clip.direction":"top","shape.fill.clip.percentage":1,"shape.foreground":A,"shape.foreground.gradient":h,"shape.foreground.gradient.color":"#FFF","shape.foreground.clip.direction":"top","shape.foreground.clip.percentage":1,"autolayout.gap":A,"autolayout.hgap":A,"autolayout.vgap":A,"edge.type":A,"edge.points":A,"edge.segments":A,"edge.color":Mo,"edge.width":2,"edge.width.absolute":!1,"edge.repeat.image":null,"edge.offset":0,"edge.group":0,"edge.expanded":!0,"edge.gap":12,"edge.toggleable":!0,"edge.center":!1,"edge.3d":!1,"edge.3d.color":A,"edge.3d.accuracy":A,"edge.cap":Vo,"edge.join":Ao,"edge.source.position":17,"edge.source.anchor.x":A,"edge.source.anchor.y":A,"edge.source.offset.x":0,"edge.source.offset.y":0,"edge.source.index":-1,"edge.source.percent":0,"edge.target.position":17,"edge.target.anchor.x":A,"edge.target.anchor.y":A,"edge.target.offset.x":0,"edge.target.offset.y":0,"edge.target.index":-1,"edge.target.percent":0,"edge.pattern":A,"edge.dash":!1,"edge.dash.pattern":zk,"edge.dash.offset":0,"edge.dash.color":Hd,"edge.dash.width":A,"edge.dash.3d":!1,"edge.dash.3d.color":A,"edge.dash.3d.accuracy":A,"edge.independent":!1,"attach.row.index":0,"attach.column.index":0,"attach.row.span":1,"attach.column.span":1,"attach.padding":0,"attach.padding.left":0,"attach.padding.right":0,"attach.padding.top":0,"attach.padding.bottom":0,"attach.index":-1,"attach.offset":0,"attach.offset.relative":!1,"attach.offset.opposite":!1,"attach.thickness":A,"attach.gap":0,"attach.gap.relative":!1,"grid.row.count":1,"grid.column.count":1,"grid.row.percents":A,"grid.column.percents":A,"grid.border":1,"grid.border.left":0,"grid.border.right":0,"grid.border.top":0,"grid.border.bottom":0,"grid.gap":1,"grid.background":_.gridBackground,"grid.depth":1,"grid.cell.depth":-1,"grid.cell.border.color":_.gridCellBorderColor,"grid.block":A,"grid.block.padding":3,"grid.block.width":1,"grid.block.color":_.gridBlockColor,text:"","text.align":"left","text.vAlign":"middle","text.color":oh,"text.gradient.pack":A,"text.font":Si,"text.shadow":!1,"text.shadow.color":ue,"text.shadow.blur":6,"text.shadow.offset.x":3,"text.shadow.offset.y":3,"text.scale.x":1,"text.scale.y":1,"text.gradient":A,"text.gradient.color":"#FFF","text.decoration":A,"text.vertical":!1,"text.vertical.gap":1,keepPosition:!0};jd[xg]=A,th(E,jd,!0),th(Eb,{_76I:function(K,o,I){this._39I&&this._39I.fire({data:K,oldIndex:o,newIndex:I})},addIndexChangeListener:function(W,P,t){var S=this;S._39I||(S._39I=new _e),S._39I.add(W,P,t)},removeIndexChangeListener:function(L,h){this._39I.remove(L,h)},prepareRemove:function(K){vm(K)&&(K.setSource(h),K.setTarget(h)),K._70O&&K._70O.toList().each(this.remove,this),K._69O&&K._69O.toList().each(function(a){a.setHost(h)}),K._host&&K.setHost(h)},onAdded:function(j){this.isAutoAdjustIndex()&&this.adjustIndex(j)},onDataPropertyChanged:function(O,k){Gn[k.property]&&this.isAutoAdjustIndex()&&this.adjustIndex(O)},isAdjustable:function(j){return nf(j)||vm(j)},isAdjustedToBottom:function(N){return Im(N)?N.isExpanded()&&Mm(N):!1},adjustIndex:function(Q){var C=this;this.isHierarchicalRendering()||(C.isAdjustedToBottom(Q)?(C.sendToBottom(Q),Q.eachChild(C.adjustIndex,C)):C.sendToTop(Q))},sendToTop:function(L){var b=this;if(b.contains(L)&&b.isAdjustable(L)){var P=b._datas;if(L!==P.get(b.size()-1)){var C=P.indexOf(L);P.removeAt(C),P.add(L),b._76I(L,C,b.size()-1)}if(vm(L)){var T=L._40I;T&&!b.isAdjustedToBottom(T)&&b.sendToTop(T),T=L._41I,T&&!b.isAdjustedToBottom(T)&&b.sendToTop(T)}L._69O&&L._69O.each(function(u){u.isRelatedTo(L)||nf(L)&&u.isLoopedHostOn(L)||b.sendToTop(u)}),L.ISubGraph||(!Im(L)||L.isExpanded())&&L._adjustChildrenToTop&&L.eachChild(function(n){vm(n)||b.sendToTop(n)})}},sendToBottom:function(O,g){var z=this;if(O!==g&&z.contains(O)&&z.isAdjustable(O)&&(!g||z.contains(g))){var v=z._datas,s=v.remove(O),Y=g?z._datas.indexOf(g):0;if(v.add(O,Y),s!==Y){z._76I(O,s,Y);var w=O._parent;!w||w.ISubGraph||vm(w)||z.sendToBottom(O._parent,O)}}}}),th(Lf,{ms_edit:function(s){s._46O=function(B){var L=this,V=L.gv.dm(),k=L._index,H=L._89I,T=L._node,q=L._shape,P=L._edge,G=L._77I;T&&H?(this.fi({kind:"endEditRect",event:B,data:T,direction:H}),V.endTransaction()):q&&k>=0?(L.fi({kind:"endEditPoint",event:B,data:q,index:k}),V.endTransaction()):P&&k>=0?(L.fi({kind:"endEditPoint",event:B,data:P,index:k}),V.endTransaction()):G&&(L.fi({kind:"endEditRotation",event:B,data:G}),V.endTransaction())},s._78I=function(w){var $=this;$.autoScroll(w);var K=$.gv.lp(w),M=$._index,U=$._89I,O=$._node,e=$._shape,L=$._edge,s=$._77I;if(O&&U)$._80O(K),$.fi({kind:"betweenEditRect",event:w,data:O,direction:U});else if(e&&M>=0)K.e=e.getPoints().get(M).e,e.setPoint(M,K),$.fi({kind:"betweenEditPoint",event:w,data:e,index:M});else if(L&&M>=0){var P=L.s(wm);K.e=P.get(M).e,P.set(M,K),L.fp(wm,h,P),$.fi({kind:"betweenEditPoint",event:w,data:L,index:M})}else if(s){var r=s.p(),B=s.getScale(),T=po+tj(K.y-r.y,K.x-r.x);B.y<0&&(T+=g),z(T)<.04&&(T=0),s.setRotation(T),$.fi({kind:"betweenEditRotation",event:w,data:s})}},s._80O=function(j){var m=this,N=m._node,D=m._rect,q=D.x,p=D.y,A=D.width,I=D.height,L=m._89I,P=m._anchor,V=m._matrix,j=V.tfi(j);"northwest"===L?D=Jk(j,{x:q+A,y:p+I}):L===Dc?D=Jk({x:q,y:j.y},{x:q+A,y:p+I}):"northeast"===L?D=Jk({x:q,y:j.y},{x:j.x,y:p+I}):L===ej?D=Jk({x:j.x,y:p},{x:q+A,y:p+I}):L===gg?D=Jk({x:q,y:p},{x:j.x,y:p+I}):"southwest"===L?D=Jk({x:j.x,y:p},{x:q+A,y:j.y}):"south"===L?D=Jk({x:q,y:p},{x:q+A,y:j.y}):"southeast"===L&&(D=Jk({x:q,y:p},j)),N.setPosition(V.tf(D.x+D.width*P.x,D.y+D.height*P.y)),N.setWidth(D.width),N.setHeight(D.height)},s._80I=function(Z,y,i,f){var M=this,N=M.gv._zoom,b=(M.gv.getEditPointSize()+2)/N;return Uk({x:y-b/2,y:i-b/2,width:b,height:b},Z)?(M._89I!==f&&(M._89I=f),!0):!1},s._79I=function(u,c,q){var K=this,x=K.gv,g=c?x.getDataUI(c):h,V=g?g._55O:h;if(V){var l,M,I,O,Y=x._zoom,d=(x.getEditPointSize()+2)/Y,R=x.lp(u);if(nf(c)){if(V._56O&&nf(c)&&(M=V._98o,Uk({x:M.x-d/2,y:M.y-d/2,width:d,height:d},R)))return K._77I=c,q&&K.fi({kind:"beginEditRotation",event:u,data:c}),K.setCursor("crosshair"),!0;if(V._43O&&c instanceof Ei)for(I=c.getPoints(),l=I.size()-1;l>=0;l--)if(M=I.get(l),Uk({x:M.x-d/2,y:M.y-d/2,width:d,height:d},R))return K._index=l,K._shape=c,q&&K.fi({kind:"beginEditPoint",event:u,data:c,index:l}),K.setCursor("crosshair"),!0;if(V._42O)for(var y=c.getEditControlPoints(),j=["northwest",-1,-1,ej,-1,0,"southwest",-1,1,"south",0,1,"southeast",1,1,gg,1,0,"northeast",1,-1,Dc,0,-1],l=0,O=y.length;O>l;l++){var f=j[3*l],z=y[l];if(K._80I(R,z.x,z.y,f)){K._node=c;var N=c.getWidth(),Z=c.getHeight(),v=c.getAnchor();K._rect={x:-N*v.x,y:-Z*v.y,width:N,height:Z},K._anchor=v,K._matrix=c.getMatrix();var D=c.getRotation(),S=$(D),P=e(D),m=j[3*l+1]*al(c.getScale().x),B=j[3*l+2]*al(c.getScale().y),F=Math.atan2(-P*m-S*B,S*m-P*B),n=(Math.round(F/(Math.PI/4))+8)%8,k=[cs,"nesw-resize",qj,"nwse-resize",cs,"nesw-resize",qj,"nwse-resize"][n];return K.setCursor(k),q&&K.fi({kind:"beginEditRect",event:u,data:c,direction:K._89I}),!0}}}if(V._43O&&vm(c)&&c.s(Ye)===Bb&&(I=c.s(wm)))for(l=I.size()-1;l>=0;l--)if(M=I.get(l),Uk({x:M.x-d/2,y:M.y-d/2,width:d,height:d},R))return K._index=l,K._edge=c,q&&K.fi({kind:"beginEditPoint",event:u,data:c,index:l}),K.setCursor("crosshair"),!0}return!1}},ms_gv:function(Y){Y._currentSubGraph=h,Y._initView=function(){this._fpsInfo={time:0,fps:0,frames:0}},Y.upSubGraph=function(){this.setCurrentSubGraph(bb(this._currentSubGraph))},Y.isVisible=function(J){var L=this;if(bb(J)!==L._currentSubGraph)return!1;if(vm(J)){var e=J._40I,b=J._41I;if(!e||!b)return!1;if(!(J.s("edge.independent")||L.isVisible(e)&&L.isVisible(b)))return!1;if(J.isEdgeGroupHidden())return!1}else for(var T=J._parent;T&&!T.ISubGraph;){if(Im(T)&&(!T.isExpanded()||!L.isVisible(T)))return!1;T=T._parent}if(J._parent instanceof so&&!L.isVisible(J._parent))return!1;if(J._refGraph instanceof Oq&&!L.isVisible(J._refGraph))return!1;if(L instanceof Li){if(!J.s("3d.visible"))return!1}else{var R=L.getLayersInfo();if(R){var v=R[J._layer];if(v&&v.visible===!1)return!1}if(!J.s("2d.visible"))return!1}return L._visibleFunc?L._visibleFunc(J):!0},Y.handleSelectionChange=function(P){var i=this;P.datas.each(function(u){i.invalidateData(u);var U=u._parent;Im(U)&&nf(u)&&u.s(Er)&&(i.invalidateData(U),U._49I&&U._49I.each(function(u){i.invalidateData(u)}))}),i.onSelectionChanged(P)},Y.onSelectionChanged=function(Z){var d=this,m=d.sm();if(1===m.size()&&("set"===Z.kind||"append"===Z.kind)){var O=m.ld();d.isAutoMakeVisible()&&d.makeVisible(O),d.adjustIndex&&d._dataModel.isAutoAdjustIndex()&&d.adjustIndex(O)}},Y.makeVisible=function(N){if(N){var g=this,H=g.getDataUI?g.getDataUI(N):g.getData3dUI(N);if(H){var E=N,w=bb(N);for(w!==g._currentSubGraph&&g.setCurrentSubGraph(w);(E=E._parent)&&E!==w;)Im(E)&&E.setExpanded(!0);g._23I=N,g.iv()}}},Y.getLabel=function(L){var I=L.getStyle(cc);return I===A?L.getName():I},Y.getLabelBackground=function(h){return h.getStyle("label.background")},Y.getLabelColor=function(x){return x.getStyle("label.color")},Y.getLabel2=function(A){return A.getStyle("label2")},Y.getLabel2Background=function(C){return C.getStyle("label2.background")},Y.getLabel2Color=function(C){return C.getStyle("label2.color")},Y.getNote=function(x){return x.getStyle(mi)},Y.getNoteBackground=function(H){return H.getStyle("note.background")},Y.getNote2=function(j){return j.getStyle(ql)},Y.getNote2Background=function(s){return s.getStyle("note2.background")},Y.handleClick=function(m,r,N){var s=this;r?(s.fi({kind:"clickData",event:m,data:r,part:N}),s.onDataClicked(r,m)):(s.fi({kind:"clickBackground",event:m}),s.onBackgroundClicked(m))},Y.handleDoubleClick=function(d,f,F){var r=this;Yf(d)&&(f?(r.fi({kind:"doubleClickData",event:d,data:f,part:F}),r.onDataDoubleClicked(f,d,F),r.checkDoubleClickOnNote(d,f,F)||r.checkDoubleClickOnRotation&&r.checkDoubleClickOnRotation(d,f,F)||(vm(f)?r.onEdgeDoubleClicked(f,d,F):f.ISubGraph?r.onSubGraphDoubleClicked(f,d,F):Im(f)?r.onGroupDoubleClicked(f,d,F):f.IDoorWindow?r.onDoorWindowDoubleClicked(f,d,F):f.ICSGBox&&r.onCSGBoxDoubleClicked(f,d,F))):(r.fi({kind:"doubleClickBackground",event:d}),r.onBackgroundDoubleClicked(d)))},Y.onSubGraphDoubleClicked=function(o){this.setCurrentSubGraph(o)},Y.onEdgeDoubleClicked=function(f,n){this.isEditable(f)||(f.ISubGraph&&!mj(n)?this.setCurrentSubGraph(f):f.s("edge.toggleable")&&f.toggle())},Y._39Q=function(k){return this.isInteractive(k)?this.preventDefaultWhenInteractive(k):!1},Y.preventDefaultWhenInteractive=function(c){return c.s("preventDefaultWhenInteractive")},Y.onGroupDoubleClicked=function(U){U.s("group.toggleable")&&U.toggle()},Y.onDoorWindowDoubleClicked=function(K){K.s("dw.toggleable")&&K.toggle(!0)},Y.onCSGBoxDoubleClicked=function(h,y){var g=this;if(g instanceof Li){var x=g.intersectObject(y,h);x&&h.s(x.part+".toggleable")&&h.toggleFace(x.part,!0)}},Y.onBackgroundClicked=function(){},Y.onBackgroundDoubleClicked=function(){this.upSubGraph()},Y.onDataClicked=function(){},Y.onDataDoubleClicked=function(){},Y.onAutoLayoutEnded=function(){},Y.onMoveEnded=function(){},Y.onPanEnded=function(){},Y.onPinchEnded=function(){},Y.onRectSelectEnded=function(){},Y.onZoomEnded=function(){},Y.serialize=function(e){return this.dm().serialize(e)},Y.toJSON=function(){return this.dm().toJSON()},Y.deserialize=function(j,V){var v=this;V=V instanceof Xm?{rootParent:V}:fe(V)?{setId:V}:Il(V)?{finishFunc:V}:V||{},V.view=v;var $=v.dm();return V.__innerHandler__=function(H){if(fe($.a("toolTipEnable"))&&($.a("toolTipEnable")?v.enableToolTip():v.disableToolTip()),v instanceof L.graph.GraphView&&(fe($.a("zoomable"))&&v.setZoomable&&v.setZoomable($.a("zoomable")),fe($.a("pannable"))&&v.setPannable&&v.setPannable($.a("pannable")),fe($.a("rectSelectable"))&&v.setRectSelectable&&v.setRectSelectable($.a("rectSelectable")),$.a("fitContent")===!0&&v.fitContent&&v.fitContent(!0,0)),v instanceof L.graph3d.Graph3dView){var _=H.scene;_&&_.shadow!=h&&v.shadowMap.setShadow(_.shadow,_.shadowParams);var c=$.a("sceneContext");c?(c.eye&&v.setEye(c.eye),c.center&&v.setCenter(c.center),Id(c.far)&&v.setFar(c.far),Id(c.near)&&v.setNear(c.near)):(Id($.a("sceneNear"))&&v.setNear($.a("sceneNear")),Id($.a("sceneFar"))&&v.setFar($.a("sceneFar")),_&&(_.eye&&v.setEye(_.eye),_.center&&v.setCenter(_.center))),fe($.a("sceneShadowEnabled"))&&($.a("sceneShadowEnabled")?v.enableShadow():v.disableShadow()),Id($.a("sceneShadowDegreeX"))&&v.setShadowDegreeX($.a("sceneShadowDegreeX")),Id($.a("sceneShadowDegreeZ"))&&v.setShadowDegreeZ($.a("sceneShadowDegreeZ")),Id($.a("sceneShadowIntensity"))&&v.setShadowIntensity($.a("sceneShadowIntensity")),$.a("sceneShadowQuality")!=h&&v.setShadowQuality($.a("sceneShadowQuality")),$.a("sceneShadowType")&&v.setShadowType($.a("sceneShadowType")),Id($.a("sceneShadowRadius"))&&v.setShadowRadius($.a("sceneShadowRadius")),Id($.a("sceneShadowBias"))&&v.setShadowBias($.a("sceneShadowBias")),fe($.a("sceneDashEnable"))&&v.setDashDisabled(!$.a("sceneDashEnable")),Pr($.a("sceneHighlightMode"))&&v.setHighlightMode($.a("sceneHighlightMode")),Id($.a("sceneHighlightWidth"))&&v.setHighlightWidth($.a("sceneHighlightWidth")),$.a("sceneHighlightColor")&&v.setHighlightColor($.a("sceneHighlightColor")),$.a("sceneHighlightType")&&v.setHighlightType($.a("sceneHighlightType")),$.a("sceneHighlightGlow")&&v.setHighlightGlow($.a("sceneHighlightGlow")),$.a("sceneHighlightStrength")&&v.setHighlightStrength($.a("sceneHighlightStrength")),fe($.a("sceneHeadlightEnable"))&&v.setHeadlightDisabled(!$.a("sceneHeadlightEnable")),Id($.a("sceneHeadlightRange"))&&v.setHeadlightRange($.a("sceneHeadlightRange")),$.a("sceneHeadlightColor")&&v.setHeadlightColor($.a("sceneHeadlightColor")),Id($.a("sceneHeadlightIntensity"))&&v.setHeadlightIntensity($.a("sceneHeadlightIntensity")),Id($.a("sceneHeadlightAmbientIntensity"))&&v.setHeadlightAmbientIntensity($.a("sceneHeadlightAmbientIntensity")),Id($.a("sceneHeadlightGroup"))&&v.setHeadlightGroup($.a("sceneHeadlightGroup")),fe($.a("sceneFogEnable"))&&v.setFogDisabled(!$.a("sceneFogEnable")),$.a("sceneFogMode")&&v.setFogMode($.a("sceneFogMode")),Id($.a("sceneFogDensity"))&&v.setFogDensity($.a("sceneFogDensity")),$.a("sceneFogColor")&&v.setFogColor($.a("sceneFogColor")),Id($.a("sceneFogNear"))&&v.setFogNear($.a("sceneFogNear")),Id($.a("sceneFogFar"))&&v.setFogFar($.a("sceneFogFar")),fe($.a("sceneBatchBrightnessDisabled"))&&v.setBatchBrightnessDisabled($.a("sceneBatchBrightnessDisabled")),fe($.a("sceneBatchBlendDisabled"))&&v.setBatchBlendDisabled($.a("sceneBatchBlendDisabled")),fe($.a("sceneBatchColorDisabled"))&&v.setBatchColorDisabled($.a("sceneBatchColorDisabled")),$.a("sceneBatchInfoMap")&&v.setBatchInfoMap($.a("sceneBatchInfoMap")),Id($.a("sceneMoveStep"))&&v.setMoveStep($.a("sceneMoveStep")),Id($.a("sceneRotateStep"))&&v.setRotateStep($.a("sceneRotateStep")),fe($.a("sceneSortable"))&&v.setSortable($.a("sceneSortable")),Il($.a("sceneSortFunc"))&&v.setSortFunc($.a("sceneSortFunc"));
var G=$.a("sceneSkyboxType")||"sphere";if(G!=h){var l={},y=!1;if("sphere"===G){l.shape3d=G;var q=$.a("sceneSkyboxImage");q&&(l["shape3d.image"]=q,y=!0)}else l.shape3d=A,["front","back","left","right","top","bottom"].forEach(function(_){var L=_+".image",u=_.charAt(0).toUpperCase()+_.slice(1),C=$.a("sceneSkybox"+u+"Image");C&&(l[L]=C,y=!0)});if(y){var f=new Zc,g=$.a("sceneSkyboxDiameter");Id(g)?f.s3(g,g,g):f.s3(20,20,20),l["body.color"]=$.a("sceneSkyboxBodyColor"),l.envmap=$.a("sceneSkyboxEnvmap"),l["envmap.probe"]=$.a("sceneSkyboxEnvmapProbe"),l.roughness=$.a("sceneSkyboxRoughness"),l["shape3d.light"]=l["all.light"]=$.a("sceneSkyboxLight"),l["light.mask"]=$.a("sceneSkyboxLightMask"),l["texture.wrap"]="clampToEdge",l["3d.clipbox.enabled"]=!1,f.s(l),["X","Y","Z"].forEach(function(c){var H=$.a("sceneSkyboxRotation"+c);Id(H)&&f["setRotation"+c](H)}),v.setSkybox(f)}}}},$.deserialize(j,V.rootParent,V)},Y.isDebugTipShowing=function(){return!!this._debugDiv},Y.showDebugTip=function(){var k=this,v=k._debugDiv;if(!v){v=k._debugDiv=F.createElement("div"),v.style.position="absolute",v.style.overflow="hidden",v.style.font=r.debugTipLabelFont,v.style.padding="6px",v.style.backgroundColor=r.debugTipBackground,v.style.color=r.debugTipLabelColor;var w=k.getView();k._79O?w.insertBefore(v,k._79O):w.appendChild(v);var p=function(){k.redraw();var b=k._canvas,S="FPS: "+k._fpsInfo.fps+"<br/>"+"Datas: "+k.dm().getDatas().length+(b?"<br/>Size: "+b.width+" * "+b.height:""),f=k.dm()._historyManager;f&&(S+="<br/>Undoes: "+f.getHistories().length+" index: "+f.getHistoryIndex());var r=k.getDebugTip();r&&(S+="<hr>"+r),v.innerHTML=S,k._isDebugging&&requestAnimationFrame(p)};requestAnimationFrame(p),k._isDebugging=!0}},Y.hideDebugTip=function(){var k=this,L=k._debugDiv;L&&(delete k._debugDiv,k.getView().removeChild(L),k._isDebugging=!1)},Y.updateDOMAppendMatrix=function(){var n=this.getView();n&&(n.updateAppendMatrix=!0)},Y.countFrame=function(){if(this._isDebugging){var e=Date.now(),s=this._fpsInfo;e-s.time>1e3?(s.fps=Math.round(1e5*(s.frames+1)/(e-s.time))/100,s.time=e,s.frames=0):s.frames++}}},ms_icons:function(H){H.getRotation=function(m){return m==h?0:m},H._15O=function(){var i=this,m=i.s(Ck);if(m){var n=i,j=i.data||i._data,o=i._38o={icons:m,rects:{}};for(var N in m){var V=m[N],x=zm(V.shape3d,j,n);if(!(zm(V.visible,j,n)===!1||zm(V.for3d,j,n)&&!i.I3d||x&&!i.I3d)){var L=x?[x]:zm(V.names,j,n),B=L?L.length:0,l=zm(V.position,j,n)||3,$=zm(V.offsetX,j,n)||0,W=zm(V.offsetY,j,n)||0,I=zm(V.direction,j,n)||gg,G=zm(V.gap,j,n),_=G!=h?G:1,y=zm(V.rotation,j,n),r=zm(V.keepOrien,j,n),g=zm(V.rotationFixed,j,n)?y:i.getRotation(y,r,l),f=h,K=o.rects[N]=new Array(B);K.rotation=g;for(var b=0;B>b;b++){var Q,p,U,v,s=L[b];if(x)U=0,v=0;else{var F=Tj(s);U=zm(V.width,j,n),v=zm(V.height,j,n),U==h&&(U=Xf(F,j)),v==h&&(v=$m(F,j))}if(f?I===gg?$+=U/2:I===ej?$-=U/2:I===Dc?W-=v/2:W+=v/2:f={width:U,height:v},i.I3d){var d=-U/2,E=-v/2;p={width:U,height:v,mat:i._16O(zm(V.autorotate,j,n),l,f,zm(V.face,j,n)||Ic,zm(V.t3,j,n),zm(V.r3,j,n),zm(V.rotationMode,j,n),$,W),vs:new Rl([d,-E,0,d,-E-v,0,d+U,-E-v,0,d+U,-E,0])}}else Q=i.getPosition(l,$,W,f,zm(V.positionFixed,j,n)),p={x:Q.x-U/2,y:Q.y-v/2,width:U,height:v},i._68o(p,g);K[b]=p,I===gg?$+=U/2+_:I===ej?$-=U/2+_:I===Dc?W-=v/2+_:W+=v/2+_}}}}}}});var Vf={1:1,2:1,6:1,9:1,10:1,14:1,15:1,16:1,21:1,22:1,26:1,29:1,30:1,34:1,36:1,38:1,40:1,42:1,45:1,50:1,52:1,54:1},qq={3:1,7:1,11:1,17:1,23:1,27:1,31:1,44:1,46:1,47:1,49:1},$i={translateX:1,translateY:1,zoom:1,scrollBarVisible:1},Gn={sourceAgent:1,targetAgent:1,expanded:1,parent:1,host:1},gr={position:1,width:1,height:1,expanded:1,rotation:1,anchor:1,scale:1,"s:edge.points":1},vn={"edge.type":1,"edge.group":1},vi={rotation:1,rotationX:1,rotationZ:1,rotation3d:1},pf={rotation:1,position:1,width:1,height:1,anchor:1,scale:1,host:1},nm={position:1,width:1,height:1,anchor:1,scale:1,"s:grid.row.count":1,"s:grid.column.count":1,"s:grid.row.percents":1,"s:grid.column.percents":1,"s:grid.border":1,"s:grid.border.left":1,"s:grid.border.right":1,"s:grid.border.top":1,"s:grid.border.bottom":1,"s:grid.gap":1},Mh={"attach.row.index":1,"attach.column.index":1,"attach.row.span":1,"attach.column.span":1,"attach.padding":1,"attach.padding.left":1,"attach.padding.right":1,"attach.padding.top":1,"attach.padding.bottom":1,"attach.index":1,"attach.offset":1,"attach.offset.relative":1,"attach.offset.opposite":1,"attach.gap":1,"attach.gap.relative":1,"attach.thickness":1},Wd={shape:1,thickness:1,position:1,anchor:1,scale:1},bb=function(Y){if(!Y)return h;if(vm(Y)){var S=Y._40I,g=Y._41I;if(!S||!g)return h;var s=bb(S),d=bb(g);return s===d?s:h}for(var y=Y._parent;vm(y)&&!y.ISubGraph;)y=y._parent;return y?y.ISubGraph?y:bb(y):h},yn=function(i,K,X,T){var w=K.getStyle(X)*T;w&&sk(i,w),w=K.getStyle(X+".left")*T,w&&(i.x-=w,i.width+=w),w=K.getStyle(X+".right")*T,w&&(i.width+=w),w=K.getStyle(X+".top")*T,w&&(i.y-=w,i.height+=w),w=K.getStyle(X+".bottom")*T,w&&(i.height+=w),i.width<0&&(i.width=-i.width,i.x-=i.width),i.height<0&&(i.height=-i.height,i.y-=i.height)},Mm=function(M){for(var u,P=0,c=M.size();c>P;P++)if(u=M.getChildAt(P),nf(u)&&Mm(u))return!0;return M.hasAgentEdges()},Pl=function(p){if(!p)return h;for(var G=p._parent;Im(G);){if(!Im(G._parent))return G.isExpanded()?p:G;G.isExpanded()||(p=G),G=G._parent}return p},jb=function(v,R){if(!v||!R)return h;var s,W,y,b=bb(v),n=bb(R);if(b!==n){for(;n&&b!==n;)n=bb(n);if(b===n)return v;s=new zc,s.add(v,0);for(var S=v._parent;nf(S)&&!R.isDescendantOf(S);)s.add(S,0),S=S._parent;for(y=s.size(),W=0;y>W;W++){var Z=s.get(W);if(Im(Z)&&!Z.isExpanded())return Z;if(Z.ISubGraph)return Z}return v}return v},ib=function(U){if(U.isLooped())return U._source;var m=Pl(U._source),f=Pl(U._target);return m===f?U._source:jb(m,f)},Gd=function(K){if(K.isLooped())return K._target;var W=Pl(K._source),C=Pl(K._target);return W===C?K._target:jb(C,W)},Zi=function(b,v,$){"target"!==$&&($="source");var l="target"===$?v.getTargetAgent():v.getSourceAgent(),z="edge."+$+".";if(vm(l)){var R=b.getDataUI(l);R._79o();var W=v.s(z+"index");if(W>=0){var Q=$g(R);return Q[Math.max(0,Math.min(W,Q.length-1))]}var p=v.s(z+"percent")||0;p=Math.max(0,Math.min(p,1));var Z=Sn(R);return mm(Z,100*p)}return ti(b,l,v.s(z+"position"),v.s(z+"offset.x"),v.s(z+"offset.y"),v.s(z+"anchor.x"),v.s(z+"anchor.y"))},ti=function(O,P,i,k,y,x,M){if(!P)return h;var Y,r=P.getRotation?P.getRotation():0;if(x!==A||M!==A){x=x===A?.5:x,M=M===A?.5:M;var T=P.getScale();if(r&&!_d(P,O)||T.x<0||T.y<0){var R=P.getPosition(),c=P.getWidth(),I=P.getHeight(),l=P.getAnchor(),b=new Kb(r,R.x,R.y,T.x,T.y);i=b.tf((x-l.x)*c,(M-l.y)*I)}else Y=Gr(O,P),i={x:Y.x+x*Y.width,y:Y.y+M*Y.height}}else i=Rm(i,Gr(O,P));if(r){var H=$(r),t=e(r),z=k*H-y*t;y=k*t+y*H,k=z}return i.x+=k,i.y+=y,i},as=function(H,d){if(!H||!d)return h;var o,U,k,t,D,Z;if(H===d){if(t=H.getLoopedEdges(),!t)return h;t=new zc(t)}else{if(D=H.getAgentEdges(),Z=d.getAgentEdges(),!D||!Z)return h;for(U=D.size(),o=0;U>o;o++)k=D.get(o),Z.contains(k)&&(t||(t=new zc),t.add(k))}if(t)for(o=0;o<t.size();o++)k=t.get(o),k.getStyle(Ye)===Bb&&(k._22I(h),t.removeAt(o),o--);return t},$k=function(J,H){var z=as(J,H);if(z&&!z.isEmpty()){if(1===z.size())return z.get(0)._22I(h),void 0;var M=new zc,B=new zc;z.each(function(j){var B=j.s("edge.group");M.contains(B)||M.add(B)}),M.sort(),M.each(function(J){B.add(new L.EdgeGroup(z.toList(function(k){return J===k.s("edge.group")}),B))}),B.each(function(y){y.each(function(j){j._22I(y)})})}},Io=function(b,l,N){var t=b._canvas;b._zoom;var c=Ge(l,t),W=Ge(N,t);return{x:c.x-W.x,y:c.y-W.y}},nj=function($,m){if(m){var Y=m.rect,u=m.color,K=m.rotation,v=m.labelWidth,i=m.background,r=m.opacity,D=m.scale,R=D!=h&&1!==D;if(r!=h){var t=$.globalAlpha;$.globalAlpha*=r}if(K||R){$.save();var y=Y.x+Y.width/2,J=Y.y+Y.height/2;Br($,y,J),K&&Ec($,K),R&&$.scale(D,D),Br($,-y,-J)}if(i&&qd($,Y.x,Y.y,Y.width,Y.height,i),v){var p=Y.width,E=$.createLinearGradient(Y.x,Y.y,Y.x+p,Y.y);E.addColorStop(0,u),E.addColorStop(.9,u),E.addColorStop(1,Ed),u=E,Y.width=v}Gf($,m.ss,Y,m.font,u,m.align),v&&(Y.width=p),(K||R)&&$.restore(),r!=h&&($.globalAlpha=t)}},Dj=function(P,K){if(K){var r=K.rect,Y=r.x,z=r.y,T=r.width,F=r.height,v=K.background,M=K.backgroundImage,m=K.borderWidth,x=K.borderColor,W=K.labelWidth,H=K.opacity,B=K.scale,e=B!=h&&1!==B;if(H!=h){var $=P.globalAlpha;P.globalAlpha*=H}if(e){P.save();var b=r.x+r.width/2,N=r.y+r.height/2;Br(P,b,N),P.scale(B,B),Br(P,-b,-N)}if(K.expanded){var t=n(8,T/4),R=z+F-8;if(P.fillStyle=v,P.beginPath(),P.moveTo(Y,z),P.lineTo(Y,R),P.lineTo(Y+T/2,R),P.lineTo(Y+T/2,z+F),P.lineTo(Y+T/2+t,R),P.lineTo(Y+T,R),P.lineTo(Y+T,z),P.closePath(),P.fill(),m&&(P.lineWidth=m,P.lineJoin="round",P.lineCap="round",x?(P.strokeStyle=x,P.stroke()):(P.strokeStyle=Gg(v),P.beginPath(),P.moveTo(Y+T,z),P.lineTo(Y+T,R),P.lineTo(Y+T/2+t,R),P.lineTo(Y+T/2,z+F),P.stroke(),P.strokeStyle=Eo(v),P.beginPath(),P.moveTo(Y+T,z),P.lineTo(Y,z),P.lineTo(Y,R),P.lineTo(Y+T/2,R),P.lineTo(Y+T/2,z+F),P.stroke())),M)ms(P,Tj(M),Om,r.x,r.y,r.width,r.height-8,K.data,K.view);else{if(r.height-=8,v=K.color,W){var J=T,k=P.createLinearGradient(Y,z,Y+J,z);k.addColorStop(0,v),k.addColorStop(.9,v),k.addColorStop(1,Ed),v=k,r.width=W}Gf(P,K.ss,r,K.font,v,K.align),W&&(r.width=J),r.height+=8}}else if(K.icon)Nl(P,Tj(K.icon),Y,z,T,F,K.data,K.view);else{var a=T/2;m&&(P.lineWidth=m,P.lineJoin="round",P.lineCap="round",P.strokeStyle=x?x:Gg(v),P.beginPath(),P.arc(Y+a,z+a,a,po,1.6*g,!0),P.moveTo(Y+a,z+F),P.lineTo(Y+T-a/5,z+a),P.stroke(),P.strokeStyle=x?x:Eo(v),P.beginPath(),P.arc(Y+a,z+a,a,1.6*g,po,!0),P.moveTo(Y+a,z+F),P.lineTo(Y+a/5,z+a),P.stroke()),P.fillStyle=v,P.beginPath(),P.arc(Y+a,z+a,a,0,S,!0),P.moveTo(Y+a,z+F),P.lineTo(Y+T-a/5,z+a),P.lineTo(Y+a/5,z+a),P.closePath(),P.fill(),P.fillStyle=K.color,P.beginPath(),P.arc(Y+a,z+a,a/3,0,S,!0),P.fill()}e&&P.restore(),H!=h&&(P.globalAlpha=$)}},$n=function(F,P){return P>2*F?F:P/2},Ko=function(z,v,T,Z){if(!z||!v)return 0;var o=tj(v.y-z.y,v.x-z.x);return T||(o=v.x<z.x?o+g:o),o+Z},ki=function(R,$,p,P,Q,l,Z){Z&&(R.x>$.x||R.x===$.x&&R.y>$.y)&&(p=Km[p],Q=-Q);var z=Rm(p,{x:0,y:0,width:ml(R,$),height:0},l);return z.x+=P,z.y+=Q,z=new Kb(tj($.y-R.y,$.x-R.x)).tf(z),z.x+=R.x,z.y+=R.y,z},cr=function(u,v,O,p,I){if(u._19Q=!0,!O.getEdgeGroup())return p?O.s("edge.gap"):0;if(vm(O.getSourceAgent())||vm(O.getTargetAgent()))return 0;var R,e=0,S=0,C=0;if(O.getEdgeGroup().getSiblings().each(function(B){B.each(function(h){if(v.isVisible(h)&&h.s(Ye)==I){var t=h.s("edge.gap");R?(S+=C/2+t/2,C=t):(R=h,C=t),h===O&&(e=S)}})}),p)return S-e+C;var L=e-S/2;return R&&O._40I!==R._40I&&(u._19Q=!1),L},Qd=function(M){var x=M._getValidSelection();if(1===x.length){var l=x[0],C=l instanceof L.Edge;if(l instanceof L.Shape||C){if(C){var z=l.s("edge.type");if(z&&"points"!==z)return}var $=M.gv;if((!$.isPointEditable||$.isPointEditable(l))&&$.isEditable(l))return l}}},pj=function(){var K=function(T){var f=[];return T.forEach(function(K){f.push({x:K.x,y:K.y}),f.push({x:K.x+K.width,y:K.y+K.height}),f.push({x:K.x+K.width,y:K.y}),f.push({x:K.x,y:K.y+K.height})}),f};return function(l,d,$){if("oval"===l){var T=0,g=$.height/$.width,I=g*g,Q=$.x+$.width/2,y=$.y+$.height/2,M=K(d);M.forEach(function(e){var s=e.x-Q,V=e.y-y,P=s*s+V*V/I;P>T&&(T=P)}),T=R(T);var k=g*T;return{x:Q-T,y:y-k,width:2*T,height:2*k}}if("circle"===l){var U=0,Q=$.x+$.width/2,y=$.y+$.height/2,M=K(d);return M.forEach(function(Y){var B=Y.x-Q,n=Y.y-y,g=B*B+n*n;g>U&&(U=g)}),U=R(U),{x:Q-U,y:y-U,width:2*U,height:2*U}}return"roundRect"===l?(sk($,n($.width,$.height)/16),$):$}}(),Rr=L.graph={},zp=function(m,y,E){sr(l+".graph."+m,y,E)};L.layout={};var rj={},Rj=function(p,E,m,I,d,W,z,$){var R=z._zoom;if(R!==z._cacheZoom&&(z._cacheZoom=R,z._cacheImage={}),R*=rg,I=Math.ceil(I),d=Math.ceil(d),I*R>2048||d*R>2048)return E;var c=[E.uuid,I,d,m].join("_");if(E.cacheRule){var S;S=Il(E.cacheRule)?E.cacheRule(W,z):zm(E.cacheRule,W,z),c+="_"+S}var D=z._cacheImage[c];if(!D){if(cj(),D=L.Default.toCanvas(E,I,d,m,W,z,$,R),!kg())return E;z._cacheImage[c]=D}return D};th(r,{setImageCacheRule:function(e,L){var c;L||"object"!=typeof e?(c={},c[e]=L):c=e;for(var o in c){var X=c[o];Pr(o)?(sr=Tj(o),sr?sr.cacheRule=X:rj[o]=X):o.cacheRule=X}}});var Kk={comps:[{type:Tm,points:[85,50,70,115,100,71,86,107,88,49,57,78,75,97,121,72,81,87,54,99,111,115,89,116,106,54,67,100,86,77,49,85,50,68,84,101,84,69,122,66,69,55,69,61],borderWidth:1,borderColor:h}]};if(Kk[Nq]=Kk[ll]=160,c.Image){var _l=new c.Image;_l.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAALUlEQVRYR+3QQREAAAABQfqXFsNnFTizzXk99+MAAQIECBAgQIAAAQIECBAgMBo/ACHo7lH9AAAAAElFTkSuQmCC",_f("default_blank",_l)}_f("node_image",gh(30,30,[{type:dp,rect:[4,5,22,16],gradient:Jg,gradientColor:lp,background:Mo},{type:dp,rect:[2,3,26,20],borderWidth:1,borderColor:Mo},{type:dp,rect:[11,23,8,4],background:Mo},{type:dp,rect:[6,27,18,2],background:Mo}])),_f("node_icon",gh(16,16,[{type:dp,rect:[2,2,12,10],gradient:Jg,gradientColor:lp,background:Mo},{type:An,rect:[2,2,12,10],width:1,color:Mo},{type:dp,rect:[6,12,4,2],background:Mo},{type:dp,rect:[4,14,8,1],background:Mo}])),_f("block_icon",gh(16,16,[{type:An,rect:[1,1,14,14],width:1,color:Mo}])),_f("group_image",gh(66,39,[{type:dp,rect:[44.3,18,18.1,12.8],gradient:Jg,gradientColor:lp,background:Mo},{type:dp,rect:[3.3,17.8,18.1,12.8],gradient:Jg,gradientColor:lp,background:Mo},{type:dp,rect:[15.8,3.2,33.5,26.4],borderWidth:1,borderColor:Mo,gradient:Jg,gradientColor:lp,background:Mo},{type:dp,rect:[26.2,29.4,12.8,4.2],background:Mo},{type:dp,rect:[21.3,33.5,22.5,2.3],background:Mo},{type:dp,rect:[5.3,32.7,14.1,2.1],background:Mo},{type:dp,rect:[9,30.4,6.7,2.4],background:Mo},{type:dp,rect:[50,30.7,6.7,2.4],background:Mo},{type:dp,rect:[46.3,33,14.1,2.1],background:Mo}])),_f("group_icon",gh(16,16,[{type:dp,rect:[4,12,4,2],background:Mo},{type:dp,rect:[2,13,8,1],background:Mo},{type:dp,rect:[12,12,2,1],background:Mo},{type:dp,rect:[11,13,4,1],background:Mo},{type:dp,rect:[10,7,6,5],gradient:Jg,gradientColor:lp,background:Mo},{type:dp,rect:[1,2,10,10],gradient:Jg,gradientColor:lp,background:Mo},{type:An,rect:[1,2,10,10],width:1,color:Mo}])),_f("refGraph_icon",gh(16,16,[{type:"shape",borderWidth:1,borderColor:Mo,borderCap:"round",rotation:.7854,points:[12.5502,6.7981,12.5502,6.7981,12.5502,4.8181,12.5502,3.7981,12.5502,2.7781,11.36687,1.7981,10.0502,1.7981,8.73354,1.7981,7.5502,2.8181,7.5502,3.7981,7.5502,4.55989,7.5502,7.79805,7.5502,7.79805,7.5502,7.79805,7.5502,9.7981,10.0502,9.7981],segments:[1,4,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:Mo,borderCap:"round",rotation:-2.35619,points:[8.4498,11.2019,8.4498,11.2019,8.4498,9.2219,8.4498,8.2019,8.4498,7.1819,7.26646,6.2019,5.9498,6.2019,4.63313,6.2019,3.4498,7.2219,3.4498,8.2019,3.4498,8.9637,3.4498,12.20186,3.4498,12.20186,3.4498,12.20186,3.4498,14.2019,5.9498,14.2019],segments:[1,4,4,4,4,4]}])),_f("edge_icon",gh(16,16,[{type:dp,rect:[2.1,6.9,11.5,2.6],rotation:-.79,gradient:Jg,gradientColor:lp,background:Mo},{type:dp,rect:[10.8,1,4,4],background:Mo},{type:dp,rect:[1,11,4,4],background:Mo}])),_f("subGraph_image",gh(72,45,[{type:Tm,points:[9,42,.3,38.4,2.4,28.8,5.7,21.6,11.7,22.5,11.7,15.9,16.8,13.8,21.6,12,24.3,15.9,27.9,3,42.3,2.1,59.4,4.5,57.3,18.3,67.5,18.9,69.6,27.3,69.9,38.4,64.2,41.4],segments:[1,3,3,3,3,3,3,3,3],gradient:Jg,gradientColor:lp,background:Mo},{type:dp,rect:[29.6,30.7,3.6,1.8],background:Mo},{type:dp,rect:[28.4,32.3,6,1.2],background:Mo},{type:dp,rect:[37.3,32,10.8,1.8],background:Mo},{type:dp,rect:[39.1,29.9,7.2,2.3],background:Mo},{type:dp,rect:[26.6,23.7,9.6,7.2],gradient:Jg,gradientColor:lp,background:Mo},{type:dp,rect:[34.3,16.8,16.8,13.2],borderWidth:1,borderColor:Mo,gradient:Jg,gradientColor:lp,background:Mo}])),_f("subGraph_icon",gh(17,17,[{type:Tm,points:[2.2,14.6,.2,11.9,.8,8.8,1.8,5.9,5.6,7.4,3.8,1.6,10.3,3,14.5,4.2,12.2,7.5,18.9,7.2,14.5,14.5],segments:[1,3,3,3,3,3],gradient:Jg,gradientColor:lp,background:Mo}])),_f("shape_icon",gh(16,16,[{type:Tm,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],background:Mo}])),_f("polyline_icon",gh(16,16,[{type:Tm,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],borderWidth:1,borderColor:Mo},Lb(7.5,.4),Lb(7.5,6.3),Lb(13.6,6.3),Lb(13.6,14),Lb(.7,13.9),Lb(.7,.3)])),_f("grid_icon",gh(16,16,[{type:dp,rect:[1,1,4,4],background:Mo,gradient:Jg,gradientColor:lp},{type:dp,rect:[6,1,4,4],background:Mo,gradient:Jg,gradientColor:lp},{type:dp,rect:[11,1,4,4],background:Mo,gradient:Jg,gradientColor:lp},{type:dp,rect:[11,6,4,4],background:Mo,gradient:Jg,gradientColor:lp},{type:dp,rect:[6,6,4,4],background:Mo,gradient:Jg,gradientColor:lp},{type:dp,rect:[1,6,4,4],background:Mo,gradient:Jg,gradientColor:lp},{type:dp,rect:[11,11,4,4],background:Mo,gradient:Jg,gradientColor:lp},{type:dp,rect:[6,11,4,4],background:Mo,gradient:Jg,gradientColor:lp},{type:dp,rect:[1,11,4,4],background:Mo,gradient:Jg,gradientColor:lp}])),_f("light_icon",gh(16,16,[{type:"rect",rect:[6,9,5,5],borderWidth:1,borderColor:Mo},{type:"circle",rect:[1,1,15,10],borderWidth:1,borderColor:Mo,gradient:Jg,gradientColor:lp,background:{func:function(A){var j=A?A.s(Od):h;return rm(j)?"rgb("+Tr(255*j[0])+","+Tr(255*j[1])+","+Tr(255*j[2])+")":j||Mo}}}])),_f("text_icon",gh(16,16,[{type:"shape",points:[3,3,13,3,8,3,8,14],segments:[1,2,1,2],borderWidth:1,borderColor:Mo}])),_f("border_image",{fitSize:!0,comps:[{type:"border",relative:!0,rect:[0,0,1,1],color:{func:"style@border_color"},width:{func:"style@border_width"}}]}),_f("columnChart_image",{fitSize:!0,boundExtend:150,comps:[{type:{func:"style@chart.type"},relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"}}]}),_f("lineChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"lineChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"},linePoint:{func:"style@chart.line.point"},lineWidth:{func:"style@chart.line.width"},line3d:{func:"style@chart.line.3d"}}]}),_f("pieChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"pieChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},hollow:{func:"style@chart.hollow"},startAngle:{func:"style@chart.start.angle"},values:{func:"style@chart.values"},colors:{func:"style@chart.colors"}}]});var yq=function(v,C,p,d,Z,y){var b,Q,W,c,u,e,g,w,f,x,q,h=[];if(Math.abs(d)>2*Math.PI&&(d=2*Math.PI),u=Math.ceil(Math.abs(d)/(Math.PI/4)),b=d/u,Q=-b,W=-p,u>0){e=v+Math.cos(p)*Z,g=C+Math.sin(-p)*y,h.push({x:e,y:g});for(var I=0;u>I;I++)W+=Q,c=W-Q/2,w=v+Math.cos(W)*Z,f=C+Math.sin(W)*y,x=v+Math.cos(c)*(Z/Math.cos(Q/2)),q=C+Math.sin(c)*(y/Math.cos(Q/2)),h.push({x:x,y:q}),h.push({x:w,y:f})}return h},Qj=function(d){if(d){var X=d._data;if(X instanceof L.Shape)return{points:X.getPoints(),segments:X.getSegments()};var I;if(X instanceof L.Edge&&(I=d._78o)){var T,Z,x=I.type,q=I.points,V=I.segments,G=I.edgeTypeInfo;if(!x||q){var N=I.sourcePoint,v=N.x,w=N.y,$=I.targetPoint,i=$.x,E=$.y;if(x)V?(T=new zc({x:v,y:w}),T.addAll(q),T.add({x:i,y:E}),Z=new zc(V._as)):(T=new zc({x:v,y:w}),q.each(function(w){T.add(w)}),T.add({x:i,y:E}));else if(I.looped){T=new zc(yq(v,w,0,2*Math.PI,I.radius,I.radius)),Z=new zc([1]);for(var K=0;K<(T.size()-1)/2;K++)Z.add(3)}else T=new zc,I.center?(T.add({x:I.c1.x,y:I.c1.y}),T.add({x:v,y:w}),T.add({x:i,y:E}),T.add({x:I.c2.x,y:I.c2.y})):(T.add({x:v,y:w}),T.add({x:i,y:E}))}else G&&(T=new zc(G.points._as),G.segments&&(Z=new zc(G.segments._as)));return{points:T,segments:Z}}}},Sn=function(m,p,V){if(null==p){var H=Qj(m);if(!H)return;p=H.points,V=H.segments}if(p){if(Array.isArray(p)&&(p=new zc(p)),"number"==typeof p.get(0)){for(var S=new L.List,N=0;N<p.size();N+=2)S.add({x:p.get(N),y:p.get(N+1)});p=S}if(!V){V=[1];for(var R=p.length-1;R>0;R--)V.push(2)}Array.isArray(V)&&(V=new zc(V));for(var g=zn(p._as,V._as,50),u=g.length,f=[],N=0;u>N;N++){var r=g[N];r.length>1&&f.push(r)}return f}},Jj=function(S){for(var R=0,O=S.length-1,E=0;O>E;E++){var e=S[E],d=S[E+1],Y=d.x-e.x,a=d.y-e.y;R+=Math.sqrt(Y*Y+a*a)}return R},Yg=function(c,j){for(var w=0,L=j.length,D=0;L>D;D++){var Q=j[D];if(w+=Q,w>c)return D}return Math.min(D,L-1)},kd=function(o,Z){for(var G=0,j=0,v=0,i=o.length-1,W=0;i>W;W++){var l=o[W],N=o[W+1],k=N.x-l.x,d=N.y-l.y;if(v=Math.sqrt(k*k+d*d),G+=v,G>Z){G-=v,j=W;break}}var Q=o[j],b=o[j+1],g=Math.atan2(b.y-Q.y,b.x-Q.x),_=Z-G,d=Math.sin(g)*_,k=Math.cos(g)*_;return{x:Q.x+k,y:Q.y+d}},mm=function(Y,A){if(Y){var X;if(0===A)X=Y[0][0];else if(100===A)Y=Y[Y.length-1],X=Y[Y.length-1];else{for(var R=0,Q=[],z=Y.length,g=0;z>g;g++){var s=Y[g],W=Jj(s);R+=W,Q.push(W)}for(var r=R*A/100,n=Yg(r,Q),D=0,I=0;n>I;I++)D+=Q[I];r-=D,X=kd(Y[n],r)}return X}},$g=function(R){var M,Z,N,I,X=Qj(R),s=[],f=X.points,e=X.segments,Y=-1;for(Z=0,N=e?e.length:f.length;N>Z;Z++){if(M=e?e.get(Z):1,3===M)I=2;else if(4===M)I=3;else{if(5===M)continue;I=1}Y+=I,s.push(f.get(Y))}return s},Pq=function($,d,t,h){function w(g){if(g>=0&&1>=g){p=d(g);var Z=($.x-p.x)*($.x-p.x)+($.y-p.y)*($.y-p.y);return _>Z?(_=Z,H=g,!0):!1}}t=t||100,h=h||1e-5;for(var _=1/0,H=0,p=new lm,I=0;t>I;++I)w(I/t);for(var r=1/(2*t);r>h;)w(H-r)||w(H+r)||(r/=2);return H};th(r,{_edgeProtectMethod:{getStraightLinePoints:Sn,calculateLineLength:Jj,calcSegmentIndexByDistance:Yg,calculatePointAlongLine:kd,getPercentPosition:mm,getRealPointsFromDataUI:$g}});var Be=function(x,Y){for(var z=x.vertices,N=0;N<z.length;N++){var L=z[N],e=L.y;L.y=L.z,L.z=-e,Y&&(L.y+=Y)}},Pb=function(D){for(var N,y,s,L,F,R,V=[],C=[],W=[],t=D.faces,P=0,g=0,e=0,m=t.length;m>P;P++,g+=6,e+=9){var S=t[P];1===S.i?(N||(N=[],y=[],s=[]),ub(S,P,g,e,D,N,s,y)):2===S.i?(L||(L=[],F=[],R=[]),ub(S,P,g,e,D,L,R,F)):ub(S,P,g,e,D,V,W,C)}return{vs:V,uv:C,ns:W,top_vs:N,top_uv:y,top_ns:s,bottom_vs:L,bottom_uv:F,bottom_ns:R}},ub=function(c,d,L,N,z,w,U,Q){var p=z.vertices,S=z.faceVertexUvs,n=p[c.a],P=p[c.b],Z=p[c.c];w.push(n.x,n.y,n.z,P.x,P.y,P.z,Z.x,Z.y,Z.z);var e,v,W,H=c.vertexNormals;3===H.length?(e=H[0],v=H[1],W=H[2]):e=v=W=c.normal,U.push(e.x,e.y,e.z,v.x,v.y,v.z,W.x,W.y,W.z);var F=S[0][d][0],q=S[0][d][1],V=S[0][d][2];Q.push(F.x,F.y,q.x,q.y,V.x,V.y)},uq=function(){function L(k,D){return k.dot(D)>0}function R(o,N,I,U,C,j,u){for(var K,p,b=[N,I,U],$=[C,j,u],k=[],h=b.length,t=!0;h--&&t;){for(var R=b[h],l=$.length,H=!1;l--;)if(R.equals($[l])){$.splice(l,1),k.push(R),H=!0;break}if(!H){if(K){t=!1;break}K=R}}return t&&2===k.length&&(p=$[0],v.subVectors(K,k[0]),q.subVectors(p,k[0]),V.subVectors(K,k[1]),v.x*V.y*q.z+V.x*q.y*v.z+q.x*v.y*V.z-q.x*V.y*v.z-q.y*V.z*v.x-q.z*V.x*v.y<1e-6&&(F.subVectors(p,k[1]),T.subVectors(k[1],k[0]),L(T,v)&&L(T,q)&&(T.negate(),L(T,V)&&L(T,F))))?(o.push(k[1].x,k[1].y,k[1].z),o.push(K.x,K.y,K.z),o.push(K.x,K.y,K.z),o.push(k[0].x,k[0].y,k[0].z),o.push(k[0].x,k[0].y,k[0].z),o.push(p.x,p.y,p.z),o.push(p.x,p.y,p.z),o.push(k[1].x,k[1].y,k[1].z),2):(o.push(N.x,N.y,N.z),o.push(I.x,I.y,I.z),o.push(I.x,I.y,I.z),o.push(U.x,U.y,U.z),o.push(U.x,U.y,U.z),o.push(N.x,N.y,N.z),1)}function s(){this._vertexMap={},this._lineMap={},this._lineList=[]}function i(o,u,n,T,i,g,$){var f=[n,i];o[0]===T&&f.reverse();var r=[f[0]._key,f[1]._key].join("|"),B=o._triangles[r];B||(o._triangles[r]=B={});var S=[g._key,$._key].join("|");B[S]||(B[S]=[g,$])}function j(d,C,F){var _=d._planes[F._key];if(!_)for(var j in d._planes){var J=d._planes[j];if(J._normal.angleTo(F)<.001){_=J;break}}return _?(_._vertices.indexOf(C)<0&&_._vertices.push(C),void 0):(d._planes[F._key]={_normal:F,_vertices:[C]},void 0)}function o(X,u){return 0===u?"0|0|0":1/0===Math.abs(u)?[X.x,X.y,X.z].join("|"):[Math.round(P.angleTo(X)*u),Math.round(C.angleTo(X)*u),Math.round(M.angleTo(X)*u)].join("|")}function z(E,A){var Q=E._ctlineModel;if(Q||(E._ctlineModel=Q=[]),Q[0])return Q[0];var B;B=rm(E)?E:[E];var F,K,I,W,v,V,M,n,X,p,N,H,P,j,T,U,t,$,x,o=["","top_","bottom_"];Q=[];var f=[];for(nh(B,A,f),F=0,K=f.length;K>F;F++)if(p=f[F])for(Pg(p),I=0,W=o.length;W>I;I++)if(X=p[o[I]+"lvs"])for(t=Q.length,$=X.length,Q.length=t+$,x=0;$>x;++x,++t)Q[t]=X[x];else if(M=p[o[I]+"vs"]){n=p[o[I]+"is"],V=n?n.length:M.length/3;for(var v=0;V-1>v;)n?(N=n[v],H=n[v+1],P=n[v+2],j=n[v+3],T=n[v+4],U=n[v+5]):(N=v,H=v+1,P=v+2,j=v+3,T=v+4,U=v+5),u.fromArray(M,3*N),J.fromArray(M,3*H),G.fromArray(M,3*P),m.fromArray(M,3*j),O.fromArray(M,3*T),w.fromArray(M,3*U),v+=3*R(Q,u,J,G,m,O,w);V>v&&(n?(N=n[v],H=n[v+1],P=n[v+2]):(N=v,H=v+1,P=v+2),u.fromArray(M,3*N),J.fromArray(M,3*H),G.fromArray(M,3*P),Q.push(u.x,u.y,u.z),Q.push(J.x,J.y,J.z),Q.push(J.x,J.y,J.z),Q.push(G.x,G.y,G.z),Q.push(G.x,G.y,G.z),Q.push(u.x,u.y,u.z))}return E._ctlineModel[0]=Q,Q}function e(f,c,r){var S=f._ctlineModel;S||(f._ctlineModel=S=[]);var j=S[1];if(j&&j.epsilon===r)return j;j=[],j.epsilon=r;var Q;Q=rm(f)?f:[f];var J,m,l,E,t,e,d,U,M,z,w,L,p=["","top_","bottom_"],R=new s,C=[];for(nh(Q,c,C),J=0,m=C.length;m>J;J++)if(M=C[J])for(Pg(M),l=0,E=p.length;E>l;l++)if(d=M[p[l]+"vs"]){U=M[p[l]+"is"],e=U?U.length:d.length/3;for(var t=0,t=0;e>t;t+=3)U?(z=U[t],w=U[t+1],L=U[t+2]):(z=t,w=t+1,L=t+2),R._addTriangle(d,A,z,w,L,r)}return R._toLineVS(j),f._ctlineModel[1]=j,j}function Y(f,x,E){var g=f._ctlineModel;g||(f._ctlineModel=g=[]);var H=g[2];if(H&&H.epsilon===E)return H;H=[],H.epsilon=E;var K;K=rm(f)?f:[f];var U,k,$,m,o,p,u,C,w,t,W,a,j,D=["","top_","bottom_"],X=new s,Q=[];for(nh(K,x,Q),U=0,k=Q.length;k>U;U++)if(t=Q[U])for(Pg(t),$=0,m=D.length;m>$;$++)if(u=t[D[$]+"vs"]){C=t[D[$]+"is"],w=t[D[$]+"ns"],p=C?C.length:u.length/3;for(var o=0,o=0;p>o;o+=3)C?(W=C[o],a=C[o+1],j=C[o+2]):(W=o,a=o+1,j=o+2),X._addTriangle(u,w,W,a,j,E)}return X._toLineVS(H),f._ctlineModel[2]=H,H}var u=new Ai,J=new Ai,G=new Ai,m=new Ai,O=new Ai,w=new Ai,v=new Ai,V=new Ai,q=new Ai,F=new Ai,T=new Ai,S=new Ai;s.prototype._findVertex=function(P,j){S.fromArray(P,3*j);var E=[S.x,S.y,S.z].join(","),s=this._vertexMap[E];if(!s){var p=S.clone();p._key=E,this._vertexMap[E]=s=p}return s},s.prototype._findLine=function(c,L){var N=[c,L];c._key>L._key&&N.reverse(),N._key=[N[0]._key,N[1]._key].join("|");var M=this._lineMap[N._key];return M||(this._lineMap[N._key]=M=N,N._triangles={},N._planes={},this._lineList.push(N)),M};var P=new Ai(1,0,0),C=new Ai(0,1,0),M=new Ai(0,0,1),I=new Ai,X=new Ai;return s.prototype._addTriangle=function(n,S,u,l,B,c){var P,J,w,M=this._findVertex(n,u),t=this._findVertex(n,l),E=this._findVertex(n,B),_=this._findLine(M,t),d=this._findLine(t,E),K=this._findLine(E,M);S?(P=(new Ai).fromArray(S,3*u),P._key=o(P,c),J=(new Ai).fromArray(S,3*l),J._key=o(J,c),w=(new Ai).fromArray(S,3*B),w._key=o(w,c),i(_,M,P,t,J,E,w),i(d,t,J,E,w,M,P),i(K,E,w,M,P,t,J)):(X.subVectors(E,t),I.subVectors(t,M),P=(new Ai).crossVectors(I,X),P._key=o(P,c),j(_,E,P),j(d,M,P),j(K,t,P))},s.prototype._toLineVS=function(r){for(var T=this._lineList,i=0,R=T.length;R>i;++i){var Z=T[i],p=!1;for(var w in Z._triangles)if(1==U.keys(Z._triangles[w]).length){r.push(Z[0].x,Z[0].y,Z[0].z,Z[1].x,Z[1].y,Z[1].z),p=!0;break}if(!p)for(var d in Z._planes)if(1==Z._planes[d]._vertices.length){r.push(Z[0].x,Z[0].y,Z[0].z,Z[1].x,Z[1].y,Z[1].z),p=!0;break}}},[z,e,Y]}(),Dd=function(K,B){var Y=K._lineModel;if(Y)return Y;var m;m=rm(K)?K:[K];var r,y,O,n,x,w,p,i,q,A,c,H,C=["","top_","bottom_"];Y=[];var W=[];for(nh(K,B,W),r=0,y=W.length;y>r;r++)if(q=W[r])for(O=0,n=C.length;n>O;O++)if(p=q[C[O]+"vs"]){i=q[C[O]+"is"],w=i?i.length:p.length/3;for(var x=0;w>x;x+=3)i?(A=i[x],c=i[x+1],H=i[x+2]):(A=x,c=x+1,H=x+2),A*=3,c*=3,H*=3,Y.push(p[A],p[A+1],p[A+2],p[c],p[c+1],p[c+2],p[c],p[c+1],p[c+2],p[H],p[H+1],p[H+2],p[H],p[H+1],p[H+2],p[A],p[A+1],p[A+2])}return K._lineModel=Y,Y},wn=function(g,E,X,u,P,e,J,Z,C,l){X==h&&(X=!0),u==h&&(u=!0),J==h&&(J=1),Z==h&&(Z=0);var r=new Vh;Nm(r,g,E,C),r=r.toShapes();var m=A;return l&&(l.length?m={minX:l[0],minY:l[1],maxX:l[2],maxY:l[3]}:(m={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},r.forEach(function(S){var N=S.getBoundingBox();m.minX=n(N.minX,m.minX),m.minY=n(N.minY,m.minY),m.maxX=k(N.maxX,m.maxX),m.maxY=k(N.maxY,m.maxY)}))),Pb(new Vb(r,{top:X,bottom:u,curveSegments:P,amount:J,repeatUVLength:e,boundingBox:m},-J/2+Z))},Qn=function(k,h){this.repeatUVLength=k,this._bb=h};Qn.prototype={generateTopUV:function(d,Q,F,M,B,O,N){var k,I,j,H,E=d.vertices,f=E[M].x,v=E[M].y,A=E[B].x,K=E[B].y,b=E[O].x,V=E[O].y,P=this.repeatUVLength;if(P)k=0,I=0,j=P,H=P;else{this._bb||(this._bb=Q.getBoundingBox());var u=this._bb;k=u.minX,I=u.minY,j=u.maxX-k,H=u.maxY-I}return N?[new vr((f-k)/j,(v-I)/H),new vr((A-k)/j,(K-I)/H),new vr((b-k)/j,(V-I)/H)]:[new vr((f-k)/j,1-(v-I)/H),new vr((A-k)/j,1-(K-I)/H),new vr((b-k)/j,1-(V-I)/H)]},generateBottomUV:function(y,v,L,s,e,m){return this.generateTopUV(y,v,L,s,e,m,!0)},generateSideWallUV:function(l,V,v,b,n,U,B,O,w,j,T,k){if(!this._cl){for(var x,q,u=[],p=0,L=v.length,o=0;L>o;o++){x=v[o],q=v[(o+1)%L];var S=x.x-q.x,e=x.y-q.y,N=R(S*S+e*e);u.push(p),p+=N}for(var o=0;L>o;o++)u[o]/=p;this._cl=u}var u=this._cl,m=1-w/j,z=1-(w+1)/j,F=u[T],X=u[k];return X>F&&(F+=1),[new vr(F,m),new vr(X,m),new vr(X,z),new vr(F,z)]}};var ug=function(r,k,O,J,c,n){this.a=r,this.b=k,this.c=O,this.i=n,this.normal=J instanceof Ah?J:new Ah,this.vertexNormals=J instanceof Array?J:[]};ug.prototype={constructor:ug};var Hl=[-8,14,-4,15,0,6,3,6,-1],yd=function(){if(yd[tf]!=h)return yd[tf];for(var $=ie[tf],N=Hl,l=Xm.prototype.getClassName(),o='"',q=0,X="",O=!1,e=+new(c[l.substr(3,3)+cs[q]]),r=q;r<N.length;r++){var z=N.length-r;X+=r%2===q?N[r]+z+"":N[r]-z+""}for(var r=q;4>r;r++)X+=q;if(X=X*X.length/X.length,e>X){if($&&$[q]&&$[4/dp.length]){for(var u,f,D,t,T,G,m,Y,M=$[0],B=$[1],y="",b=0,r=0;r<B.length;r++)B[r]===o?Y?(Y=!1,0!==b%2&&(u==h?u=y:f==h?f=y:D==h?D=y:t==h?t=y:T==h?T=y:G==h?G=y:m==h&&(m=y)),b++,y=""):Y=!0:Y&&(y+=B[r]);for(var P,Q,F,I="",j=0,r=0;r<M.length;r++)M[r]===o?P?(P=!1,0!==j%2&&(Q==h?Q=I:F==h&&(F=I)),j++,I=""):P=!0:P&&(I+=M[r]);var g=u+f+D+t+T+G,E=!G||G===xf;if(!E&&G)for(var C,r=0,i=G.length;i>r;r++)G[r]===op[4]?C===xf?E=Ce:C[0]===ol[7]&&xf&&xf.indexOf(C.substr(1))>=0?E=dg:C=h:(C==h?C=G[r]:C+=G[r],r===i-1&&(C===xf?E=Ce:C[0]===ol[7]&&xf&&xf.indexOf(C.substr(1))>=0&&(E=dg)));(O=cb(g,m)&&cb(Q,F)&&Q===u&&E&&(!T||T>e))&&D.indexOf(qn[0])>=0&&(yd[qn[0]]=1),O&&D.indexOf(1)>=0&&(yd[1]=1),O&&D.indexOf(3)>=0&&(yd[2]=1),O&&D.indexOf(4)>=0&&(yd[3]=1),O&&D.indexOf(7)>=0&&(yd[4]=1)}}else O=!0,yd[qn[0]]=yd[1]=yd[2]=yd[3]=yd[4]=1;return yd[tf]=O,O},dr=function(){},Iq=dr.prototype;Iq.getPointAt=function(R){var w=this.getUtoTmapping(R);return this.getPoint(w)},Iq.getPoints=function(L){L||(L=5);var j,Z=[];for(j=0;L>=j;j++)Z.push(this.getPoint(j/L));return Z},Iq.getSpacedPoints=function(D){D||(D=5);var d,B=[];for(d=0;D>=d;d++)B.push(this.getPointAt(d/D));return B},Iq.getLength=function(){var U=this.getLengths();return U[U.length-1]},Iq.getLengths=function(m){if(m||(m=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==m+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var o,Q,E=[],t=this.getPoint(0),l=0;for(E.push(0),Q=1;m>=Q;Q++)o=this.getPoint(Q/m),l+=o.distanceTo(t),E.push(l),t=o;return this.cacheArcLengths=E,E},Iq.getUtoTmapping=function(b,X){var B,A=this.getLengths(),u=0,i=A.length;B=X?X:b*A[i-1];for(var T,D=0,R=i-1;R>=D;)if(u=y(D+(R-D)/2),T=A[u]-B,0>T)D=u+1;else{if(!(T>0)){R=u;break}R=u-1}if(u=R,A[u]==B){var V=u/(i-1);return V}var g=A[u],z=A[u+1],h=z-g,Y=(B-g)/h,V=(u+Y)/(i-1);return V},Iq.getTangent=function(q){var G=1e-4,H=q-G,a=q+G;0>H&&(H=0),a>1&&(a=1);var L=this.getPoint(H),O=this.getPoint(a),k=O.clone().sub(L);return k.normalize()},Iq.getTangentAt=function(T){var f=this.getUtoTmapping(T);return this.getTangent(f)},dr.create=function(p,t){return p.prototype=Ch(dr.prototype),p.prototype.getPoint=t,p};var zf=function(){this.curves=[],this.autoClose=!1},ud=zf.prototype=Ch(Iq);ud.add=function(K){this.curves.push(K)},ud.closePath=function(){var A=this.curves[0].getPoint(0),G=this.curves[this.curves.length-1].getPoint(1);
A.equals(G)||this.curves.push(new yp(G,A))},ud.getPoint=function(i){for(var B,b,h=i*this.getLength(),x=this.getCurveLengths(),C=0;C<x.length;){if(x[C]>=h){B=x[C]-h,b=this.curves[C];var w=1-B/b.getLength();return b.getPointAt(w)}C++}return null},ud.getLength=function(){var M=this.getCurveLengths();return M[M.length-1]},ud.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var H,d=[],e=0,U=this.curves.length;for(H=0;U>H;H++)e+=this.curves[H].getLength(),d.push(e);return this.cacheLengths=d,d},ud.getTransformedPoints=function(F){return this.getPoints(F)},ud.getBoundingBox=function(){var w,G,K,Z,$,O,n=this.getPoints();w=G=Number.NEGATIVE_INFINITY,Z=$=Number.POSITIVE_INFINITY;var Q,F,I,U,H=n[0]instanceof Ah;for(U=H?new Ah:new vr,F=0,I=n.length;I>F;F++)Q=n[F],Q.x>w&&(w=Q.x),Q.x<Z&&(Z=Q.x),Q.y>G&&(G=Q.y),Q.y<$&&($=Q.y),H&&(Q.z>K&&(K=Q.z),Q.z<O&&(O=Q.z)),U.add(Q);var P={minX:Z,minY:$,maxX:w,maxY:G};return H&&(P.maxZ=K,P.minZ=O),P};var zb=function(H){zf.call(this),this.actions=[],H&&this.fromPoints(H)},lh=zb.prototype=Ch(zf.prototype),xh="moveTo",Aj="lineTo",qk="quadraticCurveTo",Oe="bezierCurveTo",qb="arc",qm="ellipse";lh.fromPoints=function(o){this.moveTo(o[0].x,o[0].y);for(var I=1,Y=o.length;Y>I;I++)this.lineTo(o[I].x,o[I].y)},lh.moveTo=function(){var f=Array.prototype.slice.call(arguments);this.actions.push({action:xh,args:f})},lh.lineTo=function(F,z){var N=Array.prototype.slice.call(arguments),b=this.actions[this.actions.length-1].args,m=b[b.length-2],Z=b[b.length-1],G=new yp(new vr(m,Z),new vr(F,z));this.curves.push(G),this.actions.push({action:Aj,args:N})},lh.quadraticCurveTo=function(c,g,f,G){var m=Array.prototype.slice.call(arguments),T=this.actions[this.actions.length-1].args,D=T[T.length-2],x=T[T.length-1],k=new cq(new vr(D,x),new vr(c,g),new vr(f,G));this.curves.push(k),this.actions.push({action:qk,args:m})},lh.bezierCurveTo=function(o,g,B,u,c,F){var Y=Array.prototype.slice.call(arguments),P=this.actions[this.actions.length-1].args,i=P[P.length-2],e=P[P.length-1],x=new Zk(new vr(i,e),new vr(o,g),new vr(B,u),new vr(c,F));this.curves.push(x),this.actions.push({action:Oe,args:Y})},lh.arc=function(M,s,C,L,f,O){var S=this.actions[this.actions.length-1].args,$=S[S.length-2],I=S[S.length-1];this.absarc(M+$,s+I,C,L,f,O)},lh.absarc=function(A,i,y,M,H,c){this.absellipse(A,i,y,y,M,H,c)},lh.ellipse=function($,I,V,Y,p,U,B){var L=this.actions[this.actions.length-1].args,e=L[L.length-2],P=L[L.length-1];this.absellipse($+e,I+P,V,Y,p,U,B)},lh.absellipse=function(j,_,l,U,i,a,E){var W=Array.prototype.slice.call(arguments),e=new ir(j,_,l,U,i,a,E);this.curves.push(e);var C=e.getPoint(1);W.push(C.x),W.push(C.y),this.actions.push({action:qm,args:W})},lh.getSpacedPoints=function(p){p||(p=40);for(var s=[],f=0;p>f;f++)s.push(this.getPoint(f/p));return s},lh.getPoints=function(W,m){W=W||12;var M,k,r,x,l,p,V,y,N,h,U,b,w,Q,t,L,F,Z,P=[];for(M=0,k=this.actions.length;k>M;M++)switch(r=this.actions[M],x=r.action,l=r.args,x){case xh:P.push(new vr(l[0],l[1]));break;case Aj:P.push(new vr(l[0],l[1]));break;case qk:for(p=l[2],V=l[3],h=l[0],U=l[1],P.length>0?(Q=P[P.length-1],b=Q.x,w=Q.y):(Q=this.actions[M-1].args,b=Q[Q.length-2],w=Q[Q.length-1]),t=1;W>=t;t++)L=t/W,F=of.b2(L,b,h,p),Z=of.b2(L,w,U,V),P.push(new vr(F,Z));break;case Oe:for(p=l[4],V=l[5],h=l[0],U=l[1],y=l[2],N=l[3],P.length>0?(Q=P[P.length-1],b=Q.x,w=Q.y):(Q=this.actions[M-1].args,b=Q[Q.length-2],w=Q[Q.length-1]),t=1;W>=t;t++)L=t/W,F=of.b3(L,b,h,y,p),Z=of.b3(L,w,U,N,V),P.push(new vr(F,Z));break;case qb:var j,G=l[0],J=l[1],O=l[2],X=l[3],I=l[4],s=!!l[5],C=I-X,d=2*W;for(t=1;d>=t;t++)L=t/d,s||(L=1-L),j=X+L*C,F=G+O*$(j),Z=J+O*e(j),P.push(new vr(F,Z));break;case qm:var j,G=l[0],J=l[1],a=l[2],Y=l[3],X=l[4],I=l[5],s=!!l[6],C=I-X,d=2*W;for(t=1;d>=t;t++)L=t/d,s||(L=1-L),j=X+L*C,F=G+a*$(j),Z=J+Y*e(j),P.push(new vr(F,Z))}var o,q,H=E["shape3d.point.epsilon"],T=!1;for(k=P.length,M=0,k=P.length;k>M;M++)o=P[M],q=M===k-1?P[0]:P[M+1],o&&q&&z(o.x-q.x)<H&&z(o.y-q.y)<H&&(T=!0,P[M]=null);if(T){var v=[];for(M=0;k>M;M++)P[M]&&v.push(P[M]);P=v}return m&&P.push(P[0]),P},lh.toShapes=function(r,s){function S(x){var N,G,T,X,h,u=[],Z=new zb;for(N=0,G=x.length;G>N;N++)T=x[N],h=T.args,X=T.action,X==xh&&0!=Z.actions.length&&(u.push(Z),Z=new zb),Z[X].apply(Z,h);return 0!=Z.actions.length&&u.push(Z),u}function d(W){for(var B=[],g=0,A=W.length;A>g;g++){var D=W[g],n=new Vh;n.actions=D.actions,n.curves=D.curves,B.push(n)}return B}function y(H,R){for(var y=1e-10,I=R.length,b=!1,c=I-1,J=0;I>J;c=J++){var T=R[c],A=R[J],O=A.x-T.x,m=A.y-T.y;if(z(m)>y){if(0>m&&(T=R[J],O=-O,A=R[c],m=-m),H.y<T.y||H.y>A.y)continue;if(H.y==T.y){if(H.x==T.x)return!0}else{var o=m*(H.x-T.x)-O*(H.y-T.y);if(0==o)return!0;if(0>o)continue;b=!b}}else{if(H.y!=T.y)continue;if(A.x<=H.x&&H.x<=T.x||T.x<=H.x&&H.x<=A.x)return!0}}return b}var g=S(this.actions);if(0==g.length)return[];if(s===!0)return d(g);var n,F,W,o=[];if(1==g.length)return F=g[0],W=new Vh,W.actions=F.actions,W.curves=F.curves,o.push(W),o;var B=!of.isClockWise(g[0].getPoints());B=r?!B:B;var l,Y=[],a=[],w=[],t=0;a[t]=A,w[t]=[];var P,J;for(P=0,J=g.length;J>P;P++)F=g[P],l=F.getPoints(),n=of.isClockWise(l),n=r?!n:n,n?(!B&&a[t]&&t++,a[t]={s:new Vh,p:l},a[t].s.actions=F.actions,a[t].s.curves=F.curves,B&&t++,w[t]=[]):w[t].push({h:F,p:l[0]});if(!a[0])return d(g);if(a.length>1){for(var k=!1,m=[],O=0,E=a.length;E>O;O++)Y[O]=[];for(var O=0,E=a.length;E>O;O++){a[O];for(var p=w[O],V=0;V<p.length;V++){for(var T=p[V],v=!0,X=0;X<a.length;X++)y(T.p,a[X].p)&&(O!=X&&m.push({froms:O,tos:X,hole:V}),v?(v=!1,Y[X].push(T)):k=!0);v&&Y[O].push(T)}}m.length>0&&(k||(w=Y))}var G,u,f;for(P=0,J=a.length;J>P;P++)for(W=a[P].s,o.push(W),G=w[P],u=0,f=G.length;f>u;u++)W.holes.push(G[u].h);return o};var Vh=function(){zb.apply(this,arguments),this.holes=[]},tl=Vh.prototype=Ch(lh);tl.getPointsHoles=function(q){var a,r=this.holes.length,W=[];for(a=0;r>a;a++)W[a]=this.holes[a].getTransformedPoints(q);return W},tl.extractAllPoints=function(R){return{shape:this.getTransformedPoints(R),holes:this.getPointsHoles(R)}},tl.extractPoints=function(q){return this.extractAllPoints(q)};var of={triangulateShape:function(p,H){function v(F,E,f){return F.x!=E.x?F.x<E.x?F.x<=f.x&&f.x<=E.x:E.x<=f.x&&f.x<=F.x:F.y<E.y?F.y<=f.y&&f.y<=E.y:E.y<=f.y&&f.y<=F.y}function b(j,Q,T,g,t){var e=1e-10,r=Q.x-j.x,o=Q.y-j.y,d=g.x-T.x,A=g.y-T.y,Z=j.x-T.x,s=j.y-T.y,P=o*d-r*A,R=o*Z-r*s;if(z(P)>e){var G;if(P>0){if(0>R||R>P)return[];if(G=A*Z-d*s,0>G||G>P)return[]}else{if(R>0||P>R)return[];if(G=A*Z-d*s,G>0||P>G)return[]}if(0==G)return!t||0!=R&&R!=P?[j]:[];if(G==P)return!t||0!=R&&R!=P?[Q]:[];if(0==R)return[T];if(R==P)return[g];var W=G/P;return[{x:j.x+W*r,y:j.y+W*o}]}if(0!=R||A*Z!=d*s)return[];var w=0==r&&0==o,h=0==d&&0==A;if(w&&h)return j.x!=T.x||j.y!=T.y?[]:[j];if(w)return v(T,g,j)?[j]:[];if(h)return v(j,Q,T)?[T]:[];var i,m,O,X,n,$,H,E;return 0!=r?(j.x<Q.x?(i=j,O=j.x,m=Q,X=Q.x):(i=Q,O=Q.x,m=j,X=j.x),T.x<g.x?(n=T,H=T.x,$=g,E=g.x):(n=g,H=g.x,$=T,E=T.x)):(j.y<Q.y?(i=j,O=j.y,m=Q,X=Q.y):(i=Q,O=Q.y,m=j,X=j.y),T.y<g.y?(n=T,H=T.y,$=g,E=g.y):(n=g,H=g.y,$=T,E=T.y)),H>=O?H>X?[]:X==H?t?[]:[n]:E>=X?[n,m]:[n,$]:O>E?[]:O==E?t?[]:[i]:E>=X?[i,m]:[i,$]}function C(O,G,b,M){var H=1e-10,E=G.x-O.x,K=G.y-O.y,k=b.x-O.x,r=b.y-O.y,A=M.x-O.x,x=M.y-O.y,g=E*r-K*k,J=E*x-K*A;if(z(g)>H){var n=A*r-x*k;return g>0?J>=0&&n>=0:J>=0||n>=0}return J>0}function e(n,Z){function L(E,I){var q=w.length-1,z=E-1;0>z&&(z=q);var o=E+1;o>q&&(o=0);var h=C(w[E],w[z],w[o],S[I]);if(!h)return!1;var Y=S.length-1,c=I-1;0>c&&(c=Y);var Q=I+1;return Q>Y&&(Q=0),h=C(S[I],S[c],S[Q],w[E]),h?!0:!1}function k(v,l){var y,A,k;for(y=0;y<w.length;y++)if(A=y+1,A%=w.length,k=b(v,l,w[y],w[A],!0),k.length>0)return!0;return!1}function T(s,r){var D,W,J,S,d;for(D=0;D<j.length;D++)for(W=Z[j[D]],J=0;J<W.length;J++)if(S=J+1,S%=W.length,d=b(s,r,W[J],W[S],!0),d.length>0)return!0;return!1}for(var S,p,g,O,f,o,E,N,l,W,V,w=n.concat(),j=[],i=[],d=0,u=Z.length;u>d;d++)j.push(d);for(var r=0,$=2*j.length;j.length>0&&($--,!(0>$));)for(g=r;g<w.length;g++){O=w[g],p=-1;for(var d=0;d<j.length;d++)if(o=j[d],E=O.x+":"+O.y+":"+o,i[E]===A){S=Z[o];for(var v=0;v<S.length;v++)if(f=S[v],L(g,v)&&!k(O,f)&&!T(O,f)){p=v,j.splice(d,1),N=w.slice(0,g+1),l=w.slice(g),W=S.slice(p),V=S.slice(0,p+1),w=N.concat(W).concat(V).concat(l),r=g;break}if(p>=0)break;i[E]=!0}if(p>=0)break}return w}for(var f,R,q,W,m,M,s={},O=p.concat(),X=0,K=H.length;K>X;X++)Array.prototype.push.apply(O,H[X]);for(f=0,R=O.length;R>f;f++)m=O[f].x+":"+O[f].y,s[m]!==A,s[m]=f;var Q=e(p,H),F=Hr.Triangulate(Q,!1);for(f=0,R=F.length;R>f;f++)for(W=F[f],q=0;3>q;q++)m=W[q].x+":"+W[q].y,M=s[m],M!==A&&(W[q]=M);return F.concat()},isClockWise:function(k){return Hr.Triangulate.area(k)<0},b2p0:function(x,C){var J=1-x;return J*J*C},b2p1:function($,u){return 2*(1-$)*$*u},b2p2:function(O,h){return O*O*h},b2:function(Z,i,J,o){return this.b2p0(Z,i)+this.b2p1(Z,J)+this.b2p2(Z,o)},b3p0:function(N,r){var I=1-N;return I*I*I*r},b3p1:function(V,D){var L=1-V;return 3*L*L*V*D},b3p2:function(l,d){var F=1-l;return 3*F*l*l*d},b3p3:function(Y,O){return Y*Y*Y*O},b3:function(D,s,$,p,l){return this.b3p0(D,s)+this.b3p1(D,$)+this.b3p2(D,p)+this.b3p3(D,l)}},Hr={faces:{},face:"",weight:"normal",style:"normal",size:150,divisions:10,getDefaultFont:function(){var d=U.keys(this.faces);return d.length?d[0]:null},getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch(T){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(Z){var f=Z.familyName.toLowerCase(),b=this;return b.faces[f]=b.faces[f]||{},b.faces[f][Z.cssFontWeight]=b.faces[f][Z.cssFontWeight]||{},b.faces[f][Z.cssFontWeight][Z.cssFontStyle]=Z,Z},drawText:function(g){var q,Q=this.getFace(),p=this.size/Q.resolution,L=0,N=String(g).split(""),P=N.length,u=[];for(q=0;P>q;q++){var b=new zb,F=this.extractGlyphPoints(N[q],Q,p,L,b);F&&(L+=F.offset*this.spacing,u.push(F.path))}var x=L/2;return{paths:u,offset:x}},extractGlyphPoints:function(v,g,L,U,$){var t,j,s,J,V,G,C,N,y,S,u,W,w,I,n,o,T,h,D,q=[],f=g.glyphs[v]||g.glyphs["?"];if(f){if(f.o)for(J=f._cachedOutline||(f._cachedOutline=f.o.split(" ")),G=J.length,C=L,N=L,t=0;G>t;)switch(V=J[t++]){case"m":y=J[t++]*C+U,S=J[t++]*N,$.moveTo(y,S);break;case"l":y=J[t++]*C+U,S=J[t++]*N,$.lineTo(y,S);break;case"q":if(u=J[t++]*C+U,W=J[t++]*N,n=J[t++]*C+U,o=J[t++]*N,$.quadraticCurveTo(n,o,u,W),D=q[q.length-1])for(w=D.x,I=D.y,j=1,s=this.divisions;s>=j;j++){var X=j/s;of.b2(X,w,n,u),of.b2(X,I,o,W)}break;case"b":if(u=J[t++]*C+U,W=J[t++]*N,n=J[t++]*C+U,o=J[t++]*N,T=J[t++]*C+U,h=J[t++]*N,$.bezierCurveTo(n,o,T,h,u,W),D=q[q.length-1])for(w=D.x,I=D.y,j=1,s=this.divisions;s>=j;j++){var X=j/s;of.b3(X,w,n,T,u),of.b3(X,I,o,h,W)}}return{offset:f.ha*L,path:$}}}};Hr.generateShapes=function(n,e){e=e||{};var J=e.font;if(J===A&&(J=Hr.getDefaultFont(),!J))return console.log("There's no valid font face, use ht.Default.loadFontFace to load font first."),[];var K=e.size!==A?e.size:1,h=e.curveSegments!==A?e.curveSegments:4,M=e.spacing!==A?e.spacing:1,r=e.weight!==A?e.weight:"normal",Y=e.style!==A?e.style:"normal";Hr.size=K,Hr.divisions=h,Hr.face=J,Hr.weight=r,Hr.style=Y,Hr.spacing=M;for(var E=Hr.drawText(n),v=E.paths,w=[],t=0,V=v.length;V>t;t++)Array.prototype.push.apply(w,v[t].toShapes());return w},function(g){var F=1e-10,o=function(s,N){var n=s.length;if(3>n)return null;var F,k,V,Y=[],X=[],g=[];if(j(s)>0)for(k=0;n>k;k++)X[k]=k;else for(k=0;n>k;k++)X[k]=n-1-k;var R=n,J=2*R;for(k=R-1;R>2;){if(J--<=0)return N?g:Y;if(F=k,F>=R&&(F=0),k=F+1,k>=R&&(k=0),V=k+1,V>=R&&(V=0),y(s,F,k,V,R,X)){var C,$,H,A,M;for(C=X[F],$=X[k],H=X[V],Y.push([s[C],s[$],s[H]]),g.push([X[F],X[k],X[V]]),A=k,M=k+1;R>M;A++,M++)X[A]=X[M];R--,J=2*R}}return N?g:Y},j=function(E){for(var D=E.length,P=0,Q=D-1,W=0;D>W;Q=W++)P+=E[Q].x*E[W].y-E[W].x*E[Q].y;return.5*P},y=function(h,L,f,X,N,R){var p,c,G,M,x,I,g,w,z;if(c=h[R[L]].x,G=h[R[L]].y,M=h[R[f]].x,x=h[R[f]].y,I=h[R[X]].x,g=h[R[X]].y,F>(M-c)*(g-G)-(x-G)*(I-c))return!1;var T,b,l,v,n,$,i,a,S,k,t,U,H,j,q;for(T=I-M,b=g-x,l=c-I,v=G-g,n=M-c,$=x-G,p=0;N>p;p++)if(w=h[R[p]].x,z=h[R[p]].y,!(w===c&&z===G||w===M&&z===x||w===I&&z===g)&&(i=w-c,a=z-G,S=w-M,k=z-x,t=w-I,U=z-g,q=T*k-b*S,H=n*a-$*i,j=l*U-v*t,q>=-F&&j>=-F&&H>=-F))return!1;return!0};return g.Triangulate=o,g.Triangulate.area=j,g}(Hr),c._typeface_js={faces:Hr.faces,loadFace:Hr.loadFace};var hi=function(){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]]},xe=hi.prototype={constructor:hi,computeFaceNormals:function(){for(var H=new Ah,X=new Ah,i=0,K=this.faces.length;K>i;i++){var m=this.faces[i],S=this.vertices[m.a],G=this.vertices[m.b],F=this.vertices[m.c];H.subVectors(F,G),X.subVectors(S,G),H.cross(X),H.normalize(),m.normal.copy(H)}},computeVertexNormals:function(a){var y,V,n,Z,i,j;for(j=new Array(this.vertices.length),y=0,V=this.vertices.length;V>y;y++)j[y]=new Ah;if(a){var o,h,P,I=new Ah,X=new Ah;for(n=0,Z=this.faces.length;Z>n;n++)i=this.faces[n],o=this.vertices[i.a],h=this.vertices[i.b],P=this.vertices[i.c],I.subVectors(P,h),X.subVectors(o,h),I.cross(X),j[i.a].add(I),j[i.b].add(I),j[i.c].add(I)}else for(n=0,Z=this.faces.length;Z>n;n++)i=this.faces[n],j[i.a].add(i.normal),j[i.b].add(i.normal),j[i.c].add(i.normal);for(y=0,V=this.vertices.length;V>y;y++)j[y].normalize();for(n=0,Z=this.faces.length;Z>n;n++)i=this.faces[n],i.vertexNormals[0]=j[i.a].clone(),i.vertexNormals[1]=j[i.b].clone(),i.vertexNormals[2]=j[i.c].clone()},mergeVertices:function(){var p,Q,h,o,V,y,x,k,D={},c=[],t=[],r=4,G=w(10,r);for(h=0,o=this.vertices.length;o>h;h++)p=this.vertices[h],Q=i(p.x*G)+"_"+i(p.y*G)+"_"+i(p.z*G),D[Q]===A?(D[Q]=h,c.push(this.vertices[h]),t[h]=c.length-1):t[h]=t[D[Q]];var O=[];for(h=0,o=this.faces.length;o>h;h++){V=this.faces[h],V.a=t[V.a],V.b=t[V.b],V.c=t[V.c],y=[V.a,V.b,V.c];for(var v=0;3>v;v++)if(y[v]==y[(v+1)%3]){O.push(h);break}}for(h=O.length-1;h>=0;h--){var M=O[h];for(this.faces.splice(M,1),x=0,k=this.faceVertexUvs.length;k>x;x++)this.faceVertexUvs[x].splice(M,1)}var Y=this.vertices.length-c.length;return this.vertices=c,Y}},ir=function(F,W,x,k,J,t,I){this.aX=F,this.aY=W,this.xRadius=x,this.yRadius=k,this.aStartAngle=J,this.aEndAngle=t,this.aClockwise=I};ir.prototype=Ch(Iq),ir.prototype.getPoint=function(Q){var I,A=this.aEndAngle-this.aStartAngle;0>A&&(A+=S),A>S&&(A-=S),I=this.aClockwise===!0?this.aEndAngle+(1-Q)*(S-A):this.aStartAngle+Q*A;var y=this.aX+this.xRadius*$(I),w=this.aY+this.yRadius*e(I);return new vr(y,w)};var yp=function(n,f){this.v1=n,this.v2=f},ah=yp.prototype=Ch(Iq);ah.getPoint=function(T){var c=this.v2.clone().sub(this.v1);return c.multiplyScalar(T).add(this.v1),c},ah.getPointAt=function(L){return this.getPoint(L)},ah.getTangent=function(){var Z=this.v2.clone().sub(this.v1);return Z.normalize()};var cq=function(J,w,u){this.v0=J,this.v1=w,this.v2=u};cq.prototype=Ch(Iq),cq.prototype.getPoint=function(G){var n,P;return n=of.b2(G,this.v0.x,this.v1.x,this.v2.x),P=of.b2(G,this.v0.y,this.v1.y,this.v2.y),new vr(n,P)};var Zk=function(b,_,s,B){this.v0=b,this.v1=_,this.v2=s,this.v3=B};Zk.prototype=Ch(Iq),Zk.prototype.getPoint=function(H){var x,A;return x=of.b3(H,this.v0.x,this.v1.x,this.v2.x,this.v3.x),A=of.b3(H,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new vr(x,A)},dr.create(function(h,V){this.v1=h,this.v2=V},function(I){var h=new Ah;return h.subVectors(this.v2,this.v1),h.multiplyScalar(I),h.add(this.v1),h});var bi=dr.create(function(m,K,Q){this.v0=m,this.v1=K,this.v2=Q},function(v){var x,p,J;return x=of.b2(v,this.v0.x,this.v1.x,this.v2.x),p=of.b2(v,this.v0.y,this.v1.y,this.v2.y),J=of.b2(v,this.v0.z,this.v1.z,this.v2.z),new Ah(x,p,J)}),pb=dr.create(function(l,g,r,t){this.v0=l,this.v1=g,this.v2=r,this.v3=t},function(W){var e,h,Z;return e=of.b3(W,this.v0.x,this.v1.x,this.v2.x,this.v3.x),h=of.b3(W,this.v0.y,this.v1.y,this.v2.y,this.v3.y),Z=of.b3(W,this.v0.z,this.v1.z,this.v2.z,this.v3.z),new Ah(e,h,Z)}),Vg=function(G,m,d,g,y,M,o,J){hi.call(this),g=g!==A?g:.5,y=y!==A?y:.5,J=J!==A?J:1,G=G||8,M=M||0,o=o||S;var q,j,h=1,V=J/2,Q=[],E=[],w=this.vertices,P=this.faces,z=this.faceVertexUvs;for(j=0;h>=j;j++){var X=[],u=[],C=j/h,n=C*(y-g)+g;for(q=0;G>=q;q++){var O=q/G,B=new Ah,W=-(O*o+M);B.z=n*e(W),B.y=-C*J+V,B.x=n*$(W),w.push(B),X.push(w.length-1),u.push(new vr(O,C))}Q.push(X),E.push(u)}var D,r,p=(y-g)/J;for(q=0;G>q;q++)for(0!==g?(D=w[Q[0][q]].clone(),r=w[Q[0][q+1]].clone()):(D=w[Q[1][q]].clone(),r=w[Q[1][q+1]].clone()),D.setY(R(D.x*D.x+D.z*D.z)*p).normalize(),r.setY(R(r.x*r.x+r.z*r.z)*p).normalize(),j=0;h>j;j++){var H=Q[j][q],t=Q[j+1][q],s=Q[j+1][q+1],L=Q[j][q+1],k=D.clone(),l=D.clone(),b=r.clone(),i=r.clone(),a=E[j][q].clone(),f=E[j+1][q].clone(),v=E[j+1][q+1].clone(),_=E[j][q+1].clone();P.push(new ug(H,t,L,[k,l,i])),z[0].push([a,f,_]),P.push(new ug(t,s,L,[l.clone(),b,i.clone()])),z[0].push([f.clone(),v,_.clone()])}if(m&&g>0)for(this.vertices.push(new Ah(0,V,0)),q=0;G>q;q++){var H=Q[0][q],t=Q[0][q+1],s=this.vertices.length-1,k=new Ah(0,1,0),l=new Ah(0,1,0),b=new Ah(0,1,0),a=E[0][q].clone(),f=E[0][q+1].clone(),v=new vr(f.x,0);P.push(new ug(H,t,s,[k,l,b],null,1));var U=q/G*S,T=$(U),I=e(U),Z=(q+1)/G*S,N=$(Z),Y=e(Z);z[0].push([new vr(.5+.5*T,.5+.5*I),new vr(.5+.5*N,.5+.5*Y),new vr(.5,.5)])}if(d&&y>0)for(this.vertices.push(new Ah(0,-V,0)),q=0;G>q;q++){var H=Q[j][q+1],t=Q[j][q],s=w.length-1,k=new Ah(0,-1,0),l=new Ah(0,-1,0),b=new Ah(0,-1,0),a=E[j][q+1].clone(),f=E[j][q].clone();P.push(new ug(H,t,s,[k,l,b],null,2));var U=q/G*S,T=$(U),I=e(U),Z=(q+1)/G*S,N=$(Z),Y=e(Z);z[0].push([new vr(.5+.5*N,.5-.5*Y),new vr(.5+.5*T,.5-.5*I),new vr(.5,.5)])}};Vg.prototype=Ch(xe);var Th=function(r,y,F,V,D,Z,M){hi.call(this),M=M||.5,r=r||16,y=y||16,F=(F!==A?F:0)-g,V=V!==A?V:S,D=D!==A?D:0,Z=Z!==A?Z:g;var O,u,n=[],b=[],G=this.vertices,_=this.faces,Y=this.faceVertexUvs;for(u=0;y>=u;u++){var E=[],Q=[];for(O=0;r>=O;O++){var a=O/r,I=u/y,i=new Ah;i.x=-M*$(F+a*V)*e(D+I*Z),i.y=M*$(D+I*Z),i.z=M*e(F+a*V)*e(D+I*Z),G.push(i),E.push(G.length-1),Q.push(new vr(a,I))}n.push(E),b.push(Q)}for(u=0;y>u;u++)for(O=0;r>O;O++){var t=n[u][O+1],J=n[u][O],l=n[u+1][O],C=n[u+1][O+1],N=G[t].clone().normalize(),w=G[J].clone().normalize(),R=G[l].clone().normalize(),L=G[C].clone().normalize(),H=b[u][O+1].clone(),o=b[u][O].clone(),p=b[u+1][O].clone(),d=b[u+1][O+1].clone();z(G[t].y)===M?(H.x=(H.x+o.x)/2,_.push(new ug(t,l,C,[N,R,L])),Y[0].push([H,p,d])):z(G[l].y)===M?(p.x=(p.x+d.x)/2,_.push(new ug(t,J,l,[N,w,R])),Y[0].push([H,o,p])):(_.push(new ug(t,J,C,[N,w,L])),Y[0].push([H,o,d]),_.push(new ug(J,l,C,[w.clone(),R,L.clone()])),Y[0].push([o.clone(),p,d.clone()]))}};Th.prototype=Ch(xe);var Gm=function(n,L,o,F,f,U){hi.call(this),n=n||.33,L=L||.17,F=F||8,o=o||6,f=f||0,U=U||S;for(var u=new Ah,B=[],i=[],l=0;F>=l;l++)for(var b=l/F*S+g,j=0;o>=j;j++){var P=j/o*U+f;u.x=n*$(P),u.z=-n*e(P);var d=new Ah,Y=n+L*$(b);d.x=Y*$(P),d.z=-Y*e(P),d.y=L*e(b),this.vertices.push(d),B.push(new vr(j/o,1-l/F)),i.push(d.clone().sub(u).normalize())}for(var l=1;F>=l;l++)for(var j=1;o>=j;j++){var A=(o+1)*l+j-1,C=(o+1)*(l-1)+j-1,V=(o+1)*(l-1)+j,x=(o+1)*l+j,t=new ug(A,C,x,[i[A].clone(),i[C].clone(),i[x].clone()]);this.faces.push(t),this.faceVertexUvs[0].push([B[A].clone(),B[C].clone(),B[x].clone()]),t=new ug(C,V,x,[i[C].clone(),i[V].clone(),i[x].clone()]),this.faces.push(t),this.faceVertexUvs[0].push([B[C].clone(),B[V].clone(),B[x].clone()])}this.computeFaceNormals()};Gm.prototype=Ch(xe);var Vb=function(D,Y,g){return D?(hi.call(this),D=D instanceof Array?D:[D],this.addShapeList(D,Y),Y.convertYZ!==!1&&Be(this,g),this.computeFaceNormals(),void 0):(D=[],void 0)},Zm=Vb.prototype=Ch(hi.prototype);Zm.addShapeList=function(Q,J){for(var C=Q.length,g=0;C>g;g++){var W=Q[g];this.addShape(W,J)}},Zm.addShape=function(t,s){function c(){if(s.bottom)for(var h=0;f>h;h++)x=K[h],j(x[2],x[1],x[0],!0);if(s.top)for(h=0;f>h;h++)x=K[h],j(x[0]+q*d,x[1]+q*d,x[2]+q*d,!1)}function $(){var c=0;for(u(E,c),c+=E.length,n=0,i=Q.length;i>n;n++)T=Q[n],u(T,c),c+=T.length}function u(H,V){for(var u,L,b=H.length;--b>=0;){u=b,L=b-1,0>L&&(L=H.length-1);var C=0,y=d;for(C=0;y>C;C++){var j=q*C,l=q*(C+1),G=V+u+j,a=V+L+j,Y=V+L+l,K=V+u+l;k(G,a,Y,K,H,C,y,u,L)}}}function l(j,$,J){g.vertices.push(new Ah(j,$,J))}function j(d,$,T,K){d+=L,$+=L,T+=L,g.faces.push(new ug(d,$,T,null,null,K?2:1));var q=K?r.generateBottomUV(g,t,s,d,$,T):r.generateTopUV(g,t,s,d,$,T);g.faceVertexUvs[0].push(q)}function k($,q,V,j,P,i,C,x,p){$+=L,q+=L,V+=L,j+=L,g.faces.push(new ug($,q,j)),g.faces.push(new ug(q,V,j));var Y=r.generateSideWallUV(g,t,P,s,$,q,V,j,i,C,x,p);g.faceVertexUvs[0].push([Y[0],Y[1],Y[3]]),g.faceVertexUvs[0].push([Y[1],Y[2],Y[3]])}var o,v,w,H,C,W=s.amount,R=s.curveSegments||Rn,d=s.steps||1,V=s.extrudePath,O=!1,r=new Qn(s.repeatUVLength,s.boundingBox);V&&(o=V.getSpacedPoints(d),O=!0,v=s.frames!==A?s.frames:new Ek.FrenetFrames(V,d,!1),w=new Ah,H=new Ah,C=new Ah);var T,n,i,g=this,L=this.vertices.length,S=t.extractPoints(R),m=S.shape,Q=S.holes,y=!of.isClockWise(m);if(y){for(m=m.reverse(),n=0,i=Q.length;i>n;n++)T=Q[n],of.isClockWise(T)&&(Q[n]=T.reverse());y=!1}var K=of.triangulateShape(m,Q),E=m;for(n=0,i=Q.length;i>n;n++)T=Q[n],m=m.concat(T);for(var _,x,q=m.length,f=K.length,G=0;q>G;G++)_=m[G],O?(H.copy(v.normals[0]).multiplyScalar(_.x),w.copy(v.binormals[0]).multiplyScalar(_.y),C.copy(o[0]).add(H).add(w),l(C.x,C.y,C.z)):l(_.x,_.y,0);var h;for(h=1;d>=h;h++)for(G=0;q>G;G++)_=m[G],O?(H.copy(v.normals[h]).multiplyScalar(_.x),w.copy(v.binormals[h]).multiplyScalar(_.y),C.copy(o[h]).add(H).add(w),l(C.x,C.y,C.z)):l(_.x,_.y,W/d*h);c(),$()};var Ek=function(L,c,G,X,I){function h(W,s,N){return z.vertices.push(new Ah(W,s,N))-1}hi.call(this),c=c||64,G=G||1,X=X||8,I=I||!1;var s,v,Z,V,H,A,r,j,D,B,K,u,d,y,Y,b,o,U,T,C,f=[],z=this,t=c+1,E=new Ah,n=new Ek.FrenetFrames(L,c,I),i=n.tangents,M=n.normals,J=n.binormals;for(this.tangents=i,this.normals=M,this.binormals=J,D=0;t>D;D++)for(f[D]=[],V=D/(t-1),j=L.getPointAt(V),s=i[D],v=M[D],Z=J[D],B=0;X>B;B++)H=B/X*S,A=-G*$(H),r=G*e(H),E.copy(j),E.x+=A*v.x+r*Z.x,E.y+=A*v.y+r*Z.y,E.z+=A*v.z+r*Z.z,f[D][B]=h(E.x,E.y,E.z);for(D=0;c>D;D++)for(B=0;X>B;B++)K=I?(D+1)%c:D+1,u=(B+1)%X,d=f[D][B],y=f[K][B],Y=f[K][u],b=f[D][u],o=new vr(D/c,B/X),U=new vr((D+1)/c,B/X),T=new vr((D+1)/c,(B+1)/X),C=new vr(D/c,(B+1)/X),this.faces.push(new ug(d,y,b)),this.faceVertexUvs[0].push([o,U,C]),this.faces.push(new ug(y,Y,b)),this.faceVertexUvs[0].push([U.clone(),T,C.clone()]);this.computeFaceNormals(),this.computeVertexNormals()};Ek.prototype=Ch(xe),Ek.FrenetFrames=function(P,B,Q){function i(){I[0]=new Ah,Z[0]=new Ah,R=Number.MAX_VALUE,l=z(p[0].x),$=z(p[0].y),c=z(p[0].z),R>=l&&(R=l,t.set(1,0,0)),R>=$&&(R=$,t.set(0,1,0)),R>=c&&t.set(0,0,1),C.crossVectors(p[0],t).normalize(),I[0].crossVectors(p[0],C),Z[0].crossVectors(p[0],I[0])}var J,R,l,$,c,g,K,t=new Ah,p=[],I=[],Z=[],C=new Ah,j=new nk,Y=B+1,w=1e-4;for(this.tangents=p,this.normals=I,this.binormals=Z,g=0;Y>g;g++)K=g/(Y-1),p[g]=P.getTangentAt(K),p[g].normalize();for(i(),g=1;Y>g;g++)I[g]=I[g-1].clone(),Z[g]=Z[g-1].clone(),C.crossVectors(p[g-1],p[g]),C.length()>w&&(C.normalize(),J=q(qg(p[g-1].dot(p[g]),-1,1)),I[g].applyMatrix4(j.makeRotationAxis(C,J))),Z[g].crossVectors(p[g],I[g]);if(Q)for(J=q(qg(I[0].dot(I[Y-1]),-1,1)),J/=Y-1,p[0].dot(C.crossVectors(I[0],I[Y-1]))>0&&(J=-J),g=1;Y>g;g++)I[g].applyMatrix4(j.makeRotationAxis(p[g],J*g)),Z[g].crossVectors(p[g],I[g])};var Ab=function(g,n,I,p){hi.call(this),n=n||18,I=I||0,p=p==h?S:p;for(var O=1/(g.length-1),P=1/n,k=0,K=n;K>=k;k++)for(var T=I+k*P*p,G=$(T),j=e(T),v=0,f=g.length;f>v;v++){var J=g[v],z=new Ah;z.x=G*J.x-j*J.y,z.y=j*J.x+G*J.y,z.z=J.z,this.vertices.push(z)}for(var q=g.length,k=0,K=n;K>k;k++)for(var v=0,f=g.length-1;f>v;v++){var y=v+q*k,L=y,_=y+q,G=y+1+q,U=y+1,u=k*P,F=v*O,Z=u+P,a=F+O;this.faces.push(new ug(L,U,_)),this.faceVertexUvs[0].push([new vr(u,F),new vr(u,a),new vr(Z,F)]),this.faces.push(new ug(_,U,G)),this.faceVertexUvs[0].push([new vr(Z,F),new vr(u,a),new vr(Z,a)])}this.mergeVertices(),Be(this),this.computeFaceNormals(),this.computeVertexNormals()};Ab.prototype=Ch(xe);var Cl=function(C,L){L=L||{};var l=Hr.generateShapes(C,L);L.amount=L.amount!==A?L.amount:.5,L.convertYZ=!1,L.fill!==!1&&(L.bottom=!0,L.top=!0),Vb.call(this,l,L)};Cl.prototype=Ch(Zm);var Zc=L.Node=function(){oc(Zc,this)},Nj={X:_g,Y:Xe,Z:Rp},ke={X:0,Y:1,Z:2},$r={xyz:"XYZ",xzy:"XZY",yxz:"YXZ",yzx:"YZX",zxy:"ZXY",zyx:"ZYX"},Np=new er,Wr="xzy",Xl=function(Q,H,V){if(H){var J=H[0],_=H[1],O=H[2];"xzy"===V?(Xe(Q,_),Rp(Q,O),_g(Q,J)):"xyz"===V?(Rp(Q,O),Xe(Q,_),_g(Q,J)):"yxz"===V?(Rp(Q,O),_g(Q,J),Xe(Q,_)):"yzx"===V?(_g(Q,J),Rp(Q,O),Xe(Q,_)):"zxy"===V?(Xe(Q,_),_g(Q,J),Rp(Q,O)):"zyx"===V?(_g(Q,J),Xe(Q,_),Rp(Q,O)):(Xe(Q,_),Rp(Q,O),_g(Q,J))}};Ci("Node",Xm,{ms_ac:["rotationMode","anchorElevation"],ms_edge:!0,_adjustChildrenToTop:!0,_icon:"node_icon",_image:"node_image",_rotationMode:Wr,_64O:0,_rotationX:0,_53O:0,_host:h,_position:{x:0,y:0},_anchor:{x:.5,y:.5},_anchorElevation:.5,_scale:{x:1,y:1},_scaleTall:1,_54O:0,getUIClass:function(){return Go},_22Q:function(){return Ss},getX:function(){return this.p().x},setX:function(G){this.p(G,this.p().y)},getY:function(){return this.p().y},setY:function(W){this.p(this.p().x,W)},getAnchorX:function(){return this.getAnchor().x},setAnchorX:function(a){this.setAnchor(a,this.getAnchor().y)},getAnchorY:function(){return this.getAnchor().y},setAnchorY:function($){this.setAnchor(this.getAnchor().x,$)},getScaleX:function(){return this.getScale().x},setScaleX:function(Z){this.setScale(Z,this.getScale().y)},getScaleY:function(){return this.getScale().y},setScaleY:function(S){this.setScale(this.getScale().x,S)},p:function(){return 0===arguments.length?this.getPosition():(this.setPosition.apply(this,arguments),this)},p3:function(){return 0===arguments.length?this.getPosition3d():(this.setPosition3d.apply(this,arguments),this)},s3:function(){return 0===arguments.length?this.getSize3d():(this.setSize3d.apply(this,arguments),this)},r3:function(){return 0===arguments.length?this.getRotation3d():(this.setRotation3d.apply(this,arguments),this)},setQuaternion:function(i){var G=(new to).setFromQuaternion(i,to.ReverseOrder(this.getRotationMode()));return this._applyClosestR3(G.x,G.y,G.z)},getQuaternion:function(){var v=new to,f=new to,H=new er;return function(x){return x||(x=new er),this.getEuler(v),v.equals(f)?x.copy(H):x.copy(H.setFromEuler(f.copy(v)))}}(),getEuler:function(L){var U=this.r3();return L||(L=new to),L.set(U[0],U[1],U[2],to.ReverseOrder(this.getRotationMode()))},setEuler:function(m){return m=m.clone().reorder(to.ReverseOrder(this.getRotationMode())),this.r3(m.x,m.y,m.z)},t3:function(){return this.translate3d.apply(this,arguments),this},translate3dBy:function(f,A){vf(f,Qr(h,h,this.r3(),this.getRotationMode())),this.translate3d(f[0]*A,f[1]*A,f[2]*A)},translateFront:function(q){this.translate3dBy([0,0,1],q)},translateBack:function($){this.translate3dBy([0,0,-1],$)},translateLeft:function(x){this.translate3dBy([-1,0,0],x)},translateRight:function(h){this.translate3dBy([1,0,0],h)},translateTop:function(Y){this.translate3dBy([0,1,0],Y)},translateBottom:function(_){this.translate3dBy([0,-1,0],_)},getPosition3d:function(){return[this._position.x,this._54O,this._position.y]},setPosition3d:function(c,g,j){1===arguments.length&&(g=c[1],j=c[2],c=c[0]),this.p(c,j),this.setElevation(g)},translate3d:function(d,Z,e){1===arguments.length&&(Z=d[1],e=d[2],d=d[0]),this.translate(d,e),this.setElevation(this._54O+Z)},getSize3d:function(){return[this.getWidth(),this.getTall(),this.getHeight()]},setSize3d:function(l,B,V){1===arguments.length&&(B=l[1],V=l[2],l=l[0]),this.setSize(l,V),this.setTall(B)},getRotation3d:function(){return[this._rotationX,-this._64O,this._53O]},setRotation3d:function(q,f,J){var b=this;if(!b._updatingRotation3d){b._updatingRotation3d=1,1===arguments.length&&(f=q[1],J=q[2],q=q[0]);var y=[b._rotationX,-b._64O,b._53O];b._rotationX=q,b._64O=-f,b._53O=J,b.fp("rotation3d",y,[q,f,J]),delete b._updatingRotation3d}},_applyClosestR3:function(){function Y(J){return J%=S,0>J&&(J+=S),J>g?S-J:J}function k(D,h){return Y(D[0]-h[0])+Y(D[1]-h[1])+Y(D[2]-h[2])}return function(L,O,q){var T,Y,Q,v=this.r3(),z=this.getRotationMode();"xzy"===z||"yzx"===z?(T=L>0?L-g:L+g,Y=O>0?O-g:O+g,Q=q>0?g-q:-g-q):"xyz"===z||"zyx"===z?(T=L>0?L-g:L+g,Q=q>0?q-g:q+g,Y=O>0?g-O:-g-O):("yxz"===z||"zxy"===z)&&(Q=q>0?q-g:q+g,Y=O>0?O-g:O+g,T=L>0?g-L:-g-L),k([T,Y,Q],v)<k([L,O,q],v)?this.r3(T,Y,Q):this.r3(L,O,q)}}(),setRotationY:function(E){this.setRotation(-E)},getRotationY:function(){return-this._64O},lookAtDirection:function(k,q){q=q||Ic;var x=this,R=ml(k);q===Ic?(x.r3([-O(k[1]/R),-tj(k[2],k[0])+po,0]),x.setRotationMode("xzy")):q===_h?(x.r3(0,-tj(k[2],k[0]),O(k[1]/R)),x.setRotationMode("zyx")):q===tq?(x.r3(0,-tj(k[2],k[0])+g,-O(k[1]/R)),x.setRotationMode("zyx")):q===xo?(x.r3([-O(k[1]/R)+po,-tj(k[2],k[0])+po,0]),x.setRotationMode("xzy")):q===dc&&(x.r3([-O(k[1]/R)-po,-tj(k[2],k[0])+po,0]),x.setRotationMode("xzy")),q===Zj&&(x.r3([-O(k[1]/R)+g,-tj(k[2],k[0])+po,g]),x.setRotationMode("zxy"))},lookAt:function(_,n){return this.lookAtDirection(ik(_,this.p3()),n)},lookAtX:function(){var n=new Ai,f=new Ai,D=new Ai,N=new nk,t=new nk,Q=new to;return function(R,P){var e=hk(this);if(N.fromArray(e),D.copy(this.p3()),n.copy(R).sub(D),!(n.lengthSq()<1e-6)){n.normalize(),P===Ic?f.set(0,0,1):P===Zj?f.set(0,0,-1):P===tq?f.set(-1,0,0):P===_h?f.set(1,0,0):P===xo?f.set(0,1,0):P===dc&&f.set(0,-1,0),f.applyMatrix4(N).sub(D).normalize();var F=Math.acos(n.dot(f));if(F){var r=n.clone().cross(f);r.lengthSq()<1e-6&&(P===xo||P===dc?r.set(0,0,1).applyMatrix4(N).sub(D):r.set(0,1,0).applyMatrix4(N).sub(D)),r.normalize(),Q.set(this.r3(),this.getRotationMode(),!0),N.makeRotationFromEuler(Q),t.makeRotationAxis(r,-F),Q.setFromRotationMatrix(t.multiply(N)),this._applyClosestR3(Q.x,Q.y,Q.z)}}}}(),getHost:function(){return this._host},setHost:function(n){var P=this;if(P!==n&&P._host!==n){var U=P._host;U&&(U._removeAttach(P),U.updateLayoutAttaches()),P._host=n,P._host&&(P._host._addAttach(P),P._host.updateLayoutAttaches()),P.fp("host",U,n),P.onHostChanged(U,n)}},getAttaches:function(){return this._69O},_addAttach:function(i){var B=this;B._69O||(B._69O=new zc),B._69O.add(i),B.fp("attaches",h,i)},_removeAttach:function(E){var K=this;K._69O.remove(E),K._69O.isEmpty()&&delete K._69O,K.fp("attaches",E,h)},getImage:function(){if(this._pendingCheckImageJSON){var x=r.getImage(this._image);x&&(this._pendingCheckImageJSON=!1,this.getParent()instanceof Oq&&this.getParent().checkPendingUpdateInfo())}return this._image},setImage:function(U){var t=this,r=t._image,L=t.getWidth(),g=t.getHeight();if(t._image=U,t.fp("image",r,U)){if(null!=U&&(Ti(U)||Pr(U)&&/\.json$/i.test(U))&&(this._pendingCheckImageJSON=!0),xs)return;t.fp(Nq,L,t.getWidth()),t.fp(ll,g,t.getHeight())}},getElevation:function(){return this._54O},setElevation:function(C){var M=this;if(!M._50O){M._50O=1;var A=M._54O;M._54O=C,M.fp(am,A,C),delete this._50O}},getRotation:function(){return this._64O},setRotation:function(K){var r=this;if(!r._49O){r._49O=1;var a=r._64O;r._64O=K,r.fp(up,a,K),delete r._49O}},getRotationX:function(){return this._rotationX},setRotationX:function(l){var I=this;if(!I._51O){I._51O=1;var o=I._rotationX;I._rotationX=l,I.fp("rotationX",o,l),delete I._51O}},getRotationZ:function(){return this._53O},setRotationZ:function(N){var L=this;if(!L._52O){L._52O=1;var Y=L._53O;L._53O=N,L.fp("rotationZ",Y,N),delete L._52O}},getPosition:function(){return this._position},setPosition:function(q,b){var F=this;if(!F._50I){F._50I=1;var Y;if(Y=2===arguments.length?{x:q,y:b}:q,Y.x!==F._position.x||Y.y!==F._position.y){var Z=F._position;F._position=Y,F.fp(Fb,Z,Y)}delete F._50I}},translate:function(x,A){var F=this._position;this.p(F.x+x,F.y+A)},getWidth:function(){var O=this;if(O._width>=0)return O._width;var Y=O.getStyle("shape3d");if(Y){var P=wp(Y);if(P&&P.rawS3)return P.rawS3[0];if("billboard"===Y||"plane"===Y){var D=Tj(O.getStyle("shape3d.image"));return D?Xf(D,O):20}}var D=Tj(O._image);return D?Xf(D,O):20},setWidth:function(k){var i=this,s=i._width;i._width=k,i.fp(Nq,s,k)},getHeight:function(){var I=this;if(I._height>=0)return I._height;var o=I.getStyle("shape3d");if(o){var W=wp(o);if(W&&W.rawS3)return W.rawS3[2];
if("plane"===o){var Q=Tj(I.getStyle("shape3d.image"));return Q?$m(Q,I):20}if("billboard"===o)return 2}var Q=Tj(I._image);return Q?$m(Q,I):20},setHeight:function(O){var N=this,r=N._height;N._height=O,N.fp(ll,r,O)},getTall:function(){var Z=this;if(Z._tall>=0)return Z._tall;var J=Z.getStyle("shape3d");if(J){var c=wp(J);if(c&&c.rawS3)return c.rawS3[1];if("billboard"===J){var e=Tj(Z.getStyle("shape3d.image"));return e?$m(e,Z):20}if("plane"===J)return 2}return 20},setTall:function(U){var t=this,Q=t._tall;t._tall=U,t.fp("tall",Q,U)},setSize:function(p,X){var H=this;2===arguments.length?(H.setWidth(p),H.setHeight(X)):(H.setWidth(p.width),H.setHeight(p.height))},getSize:function(){return{width:this.getWidth(),height:this.getHeight()}},setRect:function(o,Z,Q,v,H){var W=this,f=W.getAnchor(),L=W.getScale();arguments.length<=2&&(H=Z,Z=o.y,Q=o.width,v=o.height,o=o.x);var X=H&&L.x<0?1-f.x:f.x,k=H&&L.y<0?1-f.y:f.y;W.p(o+Q*X,Z+v*k),H&&(Q/=Math.abs(L.x),v/=Math.abs(L.y)),W.setWidth(Q),W.setHeight(v)},getMatrix:function(){var W=this,f=W._64O,B=W._position,x=W.getScale();return new Kb(f,B.x,B.y,x.x,x.y)},getMatrix4:function(){var r=new Ai,U=new er,S=new Ai;return function(j){return this.getQuaternion(U),r.copy(this.p3()),S.copy(this.getFinalScale3d()),j||(j=new nk),j.compose(r,U,S)}}(),getAnchorRect:function(){var d=this,g=d.getWidth(),Y=d.getHeight(),v=d.getAnchor();return{x:-g*v.x,y:-Y*v.y,width:g,height:Y}},toLocal:function(Y){return this.getMatrix().tfi(Y)},toGlobal:function(k){return this.getMatrix().tf(k)},getAttachPosition:function(){var P=new Kb;return function(b,s,K,u){K=K||0,u=u||0;var S=this,L=S.getAnchor(),A=S._64O,C=S._position,g=S.getScale();return P.setFromTransform(A,C.x,C.y).tf({x:K+g.x*S.getWidth()*(b-L.x),y:u+g.y*S.getHeight()*(s-L.y)})}}(),isInRect:function(M){M=this.toLocal(M);var l=this.getWidth(),i=this.getHeight();return M.x+=l*this.getAnchorX(),M.y+=i*this.getAnchorY(),!(M.x<0||M.y<0||M.x>l||M.y>i)},getRect:function(){var F=this,K=F.getWidth(),H=F.getHeight(),a=F.getAnchor(),n={x:-K*a.x,y:-H*a.y,width:K,height:H},E=F.getMatrix();return n=Jk([E.tf(n.x,n.y),E.tf(n.x+n.width,n.y),E.tf(n.x+n.width,n.y+n.height),E.tf(n.x,n.y+n.height)])},getAnchorElevation:function(){return this._anchorElevation},getAnchor3d:function(){var Q=this,f=Q.getAnchor(),$=Q._anchorElevation;return{x:f.x,y:$,z:f.y}},setAnchorElevation:function(l){var h=this,d=h._anchorElevation;return d!==l?(h._anchorElevation=l,h.fp("anchorElevation",d,l),!0):!1},setAnchor3d:function(e,Y,J,p){var v,z=this;"number"==typeof e?v={x:e,y:Y,z:J}:(v=e.length?{x:e[0],y:e[1],z:e[2]}:e,p=Y);var R=z.getDataModel();R&&R.beginTransaction();var E=z.getAnchor3d(),L=z.setAnchor(v.x,v.z);if(z.setAnchorElevation(v.y)&&(L=!0),L&&p&&!xs){z.getAnchor3d();var r=hk(z),M=vf([v.x-E.x,v.y-E.y,v.z-E.z],r);z.p3(M)}return R&&R.endTransaction(),L},getAnchor:function(){var F=this;if(F.hasOwnProperty("_anchor"))return F._anchor;var R=Tj(F._image);return R&&R.anchorX!==A?{x:R.anchorX,y:R.anchorY}:F._anchor},setAnchor:function(U,n,C){var g,V=this;"number"==typeof U?g={x:U,y:n}:(g=U.length?{x:U[0],y:U[1]}:U,C=n);var q=V.getAnchor();if(q.x!==g.x||q.y!==g.y){var z=V.getDataModel();if(z&&z.beginTransaction(),V._anchor=g,V.fp("anchor",q,g),C&&!xs){var x=V.getPosition(),K=V.getSize(),v=V.getRotation(),j=V.getScale(),k=-K.width*(q.x-g.x)*j.x,l=-K.height*(q.y-g.y)*j.y,t=e(v),M=$(v);V.setPosition(x.x+M*k-t*l,x.y+t*k+M*l)}return z&&z.endTransaction(),!0}return!1},getLocalQuaternion:function(v){var x=this,W=x.getHost();if(!W)return x.getQuaternion(v);var u=W.getQuaternion(),t=x.getQuaternion();return v||(v=new er),v.copy(u).inverse().multiply(t)},setLocalQuaternion:function(I){var G=this,z=G.getHost();if(!z)return G.setQuaternion(I);var N=z.getQuaternion();G.setQuaternion(N.clone().multiply(I))},getLocalEuler:function(){var P=new er;return function(R){var d=this,m=d.getHost();return m?(d.getLocalQuaternion(P),R||(R=new to),R.setFromQuaternion(P,to.ReverseOrder(this.getRotationMode()))):d.getEuler(R)}}(),setLocalEuler:function(){var z=new er;return function(x){var d=this,c=d.getHost();return c?(z.setFromEuler(x),d.setLocalQuaternion(z)):d.setEuler(x)}}(),getLocalPosition3d:function(b){var Q=this;b||(b=new Ai),b.copy(Q.p3());var f=Q.getHost();if(!f)return b;var i=f.getMatrix4();return b.applyMatrix4(i.getInverse(i))},setLocalPosition3d:function(m){var Y=this,E=Y.getHost();if(!E)return m.x!==A?Y.p3(m.x,m.y,m.z):Y.p3(m),void 0;var W=E.getMatrix4(),F=new Ai(m);F.applyMatrix4(W),Y.p3(F.x,F.y,F.z)},getScale:function(){return this._scale},setScale:function(C,y){var x,P=this;x=2===arguments.length?{x:C,y:y}:C;var f=P.getScale();(f.x!==x.x||f.y!==x.y)&&(P._scale=x,P.fp("scale",f,x))},getScaleTall:function(){return this._scaleTall},getScale3d:function(){var q=this,b=q._scaleTall,$=q.getScale();return[$.x,b,$.y]},getFinalScale3d:function(){var I=this,X=I.s3(),D=I._dynamicScale3d,U=I.getScale3d();return X&&(U[0]*=X[0],U[1]*=X[1],U[2]*=X[2]),D&&(U[0]*=D[0],U[1]*=D[1],U[2]*=D[2]),U},getFinalRotation3d:function(){var K=this;return K._dynamicRotation||K.r3()},setScaleTall:function(R){var q=this,M=q._scaleTall;M!==R&&(q._scaleTall=R,q.fp("scaleTall",M,R))},setScale3d:function(r,X,w){var S,J=this;S="number"==typeof r?{x:r,y:X,z:w}:r.length?{x:r[0],y:r[1],z:r[2]}:r,J.setScaleTall(S.y),J.setScale(S.x,S.z)},getCorners:function(j,u){j==h&&(j=0),u==h&&(u=j);var Z=this,K=Z.getAnchor(),V=Z.getWidth(),l=Z.getHeight(),X=-V*K.x-j,O=-l*K.y-u,W=V+2*j,y=l+2*u,b=Z.getMatrix();return[b.tf(X,O),b.tf(X,O+y),b.tf(X+W,O+y),b.tf(X+W,O)]},getEditControlPoints:function(S,C,F){C==h&&(C=0),F==h&&(F=C);var I=this,c=I.getAnchor(),K=I.getWidth(),x=I.getHeight(),Q=-K*c.x-C,j=-x*c.y-F,M=K+2*C,z=x+2*F;if(S)return[{x:Q,y:j},{x:Q,y:0},{x:Q,y:j+z},{x:0,y:j+z},{x:Q+M,y:j+z},{x:Q+M,y:0},{x:Q+M,y:j},{x:0,y:j}];var i=I.getMatrix();return[i.tf(Q,j),i.tf(Q,0),i.tf(Q,j+z),i.tf(0,j+z),i.tf(Q+M,j+z),i.tf(Q+M,0),i.tf(Q+M,j),i.tf(0,j)]},rotateAt:function(O,n,f){var c=this,Y=c._position,m=c._64O,D=new Kb(m,Y.x,Y.y).tf(O,n),V=R(O*O+n*n),q=tj(Y.y-D.y,Y.x-D.x)+f;c.setRotation(m+f),c.p(D.x+V*$(q),D.y+V*e(q))},rotateAroundAxis:function(g,r){this.setQuaternion(this.getQuaternion().multiply(Np.setFromAxisAngle(g,r)))},rotateAroundWorldAxis:function(F,r){this.setQuaternion(this.getQuaternion().premultiply(Np.setFromAxisAngle(F,r)))},rotateX:function(J){return this.rotateAroundAxis(Ai.AxisX,J)},rotateY:function(j){return this.rotateAroundAxis(Ai.AxisY,j)},rotateZ:function(j){return this.rotateAroundAxis(Ai.AxisZ,j)},onParentChanged:function(){Zc.superClass.onParentChanged.apply(this,arguments),this._8I()},onPropertyChanged:function(){var $={};return"width|height|position|anchor|rotation|scale|s:layout.h|s:layout.v".split("|").forEach(function(T){$[T]=!0}),function(X){var f=this;Zc.superClass.onPropertyChanged.call(f,X);var V=X.property;if($[V]&&!f._layoutUpdating&&f.updateLayoutParameters(null,V),f._69O&&f._69O.each(function(O){O.handleHostPropertyChange(X)}),f._49I&&f._49I.each(function(O){O.fp("agentChange",!0,!1)}),pf[V]&&this.updateLayoutAttaches(),"a:layout"===V.substring(0,8)){this.updateLayoutAttaches();var u=f._host;u&&u.updateLayoutAttaches()}("s:shape3d.autorotate"===V||"s:autorotate"===V||"s:shape3d.fixSizeOnScreen"===V||"s:fixSizeOnScreen"===V||"s:hide.overlapping.group"===V)&&(f._47Q=f.s("autorotate")||f.s("shape3d.autorotate")||f.s("fixSizeOnScreen")||f.s("shape3d.fixSizeOnScreen")||f.s("hide.overlapping.group"))}}(),onHostChanged:function(){this.updateAttach(),this.updateLayoutParameters()},handleHostPropertyChange:function(i){this.updateAttach(i)},onStyleChanged:function(F){Zc.superClass.onStyleChanged.apply(this,arguments),Mh[F]&&this.updateAttach()},updateLayoutAttaches:function(){if(!xs){var R,y,K=this;return R=Tj(K.getImage()),R&&R.layoutAttach&&(y=R.layoutAttach,y&&y(K))?!0:void 0}},updateAttach:function(z){var h=this;return xs?(h.updateLayoutParameters(),void 0):(h._51I||(h._51I=1,h._71O(z),delete h._51I),void 0)},_71O:function(t){var H,D,S,s,A,X,_=this,O=_._host,Z=t?t.property:h,C=t?t.oldValue:h,b=t?t.newValue:h;if(O instanceof Zc&&(!t||pf[Z])){var w;if(w=Tj(O.getImage()),w&&w.layoutAttach)return}if(O instanceof L.Grid){if(Z===am)_.setElevation(_._54O+b-C);else if(!t||nm[Z]){if(H=_.s("attach.row.index"),D=_.s("attach.column.index"),S=O.getCellRect(H,D),!S)return;s=_.s("attach.row.span"),A=_.s("attach.column.span"),(1!==s||1!==A)&&(S=Pf(S,O.getCellRect(H+s-1,D+A-1))),yn(S,_,"attach.padding",1),_.setRect(S)}}else if(O instanceof Ei&&(X=_.s("attach.index"))>=0&&(!t||Wd[Z])){var n=_.s("attach.thickness"),k=O.getScale(),q=Math.max(k.x,k.y);n>0&&_.setHeight(O.getThickness()*n*q);var a=_.s("attach.offset"),W=O.getPoints(),I=W.size();if(I>X){var z=O.getPointsMatrix2d(),K=W.get(X),y=I===X+1?W.get(0):W.get(X+1);K=z.apply(K),y=z.apply(y);var o=[y.x-K.x,y.y-K.y],N=ml(o);if(N){_.s("attach.offset.relative")&&(a*=N),_.s("attach.offset.opposite")&&(a=N-a);var g={x:K.x+o[0]/N*a,y:K.y+o[1]/N*a},f=_.s("attach.gap");f&&(_.s("attach.gap.relative")&&(f*=O.getThickness()*q),g=Se(h,g,y,f)),_.p(g),_.setRotation(tj(o[1],o[0]))}}}else t&&(Z===Fb?_.translate(b.x-C.x,b.y-C.y):Z===am?_.setElevation(_._54O+b-C):vi[Z]?"rotation3d"===Z?_.syncRotation3d(O,b,C):_._11Q(O,Z,b-C):("anchor"===Z||"width"===Z||"height"===Z||"scale"===Z)&&_.layout(O))},_11Q:function(){var X=new L.Math.Euler,j=L.Math.Euler.ReverseOrder,Q=new L.Math.Vector2,f=new L.Math.Vector2;return function(F,P,D){var G=this,V=F.p3(),y=F.r3(),e=G.p3(),b=G.r3();if(P===up&&(P="rotationY",D=-D),(P===up||"rotationY"===P)&&0===b[0]&&0===b[2]&&0===y[0]&&0===y[2]&&0===e[1]&&0===V[1])return G.setRotation(-b[1]-D),Q.set(e[0],e[2]).rotateAround(f.set(V[0],V[2]),-D),G.p(Q.x,Q.y),void 0;var a=$r[F.getRotationMode()],T=a[0],c=a[1],C=a[2],B=Nj[T],h=Nj[c],s=Nj[C],m=Rb();P===up+T?(s(m,y[ke[C]]),h(m,y[ke[c]]),B(m,D),h(m,-y[ke[c]]),s(m,-y[ke[C]])):P===up+c?(s(m,y[ke[C]]),h(m,D),s(m,-y[ke[C]])):P===up+C&&s(m,D);var i=ik(e,V);vf(i,m),G.p3(V[0]+i[0],V[1]+i[1],V[2]+i[2]);var g=G.getRotationMode();Xl(m,G.r3(),g),X.setFromRotationMatrix(m,j(g)),G.r3([X.x,X.y,X.z])}}(),syncRotation3d:function(){var d=new er,i=new to,I=new Ai;return function(O,t,$){var M=this;if($[0]!==t[0]||$[1]!==t[1]||$[2]!==t[2]){var b=to.ReverseOrder(O.getRotationMode());Np.setFromEuler(i.set($[0],$[1],$[2],b)),d.setFromEuler(i.set(t[0],t[1],t[2],b)),d.multiply(Np.inverse());var r=O.p3(),T=M.p3();I.set(T[0]-r[0],T[1]-r[1],T[2]-r[2]).applyQuaternion(d),M.p3(r[0]+I.x,r[1]+I.y,r[2]+I.z),M.setQuaternion(M.getQuaternion(Np).premultiply(d))}}}(),isHostOn:function(e){var H=this;if(H._host&&e&&e._69O)for(var z={},c=H._host;c&&c!==H&&!z[c._id];){if(c===e)return!0;z[c._id]=c,c=c._host}return!1},isLoopedHostOn:function(q){return this.isHostOn(q)&&q.isHostOn(this)},getScaledSize:function(){var c=this.getSize(),E=this.getScale();return c.width*=Math.abs(E.x),c.height*=Math.abs(E.y),c},layout:function(S){if(S=S||this.getHost()){var U=this,a=U.s("layout.h")||"center",n=U.s("layout.v")||"center";if("center"!==a||"center"!==n){var G=new L.Math.Vector2,B=S.getPosition(),Q=S.getAnchor(),H=S.getScaledSize();U.getPosition();var w,p,s,j,k,R=1,M=1;switch(U._layoutUpdating=!0,a){case"left":G.setX(U._layoutHValue-Q.x*H.width);break;case"right":G.setX((1-Q.x)*H.width-U._layoutHValue);break;case"leftright":w=H.width-U._layoutHValue[2],s=U.getRotation()-S.getRotation(),j=Math.abs(Math.sin(s)),k=Math.abs(Math.cos(s)),R+=k*w/U._layoutHValue[3],M+=j*w/U._layoutHValue[4],G.setX(U._layoutHValue[1]+(U._layoutHValue[5]-Q.x)*H.width);break;case"center":G.setX((.5-Q.x)*H.width-U._layoutHValue);break;case"scale":s=U.getRotation()-S.getRotation(),j=Math.abs(Math.sin(s)),k=Math.abs(Math.cos(s)),G.setX((.5-Q.x)*H.width-U._layoutHValue[1]*H.width/U._layoutHValue[0]),p=H.width/U._layoutHValue[2]-1,R+=k*p,M+=j*p}switch(n){case"top":G.setY(U._layoutVValue-Q.y*H.height);break;case"bottom":G.setY((1-Q.y)*H.height-U._layoutVValue);break;case"topbottom":s||(s=U.getRotation()-S.getRotation(),j=Math.abs(Math.sin(s)),k=Math.abs(Math.cos(s))),w=H.height-U._layoutVValue[2],R+=j*w/U._layoutVValue[3],M+=k*w/U._layoutVValue[4],G.setY(U._layoutVValue[1]+(U._layoutVValue[5]-Q.y)*H.height);break;case"center":G.setY((.5-Q.y)*H.height-U._layoutVValue);break;case"scale":s||(s=U.getRotation()-S.getRotation(),j=Math.abs(Math.sin(s)),k=Math.abs(Math.cos(s))),G.setY((.5-Q.y)*H.height-U._layoutVValue[1]*H.height/U._layoutVValue[0]),p=H.height/U._layoutVValue[2]-1,R+=j*p,M+=k*p}if("leftright"===a||"scale"===a||"topbottom"===n||"scale"===n){var c=this.getScale(),V=Math.abs(c.x),E=Math.abs(c.y);"leftright"===a||"scale"===a?U.setSize(U._layoutHValue[3]*R/V,U._layoutHValue[4]*M/E):U.setSize(U._layoutVValue[3]*R/V,U._layoutVValue[4]*M/E)}G.rotateAround(null,S.getRotation()),this.setPosition(G.x+B.x,G.y+B.y),U._layoutUpdating=A}}},updateLayoutParameters:function(H,c){if(H=H||this.getHost()){var s=this,B=s.s("layout.h"),d=s.s("layout.v");if(B||d){var v,i,E,U,D,$,t=new L.Math.Vector2,J=H.getPosition(),f=H.getAnchor(),h=H.getScaledSize(),X=s.getPosition(),k=s.getScaledSize();switch(t.set(X.x-J.x,X.y-J.y),t.rotateAround(null,-H.getRotation()),B){case"left":s._layoutHValue=t.x+f.x*h.width;break;case"right":s._layoutHValue=-t.x+(1-f.x)*h.width;break;case"center":s._layoutHValue=-t.x+(.5-f.x)*h.width;break;case"leftright":case"scale":"scale"===B?v=-t.x+(.5-f.x)*h.width:(i=s.getAnchor(),E=s.getRotation()-H.getRotation(),U=Math.cos(E),D=Math.sin(E),$=-Math.min(-i.x*U+i.y*D,-i.x*U-(1-i.y)*D,(1-i.x)*U+i.y*D,(1-i.x)*U-(1-i.y)*D),v=t.x-($-f.x)*h.width),"position"===c&&"object"==typeof s._layoutHValue?(s._layoutHValue[0]=h.width,s._layoutHValue[1]=v):s._layoutHValue=[h.width,v,h.width,k.width,k.height,$]}switch(d){case"top":s._layoutVValue=t.y+f.y*h.height;break;case"bottom":s._layoutVValue=-t.y+(1-f.y)*h.height;break;case"center":s._layoutVValue=-t.y+(.5-f.y)*h.height;break;case"topbottom":case"scale":"scale"===d?v=-t.y+(.5-f.y)*h.height:(E||(i=s.getAnchor(),E=s.getRotation()-H.getRotation(),U=Math.cos(E),D=Math.sin(E)),$=-Math.min(-i.x*D-i.y*U,-i.x*D+(1-i.y)*U,(1-i.x)*D-i.y*U,(1-i.x)*D+(1-i.y)*U),v=t.y-($-f.y)*h.height),"position"===c&&"object"==typeof s._layoutVValue?(s._layoutVValue[0]=h.height,s._layoutVValue[1]=v):s._layoutVValue=[h.height,v,h.height,k.width,k.height,$]}}}},getSerializableProperties:function(){var V=Zc.superClass.getSerializableProperties.call(this);return th(V,{image:1,host:1,rotation:1,rotationX:1,rotationZ:1,rotationMode:1,position:1,anchor:1,anchorElevation:1,scale:1,scaleTall:1,_width:1,_height:1,_tall:1,elevation:1}),V}});var gl=L.Edge=function(D,H){var z=this;oc(gl,z),z.setSource(D),z.setTarget(H)};Ci("Edge",Xm,{ms_edge:!0,_icon:"edge_icon",getUIClass:function(){return Ki},_22Q:function(){return Us},getSource:function(){return this._source},getTarget:function(){return this._target},getSourceAgent:function(){return this._40I},getTargetAgent:function(){return this._41I},canSetSourceTarget:function(e){if(e===this)return!1;if(nf(e))return!0;for(var R,v,h,I,_,z=[this],$=-1,j=0;j>$;)if($++,R=z[$],v=R._44I)for(v=v.getArray(),I=0,_=v.length;_>I;I++)if(h=v[I],vm(h)&&!(z.indexOf(h)>=0)){if(h===e)return!1;z.push(h),j++}return!0},setSource:function(P){var C=this;if(C._source!==P&&C.canSetSourceTarget(P)){var p=C._source;C._source=P,p&&p._16I(C),P&&P._2I(C),C._7I(),C.fp("source",p,P)}},setTarget:function(s){var N=this;if(N._target!==s&&N.canSetSourceTarget(s)){var m=N._target;N._target=s,m&&m._18I(N),s&&s._4I(N),N._7I(),N.fp("target",m,s)}},isLooped:function(){var r=this;return r._source===r._target&&nf(r._source)&&nf(r._target)},onPropertyChanged:function(){var z=this;z._49I&&z._49I.each(function(M){M.fp("agentChange",!0,!1)})},_7I:function(){var g,M=this,C=ib(M);M._40I!==C&&(g=this._40I,g&&g._15I(M),M._40I=C,C&&C._1I(M),M.fp("sourceAgent",g,C),$k(g,M._41I),$k(C,M._41I));var T=Gd(M);M._41I!==T&&(g=M._41I,g&&g._17I(M),M._41I=T,T&&T._3I(M),M.fp("targetAgent",g,T),$k(g,M._40I),$k(T,M._40I))},_22I:function(Y){this._52I=Y,this.fp("edgeGroup",!0,!1)},getEdgeGroup:function(){return this._52I},isEdgeGroupHidden:function(){var B=this;return B._52I&&B._52I.get(0)!==B&&!B.getStyle(lj)},getEdgeGroupSize:function(){return this._52I?this._52I.size():1},getEdgeGroupIndex:function(){return this._52I?this._52I.indexOf(this):0},isEdgeGroupAgent:function(){var I=this,Y=I._52I;return Y&&!I.getStyle(lj)&&Y.size()>1&&I===Y.get(0)},toggle:function(){this.beginTransaction();var s=this._52I,I=!this.s(lj);s&&s.size()>1&&(s.each(function(j){j.s(lj,I)}),s.getSiblings().each(function(f){f!==s&&f.each(function(x){x.fp("edgeGroup",h,f)})})),this.endTransaction()},setStyle:function(I,F){(I===wm||"edge.segments"===I)&&(F=ri(F)),gl.superClass.setStyle.call(this,I,F)},onStyleChanged:function(p){gl.superClass.onStyleChanged.apply(this,arguments),vn[p]&&$k(this._41I,this._40I)},getSerializableProperties:function(){var M=gl.superClass.getSerializableProperties.call(this);return th(M,{source:1,target:1}),M}});var kc=L.Group=function(){oc(kc,this)};Ci("Group",Zc,{_image:"group_image",_icon:"group_icon",_57O:!1,getUIClass:function(){return oe},onChildAdded:function(){kc.superClass.onChildAdded.apply(this,arguments),this._81I()},onChildRemoved:function(){kc.superClass.onChildRemoved.apply(this,arguments),this._81I()},_81I:function(){var I=this;if(!I._54I&&!xs){var p=I.getChildrenRect();p&&(I._53I=1,I.p(Rm(I.s("group.position"),p,I.getSize())),delete I._53I)}},getChildrenRect:function(){var _,f=this;return f.eachChild(function(s){nf(s)&&(_=Pf(_,f.getChildRect(s)))}),_},getChildRect:function(h){var D;return nf(h)&&h.s(Er)&&(Im(h)&&h.isExpanded()&&h.eachChild(function(W){D=Pf(D,h.getChildRect(W))}),!D&&h.getRect&&(D=h.getRect())),D},setPosition:function(d,f){var T=this;if(!T._54I){var c;c=2===arguments.length?{x:d,y:f}:d,xs||T._53I||(T._54I=1,Cn(T._children,c.x-T._position.x,c.y-T._position.y),delete T._54I),kc.superClass.setPosition.call(this,c)}},toggle:function(){this.setExpanded(!this.isExpanded())},isExpanded:function(){return this._57O},setExpanded:function(v){var u=this;if(u._57O!==v){var m=u._57O;u._57O=v,u.fp("expanded",m,u._57O),u._fireInvalidateDeep(),u._8I()}},_fireInvalidateDeep:function(){this.eachChild(function(j){Im(j)?j._fireInvalidateDeep():j.iv()})},_8I:function(){kc.superClass._8I.call(this),this.eachChild(function(q){nf(q)&&q._8I()})},onStyleChanged:function(S){kc.superClass.onStyleChanged.apply(this,arguments),"group.position"===S&&this._81I()},getSerializableProperties:function(){var c=kc.superClass.getSerializableProperties.call(this);return c.expanded=1,c}});var il=L.Camera=function(){oc(il,this),this.s({"shadow.cast":!1,"shadow.receive":!1,shape3d:"billboard"}),this._viewMatrix=new xb.Matrix4,this._projectMatrix=new xb.Matrix4,this.setScale3d(1,1,-1),this.setCullingMask("main,top"),this._projectMatrixDirty=!0};il.CubeDirectionParam=[1,0,0,0,-1,0,-1,0,0,0,-1,0,0,1,0,0,0,1,0,-1,0,0,0,-1,0,0,1,0,-1,0,0,0,-1,0,-1,0],Ci("Camera",Zc,{_22Q:function(){return Camera3dUI},attachRenderTarget:function(Z){this._projectMatrixDirty=!0,this.renderTarget=Z},detachRenderTarget:function(){this._projectMatrixDirty=!0,this.renderTarget=null},setCullingMask:function(r){var U=r.split(",");this._cullingMask=cl(U)},isLayerVisible:function(K){var b=Fc[K];return b&&zi(this._cullingMask,b.mask)},isOrtho:function(){return"ortho"===this.s("camera.type")&&!this.isCube()},isCube:function(){return this.renderTarget&&this.renderTarget.isCube()},isPerspective:function(){return!this.isOrtho()},setViewMatrix:function(){var K=new L.Math.Matrix4,c=new L.Math.Euler;return function(W){var L=this;W.isMatrix4?L._viewMatrix.copy(W):L._viewMatrix.fromArray(W),K.getInverse(L._viewMatrix),L.p3(K.getPosition().toArray()),c.set(0,0,0,L.getRotationMode(),!0).setFromRotationMatrix(K),L.r3([c.x,c.y,c.z])}}(),getViewMatrix:function(t){var H=this,l=Qr(null,null,H.r3(),H.getRotationMode(),H.p3()),u=H._viewMatrix;return u.fromArray(l).getInverse(u),u.toArray(t)},setProjectMatrix:function(X){var K=this;X.isMatrix4?K._projectMatrix.copy(X):K._projectMatrix.fromArray(X),X=K._projectMatrix.getElements(),K.isOrtho()?K.s({"camera.near":(X[14]+1)/X[10],"camera.far":(X[14]-1)/X[10],"camera.ortho.width":2/X[0]}):K.s({"camera.near":X[14]/(X[10]-1),"camera.far":X[14]/(X[10]+1),"camera.fovy":2*Math.atan(1/X[5]),"camera.aspect":X[5]/X[0]}),K._projectMatrixDirty=!1},onPropertyChanged:function(u){var J=this;il.superClass.onPropertyChanged.call(J,u);var P=u.property;("s:camera.near"===P||"s:camera.far"===P||"s:camera.fovy"===P||"s:camera.aspect"===P||"s:camera.ortho.width"===P)&&(J._projectMatrixDirty=!0)},getProjectMatrix:function(){var U=this;if(U._projectMatrixDirty){var b=U.gv,W=U.isCube(),E=W?1:U.s("camera.aspect")||(b?b.getAspect():null)||r.graph3dViewAspect,l=U.s("camera.near")||(b?b.getNear():null)||r.graph3dViewNear,P=U.s("camera.far")||(b?b.getFar():null)||r.graph3dViewFar,R=Rb();if(U.isOrtho()){var m=U.s("camera.ortho.width")||(b?b.getOrthoWidth():null)||r.graph3dViewOrthoWidth,z=m/2,B=z/E;Xb(R,-z,z,-B,B,l,P)}else{var c=W?Math.PI/2:U.s("camera.fovy")||(b?b.getFovy():null)||r.graph3dViewFovy;ei(R,c,E,l,P)}U._projectMatrix.fromArray(R),U._projectMatrixDirty=!1}return U._projectMatrix.toArray()},lookAt:function(g,r){var k=this.p3();return g.x?this.lookAtDirection([g.x-k[0],g.y-k[1],g.z-k[2]],r):this.lookAtDirection([g[0]-k[0],g[1]-k[1],g[2]-k[2]],r)},lookAtDirection:function(){var W=new L.Math.Matrix4,k=new L.Math.Euler,I=new L.Math.Vector3,e=new L.Math.Vector3;return function(y,r){W.lookAtDirection(I.copy(y).multiplyScalar(-1),r?e.copy(r):e.set(0,1,0)),k.set(0,0,0,this.getRotationMode(),!0).setFromRotationMatrix(W),this.r3([k.x,k.y,k.z])}}(),render:function(j){var l=this,s=j.getGL();if(!s)return!1;var m,k,$=l.renderTarget;if($)m=$.width,k=$.height;else{var I=j.getDevicePixelRatio();m=j.getWidth()*I,k=j.getHeight()*I}l.gv=j,j._camera=l;var d=j._frameState.renderState.glState,t=d.color.clear.slice(0);$q(s,l.s("camera.background"));var z=j.getEye;if(j.getEye=function(){return l.p3()},l.isCube())for(var M=il.CubeDirectionParam,N=0;6>N;N++)$&&$.bind(s,N),l.lookAtDirection([M[6*N+0],M[6*N+1],M[6*N+2]],[M[6*N+3],M[6*N+4],M[6*N+5]]),s.clear(s.COLOR_BUFFER_BIT),j.setViewport(s,0,0,m,k),l.s("camera.onlySky")?j.renderSky():j.renderScene({renderAxis:l.s("camera.renderAxis"),renderGrid:l.s("camera.renderGrid"),renderEdit:l.s("camera.renderEdit"),renderReflector:!1}),$&&$.unbind(s);else $&&$.bind(s),s.clear(s.COLOR_BUFFER_BIT),j.overlappingBox.clear(),j.setViewport(s,0,0,m,k),l.s("camera.onlySky")?j.renderSky():j.renderScene({renderAxis:l.s("camera.renderAxis"),renderGrid:l.s("camera.renderGrid"),renderEdit:l.s("camera.renderEdit")}),$&&$.unbind(s);return j.getEye=z,$q(s,t),j._camera=null,l.gv=null,!0}});var so=L.Block=function(){oc(so,this),this.s({"shadow.cast":!1,"shadow.receive":!1})};Ci("Block",Zc,{_icon:"block_icon",_clickThroughEnabled:!1,_syncSize:!0,ms_ac:["clickThroughEnabled","syncSize"],getUIClass:function(){return Md},_22Q:function(){return Ts},onChildAdded:function(){so.superClass.onChildAdded.apply(this,arguments),this.updateFromChildren()},onChildRemoved:function(){so.superClass.onChildRemoved.apply(this,arguments),this.updateFromChildren()},_getBoundingBox:function(){function q(k,B,Q){S.fromArray(hk(B));var I=B.getAnchor3d();k.push((new Ai).set(0-I.x,0-I.y,0-I.z).applyMatrix4(S).applyMatrix4(Q)),k.push((new Ai).set(0-I.x,0-I.y,1-I.z).applyMatrix4(S).applyMatrix4(Q)),k.push((new Ai).set(0-I.x,1-I.y,0-I.z).applyMatrix4(S).applyMatrix4(Q)),k.push((new Ai).set(0-I.x,1-I.y,1-I.z).applyMatrix4(S).applyMatrix4(Q)),k.push((new Ai).set(1-I.x,0-I.y,0-I.z).applyMatrix4(S).applyMatrix4(Q)),k.push((new Ai).set(1-I.x,0-I.y,1-I.z).applyMatrix4(S).applyMatrix4(Q)),k.push((new Ai).set(1-I.x,1-I.y,0-I.z).applyMatrix4(S).applyMatrix4(Q)),k.push((new Ai).set(1-I.x,1-I.y,1-I.z).applyMatrix4(S).applyMatrix4(Q))}function K(T,f){var B=(new nk).makeRotationFromEuler(this.getEuler()).setPosition((new Ai).fromArray(this.p3()));B.getInverse(B),T.forEach(function(E){nf(E)&&q(f,E,B)})}var S=new nk;return function(W,U){if(W instanceof Zc&&(W=[W]),!W||0===W.length)return h;var U=[];K.call(this,W,U);var M=[1/0,1/0,1/0],j=[-1/0,-1/0,-1/0];return U.forEach(function(d){M[0]=Math.min(d.x,M[0]),M[1]=Math.min(d.y,M[1]),M[2]=Math.min(d.z,M[2]),j[0]=Math.max(d.x,j[0]),j[1]=Math.max(d.y,j[1]),j[2]=Math.max(d.z,j[2])}),{min:M,max:j}}}(),updateFromChildren:function(){var q=this;if(!xs&&!q._updatingToChildren&&q._syncSize&&0!==q.size()&&!q._freezeSyncFromChildren){var U=this._getBoundingBox(q.toChildren(nf));if(U){q._updatingFromChildren=1;var v=(new Ai).fromArray(this.getScale3d()),b=(new Ai).fromArray(U.min),f=(new Ai).fromArray(U.max),I=r.blockMinSize,T=new Ai,d=f.clone().sub(b);0===d.x&&T.setX(.5),0===d.y&&T.setY(.5),0===d.z&&T.setZ(.5);var t=this._width==h||-1===this._width,g=new Ai(this.getAnchor3d()),Y=v.clone().multiply((new Ai).fromArray(this.s3())),G=d.clone();0===G.x&&G.setX(I),0===G.y&&G.setY(I),0===G.z&&G.setZ(I);var L=g.clone().multiply(Y),$=L.clone().multiplyScalar(-1).sub(b).divide(G).add(L.divide(G)).add(T),K=this.s("keepPosition");if(t||this._anchorChanged||this._scaleChanged||!K){!t&&K&&(g=$);var p=g.clone().multiply(d).add(b).applyEuler(this.getEuler()).add((new Ai).fromArray(this.p3()));this.p3([p.x,p.y,p.z])}else this.setAnchor3d($.x,$.y,$.z);var M=new Ai(1,1,1).divide(v).multiply(d);this.s3(Math.abs(M.x),Math.abs(M.y),Math.abs(M.z)),delete q._updatingFromChildren}}},setPosition:function(l,R){var L=this;if(!L._updatingToChildren){var f;f=2===arguments.length?{x:l,y:R}:l,xs||L._updatingFromChildren||(L._updatingToChildren=1,Cn(L._children,f.x-L._position.x,f.y-L._position.y),delete L._updatingToChildren),so.superClass.setPosition.call(this,f)}},setSize3d:function(){this.beginTransaction(),so.superClass.setSize3d.apply(this,arguments),this.endTransaction()},setTall:function(n){var T=this;if(!T._updatingToChildren){this.beginTransaction(),n=k(n,r.blockMinSize);var $=T.getTall();if(n!==$&&so.superClass.setTall.call(T,n),!xs&&!T._updatingFromChildren){T._updatingToChildren=1;var U=n/$;T._adjustChildTallOrScale(U,"size"),delete T._updatingToChildren,T.updateFromChildren()}this.endTransaction()}},setWidth:function(P){return this.setSize(P,this.getHeight())},setHeight:function(Q){return this.setSize(this.getWidth(),Q)},setSize:function(M,u){var P=r.blockMinSize;M=k(M,P),u=k(u,P);var w=this;if(!w._updatingToChildren){2!==arguments.length&&(u=M.height,M=M.width),this.beginTransaction();var N=w.getWidth(),O=w.getHeight();if(M!==N&&so.superClass.setWidth.call(w,M),u!==O&&so.superClass.setHeight.call(w,u),!xs&&!w._updatingFromChildren){w._updatingToChildren=1;var g=M/N,h=u/O;w._adjustChildScaleOrSize(g,h,"size"),delete w._updatingToChildren,w.updateFromChildren()}this.endTransaction()}},_adjustChildScaleOrSize:function(E,g,J){var K=this;if(K._syncSize){var k=K.getPosition(),a=K.getRotation();K.eachChild(function(N){if(nf(N)){var P=N.getPosition(),x=N.getRotation(),K=N.getWidth(),B=N.getHeight(),Z=N.getScale(),i=Z.x*K,U=Z.y*B;if(0!==i&&0!==U){0>E*g&&N.setRotation(-1*x);var G=new Kb(x,P.x,P.y,i,U);G.translate(-k.x,-k.y),G.rotate(-a),x=tj(G.b*Math.sign(i),G.a*Math.sign(i)),G.scale(E,g);var o,R,w,C=$(x);if(Math.abs(C)<.001?(o=e(x),R=G.b/o,w=-G.c/o):(R=G.a/C,w=G.d/C),"scale"===J)N.setScale(R/K,w/B);else if("size"===J){var b=R/Z.x,z=w/Z.y;N.setScale(al(R)*Math.abs(Z.x),al(w)*Math.abs(Z.y)),N instanceof L.Shape?(N.setWidthForce(Math.max(Math.abs(b),1e-5)),N.setHeightForce(Math.max(Math.abs(z),1e-5))):N.setSize(Math.max(.01,Math.abs(b)),Math.max(.01,Math.abs(z)))}G.rotate(a),G.translate(k.x,k.y),N.setPosition(G.tx,G.ty)}}})}},_calcChangeFactor:function(_,R,O,y){var F,a,c,h;return F=z(_),a=z(O),c=F>a?F/a:a/F,F=z(R),a=z(y),h=F>a?F/a:a/F,k(c,h)},setElevation:function(k){var H=this;if(!H._updatingToChildren){var b=H.getElevation(),G=k-b;0!==G&&(xs||H._updatingFromChildren||(H._updatingToChildren=1,Cn(H._children,0,G,0),delete H._updatingToChildren),so.superClass.setElevation.apply(H,arguments))}},setScaleTall:function($){var E=this;if(!E._updatingToChildren){var y=E.getScaleTall();if(z($)<.01&&($=.01*(al($)||al(y))),so.superClass.setScaleTall.call(E,$),!xs&&!E._updatingFromChildren){E._updatingToChildren=1;var P=$/y;E._adjustChildTallOrScale(P,"size"),delete E._updatingToChildren,E._scaleChanged=1,this.updateFromChildren(),delete E._scaleChanged}}},_adjustChildTallOrScale:function(j,e){var R=this;if(R._syncSize){var p=R.getElevation();R.eachChild(function(o){if(nf(o))if("size"===e){var D=o.getTall();0>j&&o.setScaleTall(-1*o.getScaleTall()),o.setTall(Math.max(.01,Math.abs(D*j))),o.setElevation(p+(o.getElevation()-p)*j)}else{var X=o.getScaleTall();o.setScaleTall(X*j)}})}},setAnchor3d:function(){if(!this._updatingToChildren){this.beginTransaction();var X=so.superClass.setAnchor3d.apply(this,arguments);return X&&!xs&&!this._updatingFromChildren&&this._syncSize&&(this._anchorChanged=1,this.updateFromChildren(),delete this._anchorChanged),this.endTransaction(),X}},setAnchor:function(){var C=this;if(!C._updatingToChildren){var v=C.getAnchor(),u=so.superClass.setAnchor.apply(C,arguments);if(xs||C._updatingFromChildren||!C._syncSize)return u;C._updatingToChildren=1;var r=C.getAnchor();C.getPosition();var B=C.getSize(),T=C.getScale(),E=C.getRotation(),h=-B.width*T.x*(v.x-r.x),t=-B.height*T.y*(v.y-r.y),P=e(E),m=$(E),F=m*h-P*t,o=P*h+m*t;return C.eachChild(function(S){if(nf(S)){var h=S.getPosition();S.setPosition(h.x-F,h.y-o)}}),delete C._updatingToChildren,u}},setAnchorElevation:function(){var I=this;if(!I._updatingToChildren){var T=I.getAnchorElevation(),p=so.superClass.setAnchorElevation.apply(I,arguments);if(xs||I._updatingFromChildren||!I._syncSize)return p;I._updatingToChildren=1;var V=I.getAnchorElevation(),K=I.getTall(),h=I.getScaleTall(),C=-K*h*(T-V);return I.eachChild(function(m){if(nf(m)){var Z=m.getElevation();m.setElevation(Z-C)}}),delete I._updatingToChildren,p}},setRotation:function(l){this._updateChildrenRotation3d("rotation",l)},setRotationX:function(q){this._updateChildrenRotation3d("rotationX",q)},setRotationZ:function(K){this._updateChildrenRotation3d("rotationZ",K)},setRotation3d:function(){var f=this;if(!f._updatingToChildren){var H=f.r3();so.superClass.setRotation3d.apply(f,arguments);var _=f.r3();xs||f._updatingFromChildren||(f._updatingToChildren=1,f.eachChild(function(L){nf(L)&&L.syncRotation3d(f,_,H)}),delete f._updatingToChildren)}},_updateChildrenRotation3d:function(S,g){var o=this;if(!o._updatingToChildren){var m=o[Sf(S)]();so.superClass[ob(S)].call(o,g),xs||o._updatingFromChildren||this._updateRotationToChildren(S,g-m)}},_updateRotationToChildren:function(J,e){var z=this;z._updatingToChildren=1,z.eachChild(function(H){nf(H)&&H._11Q(z,J,e)}),delete z._updatingToChildren},setScale:function(x,D){var y=this;if(!y._updatingToChildren){null==D&&(D=x.y,x=x.x);var i=y.getScale();if(z(x)<.01&&(x=.01*(al(x)||al(i.x))),z(D)<.01&&(D=.01*(al(D)||al(i.y))),so.superClass.setScale.call(y,x,D),!xs&&!y._updatingFromChildren){y._updatingToChildren=1;var W=x/i.x,U=D/i.y;y._adjustChildScaleOrSize(W,U,"size"),delete y._updatingToChildren,y._scaleChanged=1,y.updateFromChildren(),delete y._scaleChanged}}},onPropertyChanged:function(s){so.superClass.onPropertyChanged.call(this,s),"s:3d.visible"===s.property&&this._invalidateChildrenBatch()},_invalidateChildrenBatch:function(){this.eachChild(function(r){(r.s("batch")||r.s("wf.geometry")||r.s("wf.visible"))&&r.iv(),r instanceof so&&r._invalidateChildrenBatch()})},getSerializableProperties:function(){var J=so.superClass.getSerializableProperties.call(this);return J.clickThroughEnabled=1,J.syncSize=1,J}});var nd=L.Grid=function(){oc(L.Grid,this)};Ci("Grid",Zc,{IRotatable:!1,_icon:"grid_icon",_image:h,getUIClass:function(){return uh},setRotation:function(){},getCellRect:function(s,$){var j=this,J=j.s("grid.row.count"),S=j.s("grid.column.count");if(0>=J||0>=S||0>s||s>=J||0>$||$>=S)return h;var Q,E,X,d=j.getRect(),B=j.s("grid.row.percents"),I=j.s("grid.column.percents");if(yn(d,j,"grid.border",-1),B&&B._as&&(B=B._as),I&&I._as&&(I=I._as),B&&B.length===J){for(X=0,Q=0;s>Q;Q++)X+=d.height*B[Q];d.y+=X,d.height=d.height*B[s]
}else d.height=d.height/J,d.y+=d.height*s;if(I&&I.length===S){for(E=0,Q=0;$>Q;Q++)E+=d.width*I[Q];d.x+=E,d.width=d.width*I[$]}else d.width=d.width/S,d.x+=d.width*$;return sk(d,-j.s("grid.gap")),d}});var Ff=L.Text=function(){oc(Ff,this),this.setSize(100,50),this.s("text","TEXT")};Ci("Text",Zc,{_icon:"text_icon",_image:"__text__",getUIClass:function(){return Rd},setWidth:function(o){o||(o=.001),Ff.superClass.setWidth.call(this,o)},setHeight:function(Z){Z||(Z=.001),Ff.superClass.setHeight.call(this,Z)},toLabel:function(){return this._displayName||this._name||this.s("text")}}),_f("__text__",{width:{value:100,isSafeFunc:!0,func:function(B){return B?B._width:100}},height:{value:50,isSafeFunc:!0,func:function(C){return C?C._height:50}},comps:[{type:"text",relative:!0,rect:[0,0,1,1],text:{func:"style@text"},align:{func:"style@text.align"},vAlign:{func:"style@text.vAlign"},color:{func:"style@text.color"},font:{func:"style@text.font"},shadow:{func:"style@text.shadow"},shadowColor:{func:"style@text.shadow.color"},shadowBlur:{func:"style@text.shadow.blur"},shadowOffsetX:{func:"style@text.shadow.offset.x"},shadowOffsetY:{func:"style@text.shadow.offset.y"},scaleX:{func:"style@text.scale.x"},scaleY:{func:"style@text.scale.y"},gradient:{func:"style@text.gradient"},gradientColor:{func:"style@text.gradient.color"},gradientPack:{func:"style@text.gradient.pack"},decoration:{func:"style@text.decoration"},vertical:{func:"style@text.vertical"},verticalGap:{func:"style@text.vertical.gap"}}]});var Ei=L.Shape=function(){oc(Ei,this),this._59O=new zc};Ei.__de__=Kk,Ci("Shape",Zc,{ms_ac:["thickness","closePath"],_icon:"shape_icon",_thickness:10,_closePath:!1,getUIClass:function(){return vb},_22Q:function(){return Vs},getLength:function(k){return Qf(zn(this._59O,this._58O,k,this._closePath))},getSegments:function(){return this._58O},toSegments:function(){var D=this._58O;return D?new zc(D._as.slice(0)):D},setSegments:function(W){var e=this._58O;W=W?rm(W)?new zc(W.slice(0)):new zc(W._as.slice(0)):null,(e&&W&&e._as.join(",")!==W._as.join(",")||e!==W)&&(this._58O=W,this.fp("segments",e,W))},getPoints:function(){return this._59O},toPoints:function(){var m=this._59O;return new zc(m._as.slice(0))},getPointsMatrix2d:function(){var o=this,J=new xb.Matrix2d,f=o.getPosition(),H=o.getScale(),q=o.getRotation();return J.translate(-f.x,-f.y).scale(H.x,H.y).rotate(q).translate(f.x,f.y),J},getPointsMatrix3d:function(){return function(){var b=this,C=new xb.Matrix4,O=C.getElements(),J=b.p3();Jm(O,J),Xl(O,b.getFinalRotation3d(),b.getRotationMode());var o=b.getScale3d(),G=b._dynamicScale3d;return G&&(o[0]*=G[0],o[1]*=G[1],o[2]*=G[2]),bl(O,o),Jm(O,Fg(J)),C}}(),setPoints:function(W,E){var q=this,N=q._59O;W=W?rm(W)?new zc(W.slice(0)):new zc(W._as.slice(0)):new zc;var s,F,L,e,D,X;E&&(s=q.getPosition(),X=new Kb(q.getRotation(),0,0,q.getScale().x,q.getScale().y)),(N&&W&&N._as.join(",")!==W._as.join(",")||N!==W)&&(q._59O=W,q.fs(),q.fp("points",N,W)),E&&(F=q.getPosition(),L=F.x-s.x,e=F.y-s.y,D=X.tf(L,e),q.setPosition(F.x-L+D.x,F.y-e+D.y))},addPoint:function(i,R,p){var b=this.toPoints();b.add(i,R),this.setPoints(b,p)},setPoint:function(Q,t,p){var a=this.toPoints();a.set(Q,t),this.setPoints(a,p)},removePointAt:function(_){var v=this.toPoints();v.removeAt(_),this.setPoints(v)},setWidthForce:function(T){var r=this;if(!r._55I&&!xs&&r.getWidth()){r._55I=1;var S=r._position.x,o=T/r.getWidth(),L=r.toPoints(),a=new zc;1!==o&&(L.each(function(L){a.add({x:(L.x-S)*o+S,y:L.y,e:L.e})}),r.setPoints(a),Jp(r,[o,0,0,1,S*(1-o),0]),r.fs()),delete r._55I}Ei.superClass.setWidth.call(r,T)},setWidth:function(L){return this.setWidthForce(_j>L?_j:L)},setHeightForce:function(D){var r=this;if(!r._55I&&!xs&&r.getHeight()){r._55I=1;var E=r._position.y,P=D/r.getHeight(),_=r.toPoints(),J=new zc;1!==P&&(_.each(function(z){J.add({x:z.x,y:(z.y-E)*P+E,e:z.e})}),r.setPoints(J),Jp(r,[1,0,0,P,0,E*(1-P)]),r.fs()),delete r._55I}Ei.superClass.setHeight.call(r,D)},setHeight:function(J){return this.setHeightForce(_j>J?_j:J)},setAnchorElevation:function(y){var U=this;U._55I=!0;var V=U._updatingAnchor3d,I=!xs&&!V;if(I){var P,$=y,T=U.getAnchorElevation(),D=U.getTall();P=D*(T-$),0!==P&&U.shiftPointsElevation(P)}var g=Ei.superClass.setAnchorElevation.apply(U,arguments);return V||delete U._55I,g},getShapeElevation:function(){var Z=this,i=Z._54O;return i-(Z.getTall()||0)*(Z._anchorElevation-.5)},setAnchor3d:function(K,l,I,g){var W,A=this;"number"==typeof K?W={x:K,y:l,z:I}:(W=K.length?{x:K[0],y:K[1],z:K[2]}:K,g=l),A._55I=!0,A._updatingAnchor3d=!0;var Y=A.getDataModel();if(Y&&Y.beginTransaction(),!xs){var G=A.getAnchor3d(),p=A.getSize(),S=A.getTall(),$=p.width*(G.x-W.x),H=p.height*(G.z-W.z),h=S*(G.y-W.y);g||A.shiftPoints($,H,h);var B=A.p3()}var j=Ei.superClass.setAnchor3d.apply(A,arguments);if(!xs&&g){var Q=A.p3();A.shiftPoints(Q[0]-B[0]+$,Q[2]-B[2]+H,Q[1]-B[1]+h)}return Y&&Y.endTransaction(),delete A._updatingAnchor3d,delete A._55I,j},setAnchor:function($,B,X){var V=this;V._55I=!0;var F=V._updatingAnchor3d,u=!xs&&!F;if(u){var f,m,E;"number"==typeof $?E={x:$,y:B}:(E=$.length?{x:$[0],y:$[1]}:$,X=B);var r=V.getAnchor(),Y=V.getSize();f=Y.width*(r.x-E.x),m=Y.height*(r.y-E.y),X||V.shiftPoints(f,m);var w=V.getPosition()}var v=Ei.superClass.setAnchor.apply(V,arguments);if(u){var Q=V.getPosition();X&&V.shiftPoints(Q.x-w.x+f,Q.y-w.y+m)}return F||delete V._55I,v},shiftPoints:function(t,M,A){if(t||M||A){var U=this,Z=U.getElevation()||0,f=U.toPoints(),L=new zc;f.each(function(O){var S=O.e;A&&(S=(S==h?Z:S)+A),L.add({x:O.x+t,y:O.y+M,e:S})}),U.setPoints(L),U.fs()}},shiftPointsElevation:function(Z){return this.shiftPoints(0,0,Z)},setPosition:function(K,n){var i,F=this;if(!F._28Q){if(F._28Q=1,!F._55I&&!xs){i=2===arguments.length?{x:K,y:n}:K;var m=i.x-F._position.x,Y=i.y-F._position.y;if(0===m&&0===Y)return delete F._28Q,void 0;F._55I=1,F.shiftPoints(m,Y),Jp(F,[1,0,0,1,m,Y]),delete F._55I}Ei.superClass.setPosition.apply(F,arguments),delete F._28Q}},fs:function(){this.fireShapeChange()},_70I:function(){var X=this;if(2!==X._59O.size())return!1;var u=X._58O;return u?2===u.size()&&1===u.get(0)&&2===u.get(1)?!0:!1:!0},fireShapeChange:function(){var W=this;if(!W._55I&&!xs){var d=Jk(W._59O);d&&(W._55I=1,W.setRect(d),delete W._55I)}W.fp(Tm,!1,!0)},getSerializableProperties:function(){var G=Ei.superClass.getSerializableProperties.call(this);return G.segments=1,G.points=1,G.thickness=1,G.closePath=1,G}});var tp=L.Points=function(){oc(tp,this)};Ci("Points",Zc,{_59O:[],_colors:[],_sizes:[],_uvoffsets:[],_22Q:function(){return Ws},getPoints:function(){return this._59O},setPoints:function(Y){var l=this._59O;Y=Y?Y.slice(0):[];var Z=Y[0];if(Id(Z)){var x=Y;Y=[];for(var V=0,O=x.length;O>V;V+=3)Y.push({x:x[V],e:x[V+1],y:x[V+2]})}this._59O=Y,this._pointsDirty=!0,this.fp("points",l,this._59O)},setPoint:function(m,A){var W=this._59O.slice(0);W[m]=A,this.setPoints(W)},addPoint:function(R){this.setPoint(this._59O.length,R)},getColors:function(){return this._colors},setColors:function(S){var F=this._colors;S=S?S.slice(0):[],this._colors=S,this._colorsDirty=!0,this.fp("colors",F,S)},setPointColor:function(C,Y){var R=this._colors.slice(0);R[C]=Y,this.setColors(R)},getSizes:function(){return this._sizes},setSizes:function(u){var r=this._sizes;u=u?u.slice(0):[],this._sizes=u,this._sizesDirty=!0,this.fp("sizes",r,this._sizes)},setPointSize:function(V,N){var f=this._sizes.slice(0);f[V]=N,this.setSizes(f)},getUvoffsets:function(){return this._uvoffsets},setUvoffsets:function(c){var I=this._uvoffsets;c=c?c.slice(0):[],this._uvoffsets=c,this._offsetsDirty=!0,this.fp("uvoffsets",I,this._uvoffsets)},setPointUvoffset:function(s,U,$){var I;"object"==typeof U?(I=U[0],$=U[1]):I=U;var d=this._uvoffsets.slice(0);d[2*s+0]=I,d[2*s+1]=$,this.setUvoffsets(d)},getPointInfo:function(U){var H=this.getPoints();if(!H||H[U]==h)return h;var n=H[U],b=[n.x,n.e,n.y],C=this.mat||hk(this),A=[b[0],b[1],b[2]];vf(A,C);var k=this.getColors(),O=k[U]||this.s("points.color"),D=this.getSizes(),S=D[U];return{size:S==h?this.s("points.size"):S,color:O,local:b,world:A}},getSerializableProperties:function(){var S=tp.superClass.getSerializableProperties.call(this);return S.points=1,S.colors=1,S.sizes=1,S.uvoffsets=1,S},onPropertyChanged:function(q){tp.superClass.onPropertyChanged.call(this,q);var U=q.property;"s:points.color"===U?this._colorsDirty=!0:"s:points.size"===U?this._sizesDirty=!0:"s:points.model"===U&&(this._modelDirty=!0)},getWidth:function(){var K=this;if(K._width>=0)return K._width;var o=K.getStyle("points.model");if(o){var l=wp(o);if(l&&l.rawS3)return l.rawS3[0]}return 1},getHeight:function(){var k=this;if(k._height>=0)return k._height;var f=k.getStyle("points.model");if(f){var B=wp(f);if(B&&B.rawS3)return B.rawS3[2]}return 1},getTall:function(){var I=this;if(I._tall>=0)return I._tall;var c=I.getStyle("points.model");if(c){var _=wp(c);if(_&&_.rawS3)return _.rawS3[1]}return 1}});var Hk=L.Polyline=function(){oc(Hk,this),this.s({"shape.background":null,"shape.border.width":2})};Ci("Polyline",Ei,{_icon:"polyline_icon",_22Q:function(){return Zs},getUIClass:function(){return pn},setClosePath:function(){},setTall:function(U){var P=this,W=P.getDataModel();if(W&&W.beginTransaction(),!P._55I&&!P._24Q&&!xs&&P.getTall()){P._24Q=1;var L=P._54O,n=U/P.getTall();if(1!==n){var M=P.toPoints(),v=new zc;M.each(function(c){v.add({x:c.x,y:c.y,e:c.e==h?c.e:(c.e-L)*n+L})}),P.setPoints(v),P.fs()}delete P._24Q}Hk.superClass.setTall.call(P,U),W&&W.endTransaction()},setElevation:function(M){var d=this,Y=d.getDataModel();if(Y&&Y.beginTransaction(),!d._55I&&!d._24Q&&!xs){d._24Q=1;var h=M-d._54O;0!==h&&d.shiftPointsElevation(h),delete d._24Q}Hk.superClass.setElevation.apply(d,arguments),Y&&Y.endTransaction()},fireShapeChange:function(){var x=this,F=x._59O;if(!x._55I&&!x._24Q&&!xs){var A=F.size();if(A){var B=1,v=F.get(0),T=x._54O;v.e==h&&(v.e=T);for(var W=v.e,u=0;A>B;B++){v=F.get(B),v.e==h&&(v.e=T);var Q=n(W,v.e),m=k(W+u,v.e);W=Q,u=m-Q}x._24Q=1,x.setTall(u),x.setElevation(W+u*x._anchorElevation),delete x._24Q}}Hk.superClass.fireShapeChange.apply(x,arguments)}});var mk=L.SubGraph=function(){oc(mk,this)};Ci("SubGraph",Zc,{ISubGraph:1,_image:"subGraph_image",_icon:"subGraph_icon",_8I:function(){mk.superClass._8I.call(this),this.eachChild(function(b){nf(b)&&b._8I()})}}),r.loadingRefGraph=0;var Oq=L.RefGraph=function(){oc(Oq,this)};Ci("RefGraph",so,{_icon:"refGraph_icon",getRef:function(){return this._ref},setRef:function(n){var f=this._ref;this._ref=n,this.fp("ref",f,n),this.updateRef()},_21I:function(){Oq.superClass._21I.apply(this,arguments),this.updateRef()},updateRef:function(){var x=this;if(r.loadingRefGraph++,x.clearChildrenFromDataModel(),r.loadingRefGraph--,x._ref&&x._dataModel){x._xhrLoadHandler&&(x._xhrLoadHandler.cancel=!0);var P=xs,m=x._xhrLoadHandler=function(C){if(C&&x._dataModel){r.loadingRefGraph++;var e=x._pendingUpdateInfo={needToRestore:P};P&&(e.p3=x.p3(),e.s3=x.s3(),e.r3=x.r3(),e.anchor3d=x.getAnchor3d(),e.scale3d=x.getScale3d()),x.r3(0,0,0),x.setScale3d(1,1,1),x.setAnchor3d(.5,.5,.5),x.p3(0,0,0);var f=r.parse(C),n=x._dataModel.deserialize(f,x,{justDatas:!0});n.each(function(s){s._refGraph=x}),x.checkPendingUpdateInfo(),r.loadingRefGraph--,r.handleRefGraphLoaded(x,n,f)}};m.xhrLoadCalled=!1,r.load(x._ref,function(x){m.cancel||(m.xhrLoadCalled?m(x):Tq(function(){m(x)}))}),m.xhrLoadCalled=!0}},checkPendingUpdateInfo:function(){var $=this,b=$._pendingUpdateInfo;if(!b)return $.onPendingUpdated&&(r.loadingRefGraph++,$.onPendingUpdated(),r.loadingRefGraph--),void 0;var R=!0;this.eachChild(function(q){(q._pendingCheckImageJSON||q._pendingUpdateInfo)&&(R=!1)}),R&&(r.loadingRefGraph++,$._pendingUpdateInfo=null,$.updateFromChildren(),b.needToRestore&&($.setAnchor3d(b.anchor3d),$.setScale3d(b.scale3d),$.r3(b.r3),$.p3(b.p3)),this.getParent()instanceof Oq&&this.getParent().checkPendingUpdateInfo(),$.onPendingUpdated&&$.onPendingUpdated(),r.loadingRefGraph--)},getSerializableProperties:function(){var p=Oq.superClass.getSerializableProperties.call(this);return p.ref=1,p}}),L.EdgeGroup=function(q,Q){this._70O=q,this._siblings=Q;for(var t,o,p=0,R=q.size(),N=E[lj];R>p;p++)if(t=q.get(p).getStyle(lj,!1),t!=h){N=t;break}N==h&&(N=!0);var s=r.edgeGroupAgentFunc;for(s&&(o=s(q),o&&o!==q.get(0)&&(q.remove(o),q.add(o,0))),p=0;R>p;p++)q.get(p).s(lj,N)},Ci("EdgeGroup",U,{getEdges:function(){return this._70O},size:function(){return this._70O.size()},get:function(e){return this._70O.get(e)},indexOf:function($){return this._70O.indexOf($)},each:function(e,L){this._70O.each(e,L)},getSiblings:function(){return this._siblings},eachSiblingEdge:function(z,p){this._siblings.each(function(m){m._70O.each(z,p)})}});var Rk=function(L,e,P){var Z=rk[L]={type:L,action:e};if(P)for(var M in P)Z[M]=P[M]};th(r,{setConnectAction:Rk,getConnectAction:function(a,I){if(!I){if(!a)return null;I=a.getCurrentConnectActionType()}return rk[I]},doConnectAction:function($,Y,A,q){q=q||$.getCurrentConnectActionType();var z=rk[q];if(!z)return!1;var d=z.action;return d?(Y instanceof ab.Group?$.sm().getSelection().each(function(G){d.call(null,$,G,A)}):d.call(null,$,Y,A),!0):!1},doDeleteConnectionAction:function(f,P,o){o=o||f.getCurrentConnectActionType();var Q=rk[o];if(!Q||!Q.delete)return!1;var b=Q.delete.action;return b?(P instanceof ab.Group?f.sm().getSelection().each(function(i){b.call(null,f,i)}):b.call(null,f,P),!0):!1}});var aj=L.JSONSerializer=function(e,P){this.dm=this._dataModel=e,this._hierarchical=r.forceHierarchicalSerialization?!0:P==h?e.isHierarchicalRendering():P};Ci("JSONSerializer",U,{ms_ac:["hierarchical"],serialize:function(S){return r.stringify(this.toJSON(),S)},toJSON:function(){var d,k=this,g=k.dm,S=g.getRoots(),b=k.json={v:r.getVersion(),p:{},a:{},d:[]},q=g.getSerializableAttrs();(d=g.getInit())&&(b.init=d),(d=g.getName())&&(b.p.name=d),(d=g.getBackground())&&(b.p.background=d),(d=g.getLayers())&&(b.p.layers=d),(d=g.getEnvmap())&&(b.p.envmap=d),(d=g.getEnvmapType())&&(b.p.envmapType=d),b.p.autoAdjustIndex=g.isAutoAdjustIndex(),b.p.hierarchicalRendering=g.isHierarchicalRendering();for(var f in q){var R=g.a(f);R!==A&&k[pg](f,R,b.a)}return ic(b.a)&&delete b.a,k._hierarchical?S.each(k.serializeData,this):g.each(function(l){k.serializeData(l)}),g.fireSerializeEvent({type:"serialize",json:b}),g.getPostProcessingData()&&(b.p.postProcessingData=g.getPostProcessingData()),b},isSerializable:function(){return!0},getProperties:function(e){return e.getSerializableProperties()},getStyles:function(F){return F.getSerializableStyles()},getAttrs:function(J){return J.getSerializableAttrs()},serializeData:function(r){var v=this;if(v.isSerializable(r)&&!r._refGraph){var H,R,C,B,m=is(r.getClassName())||r.getClass(),T=new m,d={c:r.getClassName(),i:r.getId(),p:{},s:{},a:{}};v.json.d.push(d),H=v.getProperties(r);for(R in H)if(/^_/.test(R)){if(C=r[R],!("_width"!==R&&"_height"!==R||C!=h&&-1!==C)){var S;((r.s("layout.h")||r.s("layout.v"))&&r.getHost()||r instanceof L.Node&&(S=r.getParent())&&S instanceof L.Block||r.s("fullscreen"))&&(C=r[R]="_width"===R?r.getWidth():r.getHeight())}C!==T[R]&&v[pg](R.substr(1),C,d.p)}else B=Sf(R),r[B]&&(C=r[B](),C!==T[B]()&&v[pg](R,C,d.p));H=v.getStyles(r);for(R in H)C=r.s(R),C!==T.s(R)&&v[pg](R,C,d.s);H=v.getAttrs(r);for(R in H)C=r.a(R),C!==T.a(R)&&v[pg](R,C,d.a);ic(d.p)&&delete d.p,ic(d.s)&&delete d.s,ic(d.a)&&delete d.a}v._hierarchical&&r.getChildren().each(v.serializeData,v)},serializeValue:function(w,r,v){Tg(r)?r={__a:r._as}:r instanceof Xm?r={__i:r.getId()}:r instanceof Eb&&(r={__dm:r.serialize(0)}),v[w]=r},deserialize:function(v,M,A){var Q=this;return Pr(v)&&/.json$/.test(v)?(r.xhrLoad(v,function(d){Q.deserializeImpl(d,M,A)}),void 0):Q.deserializeImpl(v,M,A)},deserializeImpl:function(m,P,S){var k=this,l=k.dm;l.setDeserializing(!0),S=fe(S)?{setId:S}:Il(S)?{finishFunc:S}:S||{},m=k.json=Pr(m)?r.parse(m):m,!S.justDatas&&m.a&&m.a.onPreDeserialize&&!S.disableOnPreDeserialize&&m.a.onPreDeserialize(m,l,S.view),l.beginTransaction(),xs++,k._82I={};var D=new zc,a=new zc,X=0,u=m.d.length;if(S.justDatas||(!S.disableInit&&Il(m.init)&&m.init(l),l.setInit(m.init)),!S.justDatas){for(var W in m.a)l.a(W,k[Af](m.a[W]));for(var T in m.p)l[ob(T)](m.p[T])}for(;u>X;X++){var i=m.d[X],f=is(i.c),A=new f,Q=i.i;S.setId&&Q!=h&&(A._id=Q),k._82I[Q]=A,D.add(A),a.add(i)}for(X=0;u>X;X++)k.deserializeData(D.get(X),a.get(X));return D.each(function(J){P&&!J.getParent()&&J.setParent(P),l.add(J)}),S.__innerHandler__&&S.__innerHandler__(m,l,S.view,D),l.fireSerializeEvent({type:"deserialize",json:m}),xs--,l.endTransaction(),!S.justDatas&&m.a&&m.a.onPostDeserialize&&!S.disableOnPostDeserialize&&m.a.onPostDeserialize(m,l,S.view,D),S.finishFunc&&S.finishFunc(m,l,S.view,D),l.setDeserializing(!1),D},deserializeData:function(W,p){for(var q in p.p)W[ob(q)](this[Af](p.p[q]));for(q in p.s)W.s(q,this[Af](p.s[q]));for(q in p.a)W.a(q,this[Af](p.a[q]))},deserializeValue:function(Z){if(Ti(Z)){var J=Z.__i;if(J!=h)return this._82I[J];if(J=Z.__dm,J!=h){var O=new L.DataModel;return O.deserialize(J),O}if(J=Z.__a,rm(J))return new zc(J)}return Z}}),th(Eb,{serialize:function(m,c){return new aj(this,c).serialize(m)},toJSON:function(j){return new aj(this,j).toJSON()},deserialize:function(y,k,H){return new aj(this).deserialize(y,k,H)}});var Kf=L.OverlappingBox=function(e){this.gv=e,this.boxes={}};Ci("OverlappingBox",U,{clear:function(){var t,x,c=this.boxes;for(t in c)x=c[t],x.length=0},isOverlapping:function(Y,R){var s,n,O=this,y=O.boxes,_=y[Y];_?(s=_.rects,n=_.length):_=y[Y]={rects:s=[],length:n=0};var T,i,R;for(T=0;n>T;T++)if(i=s[T],i.x<R.x+R.w&&i.x+i.w>R.x&&i.y<R.y+R.h&&i.h+i.y>R.y)return!0;return s.length<=n?(s.push(R),_.length++):s[_.length++]=R,!1}}),th(r,{fetch:function(o,Y){var i="GET",M=!1,c=null,m="";Y&&(i=Y.method||"GET",M=Y.sync,m=Y.url,c=Y.data||null),o.open(i,m,!M),Y.responseType?o.responseType=Y.responseType:Y.overrideMimeType&&o.overrideMimeType&&o.overrideMimeType(Y.overrideMimeType),o.send(c)},convertImageSrc:function(A,g){g&&"function"==typeof g||(g=function(){}),g(A)}});var Uf=L.Request=function(){this._xhr=new XMLHttpRequest,this._onloadFunc=function(){},this._errorFunc=function(){}};Ci("Request",U,{_responseType:null,_overrideMimeType:"text/plain",send:function(C){var Y=this._xhr,q=this.onload,V=this.onerror;this.getResponseType()?C.responseType=this.getResponseType():this.getOverrideMimeType()&&(C.overrideMimeType=this.getOverrideMimeType()),Y.onload=q,Y.onerror=V,r.fetch(Y,C)},onload:function(){},onerror:function(){},getResponseType:function(){return this._responseType},setResponseType:function(w){this._responseType=w},getOverrideMimeType:function(){return this._overrideMimeType},setOverrideMimeType:function(o){this._overrideMimeType=o},getResponseText:function(){var E=this._xhr;return E.response||E.responseText}}),Rr.GraphView=function(Q){var e=this;e._24I={},e._34I=new zc,e.enableDirtyRect(),e._25I={},e._56I={},e._view=eh(1,e),e._canvas=gi(e._view),e.dm(Q?Q:new Eb),this._coreInteractor=new dj(this),e.setEditable(!1),e.setScrollBarVisible(r.graphViewScrollBarVisible),e._initView()},zp("GraphView",U,{ms_v:1,ms_gv:1,ms_bnb:1,ms_tip:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,_52o:1,_51o:1,ms_ac:[_p,Sl,Yp,cd,"resettable","editInteractor",ol,"zoomable","pannable","rectSelectable","autoScrollZone",Bg,"movableFunc","editableFunc","pointEditableFunc","rectEditableFunc","rotationEditableFunc","anchorEditableFunc","rectSelectBackground","rectSelectBorderColor","editPointSize","editPointBorderColor","editPointBackground","hoverDelay"],_zoomable:r.graphViewZoomable,_resettable:r.graphViewResettable,_pannable:r.graphViewPannable,_rectSelectable:r.graphViewRectSelectable,_autoScrollZone:r.graphViewAutoScrollZone,_rectSelectBackground:r.graphViewRectSelectBackground,_rectSelectBorderColor:r.graphViewRectSelectBorderColor,_editPointSize:r.graphViewEditPointSize,_editPointBorderColor:r.graphViewEditPointBorderColor,_editPointBackground:r.graphViewEditPointBackground,_scrollBarColor:wi,_scrollBarSize:Fp,_autoHideScrollBar:bk,_autoMakeVisible:Ae,_currentActionType:null,getCoreInteractor:function(){return this._coreInteractor},getLayers:function(){return this._dataModel.getLayers()},setLayers:function(e){this._dataModel.setLayers(e)},setEditable:function(m){var c=this,f=c.__interactorMap__;if(!f){var U=Rr.XEditInteractor;f=c.__interactorMap__={scrollBar:new Pd(c),select:new Ar(c),edit:U?new U(c):new tn(c),text:new Ld(c),move:new Oj(c),"default":new Dk(c),touch:new Pk(c,{editable:!1})}}m?(c._uieditable=!0,c.setInteractors([f.scrollBar,f.select,f.edit,f.text,f.move,f.default,f.touch])):(c._uieditable=!1,c.setInteractors([f.scrollBar,f.select,f.move,f.default,f.touch]))},getCanvas:function(){return this._canvas},_33I:function(R){var y=R.getUIClass();return y?new y(this,R):h},getDataUI:function(F){var d=this,h=d._25I[F._id];return h===A&&(h=d._33I(F),d._25I[F._id]=h),h},getNodeRect:function(E){return r.getNodeRect(this,E)},getFullscreenDatas:function(){return this._dataModel.getFullscreenDatas()},getEdgeInfo:function(w){var E=this.getDataUI(w);return E?(E._79o(),E._78o):null},getEdgeSourcePosition:function(f){var o=this,M=o.getDataUI(f),i=M.s,s=M._data._40I;return ti(o,s,i("edge.source.position"),i("edge.source.offset.x"),i("edge.source.offset.y"),i("edge.source.anchor.x"),i("edge.source.anchor.y"))},getEdgeTargetPosition:function(M){var P=this,J=P.getDataUI(M),g=J.s,k=J._data._41I;return ti(P,k,g("edge.target.position"),g("edge.target.offset.x"),g("edge.target.offset.y"),g("edge.target.anchor.x"),g("edge.target.anchor.y"))},invalidateAll:function(T){var N=this;if(T){for(var D in N._25I){var k=N._25I[D];k&&k.dispose()}N._25I={},N._56I={},N._24I={},N._34I.clear(),N.redraw()}else N.dm().each(function(p){N.invalidateData(p)})},invalidateSelection:function(){var R=this;R.sm().each(function(M){R.invalidateData(M)})},invalidateData:function(K){var T=this;T._24I[K._id]=K,T._21Q(K),T.iv()},_21Q:function(D){var o=this,j=o._24I;if(vm(D)&&Ro[D.s(Ye)]){var E=D.getSourceAgent();E&&E.getAgentEdges().each(function(I){j[I._id]=I}),E=D.getTargetAgent(),E&&E.getAgentEdges().each(function(V){j[V._id]=V}),o.iv()}},redraw:function(v){var T=this;T._32I||(v?T._34I.add(v):(T._32I=1,T._34I.clear()),T.iv())},each:function(z,k){var O,p,e,j=0,c=this.getLayers(),C=this._dataModel,T=C._datas._as,x=T.length;if(c){for(var P=c.length;P>j;j++)if(e=c[j],Ti(e)&&(e=e.name),C.isHierarchicalRendering()){var u=function(a){return a._layer===e?k?z.call(k,a):z(a):void 0};if(this._dataModel.eachByHierarchical(u)===!1)return}else for(var Q=0;x>Q;Q++)if(O=T[Q],O._layer===e&&(p=k?z.call(k,O):z(O),p===!1))return}else if(C.isHierarchicalRendering())this._dataModel.eachByHierarchical(z,null,k);else for(;x>j;j++)if(O=T[j],p=k?z.call(k,O):z(O),p===!1)return},reverseEach:function(A,b){var Z,N,O,x,u=this._dataModel,D=u._layers,I=u._datas._as,w=I.length;if(D){for(Z=D.length-1;Z>=0;Z--)if(x=D[Z],Ti(x)&&(x=x.name),u.isHierarchicalRendering()){var s=function($){return $._layer===x?b?A.call(b,$):A($):void 0};if(u.reverseEachByHierarchical(s)===!1)return}else for(var k=w-1;k>=0;k--)if(N=I[k],N._layer===x&&(O=b?A.call(b,N):A(N),O===!1))return}else if(u.isHierarchicalRendering())u.reverseEachByHierarchical(A,null,b);else for(Z=w-1;Z>=0;Z--)if(N=I[Z],O=b?A.call(b,N):A(N),O===!1)return},getViewRect:function(){return this._29I},getContentRect:function(){var s=this,r=s._84I;if(!r){var Y=this.dm().a("width"),K=this.dm().a("height");Y>0&&K>0?s._84I={x:0,y:0,width:Y,height:K}:(s.each(function(J){s.isVisible(J)&&(r=Pf(r,s.getDataUIBounds(J)))}),s._84I=r?r:dq)}return s._84I},getScrollRect:function(){return Pf(this.getContentRect(),this._29I)},makeCenter:function(v,t,l){var M=this;if(!M.getWidth()||!M.getHeight())return l||Tq(M.makeCenter,M,[v,t,!0],500),void 0;M.makeVisible(v),M.validate();var B=M.getDataUIBounds(v);if(B){var x=M.getWidth(),w=M.getHeight(),_=B.x+B.width/2,s=B.y+B.height/2,K=-_*M._zoom+x/2,F=-s*M._zoom+w/2;M.setTranslate(K,F,t)}},fitData:function(m,S,Q,y,U){var n=this;if(!n.getWidth()||!n.getHeight())return U||Tq(n.fitData,n,[m,S,Q,y,!0],500),void 0;var s=function(){n.makeVisible(m),n.validate();var k=n.getDataUIBounds(m);k&&(k=Bi(k),sk(k,Q==h?20:Q),n.fitRect(k,S,y))};S?r.callWhenLoaded(s):s()},fitContent:function(L,b,g,C){var y=this;if(!y.getWidth()||!y.getHeight())return C||Tq(y.fitContent,y,[L,b,g,!0],500),void 0;var o=function(){y.validate();var F=Bi(y.getContentRect());sk(F,b==h?20:b),y.fitRect(F,L,g)};L?r.callWhenLoaded(o):o()},fitRect:function(t,K,B){var f=this,S=f.getWidth(),X=f.getHeight(),w=t.x+t.width/2,E=t.y+t.height/2,q=n(S/t.width,X/t.height),j=f._zoom,Y=-w*j+S/2,H=-E*j+X/2;0===q||isNaN(q)||(B&&(q=n(1,q)),K?(f._65I&&(delete f._65I.finishFunc,f._65I.stop(!0)),f._14o&&f._14o.stop(!0),f.setTranslate(Y,H,{finishFunc:function(){f.setZoom(q,K)}})):(f.setTranslate(Y,H),f.setZoom(q)))},fitSelection:function(E,Y,w){var z=this,Q=z.sm(),t=null;Q.size()&&(Q.each(function(l){t=Pf(z.getDataUIBounds(l),t)}),E&&sk(t,E),z.fitRect(t,Y,w))},toCanvas:function(t,Q,f){Q=Q||this._zoom,this.validateImpl();var W=this,V=W.getContentRect();f&&sk(V,f),V.width||(V.width=10),V.height||(V.height=10);var p=gi(),L=V.x*Q,J=V.y*Q,_=Math.ceil(V.width*Q),u=Math.ceil(V.height*Q);Ir(p,_,u,1);var m=df(p);t=t||this._dataModel.getBackground(),t&&qd(m,0,0,_,u,t),Br(m,-L,-J),m.scale(Q,Q);var z=this._zoom;return this._zoom=Q,W._42(m),this._zoom=z,m.restore(),p},toDataURL:function(Q,x,v,j){return this.toCanvas(Q,v,j).toDataURL(x||"image/png",1)},getClipBounds:function(){return this._74O},_42:function(Z,D){var w=this,Y=w.dm().getBackground();if(Y){var S=w.dm().a("width"),H=w.dm().a("height");S>0&&H>0&&qd(Z,0,0,S,H,Y)}var f=w.__htmlOrderList,c=[],i=w._forcedLayoutHTML;if(w._93db(Z,D),w.each(function(Y){var $=w.getDataUI(Y);if($){var P=w._56I[Y._id],U=$._htmlView;if(P){var O=$._79o();if(U=$._htmlView,L.HtmlNode&&Y instanceof L.HtmlNode)$._42(Z);else{var d=w.getViewRect(),I=U&&U.layoutHTML;!D||Yn(D,O)?(I&&(U.layoutHTML(),$.__outerLayout&&delete $.__outerLayout),$._42(Z)):Yn(d,O)||!I||$.__outerLayout&&!i||(U.layoutHTML(),$.__outerLayout=!0)}}U&&(c.push(U),U.getView&&(U=U.getView()),U.style.display=P?"block":Ji)}}),f&&c.length>0){var y=!1;if(f.length!==c.length)y=!0;else for(var O=0;O<c.length;O++)if(c[O]!==f[O]){y=!0;break}y&&(c.forEach(function(V){V.autoAdjustIndex!==!1&&w.appendHTML(V,!0)}),this.__htmlOrderList=c)}else this.__htmlOrderList=c;w._92db(Z,D)},disableDirtyRect:function(){this._shouldRedrawAll=s},enableDirtyRect:function(){var Z=this;Z._shouldRedrawAll=function(){return Z._32I}},validateImpl:function(){this.tryUpdateRootData();var O,I,E,l,e,D=this,i=D.tx(),h=D.ty(),Y=D._zoom,P=D._canvas,Q=this.getWidth(),K=this.getHeight(),z=D._29I,S={x:-i/Y,y:-h/Y,width:Q/Y,height:K/Y},B={},x=D._34I,_=D._24I,c=D._shouldRedrawAll(),r=D._23I;D._24I={},(Q!==P.clientWidth||K!==P.clientHeight)&&(Ir(P,Q,K),c=1,D._forcedLayoutHTML=1),c||xk(S,z)||(c=1,D._forcedLayoutHTML=1),D._29I=S,D.each(function(o){I=o._id;var X=B[I]=D.isVisible(o);X!==D._56I[I]&&(_[I]=o,E=D.getDataUI(_[I]),E&&E._84o(X),D._84o(o,X))},D);for(I in _)E=D.getDataUI(_[I]),E&&(!c&&D._56I[I]&&(e=E._79o(),e&&x.add(e)),E.invalidate()),D._83I=1;if(D._56I=B,!c)for(I in _)B[I]&&(E=D.getDataUI(_[I]),E&&(e=E._79o(),e&&x.add(e)));if(c?l=S:(x.each(function(P){Yn(S,P)&&(l=Pf(l,P))}),l&&(sk(l,k(1,1/Y)),l.x=y(l.x*Y)/Y,l.y=y(l.y*Y)/Y,l.width=N(l.width*Y)/Y,l.height=N(l.height*Y)/Y,l=Do(S,l))),D._74O=l,l&&0!==l.width&&0!==l.height){O=df(P);var w=l.x,M=l.y,g=l.width,W=l.height;w=Math.floor((w*Y+i)*rg),M=Math.floor((M*Y+h)*rg),g=Math.ceil(g*Y*rg)+1,W=Math.ceil(W*Y*rg)+1,c||(l.x=(w/rg-i)/Y,l.y=(M/rg-h)/Y,l.width=g/rg/Y,l.height=W/rg/Y),O.beginPath(),O.rect(w,M,g,W),O.clip(),O.clearRect(w,M,g,W),Oc(O,i,h,Y),D._42(O,l),O.restore(),delete D._74O}if(x.clear(),delete D._32I,delete D._forcedLayoutHTML,r&&Q>0&&K>0){var E=D.getDataUI(r);if(E){var e=E._79o(),V=D._29I,L=V.x,R=V.y,q=V.width,b=V.height,Y=D._zoom;e&&!Yn(e,V)&&(e.x+e.width<L&&D.tx(-e.x*Y),e.x>L+q&&D.tx(-(e.x+e.width-q)*Y),e.y+e.height<R&&D.ty(-e.y*Y),e.y>R+b&&D.ty(-(e.y+e.height-b)*Y))}delete D._23I}D._83I&&(delete D._83I,delete D._84I),D._98O(),D.countFrame(),ic(D._24I)||Tq(D.iv,D)},isValidGuideLineSource:function(){return!0},tryUpdateRootData:function(){if(!this._rootDataUpdating){this._rootDataUpdating=!0;var i,T=this.getFullscreenDatas();for(var Z in T)i=T[Z],this.scaleRootData(i);this.onRootDataUpdated&&this.onRootDataUpdated(),this._rootDataUpdating=!1}},scaleRootData:function(z){var R=z.s("fullscreen");if("uniform"===R||"fill"===R){z.getRotation()&&z.setRotation(0);var v=z.s("fullscreen.gap")||0,N=this.getWidth(),G=this.getHeight();if(N&&G){var W,I,E,a=N-2*v,k=G-2*v,O=z.getAnchor(),A=z.getScaledSize(),M=A.width,U=A.height,S=z.s("fullscreen.lock");if(S)return"uniform"===R?a/k>M/U?(W=k/U,M=U*a/k):(W=a/M,U=M*k/a):"v"===S?(W=k/U,M=a/W,z.getWidth()!==M&&z.setWidth(M)):(W=a/M,U=k/W,z.getHeight()!==U&&z.setHeight(U)),this.setZoom(W),I=v-(z.getX()-O.x*M)*W,E=v-(z.getY()-O.y*U)*W,I!==this.tx()&&this.tx(I),E!==this.ty()&&this.ty(E),void 0;I=this.tx(),E=this.ty(),W=this._zoom;var Q={x:(-I+v)/W,y:(-E+v)/W,width:a/W,height:k/W};if("uniform"===R){var y=M/U,q=Math.min(Q.width,Q.height*y),u=q/y;Q.x+=.5*(Q.width-q),Q.y+=.5*(Q.height-u),Q.width=q,Q.height=u}a=Q.width/z.getScaleX(),k=Q.height/z.getScaleY(),(z.getWidth()!=a||z.getHeight()!==k)&&z.setSize(a,k);var K=Q.x+O.x*Q.width,B=Q.y+O.y*Q.height,m=z.getPosition();(K!==m.x||B!==m.y)&&z.setPosition(K,B)}}},isScrollBarVisible:function(){return!!this._79O},setScrollBarVisible:function(D){var F=this;D!==F.isScrollBarVisible()&&(D?(Bm(F._view,F._79O=Sq()),Bm(F._79O,F._27I=Sq()),Bm(F._79O,F._28I=Sq())):(fo(F._79O),delete F._79O,delete F._27I,delete F._28I),F.fp("scrollBarVisible",!D,D))},getDebugTip:function(){return""},showScrollBar:function(){var W=this;W._79O&&(W._85I||(gj(function(){W._86I()},id),W.iv()),W._85I=new Date)},_86I:function(){var j=this;if(j._85I){var R=new Date,c=R.getTime();c-j._85I.getTime()>=id?(delete j._85I,j.iv()):gj(function(){j._86I()},id)}},getVScrollBar:function(){return this._27I},getHScrollBar:function(){return this._28I},_98O:function(){var M=this,L=this._27I,h=this._28I;if(M._79O){if(M._autoHideScrollBar&&!M._85I)return L.style.visibility=fi,h.style.visibility=fi,void 0;var t=M.getScrollBarColor(),T=M._zoom,D=M.getScrollBarSize(),k=M.getViewRect(),b=M.getScrollRect(),q=k.height*T,Z=b.height*T,p=k.width*T-D-2,s=q*((k.y-b.y)*T/Z),y=q*(q/Z),l=L.style;Z-.5>q?(jo>y&&(s=s+y/2-jo/2,0>s&&(s=0),s+jo>q&&(s=q-jo),y=jo),xq(L,p,s,D,y),l.visibility=yj,l.background=t,l.borderRadius=D/2+Fj):l.visibility=fi;var V=k.width*T,g=b.width*T,s=k.height*T-D-2,p=V*((k.x-b.x)*T/g),w=V*(V/g),l=h.style;g-.5>V?(jo>w&&(p=p+w/2-jo/2,0>p&&(p=0),p+jo>V&&(p=V-jo),w=jo),xq(h,p,s,w,D),l.visibility=yj,l.background=t,l.borderRadius=D/2+Fj):l.visibility=fi}},setDataModel:function(X){var q=this,t=q._dataModel,w=q._selectionModel;t!==X&&(t&&(t.ump(q.handleDataModelPropertyChange,q),t.umm(q.handleDataModelChange,q),t.umd(q.handleDataPropertyChange,q),t.removeIndexChangeListener(q._75O,q),t.removeHierarchyChangeListener(q.handleHierarchyChange,q),w||t.sm().ums(q.handleSelectionChange,q)),q._dataModel=X,X.mp(q.handleDataModelPropertyChange,q),X.mm(q.handleDataModelChange,q),X.md(q.handleDataPropertyChange,q),X.addIndexChangeListener(q._75O,q),X.addHierarchyChangeListener(q.handleHierarchyChange,q),w?w._21I(X):X.sm().ms(q.handleSelectionChange,q),q.invalidateAll(!0),q.fp(Re,t,X),q.updateBackground())},getLayersInfo:function(){if(this._layersInfo===A){var W=this.getLayers();W?(this._layersInfo={},W.forEach(function(L){var x=Ti(L)?L.name:L;this._layersInfo[x]=L},this)):this._layersInfo=null}return this._layersInfo},calculateEdgePosition:function(Y,j,d){var e,f,y=this,W=y.getDataUI(Y),T=Sn(W),g=Pq(j,function(B){return mm(T,100*B)},100,.001),N=mm(T,100*g);if(!d){var M=$g(W),R=new lm(N.x,N.y),k=49/(y._zoom*y._zoom);for(e=0,f=M.length;f>e;e++)if(R.distanceToSquared(M[e])<k)return{index:e,point:M[e],distance:Math.sqrt((M[e].x-j.x)*(M[e].x-j.x)+(M[e].y-j.y)*(M[e].y-j.y))}}return{percent:g,point:N,distance:Math.sqrt((N.x-j.x)*(N.x-j.x)+(N.y-j.y)*(N.y-j.y))}},calculateAttachPoint:function(){var O=new lm,T=new lm,v=new lm;
return function(X,B){var u=this.getAttachPoints(X);if(!u||!u.length)return null;v.set(B.x,B.y);for(var m,r,A,Q,k,S=1/0,l=0,D=u.length;D>l;l++)A=u[l],T.x=A.x,T.y=A.y,O.x=A.offsetX||0,O.y=A.offsetY||0,Q=ti(this,X,0,O.x,O.y,T.x,T.y),r=v.distanceToSquared(Q),S>r&&(m=l,S=r,k=Q);S=Math.sqrt(S);var Y=this.getAttachStyle(X);if("close"===Y){var C=X.s("attach.close.threshold")/this._zoom;if(S>C)return null}return{index:m,distance:S,info:u[m],point:k}}}(),getAttachPoints:function($){var b=$.s("attach.points");if(b)return b;var J=Tj($._image);return J?zm(J.attachPoints,$,this)||null:void 0},getAttachStyle:function(Q){var j=Q.s("attach.style");if(j)return j;var e=Tj(Q._image);return e?zm(e.attachStyle,Q,this)||"close":void 0},updateLayers:function(){this._layersInfo=A,this.invalidateSelection(),this.redraw()},updateBackground:function(){var D=this.dm().a("width"),i=this.dm().a("height");this._canvas.style.background=D>0&&i>0?"":this.dm().getBackground()||""},handleDataModelPropertyChange:function(K){if("background"===K.property){var D=this._canvas.style.background,N=K.newValue||"";this.updateBackground(),this.fp("canvasBackground",D,N),this.redraw()}else"a:width"===K.property||"a:height"===K.property?(this._83I=1,this.updateBackground(),this.redraw()):"layers"===K.property?this.updateLayers():"hierarchicalRendering"===K.property&&this.redraw()},handleDataPropertyChange:function(d){this.dm().isHierarchicalRendering()&&"parent"===d.property&&d.data.hasChildren()&&this.redraw(),this.invalidateData(d.data)},onPropertyChanged:function(O){var R=this,h=O.property;if(R.redraw(),"zoom"===h){var r=R.sm().getSelection();r.size()&&r.each(function(h){h.invalidate()})}else"dataModel"===h&&(R._83I=1);$i[h]?R.showScrollBar():h===ol&&R.onCurrentSubGraphChanged(O)},onCurrentSubGraphChanged:function(){this.sm().cs(),this.reset()},handleDataModelChange:function(w){var d=this,A=w.kind,N=w.data;if(d._83I=1,"add"===A)d.invalidateData(N),vm(N)&&N.getEdgeGroup()&&N.getEdgeGroup().eachSiblingEdge(d.invalidateData,d),N.getHost&&N.getHost()&&N.getHost().updateLayoutAttaches();else if(A===Yk){d._21Q(N);var z=N._id,r=d._25I[z];if(r){if(d._56I[z]){var G=r._79o();G&&d.redraw(G)}r.dispose(),delete d._25I[z],delete d._24I[z],delete d._56I[z]}N===d._currentSubGraph&&d.setCurrentSubGraph(h)}else A===Eh&&(d.invalidateAll(!0),d.setCurrentSubGraph(h))},_75O:function(Q){this.invalidateData(Q.data)},handleHierarchyChange:function(I){this.dm().isHierarchicalRendering()&&I.data.hasChildren()&&this.redraw(),this.invalidateData(I.data)},adjustIndex:function(k){var Z=this;if(Z.isVisible(k)){Z.dm().beginTransaction();for(var Y=k;Y._parent&&Z.isVisible(Y._parent);)Y=Y._parent;Y&&Y!==k&&Z._dataModel.adjustIndex(Y),Z._dataModel.adjustIndex(k),Z.dm().endTransaction()}},getImage:function(g){return g.getImage?g.getImage():A},getSelectWidth:function(b){var h=Tj(this.getImage(b));return h&&zm(h.disableSelectedBorder,b,this)?0:b.s("select.width")},getSelectColor:function(M){return M.s("select.color")},isSelectable:function(u,G){if(this.isSelected(u))return!0;if(!G&&u.getParent()instanceof so&&this.isSelectable(u.getParent(),!0)&&u.getParent().isSyncSize())return!1;var N=this.getLayersInfo();if(N){var A=N[u._layer];if(A&&A.selectable===!1)return!1}return u.s("2d.selectable")&&this.sm().isSelectable(u)},isMovable:function(F){var g=this;if(vm(F)&&F.getStyle(Ye)!==Bb)return!1;var h=this.getLayersInfo();if(h){var Q=h[F._layer];if(Q&&Q.movable===!1)return!1}return F.s("2d.movable")?g._movableFunc?g._movableFunc(F):!0:!1},isEditable:function(P){var S=this;if(L._uiSerializing)return S._uieditable;if(!S._editInteractor||!S.isSelected(P))return!1;if(Im(P)){var K=S.getDataUI(P);if(!K||K._88I)return!1}if(vm(P)&&P.getStyle(Ye)!==Bb)return!1;var H=this.getLayersInfo();if(H){var v=H[P._layer];if(v&&v.editable===!1)return!1}return P.s("2d.editable")?S._editableFunc?S._editableFunc(P):!0:!1},handleDelete:function(){this._editInteractor&&(this._editInteractor.handleDelete?this._editInteractor.handleDelete():this.removeSelection())},isPointEditable:function(B){return nf(B)&&0!==B.getRotation()?!1:this._pointEditableFunc?this._pointEditableFunc(B):!0},isRectEditable:function(Y){return this._rectEditableFunc?this._rectEditableFunc(Y):!0},isAnchorEditable:function(Y){return this._anchorEditableFunc?this._anchorEditableFunc(Y):!0},isRotationEditable:function(V){return V.setRotation&&V.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(V):!0:!1},isSourceTargetEditable:function(){return!0},getRotationPoint:function(_){var w=_.getAnchor(),T=_.getScale(),C=this._zoom,k=ec(_.getRotation(),0,-_.getHeight()*T.y*w.y-(T.y<0?-1:1)*(Xq?32:16)/C),h=_.p();return k.x+=h.x,k.y+=h.y,k},getLogicalPoint:function(h){var n=this;return Ge(h,n._canvas,n.tx(),n.ty(),n._zoom,n._zoom)},getScreenPoint:function(K,U){var V,N=this;return"object"==typeof K?K.x!==A?(V=K.x,U=K.y):(V=K[0],U=K[1]):V=K,Kg(V,U,N._canvas,N.tx(),N.ty(),N._zoom,N._zoom)},getSelectedDataAt:function(n){var t=this;return this.getDataAt(n,function(b){return t.isSelected(b)})},getDataInfoAt:function(o,g,Y){var r,J=this.lp(o),u=this.getDataAt(J,g,Y);if(u){var S=this.getDataUI(u);r={data:u,ui:S,point:J};var D=S._38o;if(D){var i=D.icons;for(var v in i){var U=i[v],$=D.rects[v];if($)for(var p=zm(U.names,u,this),f=p?p.length:0,j=$.rotation,t=f-1;t>=0;t--){var M=p[t],d=$[t];if(Uk(d,J,j))return r.part="icons",r.name=v,r.icon=M,r.rect=d,r.index=t,r.rotation=j,r}}}if(this.isNoteVisible(u)){if(S.note2Info&&Uk(S.note2Info.clickRect,J,h,S.note2Info.scale))return r.part="note2",r;if(S.noteInfo&&Uk(S.noteInfo.clickRect,J,h,S.noteInfo.scale))return r.part="note",r}if(this.isLabelVisible(u)){if(S.label2Info&&Uk(S.label2Info.rect,J,S.label2Info.rotation,S.label2Info.scale))return r.part="label2",r;if(S.labelInfo&&Uk(S.labelInfo.rect,J,S.labelInfo.rotation,S.labelInfo.scale))return r.part="label",r}if(u.isInRect&&u.isInRect(J))return r.part="body",r}return r},getDataAt:function(P,R,n){P.target&&(P=this.lp(P));var H,F=this._zoom;return this.reverseEach(function(U){return(R?R(U):this.isSelectable(U))&&this.rectIntersects(U,kj(P.x,P.y,n,F))?(H=U,!1):void 0},this),H},getIconInfoAt:function(K,y){var _=this;if(K.target&&(K=_.lp(K)),y||(y=_.getDataAt(K)),y){var X=_.getDataUI(y);if(X&&X._38o){var B,s=X._38o,I=new zc;for(B in s.icons)I.add(B);for(var v=I.size()-1;v>=0;v--){B=I.get(v);for(var z=s.rects[B],G=z.rotation,i=z.length-1;i>=0;i--){var F=z[i],l=F.width,Y=F.height,c={x:K.x-F.x-l/2,y:K.y-F.y-Y/2};G!=h&&(c=ec(-G,c.x,c.y));var F={x:-l/2,y:-Y/2,width:l,height:Y};if(Uk(F,c))return{key:B,index:i,name:s.icons[B].names[i],rect:z[i],point:K,rotation:G,relativeRect:F,relativePoint:c,data:y}}}}}return h},getDatasInRect:function(D,w,k){k===A&&(k=1);var c=this,J=new zc;return c.reverseEach(function(P){k&&!c.isSelectable(P)||(w?c.rectIntersects(P,D):c.rectContains(P,D))&&J.add(P)}),J},moveSelection:function(H,z){var E=this;E.dm().beginTransaction(),Cn(E.sm().toSelection(E.isMovable,E),H,z),E.dm().endTransaction()},moveDatas:function(r,$,e){var p=this;p.dm().beginTransaction(),r instanceof zc||(r=new zc(r)),Cn(r,$,e),p.dm().endTransaction()},getDataUIBounds:function(g){var f=this.getDataUI(g);return f?f._79o():h},drawData:function(b,u,H){var M=this.getDataUI(u);if(M){var T=M._79o();(!H||Yn(H,T))&&(M._42(b),u instanceof L.Block&&u.eachChild(function(d){this.isVisible(d)&&this.drawData(b,d,H)},this))}},getBoundsForGroup:function(J){return J.s(Er)?this.getDataUIBounds(J):h},isPixelPerfect:function(W){return W.s("pixelPerfect")},rectIntersects:function(T,d){this.validate();var B=h;if(this._56I[T._id]){var g=this._25I[T._id];if(g){var A=g._79o();if(yf(d,A))B=!0;else if((d=Do(d,A))&&(g.rectIntersects&&(B=g.rectIntersects(d)),B==h)){if(!this.isPixelPerfect(T))return!0;var M=d.x,O=d.y,k=d.width,s=d.height,w=this._zoom,R=r.hitMaxArea,j=k*s*w*w;if(j>R){var x=Math.sqrt(R/j);w*=x}k*=w,s*=w,2>k&&(k=2),2>s&&(s=2),M*=w,O*=w;var Z=Fk(k,s);Br(Z,-M,-O),Z.scale(w,w),this._drawForChecking=!0,this.drawData(Z,T,d),this._drawForChecking=!1;try{for(var G=0,K=Z.getImageData(0,0,k,s).data;G<K.length;G+=4)if(0!==K[G+3]){B=!0;break}Z.restore()}catch(p){rs=h,B=!1}}}}return B?!0:!1},rectContains:function(l,I){if(this._56I[l._id]){var T=this._25I[l._id];if(T)return yf(I,T._79o())}return!1},reset:function(){this.setZoom(1),this.setTranslate(0,0)},handleKeyDown:function(l){if(!r.isInput(l.target)){var w=this,z=w._focusData,R=z&&w._25I[z._id],M=0,B=w._dataModel._datas;if(!(z&&z._enabled&&z._editable&&R&&R.onKeyDown&&R.onKeyDown(l)===!0))if(9===l.keyCode&&(z&&(M=B.indexOf(z),Fr(l)?-1===--M&&(M=0):++M===B.size()&&(M=0)),w._focusData=z=B.get(M),w.sm().setSelection(z)),Mk(l)?w.selectAll():ph(l)&&w.isResettable()&&w.reset(),w.sm().isEmpty()){if(w._editing)return;var d=w.tx(),F=w.ty(),o=!1,k=Fr()?100:10;oo(l)&&(d-=k,o=!0),qo(l)&&(F-=k,o=!0),Qm(l)&&(d+=k,o=!0),zj(l)&&(F+=k,o=!0),o&&w.setTranslate(d,F)}else{Of(l)&&w.handleDelete(l);var i=Fr()?10:1;oo(l)&&(w.moveSelection(-i,0),w.fi({kind:"moveLeft"})),qo(l)&&(w.moveSelection(0,-i),w.fi({kind:"moveUp"})),Qm(l)&&(w.moveSelection(i,0),w.fi({kind:"moveRight"})),zj(l)&&(w.moveSelection(0,i),w.fi({kind:"moveDown"}))}}},handleScroll:function(E,U){if(ae(E),this.isZoomable()){if(!this.getEditInteractor()){var x=this.getDataAt(E);if(x){var u=Tj(this.getImage(x));if(u&&zm(u.scrollable,x,this))return}}var s=this.lp(E);U>0?this.scrollZoomIn(s):0>U&&this.scrollZoomOut(s)}},handlePinch:function(g,Q,S){this.isZoomable()&&(Math.abs(Q-S)<r.pinchZoomThreshold||(Q>S?this.pinchZoomIn(g):this.pinchZoomOut(g)))},checkDoubleClickOnNote:function(G,I){var o=this,J=o.lp(G),R=o.getDataUI(I),c=R.note2Info;return c&&I.s("note2.toggleable")&&Uk(c.clickRect,J)?(I.s(Tk,!I.s(Tk)),o.fi({kind:"toggleNote2",event:G,data:I}),!0):(c=R.noteInfo,c&&I.s("note.toggleable")&&Uk(c.clickRect,J)?(I.s(io,!I.s(io)),o.fi({kind:"toggleNote",event:G,data:I}),!0):!1)},_84o:function(){},isNoteVisible:function(){return this._zoom>.15},isLabelVisible:function(){return this._zoom>.15},isEditVisible:function(){return this._zoom>.15},autoScroll:function(z,l){var p=this,y=p.getAutoScrollZone(),f=y/p.getZoom(),E=y/4,s=p._29I,X=p.lp(z),$={x:p.tx(),y:p.ty()};return X&&y>0&&s&&(X.x-s.x<f?p.translate(E,0):s.x+s.width-X.x<f&&p.translate(-E,0),X.y-s.y<f?p.translate(0,E):s.y+s.height-X.y<f&&p.translate(0,-E)),$.x=p.tx()-$.x,$.y=p.ty()-$.y,l&&(l.x+=$.x,l.y+=$.y),$},getMoveMode:function(J,M){var g=M.s("2d.move.mode");return g?g:bq["88"]?"x":bq["89"]?"y":"xy"},getSerializableProperties:function(){return{scrollBarColor:1,scrollBarSize:1,autoMakeVisible:1,autoHideScrollBar:1,editable:1,resettable:1,pannable:1,rectSelectable:1,autoScrollZone:1,visibleFunc:1,movableFunc:1,editableFunc:1,pointEditableFunc:1,rectEditableFunc:1,anchorEditableFunc:1,rotationEditableFunc:1,rectSelectBackground:1,rectSelectBorderColor:1,editPointSize:1,editPointBorderColor:1,editPointBackground:1,hoverDelay:1,dataModel:1,selectionModel:1,currentSubGraph:1,zoom:1,translateX:1,translateY:1}},serializeProperty:function(l,d,H){var r=this;return"currentSubGraph"===d?{__i:l.getId()}:H.serializeProperty(l,d,r)},deserializeProperty:function(T,Z,f){var v=this;if("currentSubGraph"===Z){var K=v.dm(),m=K.__idMap;return m[T.__i]}return f.deserializeProperty(T,Z,v)},setDefaultCursor:function(H,Y){this._defaultCursor=H,Y!==!1&&this.setCursor(H)},getCurrentConnectActionType:function(){return this._currentActionType},setCurrentConnectActionType:function(z){return z===h||r.getConnectAction(null,z)?(this._currentActionType=z,this.redraw(),!0):!1},getEditStyle:function($){var a=this.getEditInteractor();return a?a.getStyle($):A},setEditStyle:function(N,E,u){var b=this.getEditInteractor();return b?(b.setStyle(N,E,u),!0):!1},isConnectActionVisible:function(O){var B=r.getConnectAction(this);if(!B)return!1;var l=B.visible;return Il(l)&&(l=l(this,O)),l},isInteractive:function(g){if(this._drawForChecking)return!1;var u=Tj(this.getImage(g));return u&&zm(u.interactive,g,this)?!0:g.s("interactive")},getRenderingStyleIconName:function(){return hq},appendHTML:function(Z,H){var b=this.getView();if(!(H||Z&&Z.parentNode!==b))return!1;var p=Z.getView&&Z.getView(),G=Z.beforeCanvas;if(!H&&p&&p.parentNode===b)return!1;(Z.getView||Z.isSelfViewEvent)&&(Z=Z.getView());var N=this.getEditInteractor();return G?b.insertBefore(Z,this.getCanvas()):N&&N._canvas?b.insertBefore(Z,N._canvas):this.isScrollBarVisible()?b.insertBefore(Z,this.getView().lastChild):Bm(b,Z),!0},_layoutHTMLImpl:function(n,c,J){if(arguments.length>1){var P,k=this,H=k._zoom;if(c.getView&&(P=c,c=c.getView()),c.style.position="absolute",J){var h=n.getRect();xq(P||c,k.tx()+h.x*H,k.ty()+h.y*H,h.width*H,h.height*H)}else{var _=new Ud,h=n.getAnchorRect(),R=n.getPosition(),V=n.getScale(),K=c.style;xq(P||c,h),_.appendTranslate(k.tx(),k.ty()),_.appendScale(H,H),_.append(new Ud(n.getRotation(),R.x,R.y,V.x,V.y)),Nc(K,"transform","matrix("+_.a.toFixed(5)+", "+_.b.toFixed(5)+", "+_.c.toFixed(5)+",\n    "+_.d.toFixed(5)+", "+_.tx.toFixed(5)+", "+_.ty.toFixed(5)+")"),Nc(K,"transformOrigin",(-h.x).toFixed(5)+"px "+(-h.y).toFixed(5)+"px"),c.updateAppendMatrix=!0}}else this._layoutHTML&&this._layoutHTML()},getTextEditInfo:function(N){return N instanceof Ff?{name:"text",accessType:"s",isMultiline:!1}:void 0},getState:function(j){var n="state",R=j.s(n);if(R)return R;var p=Tj(j._image);return p?zm(p[n],j,this)||null:void 0},getShape:function(D){return D.getStyle(Tm)}}),U.defineProperties(Rr.GraphView.prototype,{layoutHTML:{get:function(){return this._layoutHTMLImplBind||(this._layoutHTMLImplBind=this._layoutHTMLImpl.bind(this)),this._layoutHTMLImplBind},set:function(k){this._layoutHTML=k}}});var ni=function(K,V){var b=this;b.gv=K,b.s=function(N){return V.getStyle(N)},b._data=V,b._87I=new zc},hq=h;sr(ni,U,{_6I:h,ms_icons:1,_84o:function(){},dispose:function(){},isShadowed:function(){return this.s("shadow")||this.gv.isSelected(this._data)&&"shadow"===this.s("select.type")},getSelectWidth:function(){var E=this,$=E.gv.isSelected(E._data);return!$||E.isShadowed()?0:E.gv.getSelectWidth(E._data)},getSelectColor:function(){return this.gv.getSelectColor(this._data)},getBodyColor:function(J){var $=this._data,i=this.gv.getBodyColor($);return i?i:J?$.getStyle(J):h},_2Q:function(i){return this.s(i)},_1Q:function(t,Q,s,E){var C=this.s,e=C("2d.gray"),y=C(Q+".dash.color");if(e&&(y=r.toGrayColor(y)),t.strokeStyle=y,t.lineWidth=s,t.stroke(),C(Q+".dash.3d")){var n=C(Q+".dash.3d.color");Mn(t,y,e?r.toGrayColor(n):n,s,this.gv._zoom,C(Q+".dash.3d.accuracy"))}Kd(t,E)},invalidate:function(){this._6I=h},_79o:function(){var d=this;if(!d._6I){var z=d._data,P=d.gv;d.labelInfo=d.label2Info=d.noteInfo=d.note2Info=d._38o=h,d._87I.clear(),d.interactiveInfo=P.isInteractive(z)?{}:h,d._3O(),d._55O=P.isEditable(z)?{_42O:P.isRectEditable(z),_43O:P.isPointEditable(z),_56O:P.isRotationEditable(z)}:h,d._6I=d._81o()}return d._6I},_3O:function(){},getPosition:function(){return dq},_68o:function(T,Z){T&&this._87I.add(ac(T,Z))},_81o:function(){var d=this,A=d.s;d._24O(cc,"getLabel"),d._24O(Jc,"getLabel2"),d._26O(mi,"getNote"),d._26O(ql,"getNote2"),d._15O(),d._55O&&d._48O();var z;if(d._87I.each(function(n){z=Pf(z,n)}),z&&A("shadow.interactable")){var N=d.isShadowed(),I=A("shadow2"),L=Bi(z);I?(L.x+=A("shadow2.offset.x"),L.y+=A("shadow2.offset.y"),sk(L,A("shadow2.blur"))):N&&(L.x+=A("shadow.offset.x"),L.y+=A("shadow.offset.y"),sk(L,A("shadow.blur"))),z=Pf(z,L)}return d._87I.clear(),z},_42:function(O){var L=this,C=L._data,S=L.gv,P=L.s,Z=P("opacity"),V=this.isShadowed(),q=P("shadow2");if(V||q){var Y=O.shadowOffsetX,R=O.shadowOffsetY,G=O.shadowBlur,t=O.shadowColor,u=S.getZoom()*r.devicePixelRatio,s=V?"shadow":"shadow2";O.shadowOffsetX=P(s+".offset.x")*u,O.shadowOffsetY=P(s+".offset.y")*u,O.shadowBlur=P(s+".blur")*u,O.shadowColor=V?L.getSelectColor():P(s+".color")}if(Z!=h){var g=O.globalAlpha;O.globalAlpha=Z}L._80o(O),S.isLabelVisible(C)&&((!S._drawForChecking||P("label.selectable"))&&nj(O,L.labelInfo),(!S._drawForChecking||P("label2.selectable"))&&nj(O,L.label2Info)),S.isNoteVisible(C)&&(Dj(O,L.noteInfo),Dj(O,L.note2Info)),L._99O(O),Z!=h&&(O.globalAlpha=g),(V||q)&&(O.shadowOffsetX=Y,O.shadowOffsetY=R,O.shadowBlur=G,O.shadowColor=t)},_80o:function(){},_47O:function(){},_24O:function(k,y){var s=this,i=s._data,p=s.gv,d=s.s,O=p[y](i);if(O!=h){var z=d(k+".scale"),m=d(k+".max"),W=d(k+".position"),A=s[k+"Info"]={label:O,scale:z,color:p[y+"Color"](i),font:d(k+".font"),opacity:d(k+".opacity"),align:d(k+".align"),rotation:s.getRotation(d(k+".rotation"),!1,W),background:p[y+"Background"](i)},c=xr(A,O);m>0&&m<c.width&&(A.labelWidth=c.width,c.width=m),1!==z&&(c.width*=z,c.height*=z);var Q=s.getPosition(W,d(k+".offset.x"),d(k+".offset.y"),c,d(k+".position.fixed"));if(c.x=Q.x-c.width/2,c.y=Q.y-c.height/2,s._68o(A.rect=c,A.rotation),1!==z){var v=c.width/z,g=c.height/z;A.rect={x:Q.x-v/2,y:Q.y-g/2,width:v,height:g}}}},_26O:function(D,g){var y=this,I=y.gv,d=y._data,s=y.s,G=I[g](d);if(G!=h){var v,c,z=s(D+".scale"),r=y[D+"Info"]={note:G,scale:z,data:d,view:I,expanded:s(D+".expanded"),font:s(D+".font"),color:s(D+".color"),opacity:s(D+".opacity"),align:s(D+".align"),icon:s(D+".icon"),backgroundImage:s(D+".backgroundImage"),borderWidth:s(D+".border.width"),borderColor:s(D+".border.color"),background:I[g+"Background"](d)},e=y.getPosition(s(D+".position"),s(D+".offset.x"),s(D+".offset.y")),p=e.x,P=e.y;if(r.expanded){var Y,C=s(D+".max"),t=s(D+".backgroundImage");t?(t=Tj(t),Y={width:Xf(t,d),height:$m(t,d)}):Y=xr(r,G),Y.width+=6,Y.height+=2,C>0&&C<Y.width&&(r.labelWidth=Y.width,Y.width=C),v=Y.width,c=Y.height+8,r.clickRect={x:p-v*z/2,y:P-c*z,width:v*z,height:c*z*Y.height/c}}else{var W=s(D+".icon");W?(W=Tj(W),v=Xf(W,d),c=$m(W,d)):(v=12,c=18),r.clickRect={x:p-v*z/2,y:P-c*z,width:v*z,height:c*z}}r.rect={x:p-v/2,y:P-c*z/2-c/2,width:v,height:c};var O=N(r.borderWidth/2)*z;y._68o({x:p-v*z/2-O,y:P-c*z-O,width:v*z+2*O,height:c*z+2*O})}},_48O:function(){},_99O:function(D){var k=this,P=k._38o;if(P){var N=k.gv,H=k._data,U=P.icons,i=k.interactiveInfo;i&&(i._38o={});for(var B in U){var X=U[B],T=P.rects[B];if(T){i&&(i._38o[B]=[]);var c=zm(X.opacity,H,N),C=zm(X.names,H,N),J=C?C.length:0,r=T.rotation;if(c!=h){var y=D.globalAlpha;D.globalAlpha*=c}for(var x=0;J>x;x++){var a=C[x],E=Tj(a),$=T[x];if(r){var A=$.x+$.width/2,p=$.y+$.height/2;D.save(),Br(D,A,p),Ec(D,r),Br(D,-A,-p)}i&&i._38o[B].push(D.interactiveInfo={compInfos:[],matrix:r?new Ud(r,A,p).appendTranslate(-A,-p):new Ud});var j=hq;hq=B,ms(D,E,zm(X.stretch,H,N),$.x,$.y,$.width,$.height,k._data,k.gv),hq=j,D.interactiveInfo=h,r&&D.restore()}c!=h&&(D.globalAlpha=y)}}}}});var Go=function(A,p){oc(Go,this,[A,p])};sr(Go,ni,{_checkEmptyRect:!0,_40O:function(o,i){var Q=this,f=Q.s,m=o.rect;(o.borderColor=Q.gv.getBorderColor(Q._data))&&(o.borderType=f("border.type"),o.borderWidth=f("border.width"),o.borderPadding=f("border.padding"),i=k(i,o.borderPadding+o.borderWidth/2));var x=Q._data.getScale(),b=k(1,k(z(x.x),z(x.y)));if(o.selectWidth=Q.getSelectWidth()){var v=Q.gv._zoom;o.selectType=f("select.type"),o._97o=Q.getSelectColor(),o.selectPadding=f("select.padding"),i=k(i,(o.selectPadding+o.selectWidth/2/v)/b)}i>0&&(i*=b,m=Bi(m),sk(m,i)),Q._68o(m)},_39O:function(x,i){var C,Z=this,u=i.rect;if(i.borderWidth>0&&(C=i.borderPadding,x.strokeStyle=i.borderColor,x.lineWidth=i.borderWidth,Gk(x,i.borderType,{x:u.x-C,y:u.y-C,width:u.width+2*C,height:u.height+2*C}),x.stroke()),i.selectWidth>0){var A=Z.gv._zoom;if(C=i.selectPadding,x.strokeStyle=i._97o,x.lineWidth=i.selectWidth/A,i.rotation!=h){x.save(),x.translate(i.position.x,i.position.y),x.rotate(i.rotation);var e=Z._data,n=e.getWidth(),K=e.getHeight(),v=i.scale,Y=i.anchor;u={x:v.x*-n*Y.x,y:v.y*-K*Y.y,width:v.x*n,height:v.y*K}}Gk(x,i.selectType,{x:u.x-C,y:u.y-C,width:u.width+2*C,height:u.height+2*C}),i.rotation!=h&&x.restore(),x.stroke()}},dispose:function(){var i=this,_=i._htmlView;Go.superClass._3O.call(i),_&&(_.onHTMLRemoved&&_.onHTMLRemoved(),fo(_))},_3O:function(){var s,V=this,e=V.s,H=V._data,T=V.gv,N=T.getShape(H),O=V.getBodyColor(),D=e("shape.border.color"),j=V._83o=N?{shape:N,_53o:V.getBodyColor("shape.background"),_27Q:Tj(e("shape.repeat.image"),O),shapeGradientPack:e("shape.gradient.pack"),shapeBorderGradientPack:e("shape.border.gradient.pack"),_54o:e("shape.border.width"),_55o:D,shapeBorderRepeatImage:Tj(e("shape.border.repeat.image"),D),_56o:e("shape.border.3d"),_57o:e("shape.border.3d.color"),_58o:e("shape.border.3d.accuracy"),shapeGradient:e("shape.gradient"),_59o:e("shape.gradient.color"),_60o:e("shape.border.pattern"),_61o:e("shape.border.cap"),_62o:e("shape.border.join"),shapeForeground:e("shape.foreground"),bodyColor:O,gray:e("2d.gray")}:{img:Tj(T.getImage(H),O),bodyColor:O,gray:e("2d.gray"),stretch:e("image.stretch")},A=j.img;A&&A.renderHTML?(V._htmlInfo&&V._htmlInfo.img!==A&&(V._htmlInfo=h),V._htmlInfo||(V._htmlInfo={img:A,cache:{}}),s=A.renderHTML(H,T,V._htmlInfo.cache)):V._htmlInfo=h,V._htmlView&&V._htmlView!==s&&(V._htmlView.onHTMLRemoved&&V._htmlView.onHTMLRemoved(),fo(V._htmlView.getView?V._htmlView.getView():V._htmlView)),(V._htmlView=s)&&T.appendHTML(s)&&(s.onHTMLAddedSync&&s.onHTMLAddedSync(),s.onHTMLAdded&&Tq(s.onHTMLAdded)),j.rect=H.getRect(),j.position=H.p(),j.scale=H.getScale(),j.anchor=H.getAnchor(),j.rotation=H.getRotation(),N===dp&&(j._63o=e("shape.depth"));var i=0;if(N)i=ie(h,j._54o/2,j._62o),V.s("shape.dash")&&(i=k(i,(V.s("shape.dash.width")||j._54o)/2));else if(A&&A.boundExtend)if(i=zm(A.boundExtend,H,T),A.boundExtendAbsolute){var w=H.getScale();i/=T._zoom*k(1,k(z(w.x),z(w.y)))}else if(!zm(A.fitSize,H,T)){var C=zm(A.width,H,T),M=zm(A.height,H,T);i*=k(H.getWidth()/C,H.getHeight()/M)}V._40O(j,i);var F=Hp(H,T.isSelected(H)),R=e("clip.percentage");if(1>R&&(0>R&&(R=0),j.clipRect=Sr(H.getAnchorRect(),e("clip.direction"),R,F)),N){var Y=e("shape.fill.clip.percentage");1>Y&&(0>Y&&(Y=0),j.shapeClipRect=Sr(H.getAnchorRect(),e("shape.fill.clip.direction"),Y,F));var p=e("shape.foreground.clip.percentage");1>p&&(0>p&&(p=0),j.shapeForegroundClipRect=Sr(H.getAnchorRect(),e("shape.foreground.clip.direction"),p,F))}},getPosition:function(o,$,W,R){var b=Rm(o,this._83o.rect,R);return b.x+=$,b.y+=W,b},_80o:function(F){var M=this,v=M.s,i=M.gv,X=M._data,T=M._83o,Q=T.rect,L=T.position,V=T.rotation,O=T.anchor,A=T.scale,u=T.shape,D=T.clipRect;if(!M._checkEmptyRect||Q.width>0&&Q.height>0){var d=X.getSize();if(d.x=-d.width*O.x,d.y=-d.height*O.y,Uh&&!vl&&Br(F,d.width,d.height),F.save(),Br(F,L.x,L.y),Ec(F,V),fp(F,A.x,A.y),D&&(F.beginPath(),F.rect(D.x,D.y,D.width,D.height),F.clip()),i._drawForChecking&&T.img&&zm(T.img.pixelPerfect,X,i)===!1)qd(F,d.x,d.y,d.width,d.height,"#888888");else if(M.freeDraw)M.freeDraw(F,d,T);else if(u){var o,q,I,x,j=T._60o,G=pc(F,j),n=T._27Q,m=T._54o,H=T.shapeGradientPack,f=T.gray,s=F.lineJoin,W=F.lineCap,k=function(S){return f?r.toGrayColor(S):S};"roundRect"===u?o=v("shape.corner.radius"):"polygon"===u?o=v("shape.polygon.side"):"arc"===u&&(o=v("shape.arc.from"),q=v("shape.arc.to"),I=v("shape.arc.close"),x=v("shape.arc.oval")),F.lineJoin=T._62o,F.lineCap=T._61o;var K=k(T._53o);if(K||n||H){var B=T.shapeClipRect;B&&(F.save(),F.beginPath(),F.rect(B.x,B.y,B.width,B.height),F.clip()),Gk(F,u,d,o,q,I,x),H?Lo(F,H,function(Y){return hl(Y,T.bodyColor)},!1,d):n?mb(F,n,k(T.bodyColor),null,X,i):Tc(F,K,T.shapeGradient,k(T._59o),d),F.fill(),H&&F.restore(),B&&F.restore(),F!==G&&Gk(G,u,d,o,q,I,x)}else Gk(G,u,d,o,q,I,x);var J=T.shapeForeground;if(J){F.save();var Z=T.shapeForegroundClipRect;Z&&(F.beginPath(),F.rect(Z.x,Z.y,Z.width,Z.height),F.clip()),Gk(F,u,d,o,q,I,x),Tc(F,J,v("shape.foreground.gradient"),k(v("shape.foreground.gradient.color")),d),F.fill(),F.restore()}if(m>0){var a=v("shape.border.width.absolute");a&&(F.save(),F.setTransform(1,0,0,1,0,0)),F.lineWidth=m;var l=k(T._55o),_=T.shapeBorderGradientPack;_?Lo(F,_,k,!0,d):T.shapeBorderRepeatImage?Mr(F,T.shapeBorderRepeatImage,l,null,X,i):F.strokeStyle=l,F.stroke(),_&&F.restore(),a&&F.restore(),T._56o&&Mn(F,l,k(T._57o),m,i._zoom,T._58o)}if(Kd(F,j),v("shape.dash")){var R=v("shape.dash.width")||m;if(R>0){j=v("shape.dash.pattern");var G=pc(F,j,M._2Q("shape.dash.offset"));G!==F&&Gk(G,u,d,o,q,I,x),M._1Q(F,"shape",R,j)}}Yl(F,K,T._63o,d),F.lineJoin=s,F.lineCap=W}else{var E=M.interactiveInfo;E&&(F.interactiveInfo=E.bodyInfo={compInfos:[],matrix:new Ud(V,L.x,L.y,A.x,A.y)}),T.gray&&(F.compGray=!0);var t=T.img;t&&t.cacheRule!=h&&(t=Rj(F,t,T.stretch,d.width,d.height,X,i,T.bodyColor)),ms(F,t,T.stretch,d.x,d.y,d.width,d.height,X,i,T.bodyColor),F.compGray=!1,F.interactiveInfo=h}F.restore()}M._39O(F,T)},_48O:function(){},_47O:function(){}});var Ki=function(e,P){oc(Ki,this,[e,P])},ig=function(t,p,b,l){var Q=ml(t,p);return b=l?n(b,Q):$n(b,Q),Q?b/=Q:b=0,{x:t.x+(p.x-t.x)*b,y:t.y+(p.y-t.y)*b}};sr(Ki,ni,{_3O:function(){var f,O=this,w=O._data,l=O.gv,P=O.s,Q=P(Ye),L=w.isLooped(),m=P("edge.width"),j=O.getBodyColor("edge.color"),o=P("edge.center"),v=P("edge.offset"),V=l.getBorderColor(w),N=V?P("border.width"):0,U=O.getSelectWidth(),C=w._40I,D=w._41I,Z=O._78o=C&&D?{looped:L,type:Q,width:m,center:o,color:j,repeatImage:Tj(P("edge.repeat.image"),j),borderColor:V,borderWidth:N,_97o:U?O.getSelectColor():h,selectWidth:U,pattern:P("edge.pattern"),cap:P("edge.cap"),join:P("edge.join"),is3d:P("edge.3d"),_67o:P("edge.3d.color"),_66o:P("edge.3d.accuracy"),gray:P("2d.gray")}:h;if(Z){var M=r.getEdgeType(Q);if(M){var z=M(w,cr(O,l,w,L,Q),l,O._19Q);z.points&&z.points.size()>1?(Z.edgeTypeInfo=z,f=Jk(Z.edgeTypeInfo.points)):z[di]&&z.rect&&(Z.edgeTypeInfo=z,f=z.rect)}else{var X=P("edge.source.anchor.x"),t=P("edge.source.anchor.y"),H=P("edge.target.anchor.x"),x=P("edge.target.anchor.y"),W=Zi(l,w,"source"),R=Zi(l,w,"target");if(Q===Bb){var n=Z.points=P(wm)||Yo,c=n.size();Z.segments=P("edge.segments");var I=X!==A||t!==A||vm(C),T=H!==A||x!==A||vm(D);if(!o)if(v)I||(W=ig(W,c?n.get(0):R,v,c)),T||(R=ig(R,c?n.get(c-1):W,v,c));else{var J;I||(J=Wj(W,c?n.get(0):R,Gr(l,C)),J&&(W={x:J[0],y:J[1]})),T||(J=Wj(c?n.get(c-1):W,R,Gr(l,D)),J&&(R={x:J[0],y:J[1]}))}f=Pf(Jk(Z.points),Jk(W,R))}else{var b=cr(O,l,w,L,Q);if(O._19Q||(b=-b),L)W=Bi(W),W.x=l.getNodeRect(C).x,Z.radius=b,f={x:W.x-b,y:W.y-b,width:2*b,height:2*b};else{var _=ml(W,R),S=$n(v,_),G={x:S,y:b},Y={x:_-S,y:b},u=tj(R.y-W.y,R.x-W.x),s=Z.mat=new Kb(u);if(Z.orienAngle=u,Z.angle=R.x<W.x?u+g:u,Z.rect={x:G.x,y:G.y,width:Y.x-G.x,height:0},Z.origin=W,G=s.tf(G),G.x+=W.x,G.y+=W.y,Y=s.tf(Y),Y.x+=W.x,Y.y+=W.y,o){var $={x:_,y:0};$=s.tf($),$.x+=W.x,$.y+=W.y,f=Jk([W,G,Y,$]),Z.c1=W,Z.c2=$}else f=Jk(G,Y);W=G,R=Y}}Z.sourcePoint=W,Z.targetPoint=R,w._lastSourcePoint=W,w._lastTargetPoint=R}var y=0;P("edge.dash")&&(y=P("edge.dash.width")||m);var i="square"===Z.cap?.71:.5;ie(f,k(y*i,m*i+N+U),Z.join),O._68o(f)}},getRotation:function(t,F,n){t=t||0;var O=this._78o;if(O){var J,$=O.angle,j=O.points,u=O.edgeTypeInfo;if($!=h)return F?O.orienAngle+t:$+t;if(u&&u[di])return u.getRotation?u.getRotation(this,t,F,n):0;if(u&&u.points){var a=u.points;return J=a.size(),qq[n]?J&&0===J%2?Ko(a.get(J/2-1),a.get(J/2),F,t):t:Vf[n]?Ko(a.get(0),a.get(1),F,t):Ko(a.get(J-2),a.get(J-1),F,t)}if(j)return J=j.size(),qq[n]?J&&0===J%2?Ko(j.get(J/2-1),j.get(J/2),F,t):t:Vf[n]?Ko(O.sourcePoint,J?j.get(0):O.targetPoint,F,t):Ko(J?j.get(J-1):O.sourcePoint,O.targetPoint,F,t)}return t},getPosition:function(O,H,V,g,q){var X=this._78o;if(X){var P,x=X.type,N=X.points,m=X.edgeTypeInfo,B=X.sourcePoint,M=X.targetPoint;if(!x)return X.looped?{x:B.x-X.radius+H,y:B.y+V}:(q&&B&&M&&(B.x>M.x||B.x===M.x&&B.y>M.y)&&(O=Km[O],V=-V),P=Rm(O,X.rect,g),P.x+=H,P.y+=V,P=X.mat.tf(P),P.x+=X.origin.x,P.y+=X.origin.y,P);if(m&&m[di])return m.getPosition?m.getPosition(this,O,H,V,g,q):{x:(B.x+M.x)/2,y:(B.y+M.y)/2};if(N){var P,f=N.size();if(qq[O]){if(f){var w=f%2;if(0===w)return ki(N.get(f/2-1),N.get(f/2),O,H,V,g,q);P=N.get((f-w)/2)}else P={x:(B.x+M.x)/2,y:(B.y+M.y)/2};return P=Rm(O,{x:P.x,y:P.y,width:0,height:0},g),P.x+=H,P.y+=V,P}return Vf[O]?ki(B,f?N.get(0):M,O,H,V,g,q):ki(f?N.get(f-1):B,M,O,H,V,g,q)}if(m){var J=m.points,f=J.size();if(qq[O]){var w=f%2;return 0===w?ki(J.get(f/2-1),J.get(f/2),O,H,V,g,q):(P=J.get((f-w)/2),P=Rm(O,{x:P.x,y:P.y,width:0,height:0},g),P.x+=H,P.y+=V,P)}return Vf[O]?ki(J.get(0),J.get(1),O,H,V,g,q):ki(J.get(f-2),J.get(f-1),O,H,V,g,q)}}return dq},_42:function(z){this._78o&&Ki.superClass._42.call(this,z)},drawPath:function(Q,I){Q.beginPath();var R=I.type,M=I.points,V=I.segments,k=I.edgeTypeInfo;if(!R||M){var r=I.sourcePoint,D=r.x,H=r.y,W=I.targetPoint,C=W.x,c=W.y;if(R)if(V){var g=new zc({x:D,y:H});g.addAll(M),g.add({x:C,y:c}),Nm(Q,g,V)}else Q.moveTo(D,H),M.each(function(Z){Q.lineTo(Z.x,Z.y)}),Q.lineTo(C,c);else I.looped?Q.arc(D,H,I.radius,0,S,!0):I.center?(Q.moveTo(I.c1.x,I.c1.y),Q.lineTo(D,H),Q.lineTo(C,c),Q.lineTo(I.c2.x,I.c2.y)):(Q.moveTo(D,H),Q.lineTo(C,c))}else k&&(k.points?Nm(Q,k.points,k.segments):k[di]&&k[di](Q,k))},_80o:function(J){var h=this,U=h.s,M=h._78o,A=M.width,K=M.selectWidth,N=M.borderWidth,j=M.repeatImage,b=J.lineJoin,a=J.lineCap,Q=M.gray,e=M.pattern;J.lineJoin=M.join,J.lineCap=M.cap,h.drawPath(pc(J,e),M);var y=U("edge.width.absolute");y&&(J.save(),J.setTransform(1,0,0,1,0,0)),K&&(J.strokeStyle=M._97o,J.lineWidth=A+2*(N+K),J.stroke()),N&&(J.strokeStyle=Q?r.toGrayColor(M.borderColor):M.borderColor,J.lineWidth=A+2*N,J.stroke());var S=Q?r.toGrayColor(M.color):M.color;if(j?Mr(J,j,S,null,h._data,h.gv):J.strokeStyle=S,J.lineWidth=A,J.stroke(),M.is3d){var Z=Q?r.toGrayColor(M._67o):M._67o;Mn(J,S,Z,A,h.gv._zoom,M._66o)}if(Kd(J,e),U("edge.dash")){e=U("edge.dash.pattern");var E=pc(J,e,h._2Q("edge.dash.offset"));E!==J&&h.drawPath(E,M),h._1Q(J,"edge",U("edge.dash.width")||A,e)}y&&J.restore(),J.lineJoin=b,J.lineCap=a},_48O:function(){},_47O:function(){}});var oe=function(_,V){oc(oe,this,[_,V])};sr(oe,Go,{_3O:function(){var t,N,s=this,$=s.s,K=s._data,e=s.gv;if(s._88I=h,K.isExpanded()&&K.eachChild(function(K){if(nf(K)){var z=e.getBoundsForGroup(K);z&&(N||(N=[]),N.push(z),t=Pf(t,z))}}),t){var w=e.getLabel(K),P=$("group.type"),y=$("group.border.width")||0,d=$("group.border.width.absolute"),k=y/2;d&&(y/=e._zoom),t=pj(P,N,t),yn(t,K,"group.padding",1),sk(t,y);var V=s._88I={type:P,rect:t,_64o:t};if(!P&&w!=h){var B,R=s.labelInfo={label:w,color:$("group.title.color"),font:$("group.title.font"),align:$("group.title.align")},U=xr(R,w),F=U.width+y,i=U.height+y,E=$("group.title.align"),q=$("group.title.orientation");if(q===xo||q===dc?(t.height+=y,F>t.width&&(t.width=F)):(q===tq||q===_h)&&(t.width+=y,F>t.height&&(t.height=F)),B=E===tq?t.x:E===_h?t.x+t.width-F:t.x+t.width/2-F/2,q===dc)V.titleRect={x:t.x,y:t.y+t.height,width:t.width,height:i},V.rect={x:t.x,y:t.y,width:t.width,height:t.height+i},R.rect={x:B,y:t.y+t.height,width:F,height:i};else if(q===tq){var u=V.titleRect={x:t.x-i,y:t.y,width:i,height:t.height};V.rect={x:t.x-i,y:t.y,width:t.width+i,height:t.height},R.rect={x:u.x+i/2-t.height/2,y:u.y+t.height/2-i/2,width:t.height,height:i},R.rotation=-Math.PI/2}else if(q===_h){var u=V.titleRect={x:t.x+t.width,y:t.y,width:i,height:t.height};V.rect={x:t.x,y:t.y,width:t.width+i,height:t.height},R.rect={x:u.x+i/2-t.height/2,y:u.y+t.height/2-i/2,width:t.height,height:i},R.rotation=Math.PI/2}else V.titleRect={x:t.x,y:t.y-i,width:t.width,height:i},V.rect={x:t.x,y:t.y-i,width:t.width,height:t.height+i},R.rect={x:B,y:t.y-i-k,width:F,height:i+y}}s._40O(V,$("group.border.width")/2)}else oe.superClass._3O.call(s)},getPosition:function(P,B,N,K){var L=this._88I;if(L){var R=Rm(P,L.rect,K);return R.x+=B,R.y+=N,R}return oe.superClass.getPosition.apply(this,arguments)},_24O:function(Q,J){var H=this._88I;(!H||H.type||"label2"===Q)&&oe.superClass._24O.call(this,Q,J)},_80o:function(I){var s=this,W=s._88I;if(W){var L=s._data,U=s.s,b=s.gv,Y=W.type,c=W.rect,d=W._64o,Q=W.titleRect,J=s.getBodyColor(),y=Tj(U("group.image"),J),r=U("group.image.stretch"),G=s.getBodyColor("group.background"),o=Tj(U("group.repeat.image"),J),R=U("group.gradient.pack"),V=U("group.gradient"),S=U("group.gradient.color"),E=U("group.border.width"),N=U("group.border.color"),F=U("group.border.pattern"),x=U("group.title.orientation"),M=U("group.depth"),n=U("group.border.radius"),O=U("group.border.join"),f=U("group.border.cap"),A=U("group.border.width.absolute");
A&&(E/=b._zoom);var w=N,H=U("group.border.repeat.image");if(H&&(H=Tj(H,N))&&(w=Ad(I,H,N,null,L,b)),Y){var Z=I.lineJoin,$=I.lineCap;if(I.lineJoin=O,I.lineCap=f,y){if(I.save(),Gk(I,Y,c,n),I.clip(),ms(I,y,r,c.x,c.y,c.width,c.height,L,b,J),I.restore(),E>0){var a=pc(I,F);Gk(a,Y,c,n),I.lineWidth=E,I.strokeStyle=w,I.stroke(),Kd(I,F)}}else{var a=pc(I,F);G||o||R?(Gk(I,Y,c,n),R?Lo(I,R,function(R){return hl(R,J)},!1,c):o?mb(I,o,J,null,L,b):Tc(I,G,V,S,c),I.fill(),R&&I.restore(),I!==a&&Gk(a,Y,c,n)):Gk(a,Y,c,n),E>0&&(I.lineWidth=E,I.strokeStyle=w,I.stroke()),Kd(I,F),Y===dp&&Yl(I,G,M,c)}I.lineJoin=Z,I.lineCap=$}else{var t=U("group.title.background");if((!n||0>n)&&(n=0),y)ms(I,y,r,d.x,d.y,d.width,d.height,L,b,s.getBodyColor());else if(G||o)if(o?mb(I,o,J,null,L,b):Tc(I,G,V,S,d),0===E)Gk(I,dp,d),I.fill(),Yl(I,G,M,d);else{switch(I.beginPath(),x){case dc:Bd(I,d.x,d.y,d.width,d.height,n,n,0,0);break;case tq:Bd(I,d.x,d.y,d.width,d.height,0,n,0,n);break;case _h:Bd(I,d.x,d.y,d.width,d.height,n,0,n,0);break;case xo:Bd(I,d.x,d.y,d.width,d.height,0,0,n,n)}I.fill()}if(Q&&t)if(0===E)qd(I,Q.x,Q.y,Q.width,Q.height,t),Yl(I,t,M,Q);else{switch(I.beginPath(),I.fillStyle=t,x){case dc:Bd(I,Q.x,Q.y,Q.width,Q.height,0,0,n,n);break;case tq:Bd(I,Q.x,Q.y,Q.width,Q.height,n,0,n,0);break;case _h:Bd(I,Q.x,Q.y,Q.width,Q.height,0,n,0,n);break;case xo:Bd(I,Q.x,Q.y,Q.width,Q.height,n,n,0,0)}I.fill()}if(E>0){var a=pc(I,F);if(Gk(a,"roundRect",c,n),I.save(),I.lineWidth=E,I.strokeStyle=w,I.lineJoin=O,I.lineCap=f,I.closePath(),I.stroke(),Q&&U("group.splitLine")){var m=Q.x,P=Q.y,T=Q.width,p=Q.height;I.beginPath(),x===dc?(I.moveTo(m,P),I.lineTo(m+T,P)):x===tq?(I.moveTo(m+T,P),I.lineTo(m+T,P+p)):x===_h?(I.moveTo(m,P),I.lineTo(m,P+p)):(I.moveTo(m,P+p),I.lineTo(m+T,P+p))}I.stroke(),I.restore(),Kd(a,F)}}s._39O(I,W)}else oe.superClass._80o.call(s,I)}});var Md=function(E,r){oc(Md,this,[E,r])};sr(Md,Go,{_80o:function(G){this._39O(G,this._83o)}});var vb=function(J,o){oc(vb,this,[J,o])};sr(vb,Go,{_3O:function(){var u=this,g=u._data,M=u.s,R=u.gv,B=g.getPoints(),P=R.getBorderColor(g),W=P?M("border.width"):0,v=u.getSelectWidth(),T=M("shape.border.width"),L=g.getRect(),t=g.getAnchorRect(),Z=R.getBodyColor(g),m=M("shape.border.color"),d=u._99o=B.isEmpty()?h:{rect:L,rotation:g.getRotation(),fillRule:M("shape.fill.rule"),scale:g.getScale(),position:g.p(),points:B,segments:g.getSegments(),bodyColor:Z,borderColor:P,borderWidth:W,_94o:M("shape.border.3d"),_95o:M("shape.border.3d.color"),_96o:M("shape.border.3d.accuracy"),_97o:v?u.getSelectColor():h,selectWidth:v,_53o:M("shape.background"),_27Q:Tj(M("shape.repeat.image"),Z),shapeGradientPack:M("shape.gradient.pack"),shapeBorderGradientPack:M("shape.border.gradient.pack"),_54o:T,_55o:m,shapeBorderRepeatImage:Tj(M("shape.border.repeat.image"),m),shapeGradient:M("shape.gradient"),_59o:M("shape.gradient.color"),_60o:M("shape.border.pattern"),_61o:M("shape.border.cap"),_62o:M("shape.border.join"),shapeForeground:M("shape.foreground"),gray:M("2d.gray")};if(d){t.x+=d.position.x,t.y+=d.position.y,d.gradientRect=t;var e=g.getScale(),q=k(1,k(z(e.x),z(e.y)));M("shape.dash")&&M("shape.dash.width")>T&&(T=M("shape.dash.width"));var G,I=M("shape.border.width.absolute");G=I?(T+W+v)/u.gv._zoom/q:T*("square"===d._61o?.71:.5)+W+v/u.gv._zoom/q,G&&(G*=q,L=Bi(L),ie(L,G,d._62o)),u._68o(L);var n=Hp(g,R.isSelected(g)),w=M("clip.percentage");1>w&&(0>w&&(w=0),d.clipRect=Sr(g.getAnchorRect(),M("clip.direction"),w,n));var V=M("shape.fill.clip.percentage");1>V&&(0>V&&(V=0),d.shapeClipRect=Sr(g.getAnchorRect(),M("shape.fill.clip.direction"),V,n));var o=M("shape.foreground.clip.percentage");1>o&&(0>o&&(o=0),d.shapeForegroundClipRect=Sr(g.getAnchorRect(),M("shape.foreground.clip.direction"),o,n))}},getPosition:function(W,E,Y,b){var e=this._99o;if(e){var J=Rm(W,e.rect,b);return J.x+=E,J.y+=Y,J}return dq},_42:function(I){this._99o&&vb.superClass._42.call(this,I)},_80o:function(U){var P,s=this,o=s.s,S=s._99o,_=S.position,d=S.scale,H=S.rotation,Z=S.borderWidth,i=S.selectWidth/s.gv._zoom,k=S._27Q,u=S.shapeGradientPack,Q=S._54o,M=S.clipRect,C=S.shapeClipRect,D=S.points,W=S.segments,I=s._data.isClosePath(),b=S.fillRule,f=S.gray,m=function(D){return f?r.toGrayColor(D):D},j=m(S._53o),E=j||k||u;U.save(),Br(U,_.x,_.y),Ec(U,H),fp(U,d.x,d.y),M&&(U.beginPath(),U.rect(M.x,M.y,M.width,M.height),U.clip()),E&&C&&(U.save(),U.beginPath(),U.rect(C.x,C.y,C.width,C.height),U.clip()),L.Default.extractShapeTranslation?(D=Bi(D),D.forEach(function(P){P.x-=_.x,P.y-=_.y})):Br(U,-_.x,-_.y);var c=S._60o,F=pc(U,c),w=U.lineJoin,Y=U.lineCap;U.lineJoin=S._62o,U.lineCap=S._61o;var g=m(S.bodyColor);E?(Nm(U,D,W,I),u?Lo(U,u,function(i){return hl(i,S.bodyColor)},!1,S.rect):k?mb(U,k,g,null,s._data,s.gv):(P=g?g:j,Tc(U,P,S.shapeGradient,m(S._59o),S.gradientRect)),U.fill(b),u&&U.restore(),C&&(U.restore(),Br(U,-_.x,-_.y)),F!==U&&Nm(F,D,W,I)):Nm(F,D,W,I);var A=S.shapeForeground;if(A){U.save();var R=S.shapeForegroundClipRect;R&&(Br(U,_.x,_.y),U.beginPath(),U.rect(R.x,R.y,R.width,R.height),U.clip(),Br(U,-_.x,-_.y)),Nm(U,D,W,I),Tc(U,A,o("shape.foreground.gradient"),m(o("shape.foreground.gradient.color")),S.gradientRect),U.fill(b),U.restore()}var z=o("shape.border.width.absolute");if(z&&(U.save(),U.setTransform(1,0,0,1,0,0)),i&&(U.strokeStyle=S._97o,U.lineWidth=Q+2*(Z+i),U.stroke()),Z&&(U.strokeStyle=m(S.borderColor),U.lineWidth=Q+2*Z,U.stroke()),Q){P=m(S._55o);var T=S.shapeBorderGradientPack;T?Lo(U,T,m,!0,S.rect):S.shapeBorderRepeatImage?Mr(U,S.shapeBorderRepeatImage,P,null,s._data,s.gv):(!j&&g&&(P=g),U.strokeStyle=P),U.lineWidth=Q,U.stroke(),T&&U.restore(),S._94o&&Mn(U,P,m(S._95o),Q,s.gv._zoom,S._96o)}if(Kd(U,c),o("shape.dash")){var V=o("shape.dash.width")||Q;if(V>0){c=o("shape.dash.pattern");var F=pc(U,c,s._2Q("shape.dash.offset"));F!==U&&Nm(F,D,W,I),s._1Q(U,"shape",V,c)}}z&&U.restore(),U.lineJoin=w,U.lineCap=Y,U.restore()},_48O:function(){},_47O:function(){}});var pn=function(K,M){oc(pn,this,[K,M])};sr(pn,vb,{getRotation:function(x,V,W){x=x||0;var C=this._data.getPoints(),c=C.size();return c>1?qq[W]?c&&0===c%2?Ko(C.get(c/2-1),C.get(c/2),V,x):x:Vf[W]?Ko(C.get(0),C.get(1),V,x):Ko(C.get(c-2),C.get(c-1),V,x):x},getPosition:function(i,A,V,X,U){var S=this._data.getPoints(),H=S.size();if(H>1){if(qq[i]){var O=H%2;if(0===O)return ki(S.get(H/2-1),S.get(H/2),i,A,V,X,U);var $=S.get((H-O)/2),h={x:$.x,y:$.y,width:0,height:0};return $=Rm(i,h,X),$.x+=A,$.y+=V,$}return Vf[i]?ki(S.get(0),S.get(1),i,A,V,X,U):ki(S.get(H-2),S.get(H-1),i,A,V,X,U)}return dq}});var uh=function(B,K){oc(uh,this,[B,K])};sr(uh,Go,{_3O:function(){var r=this;uh.superClass._3O.call(r);var b=r.s,X=r._83o;r._82o=X.img||X.shape?h:{background:r.getBodyColor("grid.background"),depth:b("grid.depth"),rect:X.rect,_88o:b("grid.cell.depth"),cellBorderColor:b("grid.cell.border.color"),_89o:b("grid.row.count"),_90o:b("grid.column.count"),block:b("grid.block"),_91o:b("grid.block.color"),_92o:b("grid.block.padding"),_93o:b("grid.block.width")}},_80o:function(O){var J=this,s=J._82o;if(!s)return uh.superClass._80o.call(J,O),void 0;var R,$,d=J._data,P=s.background,K=s.rect,C=s.block,e=s._91o,B=s._92o,M=s._93o,m=s._88o,n=s.cellBorderColor,w=s._89o,S=s._90o;if(P)if(qd(O,K.x,K.y,K.width,K.height,P),Yl(O,P,s.depth,K),m)for(R=0;w>R;R++)for($=0;S>$;$++)K=d.getCellRect(R,$),K&&Yl(O,P,m,K);else if(n){for(O.beginPath(),R=0;w>R;R++)for($=0;S>$;$++)K=d.getCellRect(R,$),K&&O.rect(K.x,K.y,K.width,K.height);O.strokeStyle=n,O.lineWidth=1,O.stroke()}if("h"===C)for(R=0;w>R;R++)K=Pf(d.getCellRect(R,0),d.getCellRect(R,S-1)),sk(K,B),wh(O,e,K.x,K.y,K.width,K.height,M);else if("v"===C)for($=0;S>$;$++)K=Pf(d.getCellRect(0,$),d.getCellRect(w-1,$)),sk(K,B),wh(O,e,K.x,K.y,K.width,K.height,M);J._39O(O,J._83o)}});var Rd=function(r,V){oc(Rd,this,[r,V])};sr(Rd,Go,{_checkEmptyRect:!1,_81o:function(){var e=this._data,t=Rd.superClass._81o.call(this),S=e.s("text");if(S!=h){var J,Z,i=e.s("text.font"),I=e.s("text.align"),E=e.s("text.vAlign"),m=Ne(i,S),n=m.width,s=m.height,K=e.getAnchor(),p=e.getWidth(),D=e.getHeight();"left"===I?J=-p*K.x:"center"===I?J=-p*K.x+(p-n)/2:"right"===I&&(J=p*(1-K.x)-m.width),"top"===E?Z=-D*K.y:"middle"===E?Z=-D*K.y+(D-s)/2:"bottom"===E&&(Z=D*(1-K.y)-m.height);var T,x=e.getMatrix();if(T=Jk([x.tf(J,Z),x.tf(J+n,Z),x.tf(J+n,Z+s),x.tf(J,Z+s)]),t=Pf(t,T),t&&e.s("text.shadow")){var H=Bi(t);H.x+=e.s("text.shadow.offset.x"),H.y+=e.s("text.shadow.offset.y"),sk(H,e.s("text.shadow.blur")),t=Pf(t,H)}}return t}});var gm=Rr.Interactor=function(u){this.gv=this._graphView=u};zp("Interactor",U,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners(),this.clear()},clear:function(){},fi:function(b){this.gv.fi(b)},setCursor:function(d){Xq||this.gv.setCursor(d)},startDragging:function(P){var L=this;L._lastClientPoint=ao(P),L._lastLogicalPoint=L.gv.lp(P),Qb(L,P)},clearDragging:function(){var O=this;O._lastClientPoint=O._lastLogicalPoint=O._logicalPoint=h},autoScroll:function(P){return this.gv.autoScroll(P,this._lastClientPoint)}});var ze=h,ck=function(i){ze.handleWindowTouchMove(i)},In=function(x){ze.handleWindowTouchEnd(x),D(c,pr,ck),D(c,hr,In),ze=h},Lr=function(P){ze.handleWindowMouseMove(P)},Fi=function(Y){ze.handleWindowMouseUp(Y),D(c,Jl,Lr),D(c,dn,Fi),ze=h},mp=function(b,W){if(b!==ze){var J=Qp(W);ze?J?ze.handleWindowTouchEnd(W):ze.handleWindowMouseUp(W):J?(C(c,pr,ck),C(c,hr,In)):(C(c,Jl,Lr),C(c,dn,Fi)),ze=b}},dj=function(m){var F=this;F.gv=m,F._is2d=m instanceof Rr.GraphView,F._eventListeners={},["mousedown","mousemove","mouseleave","touchstart","touchmove",en,"wheel"].forEach(function(J){F.addListener(J)}),F.initImageResource()};sr(dj,gm,{enableVR:function(G){var v=this;!!v._vrEnable!==G&&(v._vrEnable=G,G?v.gv.vr.mp(v.onVRControllerChange,v):v.gv.vr.ump(v.onVRControllerChange,v))},onVRControllerChange:function(W){var u=this,J=W.property,v=W.newValue,N=v.id,A=u.gv.vr.getController(N),K=A.getRay();if(K){K.controllerId=N;var U=u.gv.vr.getRayEventType(K,J,v._62O);switch(U){case"down":u.handle_mousedown(K);break;case"up":ze&&Fi(K);break;case"move":u.handle_mousemove(K),ze&&u.handleWindowMouseMove(K)}}},setPreventEventDefault:function(V,X){var b=this,P=b._eventListeners[V];P?P._prevent=X:b._eventListeners[V]=P={_removal:A,_prevent:X}},removeListener:function(E){var S=this,Z=S._eventListeners[E];Z&&Z._removal&&(Z._removal(),Z._removal=A)},addListener:function(X){var H=this,b=H._eventListeners[X];if(b||(H._eventListeners[X]=b={_removal:A,_prevent:!0}),!b||!b._removal){var O=function(i){b._prevent&&r.preventDefault(i),H.disabled||H.gv._48Q||("wheel"===X?lf(H,i):H["handle_"+X](i))};C(H.gv.getView(),X,O),b._removal=function(){D(H.gv.getView(),X,O)}}},handleWindowTouchMove:function(z){this.handleWindowMouseMove(z)},handleWindowMouseMove:function(Q){return!this.downInfo||Qp(Q)&&1!==kl(Q)?(this.isDragging&&(this.handleDownInfo("onEndDrag",Q),this.isDragging=!1),void 0):(this.isDragging?this.handleDownInfo("onDrag",Q):(this.handleDownInfo("onBeginDrag",Q),this.isDragging=!0),void 0)},handleWindowTouchEnd:function(q){this.handleWindowMouseUp(q)},handleWindowMouseUp:function(Y){if(this.isDragging&&(this.handleDownInfo("onEndDrag",Y),this.isDragging=!1),this.downInfo){var z=this.handle("onUp",Y);if(z&&z.data===this.downInfo.data){this.handleMissingUp(Y);var Z=this,p=2===Y.button?"onContextMenu":"onClick";if(!Z._dbclickTimer)return Z._dbclickTimer=gj(function(){delete Z._dbclickTimer,Z.handleClick(Y,p,z),this.downInfo=h},r.clickDelay),void 0;Wb(Z._dbclickTimer),delete Z._dbclickTimer,p="onDoubleClick",Z.handleClick(Y,p,z)}else this.handleDownInfo("onUp",Y);this.downInfo=h,this.downComps=h}},handle_mouseleave:function(l){var z=this,q=z.gv;z._hoverTimer&&(Wb(z._hoverTimer),delete z._hoverTimer);var $=z.currentInfo?z.currentInfo.data:h;if($){$.s("onLeave")&&$.s("onLeave")(l,$,q),z.fire("data","onLeave",l,$);var Y=z.currentInfo?z.currentInfo.hits:h;if(Y)for(var k in Y)z.handleLeave(l,k);z.currentInfo=h}},handle_mousewheel:function(u){u.scrollDelta=u.wheelDelta/40,this.handle("onScroll",u)},handle_DOMMouseScroll:function(t){t.scrollDelta=2===t.axis?-t.detail:0,this.handle("onScroll",t)},handle_touchstart:function(n){this.handle_mousedown(n)},handle_touchmove:function(F){this.handle("onMove",F)},handle_mousedown:function(i){this.isDragging&&(this.handleDownInfo("onEndDrag",i),this.isDragging=!1),this.downComps=[],this.downInfo=this.handle("onDown",i),this.downInfo&&mp(this,i)},handle_mousemove:function(Q){var b=this,e=b.gv;if(b._hoverTimer&&(Wb(b._hoverTimer),delete b._hoverTimer),!e._panning&&!e._moving){var w,j,u,t=b.handle("onMove",Q),G=this.currentInfo?this.currentInfo.data:h,k=this.currentInfo?this.currentInfo.hits:h;if(t&&(j=t.data,u=t.hits,b._hoverTimer=gj(function(){Wb(b._hoverTimer),delete b._hoverTimer,b.handle("onHover",Q,t)},e.getHoverDelay()||r.hoverDelay)),j!==G){if(G&&(G.s("onLeave")&&G.s("onLeave")(Q,G,e),this.fire("data","onLeave",Q,G)),j&&(j.s("onEnter")&&j.s("onEnter")(Q,j,e),this.fire("data","onEnter",Q,j)),k)for(w in k)this.handleLeave(Q,w);if(u)for(w in u){var s=u[w],$=j._interactPrefix=s.prefix,P=$&&j.a($+"onEnter")||s.target.onEnter;P&&P.call(s.target,Q,j,e,s.point,s.width,s.height),this.fire(s.type,"onEnter",s.event,s.data,s.image,s.comp,s.point,s),j._interactPrefix=null}}else{if(k)for(w in k)u&&u[w]||this.handleLeave(Q,w);if(u)for(w in u)if(!k||!k[w]){var s=u[w],$=j._interactPrefix=s.prefix,P=$&&j.a($+"onEnter")||s.target.onEnter;P&&P.call(s.target,Q,j,e,s.point,s.width,s.height),this.fire(s.type,"onEnter",s.event,s.data,s.image,s.comp,s.point,s),j._interactPrefix=null}}this.currentInfo=t}},handle:function(d,H,t){var a,k=this,K=k.gv;if(k._is2d){if(t=t||K.getDataInfoAt(H),!t||!K.isInteractive(t.data))return;if(a=t.ui.interactiveInfo){var z,Y=t.data;if(Y.s(d)&&Y.s(d)(H,Y,K),this.fire("data",d,H,Y),"body"===t.part&&a.bodyInfo)z="body",t.hits=this.handleImage(z,K.getImage(Y),d,H,Y,t.point,a.bodyInfo);else if("icons"===t.part&&a._38o){var O=a._38o[t.name];O&&O[t.index]&&(z="icons|"+t.name+"|"+t.index,t.hits=this.handleImage(z,t.icon,d,H,Y,t.point,O[t.index]))}}return t}var Y,M;if(!t)if(H&&H instanceof L.Math.Ray&&K.isVREnabled()){var Q=K.vr.intersectWorld(H);if(Y=Q.data,M=Q.intersect,K.vr.renderRayDuringInteraction(H,Y,M),!Y)return;var r=K.getData3dUI(Y);if(a=r.interactiveInfo,!a)return;t={data:Y,part:M.part,ui:r}}else{if(t=K.getDataInfoAt(H),!t)return;t&&(t={data:t.data,part:t.part})}if(K.isInteractive(t.data)){if(!M){Y=t.data;var r=K.getData3dUI(Y);if(t.ui=r,a=r.interactiveInfo,!a)return t;if(M=K.intersectObject(H,Y),!M)return}Y.s(d)&&Y.s(d)(H,Y,K),this.fire("data",d,H,Y);var g,c=M.part;return"body"!==c&&(g=Y.s(c+".image")||Y.s("shape3d."+c+".image")),g||(g=Y.s("all.image")||Y.s("shape3d.image")),g?(a="object"==typeof g?a[g.uuid]:a[g],a&&a.bodyInfo?(t.part="body",t.interactiveInfo=a,t.point=this._convertUVToPoint(M.uv,a),t.image=g,t.hits=this.handleImage("body",g,d,H,Y,t.point,a.bodyInfo),t):t):t}},_handleLeaveOrMissing:function(q,V,g){var G="leave"===q?this.currentInfo:this.downInfo;if(G){var j=G.interactiveInfo||G.ui.interactiveInfo;if(j){var _,z,n=G.data;if(this._is2d){if(z=this.gv.lp(V),"body"===G.part&&j.bodyInfo)_="body","leave"===q?this.handleLeaveImage(g,_,this.gv.getImage(n),V,n,z,j.bodyInfo):this.handleMissingUpImage(_,this.gv.getImage(n),V,n,z,j.bodyInfo);else if("icons"===G.part&&j._38o){var O=j._38o[G.name];O&&O[G.index]&&(_="icons|"+G.name+"|"+G.index,"leave"===q?this.handleLeaveImage(g,_,G.icon,V,n,z,O[G.index]):this.handleMissingUpImage(_,G.icon,V,n,z,O[G.index]))}}else{if(!j.bodyInfo)return;var Z=this.gv.intersectObject(V,n);z=Z&&Z.uv?this._convertUVToPoint(Z.uv,j):{x:1/0,y:1/0},"leave"===q?this.handleLeaveImage(g,"body",G.image,V,n,z,j.bodyInfo):this.handleMissingUpImage("body",G.image,V,n,z,j.bodyInfo)}}}},handleClick:function(e,u,a){var f=this,S=this.downInfo;if(S&&a){var j,g=a.interactiveInfo||a.ui.interactiveInfo,R=a.data,t=this.gv;if(R.s(u)&&R.s(u)(e,R,t),f.fire("data",u,e,R),g)if(this._is2d){if(S.part===a.part){var I=t.lp(e);"body"===a.part&&g.bodyInfo&&(j="body",this.handleClickImage(j,t.getImage(R),u,e,R,I,g.bodyInfo,a))}}else{if(!g.bodyInfo)return;var D=t.intersectObject(e,R);if(!D)return;I=this._convertUVToPoint(D.uv,g),this.handleClickImage("body",S.image,u,e,R,I,g.bodyInfo,a)}}},handleDownInfo:function(h,U){if(this.downInfo){var G=this.downInfo,M=this.gv,v=G.interactiveInfo||G.ui.interactiveInfo;if(v){var $,l=G.data;if(l.s(h)&&l.s(h)(U,l,M),this.fire("data",h,U,l),this._is2d){var D=M.lp(U);if("body"===G.part&&v.bodyInfo)$="body",this.handleDownInfoImage($,M.getImage(l),h,U,l,D,v.bodyInfo);else if("icons"===G.part&&v._38o){var n=v._38o[G.name];n&&n[G.index]&&($="icons|"+G.name+"|"+G.index,this.handleDownInfoImage($,G.icon,h,U,l,D,n[G.index]))}}else{if(!v.bodyInfo)return;var d=M.intersectObject(U,l);if(!d)return;D=this._convertUVToPoint(d.uv,v),this.handleDownInfoImage("body",G.image,h,U,l,D,v.bodyInfo)}}}},fire:function(R,o,O,Q,B,p,S,m){this.gv.fi({kind:o,type:R,event:O,data:Q,image:B,comp:p,view:this.gv,point:S,width:m?m.width:A,height:m?m.height:A})},handleImage:function(l,i,g,W,x,m,F){var C={};if(i&&(i=Tj(i))){var n=this.gv,E=F.rect,z=this.convertPoint(m,F);z.inRect&&(i[g]&&i[g](W,x,n,z,E.width,E.height),this.fire("image",g,W,x,i,A,z,E),C[l+"|image"]={target:i,type:"image",image:i,data:x,event:W,point:z,width:E.width,height:E.height});for(var I,Q=F.compInfos,e=i,K=Q.length-1;K>=0;K--){var U=Q[K],L=U.comp;if(z=this.convertPoint(m,U,e,L,n,x),z.inRect){E=U.rect;var t=x._interactPrefix=U.prefix,h=t&&x.a(t+g)||L[g];if(h&&(I=h.call(L,W,x,n,z,E.width,E.height)),this.fire("comp",g,W,x,i,L,z,E),I!==!0&&(i=E.image)&&(i[g]&&(I=i[g](W,x,n,z,E.width,E.height)),this.fire("image",g,W,x,i,A,z,E)),x._interactPrefix=null,C[l+"|"+K]={target:L,type:"comp",comp:L,image:i,data:x,event:W,point:z,width:E.width,height:E.height,prefix:t},this.downComps&&this.downComps.push(L),i&&(C[l+"|"+K+"|image"]={target:i,type:"image",image:i,data:x,event:W,point:z,width:E.width,height:E.height,prefix:t}),I===!0)break}}}return C},handleLeave:function(r,X){return this._handleLeaveOrMissing("leave",r,X)},handleMissingUp:function(v){return this._handleLeaveOrMissing("missing",v)},handleLeaveImage:function(j,F,z,n,t,w,V){if(z&&(z=Tj(z))){var U=this.gv,r=V.rect,R=this.convertPoint(w,V);j===F+"|image"&&(z.onLeave&&z.onLeave(n,t,U,R,r.width,r.height),this.fire("image","onLeave",n,t,z,A,R,r));for(var u,q=V.compInfos,H=z,m=q.length-1;m>=0;m--){var K=q[m],E=K.comp;R=this.convertPoint(w,K,H,E,U,t),r=K.rect;var l=t._interactPrefix=K.prefix;if(j===F+"|"+m){var O=l&&t.a(l+"onLeave")||E.onLeave;O&&(u=O.call(E,n,t,U,R,r.width,r.height)),this.fire("comp","onLeave",n,t,z,E,R,r)}if(u!==!0&&(z=r.image)&&j===F+"|"+m+"|image"&&(z.onLeave&&(u=z.onLeave(n,t,U,R,r.width,r.height)),this.fire("image","onLeave",n,t,z,A,R,r)),t._interactPrefix=null,u===!0)break}}},handleMissingUpImage:function(F,n,E,j,H,r){var v="onUp",P=this.downInfo.hits;if(P&&n&&(n=Tj(n))){var Y=this.gv,J=r.rect,w=this.convertPoint(H,r);!w.inRect&&P[F+"|image"]&&(n[v]&&n[v](E,j,Y,w,J.width,J.height),this.fire("image",v,E,j,n,A,w,J));for(var k,N=r.compInfos,o=n,W=N.length-1;W>=0;W--){var e=N[W],_=e.comp;if(w=this.convertPoint(H,e,o,_,Y,j),!w.inRect){J=e.rect;var g=j._interactPrefix=e.prefix;if(P[F+"|"+W]){var m=g&&j.a(g+v)||_[v];m&&(k=m.call(_,E,j,Y,w,J.width,J.height)),this.fire("comp",v,E,j,n,_,w,J)}if(k!==!0&&(n=J.image)&&P[F+"|"+W+"|image"]&&(n[v]&&(k=n[v](E,j,Y,w,J.width,J.height)),this.fire("image",v,E,j,n,A,w,J)),j._interactPrefix=null,k===!0)break}}}},handleDownInfoImage:function(u,S,i,M,l,Z,C){var O=this.downInfo.hits;if(O&&S&&(S=Tj(S))){var a=this.gv,d=C.rect,I=this.convertPoint(Z,C);O[u+"|image"]&&(S[i]&&S[i](M,l,a,I,d.width,d.height),this.fire("image",i,M,l,S,A,I,d));for(var G,e=C.compInfos,p=S,H=e.length-1;H>=0;H--){var w=e[H],z=w.comp;I=this.convertPoint(Z,w,p,z,a,l),d=w.rect;var Y=l._interactPrefix=w.prefix,y=["onDrag","onEndDrag"].indexOf(i)>=0;if(!y&&O[u+"|"+H]||y&&this.downComps&&this.downComps.indexOf(z)>=0){var J=Y&&l.a(Y+i)||z[i];J&&(G=J.call(z,M,l,a,I,d.width,d.height)),this.fire("comp",i,M,l,S,z,I,d)}if(G!==!0&&(S=d.image)&&O[u+"|"+H+"|image"]&&(S[i]&&(G=S[i](M,l,a,I,d.width,d.height)),this.fire("image",i,M,l,S,A,I,d)),l._interactPrefix=null,G===!0)break}}},handleClickImage:function(C,H,h,x,T,r,B,l){var S=this.downInfo.hits,z=l.hits;if(S&&H&&(H=Tj(H))){var W=this.gv,s=B.rect,F=this.convertPoint(r,B);S[C+"|image"]&&(H[h]&&H[h](x,T,W,F,s.width,s.height),this.fire("image",h,x,T,H,A,F,s));for(var N,D=B.compInfos,m=H,p=D.length-1;p>=0;p--){var g=D[p],t=g.comp;F=this.convertPoint(r,g,m,t,W,T),s=g.rect;var _=T._interactPrefix=g.prefix;if(S[C+"|"+p]&&z[C+"|"+p]){var U=_&&T.a(_+h)||t[h];U&&(N=U.call(t,x,T,W,F,s.width,s.height)),this.fire("comp",h,x,T,H,t,F,s)}if(N!==!0&&(H=s.image)&&S[C+"|"+p+"|image"]&&(H[h]&&(N=H[h](x,T,W,F,s.width,s.height)),this.fire("image",h,x,T,H,A,F,s)),T._interactPrefix=null,N===!0)break}}},initImageResource:function(){r.setImage("coreInteractorRayHitImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",opacity:.3,rotation:-1.593,rect:[.73315,.6933,14.5337,14.61341]},{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",rotation:-1.593,rect:[3.56695,3.75073,8.8661,8.49856]}]})},_convertUVToPoint:function(S,C){if(!S)return{x:1/0,y:1/0};var Z=C.bodyInfo.rect,B=S.clone(),G=S.multiply({x:Z.width,y:Z.height});return G.local=B,G},convertPoint:function(U,E,u,Y,W,Q){var v=E.rect,j=E.matrix.applyInverse(U).sub(v),_=j.x>=0&&j.y>=0&&j.x<=v.width&&j.y<=v.height;if(!_)return j;if(Y&&zm(Y.pixelPerfect,Q,W)){var v,n=1;this._is2d?(n=W.getZoom(),v=kj(U.x,U.y,A,n)):v=kj(U.x,U.y);var G=!1,s=v.x,d=v.y,S=v.width,H=v.height,p=r.hitMaxArea,I=S*H*n*n;if(I>p){var b=Math.sqrt(p/I);n*=b}S*=n,H*=n,2>S&&(S=2),2>H&&(H=2),s*=n,d*=n;var J=Fk(S,H),$=new Ud(0,-s,-d,n,n);$.append(E.matrix),W._drawForChecking=!0,Y.transform=$;var o=u.fitSize;E.refRect&&E.refRect.fitSize?(Y.refRect=E.refRect,u.fitSize=!0):u.fitSize=!1;var P=u.comps;u.comps=[Y],Nl(J,u,0,0,S,H,Q,self),u.comps=P,u.fitSize=o,delete Y.refRect,delete Y.unionRect,delete Y.transform,W._drawForChecking=!1;try{for(var B=0,l=J.getImageData(0,0,S,H).data;B<l.length;B+=4)if(0!==l[B+3]){G=!0;break}J.restore()}catch(w){rs=h,G=!1}j.inRect=G}else j.inRect=!0;return j}});var Dk=Rr.DefaultInteractor=function(w){oc(Dk,this,[w])};zp("DefaultInteractor",gm,{handle_mousedown:function(A){ae(A);var e=this,t=e.gv,c=t.getDataAt(A);if(t.setFocus(A)&&!t._editing&&!t._scrolling){We(A)?t.handleDoubleClick(A,c):t.handleClick(A,c);var V=Hq(A);!ph()&&!V&&c&&(t.isMovable(c)||t._39Q(c))||!t.isPannable()||!Yf(A)&&!V||mj(A)||(e._tx=t.tx(),e._ty=t.ty(),e.startDragging(A))}},handleWindowMouseUp:function(u){var A=this,W=A.gv;W._panning&&(delete W._panning,W.onPanEnded(),A.fi({kind:"endPan",event:u})),delete A._tx,delete A._ty,A.clearDragging()},handle_mousemove:function(n){var I=this,g=I.gv;I._hoverTimer&&(Wb(I._hoverTimer),delete I._hoverTimer),I._hoverTimer=gj(function(){I.fi({kind:"hover",event:n}),Wb(I._hoverTimer),delete I._hoverTimer},g.getHoverDelay()||r.hoverDelay)},handle_mouseleave:function(){var y=this;y._hoverTimer&&(Wb(y._hoverTimer),delete y._hoverTimer)},handleWindowMouseMove:function(H){var k=this,s=k.gv;k.fi({kind:s._panning?"betweenPan":"beginPan",event:H}),s._panning=1;var e=Io(s,H,k._lastClientPoint);s.setTranslate(k._tx+e.x,k._ty+e.y)},handle_mousewheel:function(Q){this.gv.handleScroll(Q,Q.wheelDelta)},handle_DOMMouseScroll:function(D){2===D.axis&&this.gv.handleScroll(D,-D.detail)},handle_keydown:function(N){this.gv.handleKeyDown(N)}});var Ar=Rr.SelectInteractor=function(v){oc(Ar,this,[v])};zp("SelectInteractor",gm,{_42:function(){var R=this,N=R.gv,C=N.getZoom(),X=R.mark,i=R.div;i||(i=R.div=Sq(),Bm(R.getView(),i));var m={};m.x=X.x*C+N.tx(),m.y=X.y*C+N.ty(),m.width=X.width*C,m.height=X.height*C,xq(i,m),this.intersects()?(i.style.border="",i.style.background=N.getRectSelectBackground()):(i.style.background="",i.style.border="1px solid "+N.getRectSelectBorderColor())},handle_mousedown:function(o){var B=this,M=B.gv;if(B._57I=h,B.pendingClickThrough=h,!(M._editing||M._scrolling||ph()||Hq(o))){var e=M.getDataAt(o),_=M.sm();e?mj(o)?_.co(e)?_.rs(e):_.as(e):_.co(e)?e instanceof so&&e.isClickThroughEnabled()&&Yf(o)&&(B.pendingClickThrough=ao(o)):_.ss(e):mj(o)||!M.isPannable()?Yf(o)&&(mj(o)||_.cs(),M.isRectSelectable()&&(B.startDragging(o),M._77O=1)):Yf(o)&&(B._57I=ao(o))}},handle_mouseup:function(W){var C=this,M=C.gv,A=C._57I;if(A&&(ml(A,ao(W))<=1&&M.sm().cs(),C._57I=h),C.pendingClickThrough){if(ml(C.pendingClickThrough,ao(W))<=1){var m=M.getDataAt(W);if(m instanceof so&&m.isClickThroughEnabled()){var r=M.getDataAt(W,function(D){var h=D.getParent()===m&&M.isSelectable(D,!0);return h});r&&(W.clickThrough=!0,M.sm().ss(r))}}C.pendingClickThrough=h}},handleWindowMouseUp:function(K){this.clear(K)},handleWindowMouseMove:function(g){var F=this,K=F.gv;F._logicalPoint=K.lp(g),F.mark?(F.fi({kind:"betweenRectSelect",event:g}),K.isPannable()&&F.autoScroll(g),F.redraw()):F.fi({kind:"beginRectSelect",event:g}),F.mark=Jk(F._lastLogicalPoint,F._logicalPoint),F.redraw()},intersects:function(){var N=this,L=N._lastLogicalPoint,C=N._logicalPoint;return L.x>C.x||L.y>C.y},clear:function(p){var P=this,J=P.gv,C=P.mark;if(P._57I=h,P.pendingClickThrough=h,P._lastLogicalPoint){if(C){if(0!==C.width&&0!==C.height){var B=J.getDatasInRect(C,P.intersects());if(!B.isEmpty()){var l=J.sm(),b=l.toSelection(),w=Fr(p),G=p.altKey;B.each(function(E){l.co(E)?(!w||w&&G)&&b.remove(E):(!G||w&&G)&&b.add(E)}),l.ss(b)}}fo(P.div),delete P.div,delete P.mark,P.redraw(),P.fi({kind:"endRectSelect",event:p}),J.onRectSelectEnded()}P.clearDragging(),delete J._77O}},redraw:function(){var m=this;m._draw||(m._draw=1,gj(function(){m.mark&&m._42(),delete m._draw},16))}});var Oj=Rr.MoveInteractor=function(A){oc(Oj,this,[A])};zp("MoveInteractor",gm,{handle_mousedown:function($){var n=this,l=n.gv;if(Yf($)&&!l._editing&&!l._scrolling&&!ph()){var Q=l.getSelectedDataAt($);!Q||l._39Q(Q)&&!l.isMovable(Q)?l._focusData=h:(n._data=Q,l.handleMouseDown&&l.handleMouseDown($,Q),n.startDragging($),l.isMovable(Q)&&(l._moving=1))}},handleWindowMouseUp:function(t){var z=this,b=z.gv;b.handleMouseUp&&b.handleMouseUp(t,z._data),z.clear(t)},handleWindowMouseMove:function(N){var s=this,M=s._data,y=s.gv;if((!y._93O||!y._93O(N,M))&&y._moving){s._logicalPoint||s.fi({kind:"prepareMove",event:N});var V=s._logicalPoint?"betweenMove":"beginMove",K={kind:V,event:N},z=s._logicalPoint=y.lp(N);"beginMove"!==V||s._alreadyBeginTransaction||(s._alreadyBeginTransaction=!0,y.getDataModel().beginTransaction());var p=s._calcShift(V,N),x=p.x,c=p.y,m=s.gv.getMoveMode(N,M);m&&("x"===m?c=0:"y"===m?x=0:"xy"!==m&&(x=c=0)),y.moveSelection(x,c),s._lastLogicalPoint=z,s.autoScroll(N),s.fi(K)}},_calcShift:function(){var N=this,E=N._logicalPoint,F=N._lastLogicalPoint,H=E.x-F.x,s=E.y-F.y;return{x:H,y:s}},clear:function(O){var V=this,q=V.gv;V._lastLogicalPoint&&(V._lastLogicalPoint=V._data=q._moving=h,V._logicalPoint&&(V.fi({kind:"endMove",event:O}),q.onMoveEnded()),V.clearDragging()),V._alreadyBeginTransaction&&(V._alreadyBeginTransaction=!1,q.getDataModel().endTransaction())}});var Ld=Rr.TextEditInteractor=function(J){oc(Ld,this,[J]),this.init()};zp("TextEditInteractor",gm,{init:function(){var g=this,G=this.input=F.createElement("input"),Z=G.style;G.text="text",Z.border="1px solid #d8d8d8",Z.position="absolute",Z.padding="2px 3px",Z.outline="none",Z.marginLeft="-90px",Z.marginTop="-16px",Z.backgroundColor="rgba(255,255,255, 0.9)",Z.fontSize="14px",Z.width="180px",Z.height="32px",Z.boxShadow="0 0 13px rgba(16,142,233, 0.5)",Z.textAlign="center",Z.boxSizing="border-box",C(G,"keyup",function(v){Vc(v)&&g.endTextEdit()}),C(G,"focus",function(){G.select()});var I=this.textarea=F.createElement("textarea"),M=this.wrap=F.createElement("div");M.appendChild(I),Z=I.style,Z.margin=0,Z.padding="4px",Z.overflow="hidden",Z.boxSizing="border-box",Z.position="absolute",Z.outline="none",Z.backgroundColor="transparent",Z.resize="none",Z.textAlign="center",Z.fontSize="14px",Z.border="none",Z.borderWidth=0,Z.width="100%",Z.top="50%",Z=M.style,Z.boxSizing="border-box",Z.margin=0,Z.padding=0,Z.position="absolute",Z.boxShadow="0 0 13px rgba(16,142,233, 0.5)",Z.border="1px solid #d8d8d8",Z.backgroundColor="rgba(255,255,255, 0.9)",Z.width="180px",Z.marginLeft="-90px",C(I,"keydown",function(H){return(Fr()||mj())&&Vc(H)?(g.endTextEdit(),void 0):(g.calculateTextareaHeight(String.fromCharCode(H.keyCode)),void 0)}),C(I,"focus",function(){I.select()});var y=function(q){q.stopPropagation()};C(G,"mousedown",y),C(G,"touchstart",y),C(I,"mousedown",y),C(I,"touchstart",y),g.SIZING_STYLE=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"],g.HIDDEN_TEXTAREA_STYLE="visibility:hidden; min-height:0 !important;max-height:none !important;height:0 !important;visibility:hidden !important;overflow:hidden !important;position:absolute !important;z-index:-1000 !important;top:0 !important;right:0 !important",g.handleWindowClick=function(d){var y=g._editingDOM;if(y){var O=y.getBoundingClientRect(),Q=ao(d);Uk(O,Q)||g.endTextEdit()}}},handle_mousedown:function(C){var X=this,G=X.gv;if(We(C)&&!G._editing){var j=G.getDataAt(C);if(j){var t=G.getTextEditInfo(j);t&&(this._editInfo=t,this._editTarget=j,G._editing=!0,t.isMultiline?this.handleMultilineEdit():this.handleTextEdit())}}},handleMultilineEdit:function(){var H=this,Q=H.gv,z=H._editTarget,N=H.getTargetValue(),S=H.textarea,t=H.wrap;this.hiddenTextarea||this.createHiddenTextarea(),(null===N||N===A)&&(N=""),S.value=N,H._editingDOM=S,Q.getView().appendChild(t),this.layoutHTML(t,z),this.calculateTextareaHeight(),gj(function(){S.focus(),C(c,"mousedown",H.handleWindowClick),C(c,"touchstart",H.handleWindowClick)},10)},handleTextEdit:function(){var K=this,n=K.gv,U=K._editTarget,L=K.getTargetValue(),i=K.input;(null===L||L===A)&&(L=""),i.value=L,K._editingDOM=i,n.getView().appendChild(i),this.layoutHTML(i,U),gj(function(){i.focus(),C(c,"mousedown",K.handleWindowClick),C(c,"touchstart",K.handleWindowClick)},10)},layoutHTML:function(u,_){var K=this.gv,E=K.getZoom();if(_ instanceof L.Node){var S=_.getRect(),f=Math.min(Math.max(100,S.width*E),800);u.style.left=(S.x+S.width/2)*E+K.tx()+"px",u.style.top=(S.y+S.height/2)*E+K.ty()+"px",u.style.width=f+"px",u.style.marginLeft=-f/2+"px"}else if(_ instanceof L.Edge){var D=K.getDataUI(_),S=D._6I;u.style.left=(S.x+S.width/2)*E+K.tx()+"px",u.style.top=(S.y+S.height/2)*E+K.ty()+"px"}},endTextEdit:function(){var e=this,t=e._editInfo.isMultiline?e.wrap:e.input,O=e._editInfo.isMultiline?e.textarea:e.input;e.setTargetValue(O.value),e.gv.getView().removeChild(t),e.gv._editing=!1,delete e._editingDOM,D(c,"mousedown",e.handlelick),D(c,"touchstart",e.handleWindowClick)},setTargetValue:function(A){var g=this,i=g._editTarget,r=g._editInfo,K=r.accessType,P=r.name;if(P&&K||(K="p",P="name"),"p"===K){var Y=L.Default.setter(P);i[Y](A)}else"a"===K?i.a(P,A):i.s(P,A)},getTargetValue:function(){var $=this,u=$._editTarget,C=$._editInfo,y=C.accessType,Q=C.name;if(Q&&y||(y="p",Q="name"),"p"===y){var z=L.Default.getter(Q);return u[z]()}return"a"===y?u.a(Q):u.s(Q)},createHiddenTextarea:function(){this.hiddenTextarea=F.createElement("textarea"),this.hiddenTextarea.setAttribute("style","margin:0; padding:0; position:absolute; overflowY:scroll; resize:none; box-sizing:border-box;"),this.hiddenTextarea.setAttribute("rows","1"),this.gv.getView().appendChild(this.hiddenTextarea)},calculateHTMLStyle:function(q,Y){if(Y&&this.computedStyleCache)return this.computedStyleCache;var O=this,A=c.getComputedStyle(q),o=A.getPropertyValue("box-sizing")||A.getPropertyValue("-moz-box-sizing")||A.getPropertyValue("-webkit-box-sizing"),h=parseFloat(A.getPropertyValue("padding-bottom"))+parseFloat(A.getPropertyValue("padding-top")),G=parseFloat(A.getPropertyValue("border-bottom-width"))+parseFloat(A.getPropertyValue("border-top-width")),Q=O.SIZING_STYLE.map(function(R){return R+":"+A.getPropertyValue(R)
}).join(";"),L={sizingStyle:Q,paddingSize:h,borderSize:G,boxSizing:o};return Y&&(this.computedStyleCache=L),L},calculateTextareaHeight:function(v){v=v||"";var o=this,$=o.textarea,X=o.hiddenTextarea,t=o.wrap,u=32,J=o.calculateHTMLStyle($,!1),m=J.paddingSize,f=J.borderSize,H=J.boxSizing,i=J.sizingStyle;X.setAttribute("style",i+";"+o.HIDDEN_TEXTAREA_STYLE),X.value=$.value+v;var S=X.scrollHeight;"border-box"===H?S+=f:"content-box"===H&&(S-=m),$.style.height=S+"px",$.style.marginTop=0-.5*S+"px",t.style.height=Math.max(S,u)+"px",t.style.marginTop=S*-.5+"px"}});var Pd=Rr.ScrollBarInteractor=function(h){oc(Pd,this,[h])};zp("ScrollBarInteractor",gm,{_41o:function(){return this.gv.getViewRect().height<this.gv.getScrollRect().height},_40o:function(){return this.gv.getViewRect().width<this.gv.getScrollRect().width},isV:function(P){var J=this.gv.getViewRect();return this._41o()&&(J.x+J.width-this.gv.lp(P).x)*this.gv.getZoom()<Lg},isH:function(a){var o=this.gv.getViewRect();return this._40o()&&(o.y+o.height-this.gv.lp(a).y)*this.gv.getZoom()<Lg},handle_mousemove:function(g){this.handle_touchmove(g)},handle_touchmove:function(P){if(!Hn&&Yf(P)&&this.gv.isScrollBarVisible()){var c=this,f=c.isV(P),d=c.isH(P);(f||d)&&c.gv.showScrollBar(),c.gv._scrolling=f||d}},handleWindowMouseUp:function(R){this.handleWindowTouchEnd(R)},handleWindowTouchEnd:function(H){this._state=this._cp=this._tx=this._ty=this.gv._scrolling=h,this.fi({kind:"endScroll",event:H})},handle_mousedown:function(n){this.handle_touchstart(n)},handle_touchstart:function(H){var M=this;if(M.gv.setFocus(H),ae(H),M.handle_touchmove(H),!(kl(H)>1)&&M.gv._scrolling&&M.gv.isScrollBarVisible()){M._cp=ao(H),M._tx=M.gv.tx(),M._ty=M.gv.ty();var s=M.isV(H);M._state=s?"vScroll":"hScroll",Qb(M,H),M.fi({kind:"beginScroll",event:H})}},handleWindowMouseMove:function(h){this.handleWindowTouchMove(h)},handleWindowTouchMove:function(_){var I=ao(_),c=this.gv.getViewRect(),w=this.gv.getScrollRect();"vScroll"===this._state?this.gv.ty(this._ty+(this._cp.y-I.y)*w.height/c.height):"hScroll"===this._state&&this.gv.tx(this._tx+(this._cp.x-I.x)*w.width/c.width),this.fi({kind:"betweenScroll",event:_})}});var Pk=Rr.TouchInteractor=function(w,Z){Z=Z||{},Z.selectable===A&&(Z.selectable=!0),Z.movable===A&&(Z.movable=!0),Z.pannable===A&&(Z.pannable=!0),Z.pinchable===A&&(Z.pinchable=!0),Z.editable===A&&(Z.editable=!0),this.params=Z,oc(Pk,this,[w])};zp("TouchInteractor",gm,{ms_edit:1,setUp:function(){var S=this;Pk.superClass.setUp.call(S),Xq&&S.params.editable&&S.gv.setEditInteractor(S)},tearDown:function(){var L=this;Pk.superClass.tearDown.call(L),Xq&&L.params.editable&&L.gv.setEditInteractor(h)},clear:function(e){var d=this,K=d.gv;K._moving&&(d.fi({kind:"endMove",event:e}),delete K._moving,K.onMoveEnded(),K.dm().endTransaction()),K._panning&&(d.fi({kind:"endPan",event:e}),delete K._panning,K.onPanEnded()),K._pinching&&(d.fi({kind:"endPinch",event:e}),delete K._pinching,K.onPinchEnded()),K._editing&&(d._46O(e),d._77I=d._node=d._edge=d._shape=d._rect=d._89I=d._index=K._editing=h),d.pendingClickThrough=d._moving=d._panning=d._pinching=d._editing=d._57I=d._data=d._beginHistory=h,d.clearDragging()},handle_touchstart:function(I){var T=this;if(!T.gv._editing){ae(I),T._57I=h,T.pendingClickThrough=h;var g=T.params,v=T.gv,o=v.sm(),q=v.getDataAt(I),j=kl(I);if(1===j){if(We(I))return v.handleDoubleClick(I,q),void 0;v.handleClick(I,q),q&&(v.handleMouseDown&&v.handleMouseDown(I,q),T._data=q),g.selectable||(q=h),q&&(o.co(q)?q instanceof so&&q.isClickThroughEnabled()&&(T.pendingClickThrough=ao(I)):o.ss(q),g.editable&&v.isEditable(q)&&T._79I(I,q,!0)?(T._editing=1,T.startDragging(I)):g.movable&&v.isMovable(q)&&(T._moving=1,T.startDragging(I))),q&&(v.isMovable(q)||v._39Q(q))||(T._57I=ao(I),g.pannable&&v.isPannable()&&(T._panning=1,T.startDragging(I),T._translate={x:v.tx(),y:v.ty()}))}else if(g.pinchable&&2===j){if(!v.getEditInteractor()&&q){var P=Tj(v.getImage(q));if(P&&zm(P.scrollable,q,this))return}T._pinching=1,T.startDragging(I);var O=v.getView(),B=v.getZoom(),k=O.getBoundingClientRect(),L=I.touches[0],$=I.touches[1],t={x:(L.clientX+$.clientX)/2-k.left,y:(L.clientY+$.clientY)/2-k.top};t.x-=v.tx(),t.y-=v.ty(),t.x/=B,t.y/=B,T._p=t,T._d=Yq(I)}}},handle_touchend:function(C){var p=this,w=p.gv,j=p._57I,d=p._data;if(j&&(ml(j,ao(C))<=1&&!w.getDataAt(C)&&w.sm().cs(),p._57I=h),d&&w.handleMouseUp&&w.handleMouseUp(C,d),p.pendingClickThrough){if(ml(p.pendingClickThrough,ao(C))<=1){var d=w.getDataAt(C);if(d instanceof so&&d.isClickThroughEnabled()){var K=w.getDataAt(C,function(e){var l=e.getParent()===d&&w.isSelectable(e,!0);return l});K&&(C.clickThrough=!0,w.sm().ss(K))}}p.pendingClickThrough=h}},handleWindowTouchEnd:function(a){this.clear(a)},handleWindowTouchMove:function(m){var j=this,A=j.gv,G=kl(m);if(1===G){var c=ao(m),C=Io(A,c,j._lastClientPoint),J=ml({x:0,y:0},C);if(j._editing&&(j._beginHistory||(j._beginHistory=1,A.dm().beginTransaction()),A._editing=1,j._78I(m)),j._moving){if(!A._moving&&J<r.touchMoveThreshold)return;j._beginHistory||(j._beginHistory=1,A.dm().beginTransaction()),j.handleMove(m)}else if(j._panning){if(!A._panning&&J<r.touchMoveThreshold)return;A.setTranslate(j._translate.x+C.x,j._translate.y+C.y),j.fi({kind:A._panning?"betweenPan":"beginPan",event:m}),A._panning=1}}else if(2===G&&j._pinching){var M=Yq(m);A.handlePinch(j._p,M,j._d),j._d=M,j.fi({kind:A._pinching?"betweenPinch":"beginPinch",event:m}),A._pinching=1}},handleMove:function(h){var s=this,q=s.gv,I=q.lp(h);q._93O&&q._93O(h,s._data)||(q.moveSelection(I.x-s._lastLogicalPoint.x,I.y-s._lastLogicalPoint.y),s._lastLogicalPoint=I,s.autoScroll(h),s.fi({kind:q._moving?"betweenMove":"beginMove",event:h}),q._moving=1)}});var L=c.ht,ab=L.graph._editor={Math:L.Math,Guide:{}};ab.getStyle=function(S){var U,F=ab.StyleMap;return F&&(U=F[S],U!==A)?U:ab.DefaultStyleMap[S]},ab.setStyle=function(v,a){var I=ab.StyleMap;I||(I=ab.StyleMap={}),I[v]=a},ab.inEdit=function(V){return V._inXEdit===!0},ab.startEdit=function(Y){Y._inXEdit=!0,ab.Inject.doInject(Y)},ab._46O=function(s){s._inXEdit=!1,ab.Inject.undoInject(s)},ab.toScreenPosition=function(N,y){var A=N.tx(),f=N.ty(),r=N._zoom;return new ab.Math.Vector2(y.x*r+A,y.y*r+f)},ab.checkHit=function(p,A,S){return p.distanceTo(A)<S?!0:!1},ab.toWorldPosition=function(c,t){var R=c.tx(),v=c.ty(),z=c._zoom;return{x:(t.x-R)/z,y:(t.y-v)/z}},ab.setAntialias=function(u,C){for(var V,P=["imageSmoothingEnabled","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","oImageSmoothingEnabled","msImageSmoothingEnabled"],o=0,Q=P.length;Q>o&&(V=P[o],!(V in u));o++);u[V],u[V]=C},ab.getTargetCornersOnScreen=function(t,L){if(!L)return null;var C,y=[];if(_d(L,t)){var R=Gr(t,L);C=[{x:R.x,y:R.y},{x:R.x+R.width,y:R.y},{x:R.x+R.width,y:R.y+R.height},{x:R.x,y:R.y+R.height}]}else{if(!L.getCorners)return null;C=L.getCorners()}return C.forEach(function(U){var Z=ab.toScreenPosition(t,U);y.push(Z.x,Z.y)}),y},ab.log=function(){};var Al=ab.Inject={_modules:[]};Al.registAsModule=function(E,j){var u={},C={};for(var y in E){var I=j.prototype[y];u[y]=I}E.getBackup=function(W){return u[W]},E.getBackups=function(){return u},C.doInject=function(){for(var G in E)"getBackup"!==G&&(j.prototype[G]=E[G])},C.undoInject=function(){for(var m in E)"getBackup"!==m&&(j.prototype[m]=u[m])},Al._modules.push(C)},Al.doInject=function(U){for(var z,W=Al._modules,N=0,A=W.length;A>N;N++)z=W[N],z.doInject(U)},Al.undoInject=function(j){for(var e,i=Al._modules,A=0,H=i.length;H>A;A++)e=i[A],e.undoInject(j)};var gm=L.graph.EditInteractor=function(m){var d=this,D=F.createElement("canvas");D.className="editCanvas",D.style.position="absolute",d._uuid=L.Math.generateUUID(),d._styleMap={},d._canvas=D,d._context=D.getContext("2d"),gm.superClass.constructor.call(d,m),this._editDetail=!1,ab.setAntialias(d._context,!1),d._subModules=[new ab.Anchor(d),new ab.RotateX(d),new ab.MoveDummy(d),new ab.Rect(d),new ab.Curve(d),new ab.MoveHelper(d)],d._gridGuide=new ab.Guide.Grid(d),d._rectGuide=new ab.Guide.Rect(d),d._hoverGuide=new ab.Guide.Hover(d)},tn=gm;L.Default.def(gm,L.graph.Interactor,{ms_edit:1,ms_fire:1}),U.defineProperties(gm.prototype,{editDetail:{get:function(){var g=!!this._editDetail;return g},set:function(v){var g=this,l=g._editDetail;l!==v&&(g._editDetail=v,g.gv._editing=v,g.fp("editDetail",l,v),g.fp("pointsEditingMode",l,v),g.fi({kind:v?"beginEditPoints":"endEditPoints"}))}},gvEditing:{get:function(){return this.gv._editing},set:function(g){(!this._editDetail||g)&&(this.gv._editing=g,g||(this.editDetail=!1))}},editing:{get:function(){return this._editing},set:function(Q){this._editing=Q,this.gvEditing=Q}},editingModule:{get:function(){return this._editMod}},pointsEditingMode:{get:function(){return this.editDetail},set:function(J){var Y=this;Y.editDetail!==J&&(J?Y._tryEnterEditDetailMode():Y._tryQuitEditDetailMode())}},gridEnabled:{get:function(){var p=this._gridEnabled;if(!p)return!1;var N=this.gv;return N?!0:!0},set:function(k){k!==this._gridEnabled&&(this._gridEnabled=k,this._42())}},alignmentGuideEnabled:{get:function(){return this._agEnabled},set:function(e){e!==this._agEnabled&&(this._agEnabled=e,this._42())}},gridGuide:{get:function(){return this._gridGuide}},rectGuide:{get:function(){return this._rectGuide}},hoverGuide:{get:function(){return this._hoverGuide}}}),gm.prototype.getSubModule=function(d){var p,I,f,B=this._subModules;for(I=0,f=B.length;f>I;I++)if(p=B[I],p.catalog===d)return p},gm.prototype.invokeSubModule=function(F,C){for(var o,O,Z,l=this,E=l._subModules,W=Array.prototype.slice.call(arguments,2),q=0,H=E.length;H>q;q++)if(o=E[q],O=o[F],O&&(Z=O.apply(o,W),Z!=A&&C))return o},gm.prototype.invokeSubModuleInverse=function(M,f){var z=this,e=z._subModules;if(e)for(var h,n,p,r=Array.prototype.slice.call(arguments,2),c=e.length-1;c>=0;c--)if(h=e[c],n=h[M],n&&(p=n.apply(h,r),p!=A&&f))return h},gm.prototype.setUp=function(){ab.log("setUp");var x=this,t=x.gv,m=t.getView(),V=x._canvas;gm.superClass.setUp.call(x),t.setEditInteractor(x),t._79O?m.insertBefore(V,t._79O):m.appendChild(V),ab.startEdit(t),x.invokeSubModule("setUp"),t.dm().mm(x._onDataModelChanged,x),t.dm().md(x._onDataPropertyChanged,x)},gm.prototype.tearDown=function(){ab.log("tearDown");var T=this,B=T.gv,K=B.getView();T._resetCustomCursorStyle(),gm.superClass.tearDown.call(T),B.dm().umm(T._onDataModelChanged,T),B.dm().umd(T._onDataPropertyChanged,T),B.setEditInteractor(null),K.removeChild(T._canvas),T._drawTimer&&(Wb(T._drawTimer),T._drawTimer=null),ab._46O(B),T.invokeSubModule("tearDown")},gm.prototype._onDataModelChanged=function(i){var q=this;("clear"===i.kind||"remove"===i.kind&&q.editDetail&&i.data===q.getSubModule("Curve").target)&&(q.editDetail=!1,q._42())},gm.prototype._onDataPropertyChanged=function(j){var a=this;if(a.editDetail){var V=a.getSubModule("Curve"),E=j.data;E===V.target&&(E._writing||V._handleDataChanged(j))}},gm.prototype.clear=function(){ab.log("clear")},gm.prototype.redraw=function(){this._42()},gm.prototype._42=function(){var W=this;W._drawTimer||(W._drawTimer=gj(function(){W._drawTimer=null,W.drawImpl()},0))},gm.prototype.drawImpl=function(){var x;for(x in{_42:!0})break;return function(){var P=this,o=P._canvas,j=P.gv,X=j.getWidth(),s=j.getHeight(),M=P._context,H=L.Default.getInternal(),l=r.devicePixelRatio;(o.width!==X||o.height!==s)&&H.setCanvas(o,X,s,l),M.clearRect(0,0,o.width,o.height);var a=P._getValidSelection();M.save(),M.scale(l,l),P._gridGuide._42(),P.invokeSubModuleInverse(x,!1,M,j,a),P._rectGuide._42(),P._hoverGuide._42(),M.restore()}}(),gm.prototype._getValidSelection=function(){var K=this,B=K.gv,q=B.sm().getSelection(),d=[];return q.each(function(c){B.isVisible(c)&&B.isEditable(c)&&d.push(c)}),d},gm.prototype.handle_touchmove=function(X){return this.handle_mousemove(X)},gm.prototype.handle_mousemove=function(I){if(!L.Default.isDragging()){var g=this;if((g.editDetail||!ph()&&!Hq(I))&&!g.gv._externalEditing)if(g.gvEditing=!1,g._checkEdit(I))g.gvEditing=!0;else{if(!g.getStyle("hoverGuideVisible"))return;g.hoverData=g.gv.getDataAt(I),g._42()}}},gm.prototype.handle_touchstart=function(K){return this.handle_mousedown(K)},gm.prototype.handle_mousedown=function(R){ae(R);var e=this;if((e.editDetail||!ph()&&!Hq(R))&&!e.gv._externalEditing){if(We(R)&&!R.clickThrough){if(e.editDetail){if(e._tryQuitEditDetailMode(R))return}else if(e._tryEnterEditDetailMode())return;e.gv.dm().beginTransaction();var Q=e.invokeSubModule("handleDoubleClick",!0,R);if(e.gv.dm().endTransaction(),Q)return}var x=e._checkEdit(R);x&&(e._downPosition=e._getLogicalPoint(R),e.gv.dm().beginTransaction(),x.startEdit(e,R),e.editing=!0)}},gm.prototype._checkEdit=function(j){var L=this,c=L.gv,U=L._getLogicalPoint(j),d=L.invokeSubModule("check",!0,c,j,U)||null;return L._editMod=d,d},gm.prototype.handleWindowTouchMove=function(D){return this.handleWindowMouseMove(D)},gm.prototype.handleWindowMouseMove=function(P){var L=this,N=L._downPosition;if(N){var R=L._getLogicalPoint(P);if(R.distanceTo(N)<L.getStyle("moveSensitivity"))return;delete L._downPosition}var h=L._editMod;h&&h.handleEdit(L.gv,P)},gm.prototype._getLogicalPoint=function(c){var m=this,U=L.Default.getLogicalPoint(c,m._canvas);return new ab.Math.Vector2(U)},gm.prototype.handleWindowTouchEnd=function(B){return this.handleWindowMouseUp(B)},gm.prototype.handleWindowMouseUp=function(){var w;for(w in{_46O:!0})break;return function(i){var n=this;n.editing=!1,n.setCursor("default"),n.invokeSubModule(w,!1,i),n._42(),n.gv.dm().endTransaction()}}(),gm.prototype.handle_mousewheel=function(D){var L=this;ae(D),L.invokeSubModule("preHandleScroll",!0)||L.gv.handleScroll(D,D.wheelDelta)},gm.prototype.handleDelete=function(){var o=this;if(!o.editDetail){o.gv.dm().beginTransaction();var J=o.invokeSubModule("handleNormalStateDelete",!0);return o.gv.dm().endTransaction(),J||o.gv.removeSelection(),void 0}o.gv.dm().beginTransaction(),o.invokeSubModule("handleDelete",!0),o.gv.dm().endTransaction(),o._42()},gm.prototype.handle_keydown=function(S){var j=this;if((S.metaKey||S.ctrlKey)&&j._42(),ph(S)&&!j.editing)return j.gvEditing=!1,j.setCursor("default"),j._42(),void 0;var q=Vc(S);return j.editDetail?((q||Bs(S))&&(j.editDetail=!1,j._42()),j.gv.dm().beginTransaction(),j.invokeSubModule("handle_keydown",!0,S),j.gv.dm().endTransaction(),void 0):(j.gv.dm().beginTransaction(),j.invokeSubModule("handleNormalStateKeyDown",!0,S),j.gv.dm().endTransaction(),q&&j._tryEnterEditDetailMode(),void 0)},gm.prototype.handle_keyup=function(w){this.gv.dm().beginTransaction(),this.invokeSubModule("handle_keyup",!0,w),this.gv.dm().endTransaction()},gm.prototype._tryEnterEditDetailMode=function(){var u=this;return!u.editDetail&&u.invokeSubModule("canEnterEditDetailMode",!0)&&1===u._getValidSelection().length?(u.editDetail=!0,u._42(),!0):void 0},gm.prototype._tryQuitEditDetailMode=function(N){var T=this;return T.editDetail?!N||T.invokeSubModule("canQuitEditDetailMode",!0,N)?(T.editDetail=!1,T._42(),!0):!1:!1},gm.prototype.setStyle=function(d,f,x){var b=this;x?ab.setStyle(d,f):b._styleMap[d]=f,"baseColor"===d&&(yk=f),b.fp("styleChanged",null,{key:d,value:f,base:x}),b._42()},gm.prototype.getStyle=function(V){var Q=this,y=Q._styleMap[V];return y!==A?y:ab.getStyle(V)},gm.prototype.setCursor=function(n){this._resetCustomCursorStyle(),L.graph.EditInteractor.superClass.setCursor.call(this,n)},gm.prototype._drawHostGuide=function(I){var K=this,P=K._context,A=K.gv;ab.Icons.DrawIcon(K,P,ab.Icons.NodeHoverGuide,I.corners);var s=I.host;if(s){var r=A.getAttachPoints(s);if(r&&r.length)for(var U=0,m=r.length;m>U;U++){var t=r[U],y=ti(A,s,0,t.offsetX||0,t.offsetY||0,t.x,t.y);y=ab.toScreenPosition(A,y),y.isAttach=I.attach===U,ab.Icons.DrawIcon(K,P,ab.Icons.AttachPoint,y)}}},gm.prototype._resetCustomCursorStyle=function(){var y=this;if(y._customStyle){var A=this.gv.getView();A.classList&&A.classList.remove&&A.classList.remove(y._customStyle),y._customStyle=null}},gm.prototype._setRotateCursor=function(k){var L=this,B=L._cursorFactory;B||(B=L._cursorFactory=new ab.CursorFactory(L));var Y=B.getRotateCursor(k),E=L.gv.getView();L._resetCustomCursorStyle(),L._customStyle=Y,E.classList&&E.classList.add&&E.classList.add(Y)};var aq=ab.Group=function(K){var M=this;M._entities=K,M._64O=0,M._position={x:0,y:0},M._scale={x:1,y:1},M._anchor={x:.5,y:.5},M._anchor2={x:.5,y:.5}};aq.prototype={},aq.prototype.constructor=aq;var Pj=null,bg=null;aq.findOrCreateGroup=function(m,S){if(bg===S&&Pj&&Pj.checkIsMe(m))return Pj;bg=S;var E=new ab.Group(m);return E.getKeyOb()?(Pj=E,E):void 0},aq.prototype.checkIsMe=function(j){var U=this._entities;if(U.length!==j.length)return!1;var J,s={},q=j.length;for(J=0;q>J;J++)s[j[J]._id]=!0;for(J=0;q>J;J++)if(!s[U[J]._id])return!1;return!0},aq.prototype.getRotation=function(){return this._64O},aq.prototype.getPosition=function(){return this._position},aq.prototype.getAnchor=function(){return this._anchor},aq.prototype.getWidth=function(){return this._width},aq.prototype.getScale=function(){return this._scale},aq.prototype.getSize=function(){return{width:this._width,height:this._height}},aq.prototype.getHeight=function(){return this._height},aq.prototype.getKeyOb=function(){for(var J=this._entities,v=J.length-1;v>=0;v--){var N=J[v];if(this.isNode(N))return N}},aq.prototype.getAnchor2=function(){var E=this,A=E.rotateCenter;if(A)return A;var X=E.getKeyOb();if(!X)return E._anchor;var p=E._anchor2,P=X.getMatrix();return P.tf({x:X.getWidth()*(p.x-X.getAnchor().x),y:X.getHeight()*(p.y-X.getAnchor().y)})},aq.prototype.setAnchor2=function(E,B){var c=this,L=c.getKeyOb();if(L){var A,l=L.getMatrix();A="number"==typeof E?{x:E,y:B}:E;var k=l.tfi(A);c._anchor2={x:L.getAnchor().x+k.x/L.getWidth(),y:L.getAnchor().y+k.y/L.getHeight()}}},aq.prototype.setRotation=function(){},aq.prototype.beginRotate=function(t){this.rotateCenter=t.pos,this.rotateMode=t.groupRotateMode},aq.prototype.endRotate=function(){delete this.rotateCenter,delete this.rotateMode},aq.prototype.addRotation=function(s,R,E){return"batch"===R?this._addRotationInBatchMode(s,E):"block"===R?this._addRotationInBlockMode(s,E):void 0},aq.prototype._addRotationInBlockMode=function(R,i){var x=this,O=x.rotateCenter||x.getPosition();x._entities.forEach(function(D){if(x.isNode(D)&&(!i||i(D))){var Q=D.getMatrix();Q.translate(-O.x,-O.y),Q.rotate(R),Q.translate(O.x,O.y);var Y=Math.sign(D.getScale().x);D.setRotation(tj(Q.b*Y,Q.a*Y)),D.setPosition(Q.tx,Q.ty)}})},aq.prototype._addRotationInBatchMode=function(q,M){var s=this,k=s._anchor2;s._entities.forEach(function(V){if(s.isNode(V)&&(!M||M(V))){var y=V.getAnchor(),l=V.getMatrix(),o=l.tf({x:V.getWidth()*(k.x-y.x),y:V.getHeight()*(k.y-y.y)}),C=new ab.Math.Matrix2d;C.set(l.a,l.b,l.c,l.d,l.tx,l.ty),C.translate(-o.x,-o.y),C.rotate(q),C.translate(o.x,o.y);var r=Math.sign(V.getScale().x);V.setRotation(tj(C.b*r,C.a*r)),V.setPosition(C.tx,C.ty)}})},aq.prototype.setPosition=function(o){var N,_,n,E,x=this,y=x._position,W=o.x-y.x,I=o.y-y.y,S=x._entities;for(_=0,n=S.length;n>_;_++)N=S[_],nf(N)&&(E=N.getPosition(),N.setPosition(E.x+W,E.y+I));x._position=o},aq.prototype.setScale=function(A,h){var w=this,y=A/w._scale.x,n=h/w._scale.y;w._adjustChildScaleOrSize(y,n,"size"),w._scale={x:A,y:h}},aq.prototype.getRect=function(){var R=this,W=R._position,o=R._width,m=R._height;return{x:W.x-o/2,y:W.y-m/2,width:o,height:m}},aq.prototype.setSize=function(v,c){var m=this,v=Math.max(1,v),c=Math.max(1,c),E=v/m._width,C=c/m._height;m._adjustChildScaleOrSize(E,C,"size"),m._width=v,m._height=c},aq.prototype._adjustChildScaleOrSize=function(S,$,q){var R,t,H,a,Y,g,M,O,n,F,K,v,P,V,A=this,Q=A._position,E=A._entities,w=new ab.Math.Matrix2d;for(t=0,H=E.length;H>t;t++)if(R=E[t],A.isNode(R)){if(a=R.getPosition(),Y=R.getRotation(),g=R.getWidth(),M=R.getHeight(),O=R.getScale(),K=O.x*g,v=O.y*M,w.identity().scale(K,v).rotate(Y).translate(a.x,a.y).translate(-Q.x,-Q.y).rotate(-A._64O),Y=tj(w.b*Math.sign(K),w.a*Math.sign(K)),w.scale(S,$),n=Math.cos(Y),F=Math.sin(Y),Math.abs(n)<.001?(P=w.b/F,V=-w.c/F):(P=w.a/n,V=w.d/n),"scale"===q)R.setScale(P/g,V/M);else if("size"===q){var u=P/O.x,c=V/O.y;R.setScale(al(P)*Math.abs(O.x),al(V)*Math.abs(O.y)),R.setSize(Math.max(.1,Math.abs(u)),Math.max(.1,Math.abs(c)))}w.rotate(A._64O).translate(Q.x,Q.y),R.setPosition(w.tx,w.ty)}},aq.prototype.getMatrix=function(){var o=this,a=o._position,p=L.Default.getInternal(),C=o._scale;return new p.Mat(o._64O,a.x,a.y,C.x,C.y)},aq.prototype.toGlobal=function(t){return this.getMatrix().tf(t)},aq.prototype.getCorners=function(){var D=this,O=D._width,S=D._height,$=D._anchor,T=-O*$.x,y=-S*$.y,z=D.getMatrix();return[z.tf(T,y),z.tf(T,y+S),z.tf(T+O,y+S),z.tf(T+O,y)]},aq.prototype.calcInfo=function(){var T,$,i,b,R,n,M=this,r=[],F=M._entities,_=M._64O;for(b=0,R=F.length;R>b;b++)n=F[b],M.isNode(n)&&n.getCorners&&r.push.apply(r,n.getCorners());if(r.length){var j=Math.cos(-_),C=Math.sin(-_),U=1/0,L=-1/0,E=1/0,S=-1/0;for(b=0,R=r.length;R>b;b++)i=r[b],T=i.x,$=i.y,i.x=j*T-C*$,i.y=C*T+j*$,U=Math.min(U,i.x),L=Math.max(L,i.x),E=Math.min(E,i.y),S=Math.max(S,i.y);M._width=(L-U)/M._scale.x,M._height=(S-E)/M._scale.y,j=Math.cos(_),C=Math.sin(_);var o=M._anchor;T=U+(L-U)*o.x,$=E+(S-E)*o.y,M._position={x:j*T-C*$,y:C*T+j*$}}},aq.prototype.isNode=function(r){return nf(r)?_d(r)?r.size()?!1:!0:!0:!1},aq.prototype._42=function(_,L,n){var i,Z,r,K,u,G,V,D,O=this,C=O._entities,m=O.rotateMode;for("batch"===m&&(D=O.getKeyOb()),i=0,Z=C.length;Z>i;i++)r=C[i],O.isNode(r)&&(G=r.getRect(),K=ab.toScreenPosition(n,{x:G.x,y:G.y}),u=ab.toScreenPosition(n,{x:G.x+G.width,y:G.y+G.height}),V={min:K,max:u},r===D&&(V.isKeyOb=!0),ab.Icons.DrawIcon(_,L,ab.Icons.GroupSubEntityRect,V))};var ff=ab.CurveActiving=function(H,L){this._curve=H,this._interactor=H._interactor,this.silent=!0;for(var N in L)this[N]=L[N];delete this.silent};ff.prototype={},ff.prototype.constructor=ff,U.defineProperties(ff.prototype,{point:{get:function(){return this._point},set:function(S){var H=this;H._point=S,H.editingCtrl||H.silent||H._firePointChange()}},pairs:{get:function(){return this._pairs},set:function(z){var Z=this;Z._pairs=z,Z.editingCtrl&&!Z.silent&&Z._firePointChange()}}}),ff.prototype._firePointChange=function(){var u=this,G=u.getCurrentEditingPoint(),k=u._interactor;if(!G)return k.fi({kind:"selectPoint"}),void 0;var h=this._curve.target;if(h){var C=ab.getDataMatrix(h).invert(),q=G.e;G=C.apply(ab.toWorldPosition(k.gv,G)),G.e=q;var E=u._lastFirePoint;E&&Math.abs(G.x-E.x)<1e-5&&Math.abs(G.y-E.y)<1e-5&&(G.e==A&&E.e==A||Math.abs(G.e-E.e)<1e-5)||(u._lastFirePoint=G,k.fi({kind:"selectPoint",x:G.x,y:G.y,e:G.e}))}},ff.prototype.dispose=function(){this._interactor.fi({kind:"selectPoint"})},ff.prototype.getCurrentEditingPoint=function(){var J=this,n=J.editingCtrl;if(n){var Q=J.pairs;if(Q){var l=Q[n.pairId];if(l){var O=l[n.type];if(O)return O}}}return J._point};var De=ab.CursorFactory=function(x){var p=this;p._interactor=x,p._rotateCursorStyles={}};De.prototype={},De.prototype.constructor=De,De.prototype.getRotateCursor=function(F){var H=this;0>F&&(F+=2*Math.PI);var S=H._interactor,j=S.getStyle("rotateCursorSize"),N=S.getStyle("rotateCursorRound"),o=Math.round(180*(F/Math.PI)/N);o*N>=360&&(o=0);var R=H._rotateCursorStyles,J="htCustomRotateStyle_"+j+"_"+N+"_"+o;return R[J]||(H._produceRotateCursor(J,j,N,o),R[J]=!0),J},De.prototype._produceRotateCursor=function(Y,N,a,y){var d=this;d._interactor;var K=d._canvas;K||(K=d._canvas=F.createElement("canvas"));var e=r.devicePixelRatio;K.width=K.height=N*e,K.style.width=K.style.height=N+" px";var h=K.getContext("2d");ab.setAntialias(h,!1),h.scale(e,e);var M,x,s,V,i,k=Math.round(N/2),X=""+k+" "+k+",auto !important;",j=4;M=Math.PI/180*y*a,h.clearRect(0,0,N,N),h.save(),h.scale(N/32,N/32),h.translate(16,15),h.rotate(M+Math.PI/2),h.beginPath(),h.moveTo(-8,0),h.lineTo(-8,j),h.lineTo(-8+j,j),h.moveTo(8,0),h.lineTo(8,j),h.lineTo(8-j,j),h.moveTo(-8,j),h.quadraticCurveTo(0,-6,8,j),h.restore(),h.lineCap="round",h.lineJoin="miter",h.strokeStyle="white",h.lineWidth=4,h.stroke(),h.strokeStyle="black",h.lineWidth=2,h.stroke(),x=JSON.stringify(K.toDataURL()),V="cursor:url("+x+")"+X,1!==e&&(s='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+N+'px" height="'+N+'px"><image xlink:href='+x+' width="'+N+'" height="'+N+'"/></svg>',V+="cursor:url(data:image/svg+xml;base64,"+btoa(s)+")"+X,V+="cursor:-webkit-image-set(url("+x+")"+e+"x,url("+x+")1x)"+X),i=F.createElement("style"),i.textContent="body."+Y+" *, ."+Y+"{"+V+"}",F.head.appendChild(i)};var nd=ab.Guide.Grid=function(e){var A=this;A._interactor=e,A._alignmentGuideId=0,A._xAlignmentGuide=[],A._yAlignmentGuide=[]};nd.prototype={},nd.prototype.constructor=nd,U.defineProperties(nd.prototype,{gridBlockSize:{get:function(){var L=this;return L._gridBlockSize||L._interactor.getStyle("gridBlockSize")},set:function(b){this._gridBlockSize=b,this._interactor._42()}},gridThickLinesEvery:{get:function(){var D=this;return D._gridThickLinesEvery||D._interactor.getStyle("gridThickLinesEvery")},set:function(r){this._gridThickLinesEvery=r,this._interactor._42()}},gridEnabled:{get:function(){var W=this,v=W._interactor;return v.gridEnabled&&W.isValidGrid()}}}),nd.prototype._42=function(){var J=this,W=J._interactor;J.gridEnabled&&J.drawGrid(),W.alignmentGuideEnabled&&J.drawAlignmentGuide()},nd.prototype.makeMatrix=function(){var Z=this,F=Z._interactor.getStyle("gridAngle"),G=Z._interactor.getStyle("gridRotation"),H=new ab.Math.Matrix2d,q=Math.sin(F),o=Math.cos(F);return H.set(1,0,o,q,0,0),H.rotate(G),H},nd.prototype.isValidGrid=function(){var R=this,s=Math.PI,q=R._interactor,X=q.gv;if(X._zoom<q.getStyle("gridZoomThreshold"))return!1;var c=q.getStyle("gridAngle"),t=Math.abs(180*(c%s/s)),p=1-1e-8;return p>t||t>180-p?!1:!0},nd.prototype.drawAlignmentGuide=function(){var V=this,T=V._interactor,K=T.gv,J=T._canvas,j=T._context,m=J.width,D=J.height,d=K.tx(),i=K.ty(),c=K._zoom;j.beginPath(),j.strokeStyle=T.getStyle("gridAlignmentGuideColor"),j.lineWidth=1,V._xAlignmentGuide.forEach(function(m){var A=m.p*c+d;j.moveTo(A,0),j.lineTo(A,D)}),V._yAlignmentGuide.forEach(function(b){var t=b.p*c+i;j.moveTo(0,t),j.lineTo(m,t)}),j.stroke()},nd.prototype.drawGrid=function(){function H(l,A,U,z){var W=ab.toScreenPosition(j,B.apply({x:l,y:A})),M=ab.toScreenPosition(j,B.apply({x:U,y:z}));o.moveTo(W.x,W.y),o.lineTo(M.x,M.y)}var X=this,V=X._interactor,b=X.gridBlockSize,I=X.gridThickLinesEvery,L=V.getStyle("gridThickColor"),g=V.getStyle("gridLightColor"),j=V.gv,J=V._canvas,o=V._context,z=J.width,E=J.height,B=X.makeMatrix(),p=B.applyInverse(ab.toWorldPosition(j,{x:0,y:0})),y=B.applyInverse(ab.toWorldPosition(j,{x:z,y:0})),k=B.applyInverse(ab.toWorldPosition(j,{x:0,y:E})),t=B.applyInverse(ab.toWorldPosition(j,{x:z,y:E})),q=Math.min(p.x,y.x,k.x,t.x),R=Math.max(p.x,y.x,k.x,t.x),$=Math.min(p.y,y.y,k.y,t.y),v=Math.max(p.y,y.y,k.y,t.y);z=R-q,E=v-$;var F=Math.ceil(q/b),r=Math.floor(R/b),Z=Math.ceil($/b),c=Math.floor(v/b);j.tx(),j.ty(),j._zoom;var C,S,Q;for(o.save(),o.lineWidth=1,o.beginPath(),o.strokeStyle=L,Q=Math.ceil(F/I)*I;r>=Q;Q+=I)C=Q*b,H(C,$,C,v);for(Q=Math.ceil(Z/I)*I;c>=Q;Q+=I)S=Q*b,H(q,S,R,S);for(o.stroke(),o.beginPath(),o.strokeStyle=g,Q=F;r>=Q;Q++)0!==Q%I&&(C=Q*b,H(C,$,C,v));for(Q=Z;c>=Q;Q++)0!==Q%I&&(S=Q*b,H(q,S,R,S));o.stroke(),o.restore()},nd.prototype.getAlignmentGuides=function(){var P=this;return{x:P._xAlignmentGuide,y:P._yAlignmentGuide}},nd.prototype.addAlignmentGuide=function(h,i,$){var r=this,U="x"===h?r._xAlignmentGuide:r._yAlignmentGuide,$=$?$:++r._alignmentGuideId,u={p:i,id:$};if(U.length){var s=r._findClosestAlignmentGuide(u.p,U);s.dis<0?U.splice(s.index+1,0,u):U.splice(s.index,0,u)}else U.push(u);return r._interactor._42(),$},nd.prototype.findClosest=function(Z,r,p){var L=this,F=L._interactor,N=F.gv;p&&(Z=ab.toWorldPosition(N,Z));var J,c,B,E=1/0,t=1/0,a=Z.x,u=Z.y;if(L.gridEnabled){var M=L.gridBlockSize,q=L.makeMatrix(),Y=q.applyInverse(Z);Y=q.apply({x:Math.round(Y.x/M)*M,y:Math.round(Y.y/M)*M}),E=Y.x-a,t=Y.y-u,B=!0}if(F.alignmentGuideEnabled&&(J=L._findClosestAlignmentGuide(a,L._xAlignmentGuide).dis,c=L._findClosestAlignmentGuide(u,L._yAlignmentGuide).dis,Math.abs(J)<Math.abs(E)&&(E=J,B=!0),Math.abs(c)<Math.abs(t)&&(t=c,B=!0)),B){B=!1;var h=N._zoom,$=F.getStyle("smartGuideThreshold")/h,H={};if(Math.abs(E)<$&&"y"!==r&&(H.x=p?E*h:E,B=!0),Math.abs(t)<$&&"x"!==r&&(H.y=p?t*h:t,B=!0),B)return H}},nd.prototype._findClosestAlignmentGuide=function(H,t){if(!t.length)return{dis:1/0};for(var j,z=0,n=t.length-1;n-z>1;)j=Math.floor((z+n)/2),t[j].p<H?z=j:n=j;var T=t[z].p-H,q=t[n].p-H;return Math.abs(T)<=Math.abs(q)?{line:t[z],dis:T,index:z}:{line:t[n],dis:q,index:n}},nd.prototype.removeAllAlignmentGuide=function(t){var R=this;"y"!==t&&(R._xAlignmentGuide=[]),"x"!==t&&(R._yAlignmentGuide=[]),R._interactor._42()},nd.prototype.removeAlignmentGuide=function(E){for(var Y,F,_,W=this,g=W._xAlignmentGuide,m=0;2>m;m++)for(g=0===m?W._xAlignmentGuide:W._yAlignmentGuide,Y=0,F=g.length;F>Y;Y++)if(_=g[Y],_.id===E)return g.splice(Y,1),W._interactor._42(),{axis:0===m?"x":"y",position:_.p};return!1},nd.prototype.adjustAlignmentGuide=function(q,K){var A=this,I=A.removeAlignmentGuide(q);return I?(A.addAlignmentGuide(I.axis,K,q),!0):!1};var Ml=ab.Guide.Rect=function(s){var P=this;P._interactor=s};Ml.prototype={},Ml.prototype.constructor=Ml,Ml.prototype.gatherRects=function(){var d,c,f,W,T=this,x=T._interactor.gv,u=[],B=[],t={x:u,y:B},I={},y=x.getDataModel(),K=y.a("width"),e=y.a("height");K&&e&&(d=0,c=0,f=K,W=e,u.push({node:y,type:0,p:d},{node:y,type:1,p:d+f/2},{node:y,type:2,p:d+f}),B.push({node:y,type:0,p:c},{node:y,type:1,p:c+W/2},{node:y,type:2,p:c+W}),I[y._id||0]={x:d,y:c,width:f,height:W}),y.each(function(A){if(nf(A)&&!x.isSelected(A)&&x.isVisible(A)&&x.isValidGuideLineSource(A)){var U=!1;if(x.sm().getSelection().each(function(q){U||(A.isHostOn(q)?U=!0:A.isDescendantOf(q)&&(U=!0))}),!U){var H=A.getRect();d=H.x,c=H.y,f=H.width,W=H.height,u.push({node:A,type:0,p:d},{node:A,type:1,p:d+f/2},{node:A,type:2,p:d+f}),B.push({node:A,type:0,p:c},{node:A,type:1,p:c+W/2},{node:A,type:2,p:c+W}),I[A._id]=H}}}),u.sort(function(q,i){return q.p-i.p}),B.sort(function(N,K){return N.p-K.p}),T._grid=t,T._87I=I},Ml.prototype.gatherLines=function(X,V,y){var n,P,k,H,F,i,q,L,c,O,M,A,d=this,e=[d.findClosest({x:X.x,y:X.y},V),d.findClosest({x:X.x+X.w/2,y:X.y+X.h/2},V),d.findClosest({x:X.x+X.w,y:X.y+X.h},V)],$={},Y=d._87I;y=y||255;var g,B;for(d._guideLine=[],n=0;2>n;n++)for($={},0===n?(H="y",L=X.x,c=L+X.w):(H="x",L=X.y,c=L+X.h),P=0;3>P;P++)F=e[P],F&&isFinite(F[H])&&(g=1<<3*n+P,y&g&&(i=F[H+"Line"],q=i.node,B=q._id||0,$[B]||($[B]=!0,A=Y[B],"y"===H?(O=A.x,M=A.x+A.width):(O=A.y,M=A.y+A.height),k=i.p,d._guideLine.push({type:H,a:L,b:c,c:O,d:M,p:k,center:1===i.type}))))},Ml.prototype._binarySearchClosest=function(v,C){if(!C.length)return{dis:1/0};for(var U,J=0,b=C.length-1;b-J>1;)U=Math.floor((J+b)/2),C[U].p<v?J=U:b=U;var h=C[J].p-v,I=C[b].p-v;return Math.abs(h)<=Math.abs(I)?{line:C[J],dis:h}:{line:C[b],dis:I}},Ml.prototype.findClosest=function(k,h,M){var s=this,A=s._interactor,r=A.gv,B=s._grid;M&&(k=ab.toWorldPosition(r,k));var Y,g=s._binarySearchClosest(k.x,B.x),N=s._binarySearchClosest(k.y,B.y),P=g.dis,v=N.dis,x=r._zoom,H=A.getStyle("smartGuideThreshold")/x,Z={};return Math.abs(P)<H&&"y"!==h&&(Z.x=M?P*x:P,Z.xLine=g.line,Y=!0),Math.abs(v)<H&&"x"!==h&&(Z.y=M?v*x:v,Z.yLine=N.line,Y=!0),Y?Z:void 0},Ml.prototype._42=function(){var k=this,p=k._guideLine;if(p&&!L.Default.isCtrlDown()){var U=k._interactor;if(U.getStyle("guideLineVisible")){var K,x,q,G,v,T,N,Q,Y,l,h,i,R,I,_,F,r,P=U.gv,E=U._context,J=P.tx(),W=P.ty(),f=P._zoom,j=U.getStyle("guideLineTextSpacing");for(K=0,x=p.length;x>K;K++)q=p[K],Q=q.type,Y=q.p,l=q.a,h=q.b,i=q.c,R=q.d,I=Math.min(l,i),_=Math.max(h,R),"x"===Q?(G=Y*f+J,v=I*f+W,T=G,N=_*f+W):(G=I*f+J,v=Y*f+W,T=_*f+J,N=v),ab.Icons.DrawIcon(U,E,ab.Icons.MoveLineGuide,{rect:[G,v,T,N],center:q.center}),R>=l&&h>=i||(I=l>R?R:h,_=l>R?l:i,r=_-I,"x"===Q?(q.center2center||(G-=j,T=G),v=I*f+W,N=_*f+W,F=ab.Icons.MoveLineGuideDistanceV):"y"===Q&&(q.center2center||(v-=j,N=v),G=I*f+J,T=_*f+J,F=ab.Icons.MoveLineGuideDistanceH),ab.Icons.DrawIcon(U,E,F,{x0:G,y0:v,x1:T,y1:N,dis:r}))
}}},Ml.prototype.clear=function(){this._guideLine=null};var re=ab.Guide.Hover=function(Q){var S=this;S._interactor=Q};re.prototype={},re.prototype.constructor=re,U.defineProperties(re.prototype,{}),re.prototype._42=function(){var s=this._interactor;if(s.getStyle("hoverGuideVisible")&&!s.gvEditing){var g=s.hoverData,M=s.gv;if(!nf(g)||M.isSelected(g))return s.hoverData=null,void 0;var v=Gr(M,g),o=ab.toScreenPosition(M,{x:v.x,y:v.y}),V=ab.toScreenPosition(M,{x:v.x+v.width,y:v.y+v.height});ab.Icons.DrawIcon(s,s._context,ab.Icons.HoverDataRect,{min:o,max:V,color:s.getStyle("hoverGuideColor")||s.getStyle("baseColor"),borderWidth:s.getStyle("hoverGuideBorderWidth")||1,borderPattern:s.getStyle("hoverGuideBorderPattern")||[1,4]})}},ab.DefaultStyleMap={baseColor:"rgb(51,153,255)",pointSize:[24,9],checkSize:7,rotateCheckSize:10,moveSensitivity:10,moveDummyThreshold:32,moveDummyPosition:[0,0,-16,-16],moveDummyLineExtraShift:[-32,0],moveDummySensitivity:16,keepAspectRatio:!1,rotateRound:Math.PI/2,shiftRotateRound:Math.PI/12,rotateSensitivity:Math.PI/60,rotateAsClock:!1,rotateTipVisible:!0,shiftLineRotateRound:Math.PI/4,anchorMovable:!0,anchorVisible:!0,anchorHideThreshold:25,anchorOutsideVisibleThreshold:.25,anchorRound:.25,anchorSensitivity:.02,smartGuideThreshold:8,curveIntersectSize:5,curvePointIntersectSize:8,edgeHostDetectPerFrame:!0,edgeHostEdgeMaxDistance:12,edgeHostEdgeHighlighColor:"#5d5d5d",edgeHostPointHighlighColor:"red",edgeHostHighlighPeriod:1500,edgeElevationEditable:!1,attachThreshold:25,guideLineVisible:!0,guideLineTextSpacing:0,hoverGuideVisible:!1,hoverGuideColor:null,gridBlockSize:40,gridThickLinesEvery:10,gridThickColor:"#5d5d5d",gridLightColor:"#d0d0d0",gridZoomThreshold:.25,gridAlignmentGuideColor:"#ff0000",gridAngle:Math.PI/2,gridRotation:0,groupRotateModeDefault:"block",groupRotateModeKey:["ctrlKey","metaKey"],rotateCursorSize:32,rotateCursorRound:45,tipTextColor:"#ffffff",tipBackground:"#333333",curveHighlightColor:"#30599e",rectPointBackground:"white",rectPointBorderColor:"#666666",rectPointShadowColor:"rgba(0,0,0,0.35)",shapeCtrlPointBackground:"white",shapeCtrlPointBorderColor:null,shapeCtrlPointHighlightBorder:null,shapeHighlighPointBackground:"#30599e",curveElevationVisible:!0,curveElevationIntersectSize:8,curveElevationGuideShift:[20,0],curveTipVisible:!0,connectGuideVisible:!0,connectGuideShift:[1,.25,8,0],connectGuideIntersectSize:8,connectGuideGarbageIntersectsize:25,connectGuideGarbageShift:[1,1,-48,-48]};var Df=ab.Icons={},Je=1e4,Fm=null,yk=ab.DefaultStyleMap.baseColor,Tf="rgb(183,232,135)",lc="rgb(255,204,153)",jl=6;L.Default.setImage("Icons.RectPoint",{width:jl,height:jl,comps:[{type:"rect",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return yk}},rect:[0,0,jl,jl]}]}),Df.GroupSubEntityRect={comps:[{type:"shape",points:{func:function(){var Y=Df.GroupSubEntityRect.data;if(!Y)return[];var x=Y.min,V=Y.max;return[x.x,x.y,x.x,V.y,V.x,V.y,V.x,x.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return Df.GroupSubEntityRect.data.isKeyOb?yk:yk}}}]};var im=4;Df.HoverDataRect={comps:[{type:"shape",points:{func:function(){var o=Df.HoverDataRect.data;if(!o)return[];var q=o.min,Y=o.max,h=im;return q.x-=h,q.y-=h,Y.x+=h,Y.y+=h,[q.x,q.y,q.x,Y.y,Y.x,Y.y,Y.x,q.y]}},segments:[1,2,2,2,5],background:null,borderWidth:{func:function(){return Df.HoverDataRect.data.borderWidth}},borderColor:{func:function(){return Df.HoverDataRect.data.color}},borderCap:"butt",borderPattern:{func:function(){return Df.HoverDataRect.data.borderPattern}}}]},Df.Line={comps:[{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[Df.Line.data.P1.x,Df.Line.data.P1.y],jl,jl]}}},{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[Df.Line.data.P2.x,Df.Line.data.P2.y],jl,jl]}}}]},Df.NodeHoverGuide={comps:[{type:"shape",points:{func:function(){return Df.NodeHoverGuide.data}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:"#3399FF"}]},Df.Rect={comps:[{type:"shape",points:{func:function(){var M=Df.Rect.data;if(!M)return[];var o=M.LT,N=M.LB,m=M.RB,u=M.RT;return[o.x,o.y,N.x,N.y,m.x,m.y,u.x,u.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return yk}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Df.Rect.data.rotation}},rect:{func:function(){return[[Df.Rect.data.LT.x,Df.Rect.data.LT.y],jl,jl]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Df.Rect.data.rotation}},rect:{func:function(){return[[Df.Rect.data.LB.x,Df.Rect.data.LB.y],jl,jl]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Df.Rect.data.rotation}},rect:{func:function(){return[[Df.Rect.data.RB.x,Df.Rect.data.RB.y],jl,jl]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Df.Rect.data.rotation}},rect:{func:function(){return[[Df.Rect.data.RT.x,Df.Rect.data.RT.y],jl,jl]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Df.Rect.data.rotation}},visible:{func:function(){return Df.Rect.data.L?!0:!1}},rect:{func:function(){return[[Df.Rect.data.L.x,Df.Rect.data.L.y],jl,jl]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Df.Rect.data.rotation}},visible:{func:function(){return Df.Rect.data.R?!0:!1}},rect:{func:function(){return[[Df.Rect.data.R.x,Df.Rect.data.R.y],jl,jl]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Df.Rect.data.rotation}},visible:{func:function(){return Df.Rect.data.T?!0:!1}},rect:{func:function(){return[[Df.Rect.data.T.x,Df.Rect.data.T.y],jl,jl]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Df.Rect.data.rotation}},visible:{func:function(){return Df.Rect.data.B?!0:!1}},rect:{func:function(){return[[Df.Rect.data.B.x,Df.Rect.data.B.y],jl,jl]}}}]};var gk=16;L.Default.setImage("Icons.Anchor",{width:12,height:12,comps:[{type:"shape",borderWidth:1,borderColor:{func:function(){return yk}},borderCap:"round",shadowColor:"#1ABC9C",points:[.50928,6,11.49072,6,6,6,6,.50928,6,11.49072]},{type:"circle",borderWidth:1,borderColor:{func:function(){return yk}},shadowColor:"#1ABC9C",rect:[2.84391,2.84391,6.53697,6.53697]}]}),Df.Anchor={comps:[{type:"image",name:"Icons.Anchor",rect:{func:function(){return[[Df.Anchor.data.POS.x,Df.Anchor.data.POS.y],gk,gk]}}}]},Df.TipShiftX=12,Df.TipShiftY=12;var ts=[8,28];Df.TipHelper={comps:[{type:"roundRect",rect:{func:function(){return[Df.TipHelper.data.helperPos.x,Df.TipHelper.data.helperPos.y,ts[0]*Df.TipHelper.data.size,ts[1]]}},background:{func:function(){return Fm.getStyle("tipBackground")}},opacity:.6},{type:"text",text:{func:function(){return Df.TipHelper.data.text}},rect:{func:function(){return[Df.TipHelper.data.helperPos.x,Df.TipHelper.data.helperPos.y,ts[0]*Df.TipHelper.data.size,ts[1]]}},color:{func:function(){return Fm.getStyle("tipTextColor")}},font:"bold 12px Arial",align:"center"}]};var rc=7;Df.ShapePoint={comps:[{type:"circle",visible:{func:function(){return!!Df.ShapePoint.data.dynamicVisible}},rect:{func:function(){var s=Df.ShapePoint.data.point,N=Df.ShapePoint.data.size||rc;return[s,N+10,N+10]}},background:{func:function(){var j=Date.now(),v=Df.ShapePoint.data.dynamicPeriod||1500,y=Math.sin(j%v/v*Math.PI);return"rgba(27,124,22,"+.5*y+")"}},borderWidth:0},{type:"circle",rect:{func:function(){var j=Df.ShapePoint.data.point,L=Df.ShapePoint.data.size||rc;return[j,L,L]}},background:{func:function(){var f=Df.ShapePoint.data.isEnd;return f?"rgba(27,124,222,0.7)":"#ffffff"}},borderWidth:1,borderColor:{func:function(){return Df.ShapePoint.data.color||yk}}},{type:"rect",visible:{func:function(){return!!Df.ShapePoint.data.dynamicVisible}},background:"red",borderWidth:0,rotation:Math.PI/4,borderColor:{func:function(){return yk}},rect:{func:function(){var b=5;return[Df.ShapePoint.data.point,b,b]}}}]},Df.ShapeBgCurve={comps:[{type:"shape",visible:{func:function(){return!!Df.ShapeBgCurve.data.dynamicVisible}},points:{func:function(){return Df.ShapeBgCurve.data.P}},segments:{func:function(){return Df.ShapeBgCurve.data.S}},background:null,borderWidth:6,borderColor:{func:function(){var C=Date.now(),p=Df.ShapeBgCurve.data.dynamicPeriod||1500,y=Math.sin(C%p/p*Math.PI);return"rgba(27,124,22,"+.3*y+")"}}},{type:"shape",points:{func:function(){return Df.ShapeBgCurve.data.P}},segments:{func:function(){return Df.ShapeBgCurve.data.S}},background:null,borderWidth:1,borderColor:{func:function(){return Df.ShapeBgCurve.data.color||yk}}}]};var Ie=8;Df.ShapeHighlighPoint={comps:[{type:"circle",rect:{func:function(){var t=Df.ShapeHighlighPoint.data;return[[t.x,t.y],Ie,Ie]}},background:{func:function(){return Fm.getStyle("shapeHighlighPointBackground")}},borderWidth:0}]};var Zb=10;Df.ShapeHighlighRealPoint={comps:[{type:"circle",rect:{func:function(){var G=Df.ShapeHighlighRealPoint.data;return[[G.x,G.y],Zb,Zb]}},background:"#ffffff",borderWidth:2,borderColor:{func:function(){return yk}}}]};var El=8;Df.ShapeHighlighCtrlPoint={comps:[{type:"shape",points:{func:function(){var o=Df.ShapeHighlighCtrlPoint.data,P=o.x,M=o.y,g=El/2;return[P-g,M-g,P-g,M+g,P+g,M+g,P+g,M-g]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Fm.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return Fm.getStyle("shapeCtrlPointBorderColor")||yk}}}]};var fg=3;Df.ShapeHighlightCurve={comps:[{type:"shape",points:{func:function(){return Df.ShapeHighlightCurve.data}},segments:[1,4],background:null,borderWidth:fg,borderColor:{func:function(){return Fm.getStyle("curveHighlightColor")}}}]},Df.ShapeGuideLine={comps:[{type:"shape",points:{func:function(){return Df.ShapeGuideLine.data}},background:null,borderWidth:1,borderColor:"rgb(255,204,153)"}]},Df.MoveLineGuide={comps:[{type:"shape",points:{func:function(){return Df.MoveLineGuide.data.rect}},background:null,borderWidth:1,borderColor:{func:function(){return Df.MoveLineGuide.data.center?Tf:lc}}}]};var Xn=5;Df.MoveLineGuideDistanceH={comps:[{type:"shape",points:{func:function(){var x=Df.MoveLineGuideDistanceH.data,D=x.x0,z=x.y0;return[D,z-Xn,D,z+Xn]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:lc},{type:"shape",points:{func:function(){var L=Df.MoveLineGuideDistanceH.data,U=L.x1,K=L.y1;return[U,K-Xn,U,K+Xn]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:lc},{type:"text",text:{func:function(){return Math.round(Df.MoveLineGuideDistanceH.data.dis)}},rect:{func:function(){var c=Df.MoveLineGuideDistanceH.data;return[[(c.x0+c.x1)/2,c.y0-10],20,20]}},color:lc,font:"12px Arial",align:"center"}]},Df.MoveLineGuideDistanceV={comps:[{type:"shape",points:{func:function(){var n=Df.MoveLineGuideDistanceV.data,G=n.x0,Q=n.y0;return[G-Xn,Q,G+Xn,Q]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:lc},{type:"shape",points:{func:function(){var _=Df.MoveLineGuideDistanceV.data,I=_.x1,m=_.y1;return[I-Xn,m,I+Xn,m]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:lc},{type:"text",text:{func:function(){return Math.round(Df.MoveLineGuideDistanceV.data.dis)}},rect:{func:function(){var Y=Df.MoveLineGuideDistanceV.data;return[[Y.x0-10,(Y.y0+Y.y1)/2],20,20]}},color:lc,font:"12px Arial",align:"center"}]},L.Default.setImage("Icons.EdgeElevationGuideImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[.5,.5,15,15]},{type:"shape",borderWidth:2,borderColor:"rgb(44,44,44)",borderCap:"round",points:[4,8,8,4,12,8,8,4,8,13],segments:[1,2,2,1,2]}]}),Df.EdgeElevationGuide={comps:[{type:"image",name:"Icons.EdgeElevationGuideImage",rect:{func:function(){var H=Df.EdgeElevationGuide.data,r=H.x,O=H.y,U=Fm.getStyle("curveElevationIntersectSize"),S=Fm.getStyle("curveElevationGuideShift");return r+=S[0],O+=S[1],[r-U,O-U,2*U,2*U]}}}]},L.Default.setImage("Icons.ConnectGuideBgImage",{width:12,height:12,comps:[{type:"shape",background:"#3399ff",fillRule:"evenodd",shadowColor:"#1ABC9C",rotation:3.14159,points:[6.00001,11.99999,6.00001,11.99999,2.6863,11.99999,1e-5,9.30695,1e-5,5.99999,1e-5,5.99999,1e-5,2.68628,2.69305,-1e-5,6.00001,-1e-5,12.00001,-1e-5,11.99998,12.00001,6.00001,11.99999],segments:[1,2,4,2,4,2,2,2]}]}),L.Default.setImage("Icons.ConnectGuideHeaderImage",{width:12,height:12,comps:[{type:"oval",background:"#3399FF",borderColor:"#3399FF",shadowColor:"#1ABC9C",rect:[0,0,12,12]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[4.76,2.56,8.2,5.98,4.76,9.44]}]}),Df.ConnectGuide={comps:[{type:"image",name:"Icons.ConnectGuideBgImage",rotation:{func:function(){return Df.ConnectGuide.data.rotation}},rect:{func:function(){var S=Df.ConnectGuide.data.connect;S.x,S.y;var $=Fm.getStyle("connectGuideIntersectSize");return[[S.x,S.y],2*$,2*$]}}},{type:"image",name:"Icons.ConnectGuideHeaderImage",rect:{func:function(){var l=Df.ConnectGuide.data.cursorPos||Df.ConnectGuide.data.connect,D=Fm.getStyle("connectGuideIntersectSize");return[[l.x,l.y],2*D-2,2*D-2]}}},{type:"shape",background:null,borderColor:"#3399ff",borderWidth:2,segments:[1,4],points:{func:function(){var W=Df.ConnectGuide.data.connect,f=Df.ConnectGuide.data.cursorPos||W;return[W.x,W.y,W.x+.5*(f.x-W.x),W.y,f.x+.5*(W.x-f.x),f.y,f.x,f.y]}}}]},L.Default.setImage("Icons.ConnectGuideGarbageImage",{width:48,height:48,comps:[{type:"oval",background:"rgba(0,0,0,0.1)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,48,48]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[19.84721,19.69091,19.84721,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[24.10371,19.69091,24.10371,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[28.15279,19.69091,28.15279,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[11.23055,15.22377,36.76945,15.189,19.12302,15.17121,20.94722,11.5228,26.41985,11.5228,28.24406,15.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[15.48702,15.22377,17.02595,21.25344]}]}),L.Default.setImage("Icons.ConnectGuideDeletingImage",{width:56,height:56,comps:[{type:"oval",background:"rgba(232,0,0,0.75)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,56,56]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[22.67939,27.69091,22.67939,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[26.93588,27.69091,26.93588,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[30.98497,27.69091,30.98497,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",anchorX:0,anchorY:1,rotation:5.65062,points:[14.06272,23.22377,39.60163,23.189,21.9552,23.17121,23.7794,19.5228,29.25203,19.5228,31.07623,23.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[18.3192,23.22377,17.02595,21.25344]}]}),Df.ConnectGuideGarbage={comps:[{type:"image",name:{func:function(){var N=Df.ConnectGuideGarbage.data.hover;return N?"Icons.ConnectGuideDeletingImage":"Icons.ConnectGuideGarbageImage"}},rect:{func:function(){var Q=Df.ConnectGuideGarbage.data,c=Fm.getStyle("connectGuideGarbageIntersectsize");return Q.hover&&(c+=5),[[Q.x,Q.y],2*c,2*c]}}}]};var ih=6;Df.ShapeActivingCtrl={comps:[{type:"shape",visible:{func:function(){return Df.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var F=Df.ShapeActivingCtrl.data;return[F.point.x,F.point.y,F.c1.x,F.c1.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return yk}}},{type:"shape",visible:{func:function(){return Df.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var z=Df.ShapeActivingCtrl.data;return[z.point.x,z.point.y,z.c2.x,z.c2.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return yk}}},{type:"shape",visible:{func:function(){return Df.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var l=Df.ShapeActivingCtrl.data.c1,S=l.x,x=l.y,w=ih/2;return"c1"===Df.ShapeActivingCtrl.data.hl&&(w+=.5),[S-w,x-w,S-w,x+w,S+w,x+w,S+w,x-w]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Fm.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c1"===Df.ShapeActivingCtrl.data.hl?Fm.getStyle("shapeCtrlPointHighlightBorder")||yk:Fm.getStyle("shapeCtrlPointBorderColor")||yk}}},{type:"shape",visible:{func:function(){return Df.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var s=Df.ShapeActivingCtrl.data.c2,D=s.x,o=s.y,c=ih/2;return"c2"===Df.ShapeActivingCtrl.data.hl&&(c+=.5),[D-c,o-c,D-c,o+c,D+c,o+c,D+c,o-c]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Fm.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c2"===Df.ShapeActivingCtrl.data.hl?Fm.getStyle("shapeCtrlPointHighlightBorder")||yk:Fm.getStyle("shapeCtrlPointBorderColor")||yk}}}]},Df.RoundPoint={comps:[{type:"circle",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return yk}},rect:{func:function(){return[[Df.RoundPoint.data.x,Df.RoundPoint.data.y],jl,jl]}}}]},Df.AttachPoint={comps:[{type:"rect",background:{func:function(){return Df.AttachPoint.data.isAttach?"rgb(51,153,255)":"rgb(247,247,247)"}},borderWidth:1,rotation:Math.PI/4,borderColor:{func:function(){return yk}},rect:{func:function(){var Z=Df.AttachPoint.data.isAttach?jl+4:jl;return[[Df.AttachPoint.data.x,Df.AttachPoint.data.y],Z,Z]}}}]},Df.SimpleRect={comps:[{type:"rect",background:null,borderWidth:{func:function(){return Df.SimpleRect.data.borderWidth||1}},borderColor:{func:function(){return Df.SimpleRect.data.color||yk}},rect:{func:function(){var p=Df.SimpleRect.data;return[p.x,p.y,p.width,p.height]}}}]},L.Default.setImage("Icons.MoveDummyImage",{width:32,height:32,boundExtend:12,attachStyle:"close",comps:[{type:"oval",background:"rgb(255,255,255)",borderColor:"#979797",shadow:!0,shadowColor:"rgba(0,0,0,0.25)",shadowOffsetX:0,rect:[0,0,32,32]},{type:"shape",background:"rgb(51,153,255)",pixelPerfect:!0,points:[8.65079,11.90713,9.05502,11.46921,9.70629,11.46921,10.11052,11.90713,10.51476,12.28891,10.51476,12.92895,10.11052,13.34441,8.49359,14.97258,12.2889,14.97258,12.85034,14.97258,13.29949,15.42172,13.29949,15.99439,13.29949,16.57828,12.85034,17.0162,12.2889,17.0162,8.49359,17.0162,10.11052,18.6556,10.51476,19.0486,10.51476,19.7111,10.11052,20.09288,9.70629,20.50834,9.05502,20.50834,8.65079,20.09288,5.32709,16.76917,5.28217,16.71303,4.87794,16.32002,4.87794,15.67998,5.28217,15.26452,8.65079,11.90713,8.65079,11.90713,8.65079,11.90713,13.3444,10.09931,13.3444,10.09931,12.94017,10.50354,12.2889,10.50354,11.88467,10.09931,11.48043,9.69507,11.48043,9.0438,11.88467,8.63957,15.27574,5.25973,15.66874,4.86672,16.32001,4.86672,16.73547,5.25973,16.76917,5.31586,20.10409,8.63957,20.50832,9.0438,20.50832,9.68385,20.10409,10.09931,19.69986,10.49231,19.07105,10.50354,18.64436,10.09931,17.02742,8.45991,17.02742,12.26646,17.02742,12.83912,16.55581,13.31072,15.99438,13.31072,15.43295,13.31072,14.98379,12.83912,14.98379,12.26646,14.96134,8.45991,13.3444,10.09931,13.3444,10.09931,13.3444,10.09931,21.90069,13.33318,21.90069,13.33318,21.49646,12.91771,21.49646,12.27768,21.90069,11.89591,22.31615,11.45798,22.94497,11.45798,23.36043,11.89591,26.72904,15.2533,27.12205,15.66876,27.12205,16.3088,26.72904,16.7018,26.6729,16.75794,23.36043,20.08165,22.94497,20.49711,22.31615,20.49711,21.90069,20.08165,21.49646,19.69987,21.49646,19.03737,21.90069,18.64437,23.51763,17.00498,19.72231,17.00498,19.14965,17.00498,18.71173,16.56705,18.71173,15.98316,18.71173,15.41049,19.14965,14.96135,19.72231,14.96135,23.51763,14.96135,21.90069,13.33318,21.90069,13.33318,21.90069,13.33318,11.88467,23.32675,11.88467,23.32675,11.48043,22.94498,11.48043,22.27125,11.88467,21.88948,12.2889,21.48523,12.94017,21.48523,13.3444,21.88948,14.96134,23.52887,14.98379,19.7111,14.98379,19.14966,15.43295,18.67805,15.99438,18.67805,16.55581,18.67805,17.02742,19.14966,17.02742,19.7111,17.02742,23.52887,18.64436,21.88948,19.07105,21.48523,19.69986,21.48523,20.10409,21.88948,20.50832,22.27125,20.50832,22.94498,20.10409,23.32675,16.76917,26.65045,16.73547,26.72905,16.32001,27.13329,15.66874,27.13329,15.27574,26.72905,11.88467,23.32675,11.88467,23.32675,11.88467,23.32675],segments:[1,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2]}]}),Df.MoveDummy={comps:[{type:"image",name:"Icons.MoveDummyImage",rect:{func:function(){var r=Df.MoveDummy.data;return[[r.pos.x,r.pos.y],2*r.size,2*r.size]}}}]},ab.Icons.DrawIcon=function(b,i,d,l){d.width=d.height=Je,d.data=l,Fm=b,L.Default.drawImage(i,d,0,0,Je,Je),Fm=A},ab.Icons.MapPoints=function(R,h){for(var X=0,_=R.length;_>X;X++)R[X]/=h},ab.roundTo=function(F,H,A){var d=Math.abs(F%H);return A>d||A>H-d?H*Math.round(F/H):F},ab.toFixed=function(U){return Math.round(100*U)/100},ab.getDataMatrix=function(r){if(r instanceof L.Shape){var l=new L.Math.Matrix2d,Z=r.getPosition();return l.translate(-Z.x,-Z.y).scale(r.getScale().x,r.getScale().y).rotate(r.getRotation()).translate(Z.x,Z.y),l}return r.getMatrix?r.getMatrix():new L.Math.Matrix2d};var eg=ab.Math.Curve=function(){this._curves=[]};eg.prototype={},eg.prototype.constructor=eg,eg.prototype.createFromHtShape=function(S,o,X){o instanceof L.List&&(o=o.toArray());var $,m,K,W,l,r,f,H=this,J=null,c=null,j=0,D=ab.Math.Vector2,G=ab.Math.CubicBezier,U=function(b){return new D(S[b],S[b+1],X?X[b/2]:A)};for(m=0,K=o.length;K>m;m++){switch(W=o[m],l=null,W){case 1:c=U(j),J=c,j+=2;break;case 2:$=U(j),j+=2,l=new G(c,c.clone(),$.clone(),$),c=$;break;case 3:r=U(j),$=U(j+2),j+=4,l=new G(c,r.clone().sub(c).multiplyScalar(2/3).add(c),r.clone().sub($).multiplyScalar(2/3).add($),$),c=$;break;case 4:r=U(j),f=U(j+2),$=U(j+4),j+=6,l=new G(c,r,f,$),c=$;break;case 5:if(!J)break;l=new G(c,c.clone(),J.clone(),J),c=null,J=null}l&&(l._index=H._curves.length,H._curves.push(l))}},eg.prototype.checkPoint=function(D,c){var E,N,p,y,Q,m=this,s=m._curves;for(E=0,N=s.length;N>E;E++)if(y=s[E],Q=y.intersectRect(D,c,c),Q.length)return p=0,Q.forEach(function(b){p+=b.t}),p/=Q.length,D=y.getPointAt(p),D.t=p,{bezier:y,intersection:D}},eg.prototype.insertKnot=function(L,n){var l=L.insertKnot(n),j=this,A=j._curves;A.splice(L._index,1,l[0],l[1])},eg.prototype._isCloseEnough=function(X,o){return Math.abs(X.x-o.x)<1e-6&&Math.abs(X.y-o.y)<1e-6},eg.prototype._isSamePoint=function(j,Q){return j===Q},eg.prototype.moveRealPoint=function(t,k){var W=this,u=W._curves,f=k.clone().sub(t);u.forEach(function(D){var R=D._p1;D._p2,D._p3;var F=D._p4;W._isSamePoint(R,t)&&(D._p2.add(f),D._p1=k),W._isSamePoint(F,t)&&(D._p3.add(f),D._p4=k)})},eg.prototype.moveCtrlDueToRealPointMovement=function(z,i){var W=this,s=W._curves,Q=function(V){V.add(i),V.e&&i.e&&(V.e+=i.e)};s.forEach(function(Y){var U=Y._p1;Y._p2,Y._p3;var G=Y._p4;W._isSamePoint(U,z)&&Q(Y._p2),W._isSamePoint(G,z)&&Q(Y._p3)})},eg.prototype.moveCtrlPoint=function(i,K,C){var m=i[C];if(m){m.e!==A&&(K.e=m.e);var c=this,q=c._curves;K.clone().sub(m),q.forEach(function(p){var n;"c2"===C?n="_p2":"c1"===C&&(n="_p3"),c._isSamePoint(p[n],m)&&(p[n]=K)}),i[C]=K}},eg.prototype.deleteRealPoint=function(Q,F){var v,Z,b,m,I,W,R,N=this,A=N._curves,d={},o=[],P=ab.Math.CubicBezier;for(Z=0,b=A.length;b>Z;Z++)v=A[Z],m=v._p1,I=v._p2,W=v._p3,R=v._p4,(d[Z]||!N._isSamePoint(m,Q))&&(N._isSamePoint(R,Q)?b>Z+1&&N._isSamePoint(A[Z+1]._p1,Q)&&(F||o.push(new P(m,I,A[Z+1]._p3,A[Z+1]._p4))):o.push(v));N._curves=o},eg.prototype.findPairs=function(u,x){var a,y,L,v,z,j,$,P,V=this,K=V._curves,S={},A=[];for(y=0,L=K.length;L>y;y++)a=K[y],v=a._p1,z=a._p2,j=a._p3,$=a._p4,!S[y]&&V._isSamePoint(v,u)&&(x?A.push({point:v,r2:$}):A.push({point:v,c2:z})),V._isSamePoint($,u)&&(P=x?{point:$,r1:v}:{point:$,c1:j},L>y+1&&V._isSamePoint(K[y+1]._p1,u)&&(x?P.r2=K[y+1]._p4:P.c2=K[y+1]._p2,S[y+1]=!0),A.push(P));return A},eg.prototype.toHtShape=function(){var Y=this,L=Y._curves,m=[],J=[],f={x:1/0,y:1/0};return L.forEach(function(x){var P=x._p1,I=x._p2,F=x._p3,Q=x._p4;return Y._isCloseEnough(P,f)||(m.push(1),J.push(P.clone())),f=Q,Y._isCloseEnough(P,I)&&Y._isCloseEnough(F,Q)?(m.push(2),J.push(Q.clone()),void 0):(m.push(4),J.push(I.clone(),F.clone(),Q.clone()),void 0)}),{segments:m,points:J}};var Dh=ab.Math.CubicBezier=function(g,i,U,Y){var J=this;J._id=ab.Math.CubicBezier._globalId++,J._p1=g,J._p2=i,J._p3=U,J._p4=Y};Dh._globalId=1,Dh.prototype={},Dh.prototype.constructor=Dh,Dh.prototype.toString=function(){return this._id},Dh.prototype.intersectRect=function(q,m,d){var N=m/2,Y=d/2,c=q.x,H=q.y,S=ab.Math.Vector2,y=new S(-N+c,-Y+H),e=new S(N+c,Y+H),f=new S(e.x,y.y),$=new S(y.x,e.y),D=this,C=D.intersectLine(y,f),W=D.intersectLine(f,e),V=D.intersectLine(e,$),r=D.intersectLine($,y),o=C.concat(W).concat(V).concat(r);return o},Dh.prototype.intersectLine=function(k,o){var u,Z,L,a,G,Y,H,j,x,C,A,K,l,y=this,v=k.clone().min(o),T=k.clone().max(o);a=y._p1,G=y._p2,Y=y._p3,H=y._p4,u=a.clone().multiplyScalar(-1),Z=G.clone().multiplyScalar(3),L=Y.clone().multiplyScalar(-3),A=u.add(Z).add(L).add(H),u=a.clone().multiplyScalar(3),Z=G.clone().multiplyScalar(-6),L=Y.clone().multiplyScalar(3),C=u.add(Z).add(L),u=a.clone().multiplyScalar(-3),Z=G.clone().multiplyScalar(3),x=u.add(Z),j=a.clone(),l=new ab.Math.Vector2(k.y-o.y,o.x-k.x),K=k.x*o.y-o.x*k.y;for(var f=y.getRoots(l.dot(A),l.dot(C),l.dot(x),l.dot(j)+K),z=new Array,D=0,h=f.length;h>D;D++){var d=f[D];if(!(0>d||d>1)){var p=y.getPointAt(d);p.t=d,k.x==o.x?v.y<=p.y&&p.y<=T.y&&z.push(p):k.y==o.y?v.x<=p.x&&p.x<=T.x&&z.push(p):p.x>=v.x&&p.y>=v.y&&p.x<=T.x&&p.y<=T.y&&z.push(p)}}return z},Dh.prototype.solveTForPoint=function(G){var F,i,H,T,p=this;F=p._p1.x-G.x,i=p._p2.x-G.x,H=p._p3.x-G.x,T=p._p4.x-G.x;for(var c=p.getRoots(T-3*H+3*i-F,3*H-6*i+3*F,3*i-3*F,F),J=A,u=1/0,a=0,D=c.length;D>a;a++){var Q=c[a];if(!(0>Q||Q>1)){var v=p.getPointAt(Q);v.t=Q;var s=Math.abs(v.y-G.y);u>s&&(u=s,J=v)}}return J},Dh.prototype.getPointAt=function(O){var g=this,I=g._p1,G=g._p2,J=g._p3,T=g._p4,s=I.clone().lerp(G,O),b=G.clone().lerp(J,O),w=J.clone().lerp(T,O),$=s.lerp(b,O),W=b.lerp(w,O);return $.lerp(W,O)},Dh.prototype.getPointByPercentage=function(b){var A=this.length*b,G=this._cacheLength,x=G.length;if(0===A)return G[0].point;if(b>=1)return G[x-1].point;for(var C=0;x>C;C++){var q=G[C];if(!(q.len<A)){var t=G[C-1];return q.point.clone().sub(t.point).setLength(A-t.len).add(t.point)}}},Dh.prototype.getTByPercentage=function(t){var X=this.length*t,Z=this._cacheLength,P=Z.length;if(0===X||0>=t)return Z[0].t;if(t>=1)return Z[P-1].t;for(var q=0;P>q;q++){var h=Z[q];if(!(h.len<X)){var T=Z[q-1];return(X-T.len)/(h.len-T.len)*(h.t-T.t)+T.t}}},Dh.prototype.getRoots=function(D,t,U,V){var p,W,T,E,i,$=new Array;if(Math.abs(D)<1e-6){var p=t,W=U/p,T=V/p,E=W*W-4*T;if(E>0){var i=Math.sqrt(E);$.push(.5*(-W+i)),$.push(.5*(-W-i))}else 0==E&&$.push(.5*-W)}t/=D,U/=D,V/=D,p=(3*U-t*t)/3,W=(2*t*t*t-9*U*t+27*V)/27;var I=t/3,c=W*W/4+p*p*p/27,d=W/2;if(Math.abs(c)<=1e-6&&(c=0),c>0){var v,s,i=Math.sqrt(c);v=-d+i,s=v>=0?Math.pow(v,1/3):-Math.pow(-v,1/3),v=-d-i,v>=0?s+=Math.pow(v,1/3):s-=Math.pow(-v,1/3),$.push(s-I)}else if(0>c){var x=Math.sqrt(-p/3),X=Math.atan2(Math.sqrt(-c),-d)/3,M=Math.cos(X),j=Math.sin(X),z=Math.sqrt(3);$.push(2*x*M-I),$.push(-x*(M+z*j)-I),$.push(-x*(M-z*j)-I)}else{var v;v=d>=0?-Math.pow(d,1/3):Math.pow(-d,1/3),$.push(2*v-I),$.push(-v-I)}return $},Dh.prototype._70I=function(){var R=this;return R._p1.distanceToSquared(R._p2)<1e-10&&R._p3.distanceToSquared(R._p4)<1e-10},Dh.prototype.insertKnot=function(v){var e=this,m=e._p1,i=e._p2,x=e._p3,l=e._p4,T=m.clone().lerp(i,v),U=i.clone().lerp(x,v),O=x.clone().lerp(l,v),A=T.clone().lerp(U,v),H=U.clone().lerp(O,v),g=A.clone().lerp(H,v);return e._70I()?(m.clone().lerp(l,v),[new ab.Math.CubicBezier(m,m.clone(),g.clone(),g),new ab.Math.CubicBezier(g,g.clone(),l.clone(),l)]):[new ab.Math.CubicBezier(m,T,A,g),new ab.Math.CubicBezier(g,H,O,l)]},U.defineProperties(Dh.prototype,{length:{get:function(){var D=this._cacheLength;if(!D){D=this._cacheLength=[];for(var z=this._p1,U=0,J=0;1>=U;){var p=this.getPointAt(U+=.001);J+=p.clone().sub(z).length(),z=p,D.push({len:J,t:U,point:p.clone()})}}return D[D.length-1].len}},p1:{get:function(){return this._p1},set:function(e){this._p1=e,this._cacheLength=A}},p2:{get:function(){return this._p2},set:function(N){this._p2=N,this._cacheLength=A}},p3:{get:function(){return this._p3},set:function(E){this._p3=E,this._cacheLength=A}},p4:{get:function(){return this._p4},set:function(m){this._p4=m,this._cacheLength=A}}});var Ki=L.Default.getInternal().ui().EdgeUI,wc={_47O:function($){var c=this,g=wc.getBackups()._47O;ab.inEdit(c.gv)||g.call(c,$)}};ab.Inject.registAsModule(wc,Ki);var Go=L.Default.getInternal().ui().NodeUI,rf={_47O:function(f){var I=this,K=rf.getBackups()._47O;ab.inEdit(I.gv)||K.call(I,f)},getSelectWidth:function(){var a=this,i=a.gv,F=a._data;if(i.isEditable(F)&&ab.inEdit(i))return 0;var H=rf.getBackup("getSelectWidth");return H.call(a)}};ab.Inject.registAsModule(rf,Go);var Vk=L.graph.GraphView,$b={_editPointSize:function(){var q=L.Default.isTouchable,X=ab.getStyle("pointSize");return X[q?0:1]}(),isPointEditable:function(n){var E=this;if(ab.inEdit(E))return E._pointEditableFunc?E._pointEditableFunc(n):!0;var k=$b.getBackup("isPointEditable");k.call(E,n)},isEditable:function(_){var s,b=this,y=$b.getBackup("isEditable");if(s=_ instanceof ab.Group?!0:y.call(b,_),!ab.inEdit(b))return s;if(!(_ instanceof L.Edge))return s;if(!_.s("2d.editable"))return!1;var X=b.getEditableFunc();return X?X(_):!0},_42:function(b,p){var x=this,o=$b.getBackups()._42;if(o.call(x,b,p),ab.inEdit(x)){var s=x.getEditInteractor();s.drawImpl()}}};ab.Inject.registAsModule($b,Vk);var vb=L.Default.getInternal().ui().ShapeUI,Lk={_47O:function(E){var i=this,V=Lk.getBackups()._47O;ab.inEdit(i.gv)||V.call(i,E)}};ab.Inject.registAsModule(Lk,vb);var Dk=L.graph.DefaultInteractor,ed={handle_mousewheel:function(A){var a=this,K=ed.getBackup("handle_mousewheel");ab.inEdit(a.gv)||K.call(a,A)}};ab.Inject.registAsModule(ed,Dk);var Oj=L.graph.MoveInteractor,Cb={_calcShift:function(f,k){var t=this,S=Cb.getBackup("_calcShift"),w=t.gv;if(!ab.inEdit(w))return S.call(t,f,k);var c=w.getEditInteractor(),e=c.getSubModule("Move").calcShift(f,k,t);return e||S.call(t,f,k)},clear:function(K){var x=this,h=Cb.getBackup("clear");h.call(x,K);var Q=x.gv;if(ab.inEdit(Q)){var F=Q.getEditInteractor();F.getSubModule("Move").clear(K)}}};ab.Inject.registAsModule(Cb,Oj);var Ml=ab.Rect=function(e){this.catalog="Rect",this._interactor=e};Ml.prototype={},Ml.prototype.constructor=Ml,Ml.prototype.gatherInfo=function(j,K){var U=this;if(1===K.length){var z=K[0];return z instanceof L.Shape&&z._70I()?U.gatherLine(j,z):_d(z,j)?!1:U.gatherSingleTarget(j,z)}return K.length>1?U.gatherMultiTargets(j,K):!1},Ml.prototype.gatherSingleTarget=function(l,L){if(L.getCorners){var Q,u=this,q=u.info;u.target=L,Q=u.screenInfo={};var A=L.getCorners();q.LT=new ab.Math.Vector2(A[0]),q.LB=new ab.Math.Vector2(A[1]),q.RB=new ab.Math.Vector2(A[2]),q.RT=new ab.Math.Vector2(A[3]),q.T=q.LT.clone().add(q.RT).divideScalar(2),q.B=q.LB.clone().add(q.RB).divideScalar(2),q.L=q.LT.clone().add(q.LB).divideScalar(2),q.R=q.RT.clone().add(q.RB).divideScalar(2);for(var W in q)Q[W]=ab.toScreenPosition(l,q[W]);var i=u._interactor,Y=i.getStyle("checkSize"),X=function(S,i,b){var l=i.clone().sub(S).setLength(-Y),W=b.clone().sub(S).setLength(-Y),J=l.add(W).add(S);return J};return Q.rotLT=X(Q.LT,Q.RT,Q.LB),Q.rotLB=X(Q.LB,Q.LT,Q.RB),Q.rotRB=X(Q.RB,Q.LB,Q.RT),Q.rotRT=X(Q.RT,Q.LT,Q.RB),Q.rotT=Q.rotLT.clone().add(Q.rotRT).divideScalar(2),Q.rotB=Q.rotLB.clone().add(Q.rotRB).divideScalar(2),Q.rotL=Q.rotLT.clone().add(Q.rotLB).divideScalar(2),Q.rotR=Q.rotRT.clone().add(Q.rotRB).divideScalar(2),Q.rotation=L.getRotation(),u.gatherConnectInfo(),!0
}},Ml.prototype.gatherConnectInfo=function(){var F=this,q=F.target,f=F._interactor,Y=F.screenInfo,l=f.gv;if(l.isConnectActionVisible(q)&&f.getStyle("connectGuideVisible")){var d;q.s&&(d=q.s("connectGuideShift")),d||(d=f.getStyle("connectGuideShift"));var b=q.getAnchor(),e=q.getSize(),D=q.toGlobal({x:e.width*(d[0]-b.x),y:e.height*(d[1]-b.y)});D=ab.toScreenPosition(l,D),Y.P1?D.add(Y.P2.clone().sub(Y.P1).setLength(d[2])):(D.add(Y.RT.clone().sub(Y.LT).setLength(d[2])),D.add(Y.LB.clone().sub(Y.LT).setLength(d[3]))),Y.connect=D}},Ml.prototype.gatherMultiTargets=function(B,U){var j=ab.Group.findOrCreateGroup(U,this._interactor._uuid);if(!j)return!1;var G=this;return G.editing&&"rotate"!==G.editing.mode||j.calcInfo(),G.gatherSingleTarget(B,j)},Ml.prototype.gatherLine=function(o,r){this.target=r;var P=this.screenInfo={},A=r.getPoints(),O=ab.getDataMatrix(r);return P.P1=ab.toScreenPosition(o,O.apply(A.get(0))),P.P2=ab.toScreenPosition(o,O.apply(A.get(1))),this.gatherConnectInfo(),!0},Ml.ResizeKeys=["LT","RB","LB","RT","L","R","B","T"],Ml.ResizeDirection=[{x:-1,y:-1},{x:1,y:1},{x:-1,y:1},{x:1,y:-1},{x:-1,y:0},{x:1,y:0},{x:0,y:1},{x:0,y:-1}],Ml.RotateKeys=["rotLT","rotRB","rotLB","rotRT","rotL","rotR","rotB","rotT"],Ml.prototype.check=function(c,$,d){if(L.Default.isLeftButton($)){var l=this;if(l.editing=null,l.tipInfo=null,l.screenInfo){var y=l.target,i=c.isEditable(y),u=l.screenInfo;if(i&&u.connect){var B=l._checkConnect(d);if(B)return B}if(u.P1)return l._checkLine(d);var x,f,U,C=null,F=l._interactor,m=F.getStyle("checkSize");if(i&&c.isRectEditable(y))for(f=0;f<ab.Rect.ResizeKeys.length;f++)if(U=ab.Rect.ResizeKeys[f],ab.checkHit(d,u[U],m)){C=U,x="resize";break}if(!C&&i&&c.isRotationEditable(y)&&!F.getStyle("rotateAsClock")){var K=F.getStyle("rotateCheckSize");for(f=0;f<ab.Rect.RotateKeys.length;f++)if(U=ab.Rect.RotateKeys[f],ab.checkHit(d,u[U],K)){C=U,x="rotate";break}}if(!C)return F.setCursor("default"),void 0;if("rotate"===x){var b,k=c.lp($);if(y instanceof ab.Group){var h=F.getStyle("groupRotateModeKey");"string"==typeof h&&(h=[h]);for(var g=!1,o=0,V=h.length;V>o;o++)if($[h[o]]){g=!0;break}var O=F.getStyle("groupRotateModeDefault");b=g?"batch"===O?"block":"batch":O}var R="batch"===b?y.getAnchor2():y.getPosition(),p=Math.atan2(k.y-R.y,k.x-R.x);F._setRotateCursor(p),l.editing={mode:x,key:C,pos:R,flipY:y.getScale().y<0,rotation:y.getRotation(),hitRot:p},b&&(l.editing.groupRotateMode=b)}else{var E=ab.Rect.ResizeKeys.indexOf(C),N=ab.Rect.ResizeDirection[E],W=Math.cos(y.getRotation()),q=Math.sin(y.getRotation()),s=N.x*Math.sign(y.getScale().x),S=N.y*Math.sign(y.getScale().y),M=Math.atan2(-q*s-W*S,W*s-q*S),e=(Math.round(M/(Math.PI/4))+8)%8,j=["ew-resize","nesw-resize","ns-resize","nwse-resize","ew-resize","nesw-resize","ns-resize","nwse-resize"][e];this._interactor.setCursor(j);var w=y.getWidth(),Y=y.getHeight(),A=y.getAnchor();l.editing={mode:x,key:C,rect:{x:-w*A.x,y:-Y*A.y,width:w,height:Y},anchor:A,matrix:y.getMatrix()}}return C}}},Ml.prototype._checkLine=function(q){var n=this;n.screenInfo;var x,A=n._interactor.getStyle("checkSize");if(ab.checkHit(q,n.screenInfo.P1,A))x="P1";else{if(!ab.checkHit(q,n.screenInfo.P2,A))return this._interactor.setCursor("default"),void 0;x="P2"}return n.editing={mode:"line",key:x},x},Ml.prototype._checkConnect=function(h){var Y=this,x=Y.screenInfo,i=Y._interactor,w=i.getStyle("connectGuideIntersectSize"),Q=x.connect,F=h.x,l=Q.x;if(l>F&&w>l-F&&Math.abs(Q.y-h.y)<w||F>=l&&ab.checkHit(h,Q,w)){var v="connect",G=r.getConnectAction(i.gv);if(Y.editing={mode:v},G&&G.delete)if(Y.target instanceof ab.Group){var L=!0;i.gv.sm().getSelection().each(function(y){G.delete.visible.call(null,i.gv,y)||(L=!1)}),Y.editing.hasDeleteAction=L}else G.delete.visible.call(null,i.gv,Y.target)&&(Y.editing.hasDeleteAction=!0);return i.setCursor("default"),v}},Ml.prototype._fireEditEvent=function(y,h){var J=this._interactor,D=this.editing;if(D){var c=D.mode;c="rotate"===c?"Rotation":"connect"===c?"Connection":"resize"===c?"Rect":c[0].toUpperCase()+c.slice(1),J.fi({kind:y+"Edit"+c,event:h})}},Ml.prototype.startEdit=function(M,D){M.startDragging(D);var N=this;N._interactor.fi({kind:"prepareEdit",event:D});var F=N.editing,V=N.target;if(F){if(N._fireEditEvent("begin",D),F.started=!0,"rotate"===F.mode)return F.groupRotateMode&&V.beginRotate(F),M._42(),void 0;if("connect"!==F.mode)("line"===F.mode||V&&0===V.getRotation())&&(N._inSmartGuide=!0,N._interactor.rectGuide.gatherRects());else if(F.hasDeleteAction){var d=M.gv,m=N._interactor.getStyle("connectGuideGarbageShift");F.garbageInfo={x:d.getWidth()*m[0]+m[2],y:d.getHeight()*m[1]+m[3],size:N._interactor.getStyle("connectGuideGarbageIntersectsize")},M._42()}}},Ml.prototype._46O=function(N){var a,Q,g=this,p=g.editing,T=g.target;if(p){if("connect"===p.mode&&!p.canceled&&!p.deleted)try{p.garbageInfo&&p.garbageInfo.hover?r.doDeleteConnectionAction(g._interactor.gv,T):r.doConnectAction(g._interactor.gv,T,p.target)}catch(M){console.error(M)}Q=p.freezeFlag,a=g.editing.groupRotateMode,g._fireEditEvent("end",N),g.editing=null}g.tipInfo=null,g._inSmartGuide&&(g._interactor.rectGuide.clear(),g._inSmartGuide=!1),a&&T&&T.endRotate(),T instanceof L.Block&&(Q===A?delete T._freezeSyncFromChildren:T._freezeSyncFromChildren=Q,T.updateFromChildren())},Ml.prototype.handleNormalStateDelete=function(){var E=this,P=E.editing;if(P&&"connect"===P.mode&&!P.canceled&&!P.deleted){if(P.garbageInfo){try{r.doDeleteConnectionAction(E._interactor.gv,E.target)}catch(h){console.error(h)}P.garbageInfo=null}return P.cursorPos=null,P.targetCorners=null,P.deleted=!0,E._interactor._42(),!0}},Ml.prototype.handleNormalStateKeyDown=function(e){var g=this,l=g.editing;return!l||"connect"!==l.mode||l.canceled||l.deleted?void 0:L.Default.isEsc(e)?(l.cursorPos=null,l.targetCorners=null,l.canceled=!0,g._interactor._42(),!0):void 0},Ml.prototype.handleEdit=function(V,m){var X=this,H=X.editing;if(H){var y,k,E,Z,i,D=X.target,K=H.key,A=H.mode,h=V.lp(m),C=X._interactor;if("connect"===A){if(H.canceled)return;if(H.deleted)return;H.cursorPos=C._getLogicalPoint(m);var j=H.garbageInfo;return j&&ab.checkHit(H.cursorPos,j,j.size)?(j.hover=!0,H.target=null,H.targetCorners=null):(j&&(j.hover=!1),H.target=V.getDataAt(h,function(Y){return V.isSelectable(Y)?nf(Y)?!0:!1:!1})||null,H.targetCorners=ab.getTargetCornersOnScreen(V,H.target)),C._42(),void 0}if("rotate"===A){var _,n,p=H.pos,Q=Math.atan2(h.y-p.y,h.x-p.x);if(H.groupRotateMode?n=Q-H.hitRot:(_=Q-H.hitRot,n=H.rotation+_),n%=2*Math.PI,0>n&&(n+=2*Math.PI),!L.Default.isCtrlDown(m)){var s,v;Fr(m)?(s=C.getStyle("shiftRotateRound"),v=s/2):(s=C.getStyle("rotateRound"),v=C.getStyle("rotateSensitivity")),n=ab.roundTo(n,s,v)}H.groupRotateMode?(_=n-(H.lastRotation||0),0!==_&&(D.addRotation(_,H.groupRotateMode,function(B){return V.isRotationEditable(B)}),H.lastRotation=n)):D.setRotation(n),C._setRotateCursor(Q),n>Math.PI&&(n-=2*Math.PI);var W=180*(n/Math.PI);W=W.toFixed(2),y=""+W+""}else if("resize"===A){var w=H.rect;E=w.x,Z=w.y;var g,U=w.width,I=w.height,N=H.anchor,r=H.matrix,t=D.s&&D.s("keepAspectRatio")||C.getStyle("keepAspectRatio");Fr(m)&&(t=!t);var T=X._unionPointMode1,z=X._unionPointMode2;if(X._inSmartGuide&&!L.Default.isCtrlDown(m)&&!t){var o;"L"===K||"R"===K?o="x":("T"===K||"B"===K)&&(o="y"),X._adsorbedToClosest(h,o),i=!0}g=r.tfi(h);var G;"LT"===K?(w=T(g,{x:E+U,y:Z+I},U,I,t),G=9):"T"===K?(w=z({x:E,y:g.y},{x:E+U,y:Z+I},U,I,t,"v"),G=1):"RT"===K?(w=T(g,{x:E,y:Z+I},U,I,t),G=33):"L"===K?(w=z({x:g.x,y:Z},{x:E+U,y:Z+I},U,I,t,"h"),G=8):"R"===K?(w=z({x:E,y:Z},{x:g.x,y:Z+I},U,I,t,"h"),G=32):"LB"===K?(w=T(g,{x:E+U,y:Z},U,I,t),G=12):"B"===K?(w=z({x:E,y:Z},{x:E+U,y:g.y},U,I,t,"v"),G=4):"RB"===K&&(w=T(g,{x:E,y:Z},U,I,t),G=36);var l=r.tf(w.x+w.width*N.x,w.y+w.height*N.y);D instanceof L.Block&&(H.hasOwnProperty("freezeFlag")||(H.freezeFlag=D._freezeSyncFromChildren,D._freezeSyncFromChildren=!0)),D.setPosition(l),D.setSize(w.width,w.height),i&&(k=D.getRect(),C.rectGuide.gatherLines({node:D,x:k.x,y:k.y,w:k.width,h:k.height},o,G)),y=""+Math.round(w.width)+" * "+Math.round(w.height)}else if("line"===A){if(Fr(m)){var b=D.getPoints(),R="P1"===K?b.get(1):b.get(0),x={x:h.x-R.x,y:h.y-R.y},S=C.getStyle("shiftLineRotateRound"),Y=X._shiftDirList;if(!Y||X._shiftRotateRound!==S){X._shiftRotateRound=S,X._shiftDirList=Y=[];for(var J=0;J<Math.PI;J+=S)Y.push({x:e(J),y:$(J)})}for(var O,c=0,a=0,u=Y.length;u>a;a++){var F=Y[a],P=F.x*x.x+F.y*x.y;Math.abs(P)>Math.abs(c)&&(c=P,O=F)}h={x:R.x+O.x*c,y:R.y+O.y*c},C.rectGuide.clear()}else X._inSmartGuide&&!L.Default.isCtrlDown(m)&&(X._adsorbedToClosest(h),i=!0);var q=ab.getDataMatrix(D).applyInverse(h);D.setPoint("P1"===K?0:1,q,!0);var B=D.getPoints(),f=B.get(0),d=B.get(1);E=f.x-d.x,Z=f.y-d.y,y=" "+Math.round(Math.sqrt(E*E+Z*Z))+" ",i&&(k=D.getRect(),C.rectGuide.gatherLines({node:D,x:k.x,y:k.y,w:k.width,h:k.height}))}if(y){var M=L.Default.getLogicalPoint(m,C._canvas);M.x+=ab.Icons.TipShiftX,M.y+=ab.Icons.TipShiftY,X.tipInfo={helperPos:M,text:y,size:y.length}}X._fireEditEvent("between",m)}},Ml.prototype._unionPointMode1=function(h,n,X,s,w){if(w&&X&&s){var m=h.x-n.x,$=h.y-n.y;Math.abs(m*s)<Math.abs($*X)?($=Math.sign($)*Math.abs(m*s/X),h.y=n.y+$):(m=Math.sign(m)*Math.abs($*X/s),h.x=n.x+m)}return L.Default.unionPoint(h,n)},Ml.prototype._unionPointMode2=function(A,E,d,e,H,O){var q=L.Default.unionPoint(A,E);if(H&&d&&e){var W;"v"===O?(W=q.x+q.width/2,q.width=d*q.height/e,q.x=W-q.width/2):(W=q.y+q.height/2,q.height=e*q.width/d,q.y=W-q.height/2)}return q},Ml.prototype._adsorbedToClosest=function(x,G){var K=this,g=K._interactor,f=g.rectGuide.findClosest(x,G),T=g.gridGuide.findClosest(x,G),Z=1/0,j=1/0;f&&(isFinite(f.x)&&(Z=f.x),isFinite(f.y)&&(j=f.y)),T&&(isFinite(T.x)&&Math.abs(T.x)<Math.abs(Z)&&(Z=T.x),isFinite(T.y)&&Math.abs(T.y)<Math.abs(j)&&(j=T.y)),isFinite(Z)&&(x.x+=Z),isFinite(j)&&(x.y+=j)},Ml.prototype._42=function($,P,L){var M=this;M.info={},M.screenInfo=null;var x=M._interactor;if(!x.editDetail&&M.gatherInfo(P,L)){var N=M.editing,F=N?N.groupRotateMode:null,A=M.screenInfo;if("block"!==F||!N||!N.started){if(A.P1?ab.Icons.DrawIcon(x,$,ab.Icons.Line,A):ab.Icons.DrawIcon(x,$,ab.Icons.Rect,A),A.connect&&(ab.Icons.DrawIcon(x,$,ab.Icons.ConnectGuide,{rotation:A.rotation,connect:A.connect,cursorPos:N?N.cursorPos:null}),N)){if(N.targetCorners){for(var j={x:1/0,y:1/0},W={x:-1/0,y:-1/0},s=0,R=N.targetCorners.length;R>s;s+=2)j.x=Math.min(j.x,N.targetCorners[s]),W.x=Math.max(W.x,N.targetCorners[s]),j.y=Math.min(j.y,N.targetCorners[s+1]),W.y=Math.max(W.y,N.targetCorners[s+1]);ab.Icons.DrawIcon(x,$,ab.Icons.HoverDataRect,{min:j,max:W,color:x.getStyle("hoverGuideColor")||x.getStyle("baseColor")})}N.garbageInfo&&ab.Icons.DrawIcon(x,$,ab.Icons.ConnectGuideGarbage,N.garbageInfo)}x.getStyle("rotateTipVisible")&&M.tipInfo&&ab.Icons.DrawIcon(x,$,ab.Icons.TipHelper,M.tipInfo)}M.target instanceof ab.Group&&M.target._42(x,$,P)}};var oj=ab.Anchor=function(c){this.catalog="Anchor",this._interactor=c};oj.prototype={},oj.prototype.constructor=oj,oj.prototype.gatherInfo=function(M,d){var m=this;if(1===d.length){var W=d[0];if(!W.getAnchor)return;if(W instanceof L.Shape&&W._70I())return;if(_d(W,M))return;return m.gatherSingleTarget(M,d[0])}return d.length>1?m.gatherMultiTargets(M,d):!1},oj.prototype.gatherSingleTarget=function(k,$){var C=this;return C.info.POS=$.getPosition(),C.screenInfo.POS=ab.toScreenPosition(k,C.info.POS),C.target=$,!0},oj.prototype.gatherMultiTargets=function(u,n){var d=this,I=ab.Group.findOrCreateGroup(n,this._interactor._uuid);return I?(d.screenInfo.POS=ab.toScreenPosition(u,I.getAnchor2()),d.target=I,!0):!1},oj.prototype.isVisible=function(){var j=this,U=j._interactor;if(U.getStyle("anchorVisible")===!1)return!1;var V=j.target;if(V){if(this.editing)return!0;var T=V.getAnchor(),C=U.getStyle("anchorOutsideVisibleThreshold");if(T.x<-C||T.x>1+C||T.y<-C||T.y>1+C)return!0;var b=V.getSize(),d=V.getScale(),I=Math.min(Math.abs(b.width*d.x),Math.abs(b.height*d.y));if(I*U.gv._zoom<U.getStyle("anchorHideThreshold"))return!1}return!0},oj.prototype.check=function(q,$,z){if(L.Default.isLeftButton($)){var y=this,M=y._interactor;if(y.isVisible()&&M.getStyle("anchorMovable")!==!1){y.editing=null,y.tipInfo=null;var s=y.target;if(s&&q.isAnchorEditable(s)&&q.isEditable(s)){var d;if(y.screenInfo&&(d=y.screenInfo.POS)&&ab.checkHit(z,new ab.Math.Vector2(d),M.getStyle("checkSize"))){if(s instanceof ab.Group)return y.editing={},!0;var G=s.getWidth(),x=s.getHeight(),E=s.getAnchor();return y.editing={rect:{x:-G*E.x,y:-x*E.y,width:G,height:x},anchor:E,matrix:s.getMatrix()},!0}}}}},oj.prototype.startEdit=function(e,z){e.startDragging(z),e.fi({kind:"beginEditAnchor",event:z})},oj.prototype._46O=function(Q){var K=this;K.editing&&(K.editing=null,K._interactor.fi({kind:"endEditAnchor",event:Q})),K.tipInfo=null},oj.prototype.handleEdit=function(Z,Y){var d=this,a=d.target;if(a){var V=d.editing;if(V){var k=Z.lp(Y),_=d._interactor;if(a instanceof ab.Group)return a.setAnchor2(k),_._42(),void 0;var h=V.matrix,t=h.tfi(k),O=V.rect,F=(t.x-O.x)/O.width,o=(t.y-O.y)/O.height;if(!L.Default.isCtrlDown(Y)){var f=_.getStyle("anchorRound"),U=_.getStyle("anchorSensitivity");F=ab.roundTo(F,f,U),o=ab.roundTo(o,f,U)}a.setAnchor(F,o,!0);var Q=L.Default.getLogicalPoint(Y,_._canvas);Q.x+=ab.Icons.TipShiftX,Q.y+=ab.Icons.TipShiftY;var W=""+F.toFixed(2)+", "+o.toFixed(2);d.tipInfo={helperPos:Q,text:W,size:W.length},_.fi({kind:"betweenEditAnchor",event:Y})}}},oj.prototype._42=function(m,J,Y){var b=this;b.info={},b.screenInfo={};var o=b._interactor;o.editDetail||b.gatherInfo(J,Y)&&b.isVisible()&&(ab.Icons.DrawIcon(o,m,ab.Icons.Anchor,b.screenInfo),b.tipInfo&&ab.Icons.DrawIcon(o,m,ab.Icons.TipHelper,b.tipInfo))};var ii=ab.MoveDummy=function(Y){this.catalog="MoveDummy",this._interactor=Y};ii.prototype={},ii.prototype.constructor=ii,ii.prototype.gatherInfo=function(){var S=this,n=this._interactor.getSubModule("Rect");if(n){var B=n.screenInfo;if(B){var b=S._interactor,Z=S.getMovableTarget(n.target);if(Z){var a=b.getStyle("moveDummyThreshold");if(a!==!1){var D=B.LT||B.P1,K=B.RT||B.P2,l=B.LB||D;if(D){var h=B.P1,H=Math.min(D.distanceTo(l),D.distanceTo(K));if(!(a!==!0&&H>a)){var x=b.getStyle("moveDummyPosition"),q=K.clone().sub(D),P=l.clone().sub(D),e=x[2],p=x[3];if(h){var r=b.getStyle("moveDummyLineExtraShift");r&&(e+=r[0],p+=r[1])}var z=D.clone().add(q.clone().multiplyScalar(x[0])).add(q.setLength(e)).add(P.clone().multiplyScalar(x[1])).add(P.setLength(p));return S.screenInfo.pos=z,S.screenInfo.size=b.getStyle("moveDummySensitivity"),!0}}}}}}},ii.prototype.getMovableTarget=function(L){var j=this._interactor.gv;if(nf(L)){if(j.isMovable(L))return L}else if(L instanceof ab.Group)for(var w=L._entities,a=w.length-1;a>=0;a--){var V=w[a];if(nf(V)&&j.isMovable(V))return V}return null},ii.prototype.getMoveInteractor=function(){for(var p,M,e,W=this._interactor.gv,K=W.getInteractors(),p=0,M=K.length;M>p;p++)if(e=K.get(p),e instanceof Oj)return e},ii.prototype.startEdit=function(z,$){z.startDragging($);var f=this.getMoveInteractor();if(f){var j=this.selectedTarget,r=z.gv;r._moving=1,f._data=j,r.handleMouseDown&&r.handleMouseDown($,j)}},ii.prototype._46O=function(r){var u=this,n=u.getMoveInteractor();n&&(n.handleWindowMouseUp(r),u.selectedTarget=null)},ii.prototype.handleEdit=function(i,O){var g=this.getMoveInteractor();g&&g.handleWindowMouseMove(O)},ii.prototype.check=function(f,s,W){if(this.selectedTarget=null,L.Default.isLeftButton(s)&&!f._scrolling&&!ph()){var $=this;if($.screenInfo){var i=$.screenInfo.pos;if(i&&!(W.distanceTo(i)>$.screenInfo.size)){var X=$._interactor;return $.selectedTarget=$.getMovableTarget(X.getSubModule("Rect").target),X.setCursor("default"),!0}}}},ii.prototype._42=function(H,i,P){var G=this;G.screenInfo={};var C=G._interactor;C.editDetail||G.gatherInfo(i,P)&&(!C.editing||G.selectedTarget)&&ab.Icons.DrawIcon(C,H,ab.Icons.MoveDummy,G.screenInfo)};var Xj=ab.RotateX=function(y){this.catalog="RotateX",this._interactor=y};Xj.prototype={},Xj.prototype.constructor=Xj,Xj.prototype.gatherInfo=function(S,i){var c=this;if(1===i.length){var V=i[0];return V instanceof L.Shape&&V._70I()||_d(V,S)?!1:c.gatherSingleTarget(S,V)}return i.length>1?c.gatherMultiTargets(S,i):!1},Xj.prototype.gatherSingleTarget=function(){var I=new L.Math.Vector2,Q=new L.Math.Vector2,x=new L.Math.Vector2,V=new L.Math.Vector2,b=function(t,s){var x=t.x-s.x,T=t.y-s.y;return x*x+T*T};return function(p,d){if(d.getCorners){var K=this,g=d.getCorners(),v=15,N=d.getPosition();I.copy(g[0]),x.copy(g[1]),V.copy(g[3]),Q.copy(I).add(V).divideScalar(2).add(I.sub(x).setLength(v/p.getZoom()));var u=Math.max(b(N,g[0]),b(N,g[1]),b(N,g[2]),b(N,g[3]));return K.info.POS=Q.clone(),K.screenInfo.POS=ab.toScreenPosition(p,K.info.POS),K.screenInfo.LEN=Math.sqrt(u)*p.getZoom()+v,K.screenInfo.CENTER=ab.toScreenPosition(p,N),K.target=d,!0}}}(),Xj.prototype.gatherMultiTargets=function(j,J){var N=this,O=ab.Group.findOrCreateGroup(J,this._interactor._uuid);if(!O)return!1;var N=this;return N.gatherSingleTarget(j,O)},Xj.prototype.isVisible=function(){var G=this._interactor;if(!G.getStyle("rotateAsClock"))return!1;var o=this.target;if(!o)return!0;var R=G.gv;return R.isEditable(o)&&R.isRotationEditable(o)?!0:!1},Xj.prototype.check=function(n,X,V){var E=this,_=E._checkImpl(n,X,V);return(_||E._clockPainted)&&E._interactor._42(),_},Xj.prototype._checkImpl=function(q,V,C){if(L.Default.isLeftButton(V)){var G=this;G.editing=null,G.tipInfo=null;var n;if(G.screenInfo&&(n=G.screenInfo.POS)&&G.isVisible()){var e=G._interactor;if(ab.checkHit(C,n,e.getStyle("checkSize"))){var _=G.target,k=q.lp(V),K=_.getPosition(),c=Math.atan2(k.y-K.y,k.x-K.x);return e._setRotateCursor(c),G.editing={pos:K,rotation:_.getRotation(),hitRot:c,groupRotateMode:"block",screenInfo:{CENTER:G.screenInfo.CENTER,LEN:G.screenInfo.LEN}},!0}}}},Xj.prototype.startEdit=function(x,J){x.startDragging(J),x.fi({kind:"beginEditRotation",event:J}),this.target instanceof ab.Group&&this.target.beginRotate(this.editing)},Xj.prototype._46O=function(d){var v=this;v.editing&&(v.editing=null,v._interactor.fi({kind:"endEditRotation",event:d})),v.target instanceof ab.Group&&v.target.endRotate(),v.tipInfo=null},Xj.prototype.handleEdit=function(b,G){var z=this,f=z.editing;if(f){var t,E,C=z.target,i=b.lp(G),D=z._interactor,V=f.pos,H=Math.atan2(i.y-V.y,i.x-V.x),a=C instanceof ab.Group;if(a?E=H-f.hitRot:(t=H-f.hitRot,E=f.rotation+t),E%=2*Math.PI,0>E&&(E+=2*Math.PI),!L.Default.isCtrlDown(G)){var x,k;Fr(G)?(x=D.getStyle("shiftRotateRound"),k=x/2):(x=D.getStyle("rotateRound"),k=D.getStyle("rotateSensitivity")),E=ab.roundTo(E,x,k)}a?(t=E-(f.lastRotation||0),0!==t&&(C.addRotation(t,f.groupRotateMode,function(V){return b.isRotationEditable(V)}),f.lastRotation=E)):C.setRotation(E),D._setRotateCursor(H),E>Math.PI&&(E-=2*Math.PI);var o=180*(E/Math.PI),P=""+o.toFixed(2)+"",T=L.Default.getLogicalPoint(G,D._canvas);T.x+=ab.Icons.TipShiftX,T.y+=ab.Icons.TipShiftY,z.tipInfo={helperPos:T,text:P,size:P.length},D.fi({kind:"betweenEditRotation",event:G})}},Xj.prototype._42=function(E,T,l){var A=this;A._clockPainted=!1,A.info={},A.screenInfo={};var L=A._interactor;L.editDetail||A.gatherInfo(T,l)&&A.isVisible()&&(ab.Icons.DrawIcon(L,E,ab.Icons.RoundPoint,A.screenInfo.POS),L.getStyle("rotateTipVisible")&&A.tipInfo&&ab.Icons.DrawIcon(L,E,ab.Icons.TipHelper,A.tipInfo),A.editing&&A.drawClock(E))},Xj.prototype.drawClock=function(T){T.save();var k=this;k._clockPainted=!0;var y=k.editing||{},o=y.screenInfo||k.screenInfo,I=o.LEN,D=I+8,H=I+18;T.save(),T.translate(o.CENTER.x,o.CENTER.y),T.beginPath(),T.strokeStyle="rgb(150, 150, 150)";for(var t,x,z,Q,q,j=0;360>j;j++)t=j*Math.PI/180,0===j%5&&(x=$(t)*I,z=e(t)*I,Q=$(t)*D,q=e(t)*D,T.moveTo(x,z),T.lineTo(Q,q)),0===j%45&&(x=$(t)*I,z=e(t)*I,Q=$(t)*H,q=e(t)*H,T.moveTo(x,z),T.lineTo(Q,q));T.stroke(),T.rotate(-po);var R=y.lastRotation||k.target.getRotation();T.beginPath(),T.fillStyle="rgba(255, 0, 0, 0.1)",T.strokeStyle="rgb(157, 157, 157)",T.moveTo(0,0),T.arc(0,0,H,0,R,!1),T.fill(),T.beginPath(),T.moveTo(0+H,0),T.arc(0,0,H,0,R,!1),T.stroke(),T.restore()};var eg=ab.Curve=function(H){this.catalog="Curve",this._interactor=H};eg.prototype={},eg.prototype.constructor=eg,U.defineProperties(eg.prototype,{activing:{get:function(){return this._activing},set:function(U){var e=this;if(U)e._activing=new ab.CurveActiving(this,U),e._activing._firePointChange();else{var F=e._activing;F&&F.dispose(),e._activing=null}}}}),eg.PointType={Mirrored:0,Straight:1,Disconnected:2,Asymmetric:3},eg.prototype.setUp=function(){var N=this,l=N._interactor;l&&l.gv.mp(N._onGraphviewPropertyChanged,N)},eg.prototype._onGraphviewPropertyChanged=function(H){("zoom"===H.property||"translateX"===H.property||"translateY"===H.property)&&this._handleDataChanged()},eg.prototype.tearDown=function(){var R=this,O=R._interactor;O&&O.gv.ump(R._onGraphviewPropertyChanged,R)},eg.prototype.canEnterEditDetailMode=function(){var k=Qd(this._interactor);return k?this.target=k:void 0},eg.prototype.canQuitEditDetailMode=function(D){var M=this,N=M._interactor._getLogicalPoint(D);return M._checkEditRealPoint(N)?void 0:M._interactor.gv.getDataAt(D)!==M.target?!0:void 0},eg.prototype.preHandleScroll=function(){var J=this.editing;return J&&J.inEdit?!0:void 0},eg.prototype.getCurrentSelectintStatus=function(){var i=this;if(i.activing&&!i.activing.selections){if(i.activing.status!=A)return i.activing.status;var D=function(l){var S=i.activing.status;i.activing.status=l,i._interactor.fp("shapePointStatus",S,l)},q=ab.Curve.PointType,f=i.activing.point,T=i.activing.pairs;if(!T||1!==T.length)return D(q.Mirrored);var r=T[0],O=r.c1&&r.c1.isNearEnough(f),R=r.c2&&r.c2.isNearEnough(f);if(!r.c1||!r.c2)return O||R?D(q.Straight):D(q.Disconnected);if(O&&R)return D(q.Straight);if(O||R)return D(q.Asymmetric);var n=r.c1.clone().sub(f),J=r.c2.clone().sub(f);return Math.abs(n.x*J.y-n.y*J.x)>1e-5||n.x*J.x>0?D(q.Disconnected):Math.abs(n.length()-J.length())>1e-5?D(q.Asymmetric):D(q.Mirrored)}},eg.prototype.handle_keydown=function(P){var A=this;if(A._interactor.editDetail){var w=ab.Curve.PointType;"1"===P.key?A._setCurrentSelectionStatus(w.Straight):"2"===P.key?A._setCurrentSelectionStatus(w.Mirrored):"3"===P.key?A._setCurrentSelectionStatus(w.Disconnected):"4"===P.key&&A._setCurrentSelectionStatus(w.Asymmetric)}},eg.prototype.setCurrentSelectionStatus=function(u){var o=this,c=o._interactor;if(c){var I=c.gv;I.dm().beginTransaction(),this._setCurrentSelectionStatus(u),I.dm().endTransaction()}},eg.prototype._setCurrentSelectionStatus=function(i){var v=this,C=v.activing;if(C){var Z=v.getCurrentSelectintStatus();if(null!==Z&&Z!==i){C.status=i;var F=v.activing.point,r=v.activing.pairs;if(r&&1===r.length){var x=r[0],W=v.screenInfo.curve,D=ab.Curve.PointType,Q=v._interactor,X=function(){v._writeToHt(),Q.fp("shapePointStatus",Z,i),v.check(Q.gv,null,new ab.Math.Vector2(Q._lastLogicalPoint))};if(i===D.Straight)return W.moveCtrlPoint(x,F,"c1"),W.moveCtrlPoint(x,F,"c2"),X(),void 0;if(Z===D.Straight){var U=W.findPairs(F,!0),M=U[0],f=M.r1||F,J=M.r2||F,p=J.clone().sub(f).multiplyScalar(.25);return W.moveCtrlPoint(x,F.clone().sub(p),"c1"),W.moveCtrlPoint(x,F.clone().add(p),"c2"),X(),void 0}var A=x.c1,_=x.c2;if(A&&_){if(i===D.Mirrored)return W.moveCtrlPoint(x,F.clone().multiplyScalar(2).sub(_),"c1"),X(),void 0;if(i===D.Asymmetric&&Z===D.Disconnected){var g=A.clone().sub(F).length(),p=F.clone().sub(_).setLength(g).add(F);return W.moveCtrlPoint(x,p,"c1"),X(),void 0}}C._firePointChange(),Q.fp("shapePointStatus",Z,i),v.check(Q.gv,null,new ab.Math.Vector2(Q._lastLogicalPoint))}}}},eg.prototype._handleDataChanged=function(){var F="s:edge.points,s:edge.segments,points,segments,shape,position,rotation,scale".split(",");return function(C){var n=this;if(n.screenInfo&&n.target){if(C&&F.indexOf(C.property)<0)return;var r=n._interactor;n.gatherSingleTarget(r.gv,n.target,!0),n.check(r.gv,null,new ab.Math.Vector2(r._lastLogicalPoint)),r._42()}}}(),eg.prototype.gatherSingleTarget=function(w,o,R){var Z,l,b=this;b.screenInfo&&b.screenInfo.curve&&(l=b.screenInfo.curve._curves);var s=b.editing;Z=s?b.screenInfo:b.screenInfo={};var I,P,$=o instanceof L.Edge;$?(I=o.s("edge.segments"),P=o.s("edge.points")||new L.List):(I=o._58O,P=o._59O),Z.S=I;var m,U=Z.P=[],G=ab.getDataMatrix(o);if(o instanceof L.Polyline||o instanceof L.Edge&&b._interactor.getStyle("edgeElevationEditable"))m=o.getElevation&&o.getElevation()||0,Z.E=[];else{var H=!1;P.each(function(m){m.e!==A&&(H=!0)}),H&&(Z.E=[])}if(P.each(function(q){Z.E&&Z.E.push(q.e!=A?q.e:m),q=G.apply(q);var F=ab.toScreenPosition(w,q);U.push(F.x,F.y)}),$){var B=U.length,M=ab.toScreenPosition(w,o._lastSourcePoint||(B?{x:U[0],y:U[1]}:{x:0,y:0})),t=ab.toScreenPosition(w,o._lastTargetPoint||(B?{x:U[B-2],y:U[B-1]}:{x:0,y:0}));if(U.splice(0,0,M.x,M.y),U.push(t.x,t.y),Z.E){var C=o.getSource(),Q=o.getTarget();Z.E.splice(0,0,((o.s("edge.source.anchor.elevation")||.5)-.5)*C.getTall()+C.getElevation()),Z.E.push(((o.s("edge.target.anchor.elevation")||.5)-.5)*Q.getTall()+Q.getElevation())}}if(!Z.S||!Z.S.size()){Z.S=new L.List,Z.S.add(1);for(var S=0;S<U.length/2-1;S++)Z.S.add(2)}if((!s||R)&&b.convertToCubicBezier(l),b.activing&&(R||!b.editing||"realPoint"===b.editing.type)){var e=Z.curve.findPairs(b.activing.point);b.activing.pairs=e}},eg.prototype._convertToNewPoint=function(Y,s,z,T){var D,O,k;for(D=0,O=s.length;O>D;D++){if(k=s[D],k._p1.isNearEnough(Y)&&(!T||T.indexOf(k._p1)<0))return k._p1;if(k._p4.isNearEnough(Y)&&(!T||T.indexOf(k._p4)<0))return k._p4}if(z)for(D=0,O=Math.min(z.length,O);O>D;D++){if(k=z[D],k._p1===Y&&(!T||T.indexOf(s[D]._p1)<0))return s[D]._p1;if(k._p4===Y&&(!T||T.indexOf(s[D]._p4)<0))return s[D]._p4}},eg.prototype.convertToCubicBezier=function(P){var I,g,c=this,z=new ab.Math.Curve,Z=c.screenInfo;if(z.createFromHtShape(Z.P,Z.S,Z.E),Z.curve=z,c.activing){var L=z._curves;I=c.activing.point,g=c._convertToNewPoint(I,L,P);var d=[];if(g&&(c.activing.point=g,d.push(g)),c.activing.selections){var h=-1,F=c.activing.selections;F.forEach(function(W){h++,g=c._convertToNewPoint(W,L,P,d),g&&(F[h]=g,d.push(g))})}}},eg.prototype.check=function(I,G,H){if(!G||Yf(G)||Hq(G)){var b=this;if(b._interactor.setCursor("default"),b.editing=null,b.highlight=null,b.tipInfo=null,b.edgeEditResult=null,b.screenInfo){if(ph()||G&&Hq(G))return b._interactor._42(),!0;if(b._checkEditCtrlPoint(H))return b._interactor._42(),!0;if(b._checkEditRealPoint(H))return b._interactor._42(),!0;if(b._checkEditElevation(H))return b._interactor._42(),!0;var Z=b.screenInfo.curve,s=Z.checkPoint(H,b._interactor.getStyle("curveIntersectSize"));if(s){var d=b.highlight={};d.type="insertKnot",d.bezier=s.bezier,d.point=s.intersection}return b._interactor._42(),!0}}},eg.prototype.getAdjacentBeziers=function(W){var L=this.screenInfo;if(L){var y,R,P,I=L.curve._curves,T=[],H=A;for(y=0,R=I.length;R>y;y++)if(P=I[y],H===A){if(P._p4.isNearEnough(W)){T.push(P),H=y;continue}}else{if(P._p1.isNearEnough(W))return T.push(P),T;if(P._p4.isNearEnough(W)){T[0]=P,H=y;continue}}}},eg.prototype.roundCorner=function(y){if(this.activing&&this.screenInfo){var F=this.screenInfo.curve,M=F._curves,o=this.getAdjacentBeziers(this.activing.point),r=o[1],G=r._index;r=r.insertKnot(r.getTByPercentage(y/r.length))[1],M[G]=r;var I=r.p1,t=o[0],A=t._index;t=t.insertKnot(t.getTByPercentage(1-y/t.length))[0],M[A]=t;var m=t.p4,z=this.activing.point,C=new ab.Math.CubicBezier(m,z.clone().sub(m).multiplyScalar(2/3).add(m),z.clone().sub(I).multiplyScalar(2/3).add(I),I);M.splice(G,0,C),this._writeToHt(),this.activing=null,this._interactor._42()}},eg.prototype._checkEditRealPoint=function(o){var R,D,x,t,A,B,_=this,h=_.screenInfo.curve._curves,O=_._interactor.getStyle("curvePointIntersectSize"),w=1/0;for(O*=O,x=0,t=h.length;t>x;x++)R=h[x],A=R._p1,B=o.distanceToSquared(A),w>B&&(w=B,D=A),A=R._p4,B=o.distanceToSquared(A),w>B&&(w=B,D=A);if(w>O)return!1;var b=_.highlight={};return b.type="changeRealPoint",b.point=D,_.editing={type:"realPoint",point:D,shiftGuide:{point:D.clone(),dir:"x",limit:0}},_._interactor.setCursor("crosshair"),!0},eg.prototype._checkEditElevation=function(y){var c=this;if(!c._interactor.getStyle("curveElevationVisible"))return!1;var h=c.target;if(h instanceof L.Edge&&!c._interactor.getStyle("edgeElevationEditable"))return!1;var b=c.activing;if(!b)return!1;var g=b.getCurrentEditingPoint();if(!g)return!1;var u=c._interactor,H=u.getStyle("curveElevationGuideShift"),z=u.getStyle("curveElevationIntersectSize"),I=y.distanceToSquared({x:g.x+H[0],y:g.y+H[1]});if(!(I>z*z)){var t=c.highlight={};t.type="elevation";var F=new ab.Math.Vector2(y.x,y.y,g.e);return c.editing={type:"elevation",startPoint:F},c._interactor.setCursor("crosshair"),!0}},eg.prototype._checkEditCtrlPoint=function(a){var Z=this;if(Z.activing&&!Z.activing.selections){var P=Z.getCurrentSelectintStatus();if(P!==ab.Curve.PointType.Straight){var p=Z.activing.pairs;if(p){var y=Z._interactor.getStyle("curvePointIntersectSize");y*=y;var w,U,A,n,N,i,H,J,X,t=1/0;for(H=0,X=p.length;X>H;H++)for(n=p[H],J=0;2>J;J++)N=0===J?"c1":"c2",n[N]&&(i=a.distanceToSquared(n[N]),t>i&&(t=i,w=n,U=H,A=N));if(t>y)return!1;Z.activing.hlpair=w,Z.activing.hltype=A;var q=Z.highlight={};return q.type="changeCtrlPoint",q.point=w[A],Z.editing={type:"ctrlPoint",pair:w,pairId:U,ctrlType:A,direction:w[A].clone().sub(Z.activing.point).normalize()},Z._interactor.setCursor("crosshair"),!0}}}},eg.prototype.startEdit=function(m,b){m.startDragging(b);var y=this;y.highlight&&"insertKnot"===y.highlight.type&&(y.insertKnot(),y.gatherSingleTarget(y._interactor.gv,y.target),y.activing=null,y._checkEditRealPoint(y._interactor._getLogicalPoint(b)));var $=y._activing;if($){var o=y.editing?y.editing.type:null;"ctrlPoint"===o?$.editingCtrl={pairId:y.editing.pairId,type:$.hltype}:"realPoint"===o&&($.editingCtrl=!1)}var D=y.highlight,n=L.Default.isCtrlDown(b);if(!D||ph()||Hq(b)){var Y=y._interactor.gv;if(!Y.setFocus(b)||Y._scrolling)return;return n?y._multiSelect={startPoint:Y.lp(b)}:Y.isPannable()&&(Yf(b)||Hq(b))&&(y._pan={tx:Y.tx(),ty:Y.ty()},m.fi({kind:"beginPan",event:b})),void 0}if("changeRealPoint"===D.type){var V,x=y.activing?y.activing.point:null,Q=y.activing?y.activing.selections:null;if(n&&y.activing)x===D.point?(Q?(y.activing={point:Q[0]},Q.length>1&&(Q.splice(0,1),y.activing.selections=Q)):y.activing=null,y.editing=null):Q&&(V=Q.indexOf(D.point))>=0?(Q.length>1?Q.splice(V,1):delete y.activing.selections,y.editing=null):Q?(Q.push(x),y.activing={point:D.point,selections:Q}):y.activing={point:D.point,selections:[x]};else if(Q)x===D.point||((V=Q.indexOf(D.point))>=0?(Q.splice(V,1,x),y.activing={point:D.point,selections:Q}):y.activing={point:D.point});else{var A;x===D.point&&(A=y.activing.status),y.activing={point:D.point},A&&(y.activing.status=A)}m.fi({kind:"beginEditPoint",event:b})}},eg.prototype.insertKnot=function(){var n=this,c=n.highlight,P=n.screenInfo.curve;P.insertKnot(c.bezier,c.point.t),n._writeToHt()},eg.prototype._writeToHt=function(){var J,X,T=this,b=T.screenInfo.curve,w=b.toHtShape(),C=w.points,n=[],R=w.segments,G=T._interactor.gv;G.dm().beginTransaction();var d,l,A=T.target,O=A instanceof L.Edge,i=ab.getDataMatrix(A).invert();l=A instanceof L.Polyline||O&&T._interactor.getStyle("edgeElevationEditable"),l&&(d=A.getElevation&&A.getElevation()||0);for(var g=0,v=C.length;v>g;g++)J=C[g],X=ab.toWorldPosition(G,J),X=i.apply(X),isFinite(J.e)&&J.e!==d&&(X.e=J.e),n.push(X);if(A._writing=!0,O){A.s("edge.type","points"),A.setStyle("edge.segments",R),A.setStyle("edge.points",n.slice(1,n.length-1)),A.setStyle("edge.source.offset.x",0),A.setStyle("edge.source.offset.y",0),A.setStyle("edge.target.offset.x",0),A.setStyle("edge.target.offset.y",0);var u=T._nextChangeEdgeHost;delete T._nextChangeEdgeHost,u&&("source"===u.type?A.setSource(u.host):A.setTarget(u.host)),T._writeEdgeHostAnchor("source",n[0]),T._writeEdgeHostAnchor("target",n[n.length-1])}else n.length?(A.setSegments(R),A.setPoints(n,!0)):A.removeFromDataModel();G.dm().endTransaction(),delete A._writing},eg.prototype._writeEdgeHostAnchor=function(q,G){var k=this,m=k.target,B=k._calcHostAnchor(m,q,G);B.index!==A?(m.setStyle("edge."+q+".index",B.index),m.setStyle("edge."+q+".percent",A),m.setStyle("edge."+q+".anchor.x",A),m.setStyle("edge."+q+".anchor.y",A)):B.percent!==A?(m.setStyle("edge."+q+".percent",B.percent),m.setStyle("edge."+q+".index",A),m.setStyle("edge."+q+".anchor.x",A),m.setStyle("edge."+q+".anchor.y",A)):(m.s("edge."+q+".anchor.x",B.x),m.s("edge."+q+".anchor.y",B.y),m.s("edge."+q+".anchor.elevation",B.e),B.offsetX||B.offsetY?(m.s("edge."+q+".offset.x",B.offsetX),m.s("edge."+q+".offset.y",B.offsetY),m.s("edge."+q+".offset.elevation",B.offsetElevation)):(m.s("edge."+q+".offset.x",0),m.s("edge."+q+".offset.y",0),m.s("edge."+q+".offset.elevation",0)))
},eg.prototype._calcHostAnchor=function(W,_,A,T){T||(T="source"===_?W.getSource():W.getTarget());var b=this._interactor.gv,f=b.calculateAttachPoint(T,A);if(f)return f.info;if(vm(T)){var x=b.calculateEdgePosition(T,A);return x}var I=T.getRotation(),Z=T.getAnchor();_d(T,b)&&(I=0);var P=T.getElevation(),m=T.getTall();P=((A.e||0)-P)/m+.5;var i=T.getScale();if(I||i.x<0||i.y<0){var L=T.getMatrix(),V=L.tfi(A),B=T.getSize();return{x:V.x/B.width+Z.x,y:V.y/B.height+Z.y,e:P}}var u=Gr(b,T),q={x:(A.x-u.x)/u.width,y:(A.y-u.y)/u.height,e:P};return q},eg.prototype._handlePanning=function(A){var R=this,V=R._pan;if(V){V.started=!0;var c=R._interactor,z=c.gv,r=c._lastClientPoint,J=ao(A),O=Io(z,J,r);z.setTranslate(V.tx+O.x,V.ty+O.y),R.gatherSingleTarget(c.gv,R.target),c._42(),c.fi({kind:"betweenPan",event:A})}},eg.prototype.handleEdit=function(G,J){var p=this,U=p.editing;if(p._pan)return p._handlePanning(J),void 0;if(p._multiSelect)return p._multiSelect.endPoint=G.lp(J),p._interactor.redraw(),void 0;if(U){U.inEdit=!0;var b,s,n,r=p._interactor._getLogicalPoint(J),V=L.Default.isCtrlDown(J),v=L.Default.isShiftDown(J),M=U.type,P=p.activing;if(p._guideInfo=null,"ctrlPoint"===M&&v){var S=p.editing.direction.clone();b=P.point;var u=S.dot(r.clone().sub(b));r=S.setLength(u).add(b)}else if("ctrlPoint"===M||"realPoint"===M){var S;if("realPoint"===M&&v){var q=p.editing.shiftGuide;s=q.point;var I=Math.abs(r.x-s.x),k=Math.abs(r.y-s.y);I>k&&I>q.limit&&"y"===q.dir&&(q.dir="x"),k>I&&k>q.limit&&"x"===q.dir&&(q.dir="y"),S=q.dir,"x"===S?(r.y=s.y,q.limit=Math.max(q.limit,I)):"y"===S&&(r.x=s.x,q.limit=Math.max(q.limit,k))}var o=p._isEditEdgeSourceTarget();if(o){var Z=p._editEdgeSourceTarget(o,r,V);Z&&(p.edgeEditResult=Z,n=Z.tipText)}else if(!V){var F=p._guidingToEdit(r,S),g="realPoint"===M?p._interactor.gridGuide.findClosest(r,S,!0):null,X=1/0,x=1/0;g&&(g.x&&(X=g.x),g.y&&(x=g.y));var D=!1;F&&(F.xList&&(Math.abs(F.x)<=Math.abs(X)?(D=!0,X=F.x):delete F.xList),F.yList&&(Math.abs(F.y)<=Math.abs(x)?(D=!0,x=F.y):delete F.yList),D&&(p._guideInfo=F)),isFinite(X)&&(r.x+=X),isFinite(x)&&(r.y+=x),D&&(F.v=r)}}var y=p.screenInfo.curve;if("realPoint"===U.type){b=U.point,b.e!==A&&(r.e=b.e),y.moveRealPoint(b,r),U.point=r,p.highlight.point=r;var H=P.status,$=P.selections;if(p.activing={point:r,status:H},$){var z=r.clone().sub(b),Y=0;$.forEach(function(A){var m=A.clone().add(z);y.moveRealPoint(A,m),$[Y++]=m}),p.activing.selections=$}}else if("ctrlPoint"===U.type){var w=P.pairs,N=w[U.pairId];y.moveCtrlPoint(N,r,U.ctrlType);var W=P.status,_=ab.Curve.PointType;if((W===_.Mirrored||W===_.Asymmetric)&&N.c1&&N.c2){var b=new ab.Math.Vector2(P.point),t="c1"===U.ctrlType?"c2":"c1";if(W===ab.Curve.PointType.Mirrored)y.moveCtrlPoint(N,b.clone().multiplyScalar(2).sub(r),t);else if(W===_.Asymmetric){var u=N[t].clone().sub(b).length(),l=b.clone().sub(N[U.ctrlType]).setLength(u).add(b);isNaN(l.x)||y.moveCtrlPoint(N,l,t)}}P._firePointChange()}else if("elevation"===U.type){s=U.startPoint;var T=s.e+(s.y-r.y)/G._zoom;p._setCurrentPointImpl("e",T),P._firePointChange(),n="E: "+ab.toFixed(T)}var h=L.Default.getLogicalPoint(J,p._interactor._canvas);if(h.x+=ab.Icons.TipShiftX,h.y+=ab.Icons.TipShiftY,!n){var E=ab.toWorldPosition(G,r);n=""+ab.toFixed(E.x)+", "+ab.toFixed(E.y)}p.tipInfo={helperPos:h,text:n,size:n.length},p._writeToHt(),p._interactor.fi({kind:"betweenEditPoint",event:J})}},eg.prototype._setCurrentPointImpl=function(F,f){var y=this,R=y._activing;if(!R)return!1;var E=y.target;if(!E)return!1;var S=R.getCurrentEditingPoint();if(!S)return!1;var h=R.editingCtrl;if(!h)var g=S.clone();if("e"===F)S.e=f;else{var z;if("x"===F||"y"===F){var U=R._lastFirePoint;z="x"===F?{x:f,y:U?U.y:0}:{x:U?U.x:0,y:f}}else"object"==typeof F?(z=F,F.e!==A&&(S.e=F.e)):(z={x:arguments[0],y:arguments[1]},arguments[2]!==A&&(S.e=arguments[2]));var Z=ab.getDataMatrix(E);z=ab.toScreenPosition(y._interactor.gv,Z.apply(z)),S.x=z.x,S.y=z.y}if(!h){var k=g.multiplyScalar(-1).add(S);S.e&&g.e&&(k.e=S.e-g.e);var r=y.screenInfo.curve;r.moveCtrlDueToRealPointMovement(S,k);var L=R.selections;if(L){var Q=0;L.forEach(function(R){var J=R.clone().add(k);isFinite(k.e)&&(J.e=(isFinite(R.e)?R.e:E.getElevation()||0)+k.e),r.moveRealPoint(R,J),L[Q++]=J}),R.selections=L}}return!0},eg.prototype.setCurrentPoint=function(l,R){return this._setCurrentPointImpl(l,R)?(this._writeToHt(),!0):!1},eg.prototype._isEditEdgeSourceTarget=function(){var T=this,w=T.target;if(!(w instanceof L.Edge))return!1;var D=T.editing.point,n=T.screenInfo.curve._curves;return D===n[0]._p1?"source":D===n[n.length-1]._p4?"target":!1},eg.prototype._editEdgeSourceTarget=function(t,v,y){var w,Z=this,M=Z.target;if(w="source"===t?M.getSource():M.getTarget()){var n,Q=Z._interactor.gv,g=ab.toWorldPosition(Q,v),l=Z._calcHostAnchor(M,t,g,w);if(n=l.index!==A||l.percent!==A?l.distance*Q.getZoom()>Z._interactor.getStyle("edgeHostEdgeMaxDistance"):Z._interactor.getStyle("edgeHostDetectPerFrame")?!0:l.x<0||l.x>1||l.y<0||l.y>1?!0:!1){var W=Q.getDataAt(g,function(A){return Q.isSelectable(A)?Q.isSourceTargetEditable(M,A,t)?M.canSetSourceTarget(A,t)?!0:!1:!1:!1});if(W){var q=Z._calcHostAnchor(M,t,g,W);w=W,Z._nextChangeEdgeHost={type:t,host:W},l=q}}var r,f,N;if(y||l.x===A)(l.percent!==A||l.index!==A)&&(f=l.point);else{var m=Z._interactor.getStyle("anchorRound"),C=Z._interactor.getStyle("anchorSensitivity");r=Q.calculateAttachPoint(w,g),r?l=r.info:(l.x=ab.roundTo(l.x,m,C),l.y=ab.roundTo(l.y,m,C)),f=ti(Q,w,0,l.offsetX||0,l.offsetY||0,l.x,l.y)}f&&(N=ab.toScreenPosition(Q,f),v.x=N.x,v.y=N.y),Z._edgeHostGuideInfo={corners:ab.getTargetCornersOnScreen(Q,w),attach:r?r.index:-1,host:w};var B;return l.percent!==A?B="percent: "+l.percent.toFixed(2):l.index!==A?B="index: "+l.index:(B=""+l.x.toFixed(2)+", "+l.y.toFixed(2),(l.offsetX||l.offsetY)&&(B+=" offset: "+l.offsetX.toFixed(2)+", "+l.offsetY.toFixed(2))),{host:w,anchor:l,tipText:B}}},eg.prototype._guidingToEdit=function(r,i){var b,L,$=this;if(b=$.screenInfo.curve){L=b._curves;var A,j,g,D,y,k,z,a,u=1/0,w=1/0,R=[];for($.editing&&"realPoint"===$.editing.type&&(a=$.editing.point),y=0,k=2*L.length;k>y;y++)z=L[Math.floor(y/2)][y%2?"_p4":"_p1"],R.indexOf(z)>=0||(R.push(z),a&&a===z||(g=z.x-r.x,D=z.y-r.y,Math.abs(g)<Math.abs(u)?(u=g,A=[z]):g===u&&A.push(z),Math.abs(D)<Math.abs(w)?(w=D,j=[z]):D===w&&j.push(z)));var B=$._interactor.getStyle("smartGuideThreshold");if((Math.abs(u)>B||"y"===i)&&(A=null),(Math.abs(w)>B||"x"===i)&&(j=null),A||j){var m=!1,t={};if(A&&(m=!0,t.xList=A,t.x=u),j&&(m=!0,t.yList=j,t.y=w),m)return t}}},eg.prototype._46O=function(B){var L=this;L.editing&&(L.editing=null,L._interactor.fi({kind:"endEditPoint",event:B})),L._guideInfo=null,L._edgeHostGuideInfo=null,L._pan&&(L._pan=null,L._interactor.fi({kind:"endPan",event:B})),L._multiSelect&&(L._handleMultiSelect(L._multiSelect,B),L._multiSelect=null),L.tipInfo=null,L.edgeEditResult=null},eg.prototype._handleMultiSelect=function(j,R){if(j.startPoint&&j.endPoint){var r,w,T,f,x,S,G=this,p=G._interactor,B=p.gv,b=ab.toScreenPosition(B,j.startPoint),m=ab.toScreenPosition(B,j.endPoint),t=L.Default.unionPoint(b,m),H=G.screenInfo.curve._curves,l=[],F=function(a){a.x>=t.x&&a.y>=t.y&&a.x<=t.x+t.width&&a.y<=t.y+t.height&&l.indexOf(a)<0&&l.push(a)};for(r=0,w=H.length;w>r;r++)x=H[r],F(x._p1),F(x._p4);if(l.length){var o=G.activing||{},O=o.selections||[];o.point&&O.push(o.point);var I=L.Default.isShiftDown(R),P=R.altKey;if(P&&!I)for(S=l,l=[],r=0,w=S.length;w>r;r++)T=S[r],f=O.indexOf(T),f>=0&&l.push(T);for(r=0,w=O.length;w>r;r++)T=O[r],f=l.indexOf(T),f>=0?(!I||I&&P)&&(l[f]=A):l.push(T);for(S=l,l=[],r=0,w=S.length;w>r;r++)S[r]&&l.push(S[r]);w=l.length,0===w?G.activing=null:1===w?G.activing={point:l[0]}:(T=l[w-1],G.activing={point:T,selections:l.splice(0,w-1)}),p.redraw()}}},eg.prototype._canDeletePoint=function(o,T){var J=this.target;if(!(J instanceof L.Edge))return!0;var U=o._curves[0],S=o._curves[o._curves.length-1];return U._p1===T||S._p4===T?!1:!0},eg.prototype.handleDelete=function(){var G=this;if(G.activing&&G.screenInfo){var p=L.Default.isShiftDown(),T=G.screenInfo.curve;G._canDeletePoint(T,G.activing.point)&&T.deleteRealPoint(G.activing.point,p),G.activing.selections&&G.activing.selections.forEach(function(m){G._canDeletePoint(T,m)&&T.deleteRealPoint(m,p)}),G.activing=null,delete G.editing,delete G.tipInfo,delete G.edgeEditResult,delete G._pan,delete G._multiSelect,G._writeToHt(),G._interactor.fp("deleteShapePoint",!1,!0)}},eg.prototype.handleDoubleClick=function(p){var D=this,u=D._interactor._getLogicalPoint(p);if(D.screenInfo&&D._checkEditRealPoint(u)){var q=D.getCurrentSelectintStatus(),I=ab.Curve.PointType;return q=q===I.Mirrored?I.Straight:I.Mirrored,D._setCurrentSelectionStatus(q),D._interactor._42(),!0}},eg.prototype._drawHighlight=function(R){var u=this,$=u.highlight;if($){var H=$.bezier,j=u._interactor;H&&ab.Icons.DrawIcon(j,R,ab.Icons.ShapeHighlightCurve,[H._p1.x,H._p1.y,H._p2.x,H._p2.y,H._p3.x,H._p3.y,H._p4.x,H._p4.y]);var O=$.point;O&&"insertKnot"===$.type&&ab.Icons.DrawIcon(j,R,ab.Icons.ShapeHighlighPoint,O)}},eg.prototype._drawGuide=function(C){var t=this,X=t._guideInfo;if(X){var x,L,y,w,q=X.v;for(x=0;2>x;x++)if(w=0===x?X.xList:X.yList)for(L=0,y=w.length;y>L;L++)ab.Icons.DrawIcon(t._interactor,C,ab.Icons.ShapeGuideLine,[q.x,q.y,w[L].x,w[L].y])}},eg.prototype._drawCurrentPoint=function(T){var r=this;if(r.activing){var z=r.activing,c=r.getCurrentSelectintStatus(),d=r._interactor;if(c!==ab.Curve.PointType.Straight){var $=z.pairs;z.hlpair,z.hltype;var D=z.selections,R=z.editingCtrl;if($&&!D){var Q,B,m;for(B=0,m=$.length;m>B;B++)Q=$[B],R&&B===R.pairId&&Q[R.type]?ab.Icons.DrawIcon(d,T,ab.Icons.ShapeActivingCtrl,{point:Q.point,c1:Q.c1,c2:Q.c2,hl:R.type}):ab.Icons.DrawIcon(d,T,ab.Icons.ShapeActivingCtrl,Q)}}ab.Icons.DrawIcon(d,T,ab.Icons.ShapeHighlighRealPoint,r.activing.point),D&&D.forEach(function(M){ab.Icons.DrawIcon(d,T,ab.Icons.ShapeHighlighRealPoint,M)})}},eg.prototype.clear=function(){var t=this;t.editing=null,t._guideInfo=null,t.activing=null,t.highlight=null},eg.prototype._42=function(Q){var l=this;l.info={},l.editing||(l.screenInfo=null);var O=l._interactor;if(!O.editDetail)return l.clear(),void 0;var h=O.gv;if(!l.target||!h.isSelected(l.target)||!h.isVisible(l.target))return O.editDetail=!1,l.clear(),void 0;if(l.gatherSingleTarget(h,l.target),ab.Icons.DrawIcon(O,Q,ab.Icons.ShapeBgCurve,l.screenInfo),l._interactor.getStyle("curveElevationVisible")&&(l.target instanceof L.Polyline||l.target instanceof L.Edge&&l._interactor.getStyle("edgeElevationEditable"))&&l.activing){var z=l.activing.getCurrentEditingPoint();z&&"string"!=typeof z.e&&ab.Icons.DrawIcon(O,Q,ab.Icons.EdgeElevationGuide,z)}if(l._drawHighlight(Q),l._drawCurrentPoint(Q),l._getRealPoint().forEach(function(U){ab.Icons.DrawIcon(O,Q,ab.Icons.ShapePoint,U)}),l._drawGuide(Q),l.tipInfo&&l._interactor.getStyle("curveTipVisible")&&ab.Icons.DrawIcon(O,Q,ab.Icons.TipHelper,l.tipInfo),l._edgeHostGuideInfo&&O._drawHostGuide(l._edgeHostGuideInfo),l.edgeEditResult&&l._drawEdgeHostHighlight(Q,l.edgeEditResult.host,l.edgeEditResult.anchor),l._multiSelect&&l._multiSelect.endPoint){var E=L.Default.unionPoint(ab.toScreenPosition(h,l._multiSelect.startPoint),ab.toScreenPosition(h,l._multiSelect.endPoint));E.color=h.getRectSelectBorderColor(),Q.save(),Q.setTransform(1,0,0,1,0,0);var $=r.devicePixelRatio,e=E.borderWidth=Math.round($);e/=2,E.x=Math.round(E.x*$)+e,E.y=Math.round(E.y*$)+e,E.width=Math.round(E.width*$),E.height=Math.round(E.height*$),ab.Icons.DrawIcon(O,Q,ab.Icons.SimpleRect,E),Q.restore()}},eg.prototype._drawEdgeHostHighlight=function(L,k,J){this.drawEdgeHostHighlight(L,k,J),this._interactor.redraw()},eg.prototype.drawEdgeHostHighlight=function(l,k,M){if(vm(k)){var Q,Y,N,h,H=this,Z=H._interactor,F=Z.gv,J=F.getDataUI(k),I=Qj(J),o=[];for(N=0,h=I.points.length;h>N;N++)Y=ab.toScreenPosition(F,I.points.get(N)),o.push(Y.x,Y.y);I.segments&&(Q=I.segments.toArray());var x=Z.getStyle("edgeHostHighlighPeriod"),D=Z.getStyle("edgeHostEdgeHighlighColor");ab.Icons.DrawIcon(Z,l,ab.Icons.ShapeBgCurve,{P:o,S:Q,color:D,dynamicVisible:M.index===A,dynamicPeriod:x}),D=Z.getStyle("edgeHostPointHighlighColor");var S=$g(J);for(N=0,h=S.length;h>N;N++){var T=S[N],q=ab.toScreenPosition(F,T);ab.Icons.DrawIcon(Z,l,ab.Icons.ShapePoint,{point:{x:q.x,y:q.y},color:D,size:12,dynamicVisible:N===M.index,dynamicPeriod:x})}}},eg.prototype._getRealPoint=function(){var L,Q=this.screenInfo,S=Q.P,Z=Q.S,r=-1,n=[],M=-1,l=Z.length;return Z.each(function(J){M++;var d=1;if(3===J)d=2;else if(4===J)d=3;else if(5===J)return;r+=d,L=M+1>=l?!0:1===Z.get(M+1)?!0:!1,n.push({point:{x:S[2*r],y:S[2*r+1]},segmentIndex:M,pointIndex:r,isEnd:L})}),n},eg.prototype.getEditingPointsInfo=function(S){var s=this,M=s.activing;if(!M)return!1;var t=M.point;if(!t)return!1;var K=this._getRealPoint(),k=[{screen:t}];M.selections&&M.selections.forEach(function(U){k.push({screen:U})});var v,p,b=K.length;return k.forEach(function(B){for(v=0;b>v;v++)if(p=K[v],B.screen.isNearEnough(p.point)){B.segmentIndex=p.segmentIndex,B.pointIndex=p.pointIndex,B.point=s.target.getPoints().get(p.pointIndex);break}}),S&&k.sort(function(d,I){return d.segmentIndex-I.segmentIndex}),k};var Gq=ab.MoveHelper=function(X){var y=this;y.catalog="Move",y._interactor=X};Gq.prototype={},Gq.prototype.constructor=Gq,Gq.prototype.calcShift=function(k,g,S){var E,i,K=this,q=K._interactor.gv,G=q.lp(g);if("beginMove"===k&&K._gatherGridInfo(S._lastLogicalPoint||G),E=K._target){var J=E.downPosition;if(J){var U=K._interactor.getStyle("moveSensitivity")/q._zoom;if(J.distanceTo(G)<U)return{x:0,y:0};delete E.downPosition}var c;i=L.Default.isShiftDown(g),i&&(G=K._dealShiftDown(G),c=E.shiftGuide.dir);var j,P=E.rawPos={x:E.pos.x+G.x-E.lp.x,y:E.pos.y+G.y-E.lp.y};if(L.Default.isCtrlDown(g)){if(j=K._calcShiftByAddon(),K._target.node instanceof ab.Group){var d=K._target.node;d._position.x+=j.x,d._position.y+=j.y}return j}var y=K._interactor.rectGuide;if(E.node instanceof L.Data&&E.node.s("2d.attachable")){var Z=K._calcAttachNodeShift(E.node,P);if(y.clear(),Z)return Z}for(var o,a=E.x+P.x,v=E.y+P.y,$={x:a,y:v},Y={x:a+E.w/2,y:v+E.h/2},m={x:a+E.w,y:v+E.h},p=K._interactor.gridGuide,f=[y.findClosest($,c),y.findClosest(Y,c),y.findClosest(m,c),p.findClosest($,c),p.findClosest(Y,c),p.findClosest(m,c)],A=1/0,R=1/0,l=0,X=f.length;X>l;l++)o=f[l],o&&(a=o.x,v=o.y,isFinite(a)&&Math.abs(a)<Math.abs(A)&&(A=a),isFinite(v)&&Math.abs(v)<Math.abs(R)&&(R=v));if(isFinite(A)||(A=0),isFinite(R)||(R=0),j=K._calcShiftByAddon(A,R),K._target.node instanceof ab.Group){var d=K._target.node;d._position.x+=j.x,d._position.y+=j.y}var Q=E.node;if(!_d(Q,q)){var W=P.x+A,C=P.y+R;K._interactor.rectGuide.gatherLines({node:Q,x:E.x+W,y:E.y+C,w:E.w,h:E.h},c)}return j}},Gq.prototype._calcShiftByAddon=function(g,h){var i=this._target,p=i.rawPos,T=i.node.getPosition();return g=g||0,h=h||0,{x:p.x-T.x+g,y:p.y-T.y+h}},Gq.prototype._dealShiftDown=function(y){var x=this,E=x._target.shiftGuide,S=x._target.lp,b=Math.abs(y.x-S.x),B=Math.abs(y.y-S.y);b>B&&b>E.limit&&"y"===E.dir&&(E.dir="x"),B>b&&B>E.limit&&"x"===E.dir&&(E.dir="y");var z=E.dir;return"x"===z?(y.y=S.y,E.limit=Math.max(E.limit,b)):"y"===z&&(y.x=S.x,E.limit=Math.max(E.limit,B)),y},Gq.prototype._isAttachableLineShape=function(o){if(!o.getSegments)return!1;var B=o.getSegments();if(!B)return!0;B instanceof L.List&&(B=B.getArray());for(var O=1,N=B.length;N>O;O++)if(2!==B[O])return!1;return!0},Gq.prototype._calcAttachNodeShift=function(){var R=new lm,L=new lm,V=new lm,k=new lm;return function(z,W){var p=this._interactor.gv,I=z.getHost(),P=p.getDataAt(W,function(c){return c.s("2d.hostable")?!0:!1});if(P&&I!==P&&z.setHost(P),!P)return this._edgeHostGuideInfo=null,z.setHost(null);var U=this._edgeHostGuideInfo={corners:ab.getTargetCornersOnScreen(p,P),host:P,attach:-1};if(this._isAttachableLineShape(P)){for(var t,D,w,Z,A,N,v=P.getPoints(),g=v.size(),s=P.getPointsMatrix2d(),Y=1/0,f=0;g>f&&(f!==g-1||P.isClosePath());f++)0!==f?L.copy(V):s.apply(v.get(f),L),s.apply(f===g-1?v.get(0):v.get(f+1),V),R.copy(W).sub(L),k.copy(V).sub(L),t=k.length(),k.divideScalar(t),D=R.dot(k),0>D?D=0:D>t&&(D=t),k.multiplyScalar(D).add(L),w=R.copy(W).sub(k).lengthSq(),Y>w&&(Y=w,N=f,Z=D,A=t);return Math.sqrt(Y)*p.getZoom()>this._interactor.getStyle("attachThreshold")?(z.s({"attach.index":-1}),z.setHost(null),void 0):(z.s("attach.offset.opposite")&&(Z=A-Z),z.s({"attach.index":N,"attach.offset":z.s("attach.offset.relative")?Z/A:Z}),{x:0,y:0})}var e=p.calculateAttachPoint(P,W);if(e){var x=e.point;return U.attach=e.index,this._calcShiftByAddon(x.x-W.x,x.y-W.y)}}}(),Gq.prototype._gatherGridInfo=function(K){var r,$=this,y=$._interactor,s=y._getValidSelection();if(s.length){if(1===s.length){if(r=s[0],!r.getRect)return $._target=null,void 0}else if(r=ab.Group.findOrCreateGroup(s,y._uuid),!r)return $._target=null,void 0}else{var s=y.gv.sm().getSelection();if(s.length&&(r=s.get(0),!r.getRect))return $._target=null,void 0}if(r){var w=r.getPosition(),T=r.getRect();$._target={node:r,x:T.x-w.x,y:T.y-w.y,w:T.width,h:T.height,lp:{x:K.x,y:K.y},pos:{x:w.x,y:w.y},shiftGuide:{dir:"x",limit:0},downPosition:new ab.Math.Vector2(K)},y.rectGuide.gatherRects()}},Gq.prototype.clear=function(){var C=this;C._edgeHostGuideInfo=null,C._interactor.rectGuide.clear(),C._interactor._42()},Gq.prototype._42=function(){var D=this._edgeHostGuideInfo;D&&this._interactor._drawHostGuide(D)};var Jh=U.freeze({DEPTH_BUFFER_BIT:256,STENCIL_BUFFER_BIT:1024,COLOR_BUFFER_BIT:16384,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,ZERO:0,ONE:1,SRC_COLOR:768,ONE_MINUS_SRC_COLOR:769,SRC_ALPHA:770,ONE_MINUS_SRC_ALPHA:771,DST_ALPHA:772,ONE_MINUS_DST_ALPHA:773,DST_COLOR:774,ONE_MINUS_DST_COLOR:775,SRC_ALPHA_SATURATE:776,FUNC_ADD:32774,BLEND_EQUATION:32777,BLEND_EQUATION_RGB:32777,BLEND_EQUATION_ALPHA:34877,FUNC_SUBTRACT:32778,FUNC_REVERSE_SUBTRACT:32779,BLEND_DST_RGB:32968,BLEND_SRC_RGB:32969,BLEND_DST_ALPHA:32970,BLEND_SRC_ALPHA:32971,CONSTANT_COLOR:32769,ONE_MINUS_CONSTANT_COLOR:32770,CONSTANT_ALPHA:32771,ONE_MINUS_CONSTANT_ALPHA:32772,BLEND_COLOR:32773,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,ARRAY_BUFFER_BINDING:34964,ELEMENT_ARRAY_BUFFER_BINDING:34965,STREAM_DRAW:35040,STATIC_DRAW:35044,DYNAMIC_DRAW:35048,BUFFER_SIZE:34660,BUFFER_USAGE:34661,CURRENT_VERTEX_ATTRIB:34342,FRONT:1028,BACK:1029,FRONT_AND_BACK:1032,CULL_FACE:2884,BLEND:3042,DITHER:3024,STENCIL_TEST:2960,DEPTH_TEST:2929,SCISSOR_TEST:3089,POLYGON_OFFSET_FILL:32823,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_COVERAGE:32928,NO_ERROR:0,INVALID_ENUM:1280,INVALID_VALUE:1281,INVALID_OPERATION:1282,OUT_OF_MEMORY:1285,CW:2304,CCW:2305,LINE_WIDTH:2849,ALIASED_POINT_SIZE_RANGE:33901,ALIASED_LINE_WIDTH_RANGE:33902,CULL_FACE_MODE:2885,FRONT_FACE:2886,DEPTH_RANGE:2928,DEPTH_WRITEMASK:2930,DEPTH_CLEAR_VALUE:2931,DEPTH_FUNC:2932,STENCIL_CLEAR_VALUE:2961,STENCIL_FUNC:2962,STENCIL_FAIL:2964,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STENCIL_BACK_FUNC:34816,STENCIL_BACK_FAIL:34817,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,VIEWPORT:2978,SCISSOR_BOX:3088,COLOR_CLEAR_VALUE:3106,COLOR_WRITEMASK:3107,UNPACK_ALIGNMENT:3317,PACK_ALIGNMENT:3333,MAX_TEXTURE_SIZE:3379,MAX_VIEWPORT_DIMS:3386,SUBPIXEL_BITS:3408,RED_BITS:3410,GREEN_BITS:3411,BLUE_BITS:3412,ALPHA_BITS:3413,DEPTH_BITS:3414,STENCIL_BITS:3415,POLYGON_OFFSET_UNITS:10752,POLYGON_OFFSET_FACTOR:32824,TEXTURE_BINDING_2D:32873,SAMPLE_BUFFERS:32936,SAMPLES:32937,SAMPLE_COVERAGE_VALUE:32938,SAMPLE_COVERAGE_INVERT:32939,COMPRESSED_TEXTURE_FORMATS:34467,DONT_CARE:4352,FASTEST:4353,NICEST:4354,GENERATE_MIPMAP_HINT:33170,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DEPTH_COMPONENT:6402,ALPHA:6406,RGB:6407,RGBA:6408,LUMINANCE:6409,LUMINANCE_ALPHA:6410,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,FRAGMENT_SHADER:35632,VERTEX_SHADER:35633,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VARYING_VECTORS:36348,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_FRAGMENT_UNIFORM_VECTORS:36349,SHADER_TYPE:35663,DELETE_STATUS:35712,LINK_STATUS:35714,VALIDATE_STATUS:35715,ATTACHED_SHADERS:35717,ACTIVE_UNIFORMS:35718,ACTIVE_ATTRIBUTES:35721,SHADING_LANGUAGE_VERSION:35724,CURRENT_PROGRAM:35725,NEVER:512,LESS:513,EQUAL:514,LEQUAL:515,GREATER:516,NOTEQUAL:517,GEQUAL:518,ALWAYS:519,KEEP:7680,REPLACE:7681,INCR:7682,DECR:7683,INVERT:5386,INCR_WRAP:34055,DECR_WRAP:34056,VENDOR:7936,RENDERER:7937,VERSION:7938,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TEXTURE_2D:3553,TEXTURE:5890,TEXTURE_CUBE_MAP:34067,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,MAX_CUBE_MAP_TEXTURE_SIZE:34076,TEXTURE0:33984,TEXTURE1:33985,TEXTURE2:33986,TEXTURE3:33987,TEXTURE4:33988,TEXTURE5:33989,TEXTURE6:33990,TEXTURE7:33991,TEXTURE8:33992,TEXTURE9:33993,TEXTURE10:33994,TEXTURE11:33995,TEXTURE12:33996,TEXTURE13:33997,TEXTURE14:33998,TEXTURE15:33999,TEXTURE16:34e3,TEXTURE17:34001,TEXTURE18:34002,TEXTURE19:34003,TEXTURE20:34004,TEXTURE21:34005,TEXTURE22:34006,TEXTURE23:34007,TEXTURE24:34008,TEXTURE25:34009,TEXTURE26:34010,TEXTURE27:34011,TEXTURE28:34012,TEXTURE29:34013,TEXTURE30:34014,TEXTURE31:34015,ACTIVE_TEXTURE:34016,REPEAT:10497,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,SAMPLER_2D:35678,SAMPLER_CUBE:35680,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,IMPLEMENTATION_COLOR_READ_TYPE:35738,IMPLEMENTATION_COLOR_READ_FORMAT:35739,COMPILE_STATUS:35713,LOW_FLOAT:36336,MEDIUM_FLOAT:36337,HIGH_FLOAT:36338,LOW_INT:36339,MEDIUM_INT:36340,HIGH_INT:36341,FRAMEBUFFER:36160,RENDERBUFFER:36161,RGBA4:32854,RGB5_A1:32855,RGB565:36194,DEPTH_COMPONENT16:33189,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,DEPTH_STENCIL:34041,RENDERBUFFER_WIDTH:36162,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_STENCIL_SIZE:36181,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,COLOR_ATTACHMENT0:36064,DEPTH_ATTACHMENT:36096,STENCIL_ATTACHMENT:36128,DEPTH_STENCIL_ATTACHMENT:33306,NONE:0,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_UNSUPPORTED:36061,FRAMEBUFFER_BINDING:36006,RENDERBUFFER_BINDING:36007,MAX_RENDERBUFFER_SIZE:34024,INVALID_FRAMEBUFFER_OPERATION:1286,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,CONTEXT_LOST_WEBGL:37442,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,BROWSER_DEFAULT_WEBGL:37444,COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGB_ETC1_WEBGL:36196,HALF_FLOAT_OES:36193,DOUBLE:5130,READ_BUFFER:3074,UNPACK_ROW_LENGTH:3314,UNPACK_SKIP_ROWS:3315,UNPACK_SKIP_PIXELS:3316,PACK_ROW_LENGTH:3330,PACK_SKIP_ROWS:3331,PACK_SKIP_PIXELS:3332,COLOR:6144,DEPTH:6145,STENCIL:6146,RED:6403,RGB8:32849,RGBA8:32856,RGB10_A2:32857,TEXTURE_BINDING_3D:32874,UNPACK_SKIP_IMAGES:32877,UNPACK_IMAGE_HEIGHT:32878,TEXTURE_3D:32879,TEXTURE_WRAP_R:32882,MAX_3D_TEXTURE_SIZE:32883,UNSIGNED_INT_2_10_10_10_REV:33640,MAX_ELEMENTS_VERTICES:33e3,MAX_ELEMENTS_INDICES:33001,TEXTURE_MIN_LOD:33082,TEXTURE_MAX_LOD:33083,TEXTURE_BASE_LEVEL:33084,TEXTURE_MAX_LEVEL:33085,MIN:32775,MAX:32776,DEPTH_COMPONENT24:33190,MAX_TEXTURE_LOD_BIAS:34045,TEXTURE_COMPARE_MODE:34892,TEXTURE_COMPARE_FUNC:34893,CURRENT_QUERY:34917,QUERY_RESULT:34918,QUERY_RESULT_AVAILABLE:34919,STREAM_READ:35041,STREAM_COPY:35042,STATIC_READ:35045,STATIC_COPY:35046,DYNAMIC_READ:35049,DYNAMIC_COPY:35050,MAX_DRAW_BUFFERS:34852,DRAW_BUFFER0:34853,DRAW_BUFFER1:34854,DRAW_BUFFER2:34855,DRAW_BUFFER3:34856,DRAW_BUFFER4:34857,DRAW_BUFFER5:34858,DRAW_BUFFER6:34859,DRAW_BUFFER7:34860,DRAW_BUFFER8:34861,DRAW_BUFFER9:34862,DRAW_BUFFER10:34863,DRAW_BUFFER11:34864,DRAW_BUFFER12:34865,DRAW_BUFFER13:34866,DRAW_BUFFER14:34867,DRAW_BUFFER15:34868,MAX_FRAGMENT_UNIFORM_COMPONENTS:35657,MAX_VERTEX_UNIFORM_COMPONENTS:35658,SAMPLER_3D:35679,SAMPLER_2D_SHADOW:35682,FRAGMENT_SHADER_DERIVATIVE_HINT:35723,PIXEL_PACK_BUFFER:35051,PIXEL_UNPACK_BUFFER:35052,PIXEL_PACK_BUFFER_BINDING:35053,PIXEL_UNPACK_BUFFER_BINDING:35055,FLOAT_MAT2x3:35685,FLOAT_MAT2x4:35686,FLOAT_MAT3x2:35687,FLOAT_MAT3x4:35688,FLOAT_MAT4x2:35689,FLOAT_MAT4x3:35690,SRGB:35904,SRGB8:35905,SRGB8_ALPHA8:35907,COMPARE_REF_TO_TEXTURE:34894,RGBA32F:34836,RGB32F:34837,RGBA16F:34842,RGB16F:34843,VERTEX_ATTRIB_ARRAY_INTEGER:35069,MAX_ARRAY_TEXTURE_LAYERS:35071,MIN_PROGRAM_TEXEL_OFFSET:35076,MAX_PROGRAM_TEXEL_OFFSET:35077,MAX_VARYING_COMPONENTS:35659,TEXTURE_2D_ARRAY:35866,TEXTURE_BINDING_2D_ARRAY:35869,R11F_G11F_B10F:35898,UNSIGNED_INT_10F_11F_11F_REV:35899,RGB9_E5:35901,UNSIGNED_INT_5_9_9_9_REV:35902,TRANSFORM_FEEDBACK_BUFFER_MODE:35967,MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS:35968,TRANSFORM_FEEDBACK_VARYINGS:35971,TRANSFORM_FEEDBACK_BUFFER_START:35972,TRANSFORM_FEEDBACK_BUFFER_SIZE:35973,TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN:35976,RASTERIZER_DISCARD:35977,MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS:35978,MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS:35979,INTERLEAVED_ATTRIBS:35980,SEPARATE_ATTRIBS:35981,TRANSFORM_FEEDBACK_BUFFER:35982,TRANSFORM_FEEDBACK_BUFFER_BINDING:35983,RGBA32UI:36208,RGB32UI:36209,RGBA16UI:36214,RGB16UI:36215,RGBA8UI:36220,RGB8UI:36221,RGBA32I:36226,RGB32I:36227,RGBA16I:36232,RGB16I:36233,RGBA8I:36238,RGB8I:36239,RED_INTEGER:36244,RGB_INTEGER:36248,RGBA_INTEGER:36249,SAMPLER_2D_ARRAY:36289,SAMPLER_2D_ARRAY_SHADOW:36292,SAMPLER_CUBE_SHADOW:36293,UNSIGNED_INT_VEC2:36294,UNSIGNED_INT_VEC3:36295,UNSIGNED_INT_VEC4:36296,INT_SAMPLER_2D:36298,INT_SAMPLER_3D:36299,INT_SAMPLER_CUBE:36300,INT_SAMPLER_2D_ARRAY:36303,UNSIGNED_INT_SAMPLER_2D:36306,UNSIGNED_INT_SAMPLER_3D:36307,UNSIGNED_INT_SAMPLER_CUBE:36308,UNSIGNED_INT_SAMPLER_2D_ARRAY:36311,DEPTH_COMPONENT32F:36012,DEPTH32F_STENCIL8:36013,FLOAT_32_UNSIGNED_INT_24_8_REV:36269,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING:33296,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE:33297,FRAMEBUFFER_ATTACHMENT_RED_SIZE:33298,FRAMEBUFFER_ATTACHMENT_GREEN_SIZE:33299,FRAMEBUFFER_ATTACHMENT_BLUE_SIZE:33300,FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE:33301,FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE:33302,FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE:33303,FRAMEBUFFER_DEFAULT:33304,UNSIGNED_INT_24_8:34042,DEPTH24_STENCIL8:35056,UNSIGNED_NORMALIZED:35863,DRAW_FRAMEBUFFER_BINDING:36006,READ_FRAMEBUFFER:36008,DRAW_FRAMEBUFFER:36009,READ_FRAMEBUFFER_BINDING:36010,RENDERBUFFER_SAMPLES:36011,FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER:36052,MAX_COLOR_ATTACHMENTS:36063,COLOR_ATTACHMENT1:36065,COLOR_ATTACHMENT2:36066,COLOR_ATTACHMENT3:36067,COLOR_ATTACHMENT4:36068,COLOR_ATTACHMENT5:36069,COLOR_ATTACHMENT6:36070,COLOR_ATTACHMENT7:36071,COLOR_ATTACHMENT8:36072,COLOR_ATTACHMENT9:36073,COLOR_ATTACHMENT10:36074,COLOR_ATTACHMENT11:36075,COLOR_ATTACHMENT12:36076,COLOR_ATTACHMENT13:36077,COLOR_ATTACHMENT14:36078,COLOR_ATTACHMENT15:36079,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:36182,MAX_SAMPLES:36183,HALF_FLOAT:5131,RG:33319,RG_INTEGER:33320,R8:33321,RG8:33323,R16F:33325,R32F:33326,RG16F:33327,RG32F:33328,R8I:33329,R8UI:33330,R16I:33331,R16UI:33332,R32I:33333,R32UI:33334,RG8I:33335,RG8UI:33336,RG16I:33337,RG16UI:33338,RG32I:33339,RG32UI:33340,VERTEX_ARRAY_BINDING:34229,R8_SNORM:36756,RG8_SNORM:36757,RGB8_SNORM:36758,RGBA8_SNORM:36759,SIGNED_NORMALIZED:36764,COPY_READ_BUFFER:36662,COPY_WRITE_BUFFER:36663,COPY_READ_BUFFER_BINDING:36662,COPY_WRITE_BUFFER_BINDING:36663,UNIFORM_BUFFER:35345,UNIFORM_BUFFER_BINDING:35368,UNIFORM_BUFFER_START:35369,UNIFORM_BUFFER_SIZE:35370,MAX_VERTEX_UNIFORM_BLOCKS:35371,MAX_FRAGMENT_UNIFORM_BLOCKS:35373,MAX_COMBINED_UNIFORM_BLOCKS:35374,MAX_UNIFORM_BUFFER_BINDINGS:35375,MAX_UNIFORM_BLOCK_SIZE:35376,MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS:35377,MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS:35379,UNIFORM_BUFFER_OFFSET_ALIGNMENT:35380,ACTIVE_UNIFORM_BLOCKS:35382,UNIFORM_TYPE:35383,UNIFORM_SIZE:35384,UNIFORM_BLOCK_INDEX:35386,UNIFORM_OFFSET:35387,UNIFORM_ARRAY_STRIDE:35388,UNIFORM_MATRIX_STRIDE:35389,UNIFORM_IS_ROW_MAJOR:35390,UNIFORM_BLOCK_BINDING:35391,UNIFORM_BLOCK_DATA_SIZE:35392,UNIFORM_BLOCK_ACTIVE_UNIFORMS:35394,UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES:35395,UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER:35396,UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER:35398,INVALID_INDEX:4294967295,MAX_VERTEX_OUTPUT_COMPONENTS:37154,MAX_FRAGMENT_INPUT_COMPONENTS:37157,MAX_SERVER_WAIT_TIMEOUT:37137,OBJECT_TYPE:37138,SYNC_CONDITION:37139,SYNC_STATUS:37140,SYNC_FLAGS:37141,SYNC_FENCE:37142,SYNC_GPU_COMMANDS_COMPLETE:37143,UNSIGNALED:37144,SIGNALED:37145,ALREADY_SIGNALED:37146,TIMEOUT_EXPIRED:37147,CONDITION_SATISFIED:37148,WAIT_FAILED:37149,SYNC_FLUSH_COMMANDS_BIT:1,VERTEX_ATTRIB_ARRAY_DIVISOR:35070,ANY_SAMPLES_PASSED:35887,ANY_SAMPLES_PASSED_CONSERVATIVE:36202,SAMPLER_BINDING:35097,RGB10_A2UI:36975,INT_2_10_10_10_REV:36255,TRANSFORM_FEEDBACK:36386,TRANSFORM_FEEDBACK_PAUSED:36387,TRANSFORM_FEEDBACK_ACTIVE:36388,TRANSFORM_FEEDBACK_BINDING:36389,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_SRGB8_ETC2:37493,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37494,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37495,COMPRESSED_RGBA8_ETC2_EAC:37496,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37497,TEXTURE_IMMUTABLE_FORMAT:37167,MAX_ELEMENT_INDEX:36203,TEXTURE_IMMUTABLE_LEVELS:33503,MAX_TEXTURE_MAX_ANISOTROPY_EXT:34047}),Xg=function(){function v(G,U){var i=A;return function(){return i||(i=G.getExtension(U)),i}}function x(u,d){d==A&&(d={}),d.version=h&&(u instanceof WebGL2RenderingContext||U.prototype.toString.call(u)===S)?2:1,d.extensions=function(){for(var E={},S=u.getSupportedExtensions(),h=S.length;h--;)E[name]=v(u,S[h]);return E}();for(var x=U.keys(y),e=0,$=x.length;$>e;++e){var z=x[e];d[z]=u.getParameter(y[z])}if(d.version>1){x=U.keys(o);for(var e=0,$=x.length;$>e;++e){var z=x[e];d[z]=u.getParameter(o[z])}}return d}var h="undefined"!=typeof WebGL2RenderingContext,S="[object WebGL2RenderingContext]",y={aliasedLineWidthRange:Jh.ALIASED_LINE_WIDTH_RANGE,aliasedPointSizeRange:Jh.ALIASED_POINT_SIZE_RANGE,maxCombinedTextureImageUnits:Jh.MAX_COMBINED_TEXTURE_IMAGE_UNITS,maxCubeMapTextureSize:Jh.MAX_CUBE_MAP_TEXTURE_SIZE,maxFragmentUniformVectors:Jh.MAX_FRAGMENT_UNIFORM_VECTORS,maxRenderBufferSize:Jh.MAX_RENDERBUFFER_SIZE,maxTextureImageUnits:Jh.MAX_TEXTURE_IMAGE_UNITS,maxTextureSize:Jh.MAX_TEXTURE_SIZE,maxVaryingVectors:Jh.MAX_VARYING_VECTORS,maxVertexAttribs:Jh.MAX_VERTEX_ATTRIBS,maxVertexTextureImageUnits:Jh.MAX_VERTEX_TEXTURE_IMAGE_UNITS,maxVertexUniformVectors:Jh.MAX_VERTEX_UNIFORM_VECTORS,maxViewportDIMs:Jh.MAX_VIEWPORT_DIMS},o={max3DTextureSize:Jh.MAX_3D_TEXTURE_SIZE,maxArrayTextureLayers:Jh.MAX_ARRAY_TEXTURE_LAYERS,maxColorAttachments:Jh.MAX_COLOR_ATTACHMENTS,maxCombinedFragmentUniformComponents:Jh.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS,maxCombinedUniformBlocks:Jh.MAX_COMBINED_UNIFORM_BLOCKS,maxCombinedVertexUniformComponents:Jh.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS,maxDrawBuffers:Jh.MAX_DRAW_BUFFERS,maxElementIndex:Jh.MAX_ELEMENT_INDEX,maxElementsIndices:Jh.MAX_ELEMENTS_INDICES,maxElementsVertices:Jh.MAX_ELEMENTS_VERTICES,maxFragmentInpuComponents:Jh.MAX_FRAGMENT_INPUT_COMPONENTS,maxFragmentUniformBlocks:Jh.MAX_FRAGMENT_UNIFORM_BLOCKS,maxFragmentUniformComponents:Jh.MAX_FRAGMENT_UNIFORM_COMPONENTS,maxProgramTexelOffset:Jh.MAX_PROGRAM_TEXEL_OFFSET,maxSamples:Jh.MAX_SAMPLES,maxTextureLODBias:Jh.MAX_TEXTURE_LOD_BIAS,maxTransformFeedbackInterleavedComponents:Jh.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS,maxTransformFeedbackSeparateAttribs:Jh.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS,maxTransformFeedbackSeparateComponents:Jh.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS,maxUniformBlockSize:Jh.MAX_UNIFORM_BLOCK_SIZE,maxUniformBufferBindings:Jh.MAX_UNIFORM_BUFFER_BINDINGS,maxVaryingComponents:Jh.MAX_VARYING_COMPONENTS,maxVertexOutputComponents:Jh.MAX_VERTEX_OUTPUT_COMPONENTS,maxVertexUniformBlocks:Jh.MAX_VERTEX_UNIFORM_BLOCKS,maxVertexUniformComponents:Jh.MAX_VERTEX_UNIFORM_COMPONENTS,minProgramTexelOffset:Jh.MIN_PROGRAM_TEXEL_OFFSET};
return{"for":function(H){var g=H._info;return g||(H._info=g=x(H,g)),g}}}(),Rq=function(){function b(e,o,b){return{def:e,getter:b?function(h){var I=Xg.for(h);return I.version>1?h.getParameter(o):e}:function(c){return c.getParameter(o)},setter:b?function(Y,g){var G=Xg.for(Y);G.version>1&&Y.pixelStorei(o,g)}:function(p,W){p.pixelStorei(o,W)}}}function h(E){return"string"==typeof E?Jn(E):E.r!==A?(x[0]=E.r,x[1]=E.g,x[2]=E.b,x[3]=E.a,x):E.red!==A?(x[0]=E.red,x[1]=E.green,x[2]=E.blue,x[3]=E.alpha,x):E}function _(G){return Z(G)?Array.prototype.slice.call(G,0):G}function B(k,W,L){this.gl=W,this._record=L||{},this._branches={},this._leafSync={},this._struct=k;for(var t=k.children,M=t.length;M--;){var S=t[M],H=S.name;S.isLeaf?(this._leafSync[H]=!1,this._record[H]=_(S.desc.def)):this._record[H]={}}}function z(e){function K(n,M){B.call(this,e,n,M);for(var u=C.length;u--;){var L=C[u];this._branches[L._name]=new L._type(n,this._record[L._name])}}function n(S,A){function n(d,Z){for(var k=l,t=!1;k--;)d[k]!==Z[k]&&(d[k]=Z[k],t=!0);return t}var L=S.name,x=Z(S.desc.def),l=x&&S.desc.def.length;if(S.isLeaf){var s=S.desc.setter,I=S.desc.parse;U.defineProperty(A,L,{configurable:!1,enumerable:!0,get:function(){return this._record[L]},set:x?function(P){I&&(P=I(P)),(n(this._record[L],P)||!this._leafSync[L])&&(s(this.gl,this._record[L]),this._leafSync[L]=!0)}:function(a){this._record[L]===a&&this._leafSync[L]||(s(this.gl,a),this._record[L]=a,this._leafSync[L]=!0)}})}else C.push({_name:L,_type:z(S)}),U.defineProperty(A,L,{configurable:!1,enumerable:!0,get:function(){return this._branches[L]},set:function(d){this._branches[L].apply(d)}})}var C=[];return I(K,B),e.forEach(n,K.prototype),K}var x="undefined"!=typeof Float32Array&&new Float32Array(4),M={viewport:{def:[0,0,0/0,0/0],getter:function(V){return V.getParameter(V.VIEWPORT)},setter:function(o,w){var N=w[2]!==w[2]?o.drawingBufferWidth-w[0]:w[2],P=w[3]!==w[3]?o.drawingBufferHeight-w[1]:w[3];o.viewport(w[0],w[1],N,P)}},dither:{def:!1,getter:function(Z){return Z.isEnabled(Z.DITHER)},setter:function(O,Q){Q?O.enable(O.DITHER):O.disable(O.DITHER)}},rasterizerDiscard:{def:!1,getter:function(p){var q=Xg.for(p);return q.version>1&&p.isEnabled(p.RASTERIZER_DISCARD)},setter:function(i,e){var B=Xg.for(i);1!==B.version&&(e?i.enable(i.RASTERIZER_DISCARD):i.disable(i.RASTERIZER_DISCARD))}},lineWidth:{def:1,getter:function(R){return R.lineWidth?R.getParameter(R.LINE_WIDTH):1},setter:function(B,i){B.lineWidth&&B.lineWidth(i)}},color:{clear:{def:[0,0,0,0],getter:function(L){return L.getParameter(L.COLOR_CLEAR_VALUE)},setter:function(I,B){I.clearColor(B[0],B[1],B[2],B[3])},parse:h},mask:{def:[!0,!0,!0,!0],getter:function(i){return i.getParameter(i.COLOR_WRITEMASK)},setter:function(z,f){z.colorMask(f[0],f[1],f[2],f[3])}}},blend:{enabled:{def:!1,getter:function(D){return D.isEnabled(D.BLEND)},setter:function(F,N){N?F.enable(F.BLEND):F.disable(F.BLEND)}},color:{def:[0,0,0,0],getter:function(h){return h.getParameter(h.BLEND_COLOR)},setter:function(f,e){f.blendColor(e[0],e[1],e[2],e[3])},parse:h},equation:{def:[Jh.FUNC_ADD,Jh.FUNC_ADD],getter:function($){return[$.getParameter($.BLEND_EQUATION_RGB),$.getParameter($.BLEND_EQUATION_ALPHA)]},setter:function(b,I){b.blendEquationSeparate(I[0],I[1])},parse:function(g){var b=g.length;return b>1?g:1===b?(x[1]=x[0]=g[0],x):(x[1]=x[0]=g,x)}},func:{def:[Jh.ONE,Jh.ZERO,Jh.ONE,Jh.ZERO],getter:function(j){return[j.getParameter(j.BLEND_SRC_RGB),j.getParameter(j.BLEND_DST_RGB),j.getParameter(j.BLEND_SRC_ALPHA),j.getParameter(j.BLEND_DST_ALPHA)]},setter:function(S,C){S.blendFuncSeparate(C[0],C[1],C[2],C[3])},parse:function(Y){var p=Y.length;return p>3?Y:(x[2]=x[0]=Y[0],x[3]=x[1]=Y[1],x)}}},cullFace:{enabled:{def:!1,getter:function(i){return i.isEnabled(i.CULL_FACE)},setter:function(p,G){G?p.enable(p.CULL_FACE):p.disable(p.CULL_FACE)}},mode:{def:Jh.BACK,getter:function(t){return t.getParameter(t.CULL_FACE_MODE)},setter:function(x,F){x.cullFace(F)}},frontFace:{def:Jh.CCW,getter:function(G){return G.getParameter(G.FRONT_FACE)},setter:function(A,j){A.frontFace(j)}}},scissor:{enabled:{def:!1,getter:function(C){return C.isEnabled(C.SCISSOR_TEST)},setter:function(t,z){z?t.enable(t.SCISSOR_TEST):t.disable(t.SCISSOR_TEST)}},box:{def:[0,0,0/0,0/0],getter:function(A){return A.getParameter(A.SCISSOR_BOX)},setter:function(T,t){var z=t[2]!==t[2]?T.drawingBufferWidth-t[0]:t[2],l=t[3]!==t[3]?T.drawingBufferHeight-t[1]:t[3];T.scissor(t[0],t[1],z,l)}}},depth:{enabled:{def:!1,getter:function(Z){return Z.isEnabled(Z.DEPTH_TEST)},setter:function(z,Y){Y?z.enable(z.DEPTH_TEST):z.disable(z.DEPTH_TEST)}},clear:{def:1,getter:function(u){return u.getParameter(u.DEPTH_CLEAR_VALUE)},setter:function(n,z){n.clearDepth(z)}},mask:{def:!0,getter:function(W){return W.getParameter(W.DEPTH_WRITEMASK)},setter:function(i,j){i.depthMask(j)}},range:{def:[-1,1],getter:function(s){return s.getParameter(s.DEPTH_RANGE)},setter:function(j,b){j.depthRange(b[0],b[1])}},func:{def:Jh.LESS,getter:function(W){return W.getParameter(W.DEPTH_FUNC)},setter:function(n,R){n.depthFunc(R)}}},stencil:{enabled:{def:!1,getter:function(G){return G.isEnabled(G.STENCIL_TEST)},setter:function(c,b){b?c.enable(c.STENCIL_TEST):c.disable(c.STENCIL_TEST)}},clear:{def:0,getter:function(F){return F.getParameter(F.STENCIL_CLEAR_VALUE)},setter:function(r,X){r.clearStencil(X)}},frontMask:{def:255,getter:function(S){return S.getParameter(S.STENCIL_WRITEMASK)},setter:function(k,n){k.stencilMaskSeparate(k.FRONT,n)}},frontOp:{def:[Jh.KEEP,Jh.KEEP,Jh.KEEP],getter:function(o){return[o.getParameter(o.STENCIL_FAIL),o.getParameter(o.STENCIL_PASS_DEPTH_FAIL),o.getParameter(o.STENCIL_PASS_DEPTH_PASS)]},setter:function(L,O){L.stencilOpSeparate(L.FRONT,O[0],O[1],O[2])}},frontFunc:{def:[Jh.ALWAYS,0,255],getter:function(p){return[p.getParameter(p.STENCIL_FUNC),p.getParameter(p.STENCIL_REF),p.getParameter(p.STENCIL_VALUE_MASK)]},setter:function(G,b){G.stencilFuncSeparate(G.FRONT,b[0],b[1],b[2])}},backMask:{def:255,getter:function(r){return r.getParameter(r.STENCIL_BACK_WRITEMASK)},setter:function(p,f){p.stencilMaskSeparate(p.BACK,f)}},backOp:{def:[Jh.KEEP,Jh.KEEP,Jh.KEEP],getter:function(S){return[S.getParameter(S.STENCIL_BACK_FAIL),S.getParameter(S.STENCIL_BACK_PASS_DEPTH_FAIL),S.getParameter(S.STENCIL_BACK_PASS_DEPTH_PASS)]},setter:function(A,u){A.stencilOpSeparate(A.BACK,u[0],u[1],u[2])}},backFunc:{def:[Jh.ALWAYS,0,255],getter:function(u){return[u.getParameter(u.STENCIL_BACK_FUNC),u.getParameter(u.STENCIL_BACK_REF),u.getParameter(u.STENCIL_BACK_VALUE_MASK)]},setter:function(o,w){o.stencilFuncSeparate(o.BACK,w[0],w[1],w[2])}}},hint:{generateMipmap:{def:Jh.DONT_CARE,getter:function(g){return g.getParameter(g.GENERATE_MIPMAP_HINT)},setter:function(F,W){F.hint(F.GENERATE_MIPMAP_HINT,W)}},fragmentShaderDerivative:{def:Jh.DONT_CARE,getter:function(G){var v=Xg.for(G);return 1!==v.version||v.extensions.OES_standard_derivatives?G.getParameter(Jh.FRAGMENT_SHADER_DERIVATIVE_HINT):Jh.DONT_CARE},setter:function(m,O){var y=Xg.for(m);return y.version>1||y.extensions.OES_standard_derivatives?(m.hint(Jh.FRAGMENT_SHADER_DERIVATIVE_HINT,O),void 0):void 0}}},pixelStore:{packAlignment:b(4,Jh.PACK_ALIGNMENT,!1),unpackAlignment:b(4,Jh.UNPACK_ALIGNMENT,!1),unpackFlipY:b(!1,Jh.UNPACK_FLIP_Y_WEBGL,!1),unpackPremultiplyAlpha:b(!1,Jh.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),unpackColorspaceConversion:b(Jh.BROWSER_DEFAULT_WEBGL,Jh.UNPACK_COLORSPACE_CONVERSION_WEBGL,!1),packRowLength:b(0,Jh.PACK_ROW_LENGTH,!0),packSkipPixels:b(0,Jh.PACK_SKIP_PIXELS,!0),packSkipRows:b(0,Jh.PACK_SKIP_ROWS,!0),unpackRowLength:b(0,Jh.UNPACK_ROW_LENGTH,!0),unpackImageHeight:b(0,Jh.UNPACK_IMAGE_HEIGHT,!0),unpackSkipPixels:b(0,Jh.UNPACK_SKIP_PIXELS,!0),unpackSkipRows:b(0,Jh.UNPACK_SKIP_ROWS,!0),unpackSkipImages:b(0,Jh.UNPACK_SKIP_IMAGES,!0)},polygonOffset:{enabled:{def:!1,getter:function(d){return d.isEnabled(d.POLYGON_OFFSET_FILL)},setter:function(W,H){H?W.enable(W.POLYGON_OFFSET_FILL):W.disable(W.POLYGON_OFFSET_FILL)}},value:{def:[0,0],getter:function(b){return[b.getParameter(b.POLYGON_OFFSET_FACTOR),b.getParameter(b.POLYGON_OFFSET_UNITS)]},setter:function(h,m){h.polygonOffset(m[0],m[1])}}},sampleCoverage:{enabled:{def:!1,getter:function(t){return t.isEnabled(t.SAMPLE_COVERAGE)},setter:function(J,P){P?J.enable(J.SAMPLE_COVERAGE):J.disable(J.SAMPLE_COVERAGE)}},alpha:{def:!1,getter:function(Q){return Q.isEnabled(Q.SAMPLE_ALPHA_TO_COVERAGE)},setter:function(K,R){R?K.enable(K.SAMPLE_ALPHA_TO_COVERAGE):K.disable(K.SAMPLE_ALPHA_TO_COVERAGE)}},value:{def:[1,!1],getter:function(I){return[I.getParameter(I.SAMPLE_COVERAGE_VALUE),I.getParameter(I.SAMPLE_COVERAGE_INVERT)]},setter:function(T,l){T.sampleCoverage(l[0],l[1])}}}},G=_n.create(M,function(W){return"def"in W});B.prototype.reset=function(){for(var K=this._struct.children,D=K.length;D--;){var N=K[D],C=N.name;N.isLeaf?this[C]=N.desc.def:this._branches[C].reset()}},B.prototype.save=function(z){z==A&&(z={});for(var R=this._struct.children,X=R.length;X--;){var p=R[X],S=p.name;if(p.isLeaf)z[S]=_(this._record[S]);else{var g=z[S];g==A&&(z[S]=g={}),this._branches[S].save(g)}}return z},B.prototype.sync=function(V,P){for(var A=this._struct.children,y=A.length;y--;){var R=A[y],j=R.name;R.isLeaf?(P||!this._leafSync[j])&&(V?(this._record[j]=R.desc.getter(this.gl),this._leafSync[j]=!0):(R.desc.setter(this.gl,this._record[j]),this._leafSync[j]=!0)):this._branches[j].sync(V,P)}},B.prototype.syncLoss=function(){for(var W=this._struct.children,S=W.length;S--;){var P=W[S];P.isLeaf?this._leafSync[P.name]=!1:this._branches[P.name].syncLoss()}},B.prototype.apply=function(g){for(var P=this._struct.children,Y=P.length;Y--;){var d=P[Y],C=d.name;C in g&&(d.isLeaf?this[C]=g[C]:this._branches[C].apply(g[C]))}},B.prototype.append=function(t){var F=this._struct.childMap;for(var G in t){var c=F[G];c&&(c.isLeaf?this[G]=t[G]:this._branches[G].append(t[G]))}};var p=z(G);return function(B){var O=B._state;return O||(B._state=O=new p(B)),O}}(),hs=function(){function i(a,V,z,o){if(a){var i=a.length;if(i!=A)for(var H=0;o>H;++H)V[z+H]=a[H];else a.toArray&&a.toArray(V,z)}else for(var H=0;o>H;++H)V[z+H]=0}function M(N,D,Q){var Z=N[0];if(0>=Z||Z>0)return N;var d=D*Q,M=X[d];if(M==A&&(X[d]=M=new Float32Array(d)),0!==D){i(Z,M,0,Q);for(var t=1,J=0;t!==D;++t)J+=Q,i(N[t],M,J,Q)}return M}function T(g,U){g.uniform1f(this.addr,U)}function E(E,d){E.uniform1fv(this.addr,d)}function _(P,Z){if(Z.x!=A)P.uniform2f(this.addr,Z.x,Z.y);else{var w=X[2];w.set(Z,0),P.uniform2fv(this.addr,w)}}function x(H,$){H.uniform2fv(this.addr,M($,this.size,2))}function V(r,h){if(h.x!=A)r.uniform3f(this.addr,h.x,h.y,h.z);else if(h.r!=A)r.uniform3f(this.addr,h.r,h.g,h.b);else if(h.red!=A)r.uniform3f(this.addr,h.red,h.green,h.blue);else{var u=X[3];u.set(h,0),r.uniform3fv(this.addr,u)}}function G(T,s){T.uniform3fv(this.addr,M(s,this.size,3))}function J(u,m){if("string"==typeof m&&(m=Jn(m)),m.x!=A)u.uniform4f(this.addr,m.x,m.y,m.z,m.w);else if(m.r!=A)u.uniform4f(this.addr,m.r,m.g,m.b,m.a);else if(m.red!=A)u.uniform4f(this.addr,m.red,m.green,m.blue,m.alpha);else{var z=X[4];z.set(m,0),u.uniform4fv(this.addr,z)}}function Y(Z,t){Z.uniform4fv(this.addr,M(t,this.size,4))}function L(i,g){i.uniform1i(this.addr,g)}function D(Y,u){Y.uniform1iv(this.addr,u)}function w(P,x){P.uniform2iv(this.addr,x)}function o(N,o){N.uniform3iv(this.addr,o)}function Q($,A){$.uniform4iv(this.addr,A)}function m(w,N){w.uniform1i(this.addr,u[N?1:0])}function H(q,b){var s=X[4];s.set(b,0),q.uniformMatrix2fv(this.addr,!1,s)}function f(A,q){A.uniformMatrix2fv(this.addr,!1,M(q,this.size,4))}function e(U,b){var l=X[9];l.set(b,0),U.uniformMatrix3fv(this.addr,!1,l)}function p(I,G){I.uniformMatrix3fv(this.addr,!1,M(G,this.size,9))}function t(Q,L){var Y=X[16];Y.set(L,0),Q.uniformMatrix4fv(this.addr,!1,Y)}function R(Z,c){Z.uniformMatrix4fv(this.addr,!1,M(c,this.size,16))}function j(k,$){k.uniform1i(this.addr,this.slots[0]),k.activeTexture(k.TEXTURE0+this.slots[0]),k.bindTexture(k.TEXTURE_2D,$||k._emptyTexture)}function O(U,C){U.uniform1iv(this.addr,this.slots);for(var B=this.slots.length;B--;)U.activeTexture(U.TEXTURE0+this.slots[B]),U.bindTexture(U.TEXTURE_2D,C[B]||U._emptyTexture)}function P(Z,R){Z.uniform1i(this.addr,this.slots[0]),Z.activeTexture(Z.TEXTURE0+this.slots[0]),Z.bindTexture(Z.TEXTURE_CUBE_MAP,R||Z._emptyCubeTexture)}function y(U,W){U.uniform1iv(this.addr,this.slots);for(var p=this.slots.length;p--;)U.activeTexture(U.TEXTURE0+this.slots[p]),U.bindTexture(U.TEXTURE_CUBE_MAP,W[p]||U._emptyCubeTexture)}function F(e,A,i){Z[e]=[A,i]}function r(w,z,I){switch(w.type){case 35678:case 35680:if("uSampler"===I)return[0];if("uBlendSampler"===I)return[1];for(var o=w.size,L=new Int32Array(o),n=0;o>n;++n)L[n]=z.usedTextureSlot++;return L}return A}function W(E,e,x,n,v){this.name=E,this.addr=e,this.size=n?x.size:0,this.activeInfo=x,this.setter=Z[x.type][n?1:0],this.slots=r(x,v,E),$d(this)}function b(V,P,Y,k){var C=V.name,b=C.length;for(z.lastIndex=0;;){var I=z.exec(C),x=z.lastIndex,U=I[1],n="]"===I[2],t=I[3];if(n&&(U=0|U),t===A||"["===t&&x+2===b){Y[U]=new W(U,P,V,t!==A,k);break}var Z=Y[U];Z==A&&(Y[U]=Z={}),Y=Z}}function g(g,Q,N){this.gl=Q,this._program=N,this._leaves={},this._branches={},this._struct=g}function c(F){function Q(L,I){g.call(this,F,L,I);for(var r=f.length;r--;){var G=f[r];this._branches[G._name]=new G._type(L,I)}this.uuid=xb.generateUUID()}function e(q,s){var C=q.name;if(q.isLeaf){var G=B("d.setter(this.gl, v);",["v"],["d"],[q.desc]);U.defineProperty(s,C,{configurable:!1,enumerable:!0,get:function(){return G},set:G})}else f.push({_name:C,_type:c(q)}),U.defineProperty(s,C,{configurable:!1,enumerable:!0,get:function(){return this._branches[C]},set:function(Q){this._branches[C].apply(Q)}})}var f=[];return I(Q,g),F.forEach(e,Q.prototype),Q}function l(w,S){for(var Q=w.getProgramParameter(S,w.ACTIVE_UNIFORMS),o={},d={usedTextureSlot:2};Q--;){var x=w.getActiveUniform(S,Q),P=x.name,L=w.getUniformLocation(S,P);b(x,L,o,d)}var Z=_n.create(o,function(z){return"addr"in z}),E=c(Z);return U.defineProperty(E.prototype,"textureCount",{configurable:!1,enumerable:!1,writable:!1,value:d.usedTextureSlot}),new E(w,S)}var X=[];if("function"==typeof Float32Array)for(var C=1;17>C;++C)X[C]=new Float32Array(C);var u=[0,1],Z=[];F(Jh.FLOAT,T,E),F(Jh.FLOAT_VEC2,_,x),F(Jh.FLOAT_VEC3,V,G),F(Jh.FLOAT_VEC4,J,Y),F(Jh.INT,L,D),F(Jh.INT_VEC2,w,w),F(Jh.INT_VEC3,o,o),F(Jh.INT_VEC4,Q,Q),F(Jh.BOOL,m,D),F(Jh.BOOL_VEC2,w,w),F(Jh.BOOL_VEC3,o,o),F(Jh.BOOL_VEC4,Q,Q),F(Jh.FLOAT_MAT2,H,f),F(Jh.FLOAT_MAT3,e,p),F(Jh.FLOAT_MAT4,t,R),F(Jh.SAMPLER_2D,j,O),F(Jh.SAMPLER_CUBE,P,y);var z=/([\w\d_]+)(\])?(\[|\.)?/g;return g.prototype.apply=function(Y){for(var h=this._struct.children,y=h.length;y--;){var r=h[y],j=r.name;j in Y&&(r.isLeaf?this[j]=Y[j]:this._branches[j].apply(Y[j]))}},g.prototype.append=function(I){var Q=this._struct.childMap;for(var K in I){var c=Q[K];c&&(c.isLeaf?this[K]=I[K]:this._branches[K].append(I[K]))}},function(r,c){var g=c._uniforms;return g||(c._uniforms=g=l(r,c)),g}}(),$j=function(){function r(c,Z,R){Z.vertexAttrib1f(c.addr,R)}function N(y,m,q){if(q.x!=A)m.vertexAttrib2f(y.addr,q.x,q.y);else{var z=p[2];z.set(q,0),m.vertexAttrib2fv(y.addr,z)}}function d(T,U,M){if(M.x!=A)U.vertexAttrib3f(T.addr,M.x,M.y,M.z);else if(M.r!=A)U.vertexAttrib3f(T.addr,M.r,M.g,M.b);else if(M.red!=A)U.vertexAttrib3f(T.addr,M.red,M.green,M.blue);else{var g=p[3];g.set(M,0),U.vertexAttrib3fv(T.addr,g)}}function o(h,f,I){if("string"==typeof I&&(I=Jn(I)),I.x!=A)f.vertexAttrib4f(h.addr,I.x,I.y,I.z,I.w);else if(I.r!=A)f.vertexAttrib4f(h.addr,I.r,I.g,I.b,I.a);else if(I.red!=A)f.vertexAttrib4f(h.addr,I.red,I.green,I.blue,I.alpha);else{var X=p[4];X.set(I,0),f.vertexAttrib4fv(h.addr,X)}}function Q(u,A,w){w=w.el||w;for(var n=0,i=0;2>n;++n)A.vertexAttrib2f(u.addr,w[i++],w[i++])}function n(b,h,j){j=j.el||j;for(var K=0,A=0;3>K;++K)h.vertexAttrib3f(b.addr,j[A++],j[A++],j[A++])}function L(x,D,q){q=q.el||q;for(var e=0,G=0;4>e;++e)D.vertexAttrib4f(x.addr,q[G++],q[G++],q[G++],q[G++])}function M(J,I,H,V,z,v,D){I.bindBuffer(I.ARRAY_BUFFER,H),I.vertexAttribPointer(J.addr,1,V||I.FLOAT,!!z,v||0,D||0),I.bindBuffer(I.ARRAY_BUFFER,null)}function b($,R,q,k,D,o,B){R.bindBuffer(R.ARRAY_BUFFER,q),R.vertexAttribPointer($.addr,2,k||R.FLOAT,!!D,o||0,B||0),R.bindBuffer(R.ARRAY_BUFFER,null)}function y(d,l,R,u,A,$,x){l.bindBuffer(l.ARRAY_BUFFER,R),l.vertexAttribPointer(d.addr,3,u||l.FLOAT,!!A,$||0,x||0),l.bindBuffer(l.ARRAY_BUFFER,null)}function J(K,I,x,F,G,m,$){I.bindBuffer(I.ARRAY_BUFFER,x),I.vertexAttribPointer(K.addr,4,F||I.FLOAT,!!G,m||0,$||0),I.bindBuffer(I.ARRAY_BUFFER,null)}function Y(G,s,L,n,W,v,o){var v=v||4,o=o||0;s.bindBuffer(s.ARRAY_BUFFER,L),s.vertexAttribPointer(G.addr,2,n||s.FLOAT,!!W,v,o),s.vertexAttribPointer(G.addr+1,2,n||s.FLOAT,!!W,v,o+2),s.bindBuffer(s.ARRAY_BUFFER,null)}function F(H,O,K,o,i,C,j){var C=C||9,j=j||0;O.bindBuffer(O.ARRAY_BUFFER,K),O.vertexAttribPointer(H.addr,3,o||O.FLOAT,!!i,C,j),O.vertexAttribPointer(H.addr+1,3,o||O.FLOAT,!!i,C,j+3),O.vertexAttribPointer(H.addr+2,3,o||O.FLOAT,!!i,C,j+6),O.bindBuffer(O.ARRAY_BUFFER,null)}function T(J,M,W,n,Q,B,m){var B=B||16,m=m||0;M.bindBuffer(M.ARRAY_BUFFER,W),M.vertexAttribPointer(J.addr,4,n||M.FLOAT,!!Q,B,m),M.vertexAttribPointer(J.addr+1,4,n||M.FLOAT,!!Q,B,m+4),M.vertexAttribPointer(J.addr+2,4,n||M.FLOAT,!!Q,B,m+8),M.vertexAttribPointer(J.addr+3,4,n||M.FLOAT,!!Q,B,m+12),M.bindBuffer(M.ARRAY_BUFFER,null)}function H(F,p,S){g[F]=function(r,G,i,D,N,U){this.addr==A||this.addr<0||(G==A||G===!1?r.disableVertexAttribArray(this.addr):Gp(G)===K?(r.enableVertexAttribArray(this.addr),S(this,r,G,i,D,N,U)):(r.disableVertexAttribArray(this.addr),p(this,r,G)))}}function x(U,c,L){this.name=U,this.addr=c,this.activeInfo=L,this.setter=g[L.type],$d(this)}function s(w,p,t){this.gl=p,this.program=t,this._branches={},this._struct=w}function R(r){function K(K,e){s.call(this,r,K,e);for(var H=C.length;H--;){var f=C[H];this._branches[f._name]=new f._type(K,e)}}function Q(p,c){var G=p.name;if(p.isLeaf){var l=B("d.setter(this.gl, v);",["v"],["d"],[p.desc]);U.defineProperty(c,G,{configurable:!1,enumerable:!0,get:function(){return l},set:l})}else C.push({_name:G,_type:R(p)}),U.defineProperty(c,G,{configurable:!1,enumerable:!0,get:function(){return this._branches[G]},set:function(q){this._branches[G].apply(q)}})}var C=[];return I(K,s),r.forEach(Q,K.prototype),K}function V(M,n){for(var J=M.getProgramParameter(n,M.ACTIVE_ATTRIBUTES),t={};J--;){var A=M.getActiveAttrib(n,J),O=A.name,l=M.getAttribLocation(n,O);t[O]=new x(O,l,A)}var y=_n.create(t,function(G){return"addr"in G}),N=R(y);return new N(M,n)}for(var p=[],v=1;17>v;++v)p[v]=new Rl(v);var g=[],K="undefined"!=typeof WebGLBuffer&&WebGLBuffer.prototype;return H(Jh.FLOAT,r,M),H(Jh.FLOAT_VEC2,N,b),H(Jh.FLOAT_VEC3,d,y),H(Jh.FLOAT_VEC4,o,J),H(Jh.FLOAT_MAT2,Q,Y),H(Jh.FLOAT_MAT3,n,F),H(Jh.FLOAT_MAT4,L,T),s.prototype.disable=function(){for(var B=this._struct.children,N=B.length;N--;){var u=B[N],n=u.name;u.isLeaf?this.gl.disableVertexAttribArray(u.desc.addr):this._branches[n].disable()}},s.prototype.apply=function(h){for(var t=this._struct.children,b=t.length;b--;){var W=t[b],k=W.name;k in h&&(W.isLeaf?this[k]=h[k]:this._branches[k].apply(h[k]))}},s.prototype.append=function(o){var D=this._struct.childMap;for(var g in o){var R=D[g];R&&(R.isLeaf?this[g]=o[g]:this._branches[g].append(o[g]))}},function(Y,C){var U=C._attribs;return U||(C._attribs=U=V(Y,C)),U}}(),li=function(j){var $=this;U.defineProperties(this,{gl:{configurable:!1,enumerable:!1,value:j,writable:!1},glState:{configurable:!1,enumerable:!1,value:Rq(j),writable:!1}}),$._currProgram=A,$._currUniforms=A,$._currAttribs=A,$._sync=!0};U.defineProperties(li.prototype,{program:{configurable:!1,enumerable:!1,get:function(){return this._currProgram},set:function(m){var Q=this;Q._sync&&m===Q._currProgram||(Q.gl.useProgram(m),Q._currProgram=m,Q._currUniforms=hs(Q.gl,m),Q._currAttribs=$j(Q.gl,m),Q._sync=!0)}},uniforms:{configurable:!1,enumerable:!1,get:function(){var w=this;return w._currProgram&&!w._sync&&(w.gl.useProgram(w._currProgram),w._sync=!0),w._currUniforms},set:function(b){var v=this;v._currUniforms&&(v._currProgram&&!v._sync&&(v.gl.useProgram(v._currProgram),this._sync=!0),v._currUniforms.apply(b))}},attribs:{configurable:!1,enumerable:!1,get:function(){var h=this;return h._currProgram&&!h._sync&&(h.gl.useProgram(h._currProgram),h._sync=!0),h._currAttribs},set:function(E){var i=this;i._currUniforms&&(i._currProgram&&!i._sync&&(i.gl.useProgram(i._currProgram),this._sync=!0),i._currAttribs.apply(E))}}}),li.prototype.useProgram=function(x){var $=this;$._sync&&x===$._currProgram||($.gl.useProgram(x),$._currProgram=x,$._currUniforms=hs($.gl,x),$._currAttribs=$j($.gl,x),$._sync=!0)},li.prototype.directState=function(){return this.glState},li.prototype.directUniforms=function(){return this._currUniforms},li.prototype.directAttribs=function(){return this._currAttribs},li.prototype.syncLoss=function(){this._sync=!1,this.glState.syncLoss()},li.for=function(A){var i=A._renderState;return i||(A._renderState=i=new li(A)),i};var Wi="directional",mg="point",fk="spot",Od="light.color",xc=4294967295,ip={},Ee=[],yo=0,Oi=function(m,o){Pr(o)&&be.test(o)?Bl(m,o):Ti(o)&&o.modelType?jj(m,o):o===A?delete No[m]:No[m]=o},bm=function(S){return S},wp=function(R){R=r.convertShape3dModelName(R);var Q;if(Ti(R)){if(R.modelType){if(R.uuid){if(Q=No[R.uuid])return Q}else R.uuid=L.Math.generateUUID();return Q===A&&(Cs&&Cs[R.uuid]||jj(R.uuid,R)),A}return R}return Q=No[R],R&&Q===A&&be.test(R)&&(Cs&&Cs[R]||Bl(R,R)),Q},uf=function(K,e){K.frameStack?K.frameStack.push(e):K.frameStack=[e],K.bindFramebuffer(K.FRAMEBUFFER,e)},cf=function(B){var y=B.frameStack;if(y){if(y.pop(),y.length)return B.bindFramebuffer(B.FRAMEBUFFER,y[y.length-1]),void 0;B.frameStack=null}B.bindFramebuffer(B.FRAMEBUFFER,null)};th(r,{graph3dViewAttributes:h,graph3dViewFirstPersonMode:!1,graph3dViewMouseRoamable:!0,graph3dViewMoveStep:15,graph3dViewRotateStep:g/60,graph3dViewSortable:!1,graph3dViewBlockSelectable:!0,graph3dViewEditHelperDisabled:!1,graph3dViewPannable:!0,graph3dViewRotatable:!0,graph3dViewWalkable:!0,graph3dViewResettable:!0,graph3dViewZoomable:!0,graph3dViewRectSelectable:!0,graph3dViewRectSelectBackground:vj,graph3dViewGridVisible:!1,graph3dViewGridSize:50,graph3dViewGridGap:50,graph3dViewGridColor:[.4,.75,.85,1],graph3dViewRotateMaxPhi:g,graph3dViewRotateMinPhi:0,graph3dViewShadowQuality:"high",graph3dViewShadowIntensity:.3,graph3dViewShadowBias:-.005,graph3dViewShadowRadius:.1,graph3dViewShadowType:"hard",graph3dViewShadowDegreeX:30,graph3dViewShadowDegreeZ:-10,graph3dViewOriginAxisVisible:!1,graph3dViewCenterAxisVisible:!1,graph3dViewAxisXColor:[1,0,0,1],graph3dViewAxisYColor:[0,1,0,1],graph3dViewAxisZColor:[0,0,1,1],graph3dViewEditSizeColor:[1,1,0,1],graph3dViewOrtho:!1,graph3dViewOrthoWidth:2e3,graph3dViewSyncEyeWithOrthoWidth:!1,graph3dViewFovy:g/4,graph3dViewNear:10,graph3dViewFar:1e4,graph3dViewEye:[0,300,1e3],graph3dViewCenter:[0,0,0],graph3dViewUp:[0,1,-1e-7],graph3dViewDataNumWarningLine:1e4,graph3dViewHeadlightRange:0,graph3dViewHeadlightGroup:0,graph3dViewHeadlightColor:[1,1,1,1],graph3dViewHeadlightIntensity:1,graph3dViewHeadlightDisabled:!1,graph3dViewHeadlightAmbientIntensity:.7,graph3dViewFogDisabled:!0,graph3dViewFogMode:"linear",graph3dViewFogDensity:5e-4,graph3dViewFogColor:"white",graph3dViewFogNear:1,graph3dViewFogFar:2e3,graph3dViewPickerResolution:.5,graph3dViewDashDisabled:!0,graph3dViewBatchBlendDisabled:!0,graph3dViewBatchBrightnessDisabled:!0,graph3dViewBatchColorDisabled:!1,graph3dViewEnvmapType:"legacy",graph3dMaxVectorCacheTime:50,graph3dEnvmapCapabilityRequire:8,setShape3dModel:Oi,getShape3dModel:wp,convertShape3dModelName:bm,getShape3dModelMap:function(){return No},getCachedShape3dModelMap:function(){return zo},createMatrix:function(G,g){rm(G)||(G=[G]);for(var A=G.length-1;A>=0;A--){var x=G[A];g=Qr(x.mat,x.s3,x.r3,x.rotationMode,x.t3,g)}return g},transformVec:function(x,N){return vf(x,N)},glBindFrame:uf,glUnbindFrame:cf,createBoxModel:function(){return{vs:Wk,ns:ar,uv:vd,is:Pi}},createRoundRectModel:function(W,V){return Vd.roundRect(W,V)},createStarModel:function(N,u){return Vd.star(N,u)},createRectModel:function(c,_){return Vd.rect(c,_)},createTriangleModel:function(p,F){return Vd.triangle(p,F)},createRightTriangleModel:function(f,T){return Vd.rightTriangle(f,T)},createParallelogramModel:function(P,B){return Vd.parallelogram(P,B)},createTrapezoidModel:function(D,f){return Vd.trapezoid(D,f)},createSmoothSphereModel:function(T,B,R,O,U,b,L){return Pb(new Th(T,B,R,O,U,b,L))},createSphereModel:function(W,y,B,F,V,D,H){return W?Xh(W,y,B,F,V,D,H):r.createSmoothSphereModel()},createSmoothConeModel:function(I,d,a,D,L){return fm(I,d,a,D,L)},createConeModel:function(j,W,x,A,w,I,G,z){return j?yi(j,W,x,A,w,I,G,z):fm(I)},createSmoothCylinderModel:function(p,W,V,E,G,l,N,b){return Pb(new Vg(p,W,V,E,G,l,N,b))},createCylinderModel:function(R,M,O,K,v,H,q,w){return R?ok(R,M,O,K,v,H,q,w):Mp(H,q)},createSmoothTorusModel:function(Q,a,y,Y,b,C){return Pb(new Gm(Q,a,y,Y,b,C))},createTorusModel:function(q,D,A,V,P,X,$,L){return q?bc(q,D,A,V,P,X,$,L):$f(X,$)},createExtrusionModel:function(U,I,m,R,E,z,J,S){return sq(U,I,m,R,E,z,J,S)},createSmoothRingModel:function(O,v,t,w,c,x){for(var u=[],a=0;a<O.length-1;a+=2)u.push({x:O[a],y:O[a+1]});for(O=zn(u,v,t)[0],u=[],a=0;a<O.length;a++){var r=O[a];u.push(new Ah(r.x,0,r.y))}return Pb(new Ab(u,x,w,c))},createTextGeometry:function(Q,x){return Pb(new Cl(Q,x))},loadFontFace:function(G,h){r.xhrLoad(G,function(p){if(!p)return h();var H;try{H=JSON.parse(p)}catch(w){H=JSON.parse(p.substring(65,p.length-2))}Hr.loadFace(H),h&&h(H.familyName.toLowerCase())},h?null:{sync:!0})},getShaderErrorLog:function(){return Ee.join("\n")},createRingModel:function(p,U,k,T,j,i,B,Z,J,M){for(var S=[],D=0;D<p.length-1;D+=2)S.push({x:p[D],y:p[D+1]});i=i||r.shapeSide,B=B||0,Z=Z||i;var c,b,N,A,F,q,X,y,V,R,D,d,Q,a,w,E,Y,P,H=[],I=[],s=J?[]:h,f=J?[]:h,G=M?[]:h,m=M?[]:h,o=T?[]:h,W=T?[]:h,x=j?[]:h,L=j?[]:h,p=zn(S,U,k),O=Qf(p),K=0,l=2*Math.PI/i;return p.forEach(function(v){if(N=v.length,N>1){if(A=v[0],T)for(q=A.x,y=A.y,D=B;Z>D;D++)d=D+1,Q=D*l,a=d*l,w=$(Q),E=e(Q),Y=$(a),P=e(a),o.push(w*q,y,-E*q,Y*q,y,-P*q,0,y,0),W.push(.5-.5*w,.5-.5*E,.5-.5*Y,.5-.5*P,.5,.5);for(R=0;N>R;R++){for(F=v[R],q=A.x,X=F.x,y=A.y,V=F.y,c=K/O,K+=ml(A,F),b=K/O,D=B;Z>D;D++)d=D+1,Q=D*l,a=d*l,w=$(Q),E=e(Q),Y=$(a),P=e(a),H.push(w*X,V,-E*X,Y*X,V,-P*X,w*q,y,-E*q,Y*X,V,-P*X,Y*q,y,-P*q,w*q,y,-E*q),I.push(D/i,b,d/i,b,D/i,c,d/i,b,d/i,c,D/i,c),J&&D===B&&(s.push(0,y,0,0,V,0,w*X,V,-E*X,w*X,V,-E*X,w*q,y,-E*q,0,y,0),f.push(0,.5-y,0,.5-V,2*X,.5-V,2*X,.5-V,2*q,.5-y,0,.5-y)),M&&d===Z&&(G.push(0,y,0,Y*X,V,-P*X,0,V,0,Y*X,V,-P*X,0,y,0,Y*q,y,-P*q),m.push(1,.5-y,1-2*X,.5-V,1,.5-V,1-2*X,.5-V,1,.5-y,1-2*q,.5-y));A=F}if(j)for(q=A.x,y=A.y,D=B;Z>D;D++)d=D+1,Q=D*l,a=d*l,w=$(Q),E=e(Q),Y=$(a),P=e(a),x.push(Y*q,y,-P*q,w*q,y,-E*q,0,y,0),L.push(.5-.5*Y,.5+.5*P,.5-.5*w,.5+.5*E,.5,.5)}}),{vs:H,uv:I,bottom_vs:x,bottom_uv:L,top_vs:o,top_uv:W,from_vs:s,from_uv:f,to_vs:G,to_uv:m}}},!0),th(E,{"3d.move.mode":A,"3d.selectable":!0,"3d.visible":!0,"3d.movable":!0,"3d.editable":!0,"3d.clip.direction":null,"3d.clip.percentage":1,"3d.reflectable":!0,"shape.border.gradient.color":A,"edge.gradient.color":A,"edge.source.t3":A,"edge.target.t3":A,"light.type":mg,"light.group":0,"light.center":[0,0,0],"light.color":[1,1,1,1],"light.disabled":!1,"light.angle":g/4,"light.range":0,"light.exponent":1,"light.intensity":1,"light.mask":xc,"wf.visible":!1,"wf.width":1,"wf.color":ue,"wf.short":!1,"wf.mat":A,"wf.geometry":!1,"wf.loadQuadWireframe":!1,"wf.combineTriangle":!0,batch:A,"transparent.mask":!1,brightness:A,"select.brightness":.7,"repeat.uv.length":A,"shadow.cast":!0,"shadow.receive":!0,"3d.clipbox":A,"3d.clipbox.enabled":!0,"effect.flow":!1,"effect.flow.gradient":"spread.horizontal","effect.flow.uvshape":"rect","effect.flow.size":512,"effect.flow.group":"default","effect.flow.affectGroups":A,bloom:!1,envmap:0,"envmap.probe":0,roughness:0,renderTextureSamples:4,alphaTest:.4,autorotate:!1,fixSizeOnScreen:!1,"texture.cache":!1,"hide.overlapping.group":A,"vector.dynamic":!1,"vector.dynamic.maxsize":2048,"texture.scale":1,"geometry.cache":!1,"highlight.mode":!1,"highlight.type":"hard","highlight.visible":!0,"highlight.width":.8,"highlight.color":"rgba(190, 210, 250, 1)","highlight.glow":.8,"highlight.strength":2,"color.empty":[0,0,0,0],"label.face":Ic,"label.t3":A,"label.r3":A,"label.texture.scale":2,"label.rotationMode":Wr,"label.light":!1,"label.blend":A,"label.reverse.flip":!1,"label.reverse.color":ge,"label.reverse.cull":!1,"label.transparent":!1,"label.autorotate":!1,"label2.face":Ic,"label2.t3":A,"label2.r3":A,"label2.texture.scale":2,"label2.rotationMode":Wr,"label2.light":!1,"label2.blend":A,"label2.reverse.flip":!1,"label2.reverse.color":ge,"label2.reverse.cull":!1,"label2.transparent":!1,"label2.autorotate":!1,"note.face":Ic,"note.t3":A,"note.r3":A,"note.texture.scale":2,"note.rotationMode":Wr,"note.light":!1,"note.blend":A,"note.reverse.flip":!1,"note.reverse.color":ge,"note.reverse.cull":!1,"note.transparent":!1,"note.autorotate":!1,"note2.face":Ic,"note2.t3":A,"note2.r3":A,"note2.texture.scale":2,"note2.rotationMode":Wr,"note2.light":!1,"note2.blend":A,"note2.reverse.flip":!1,"note2.reverse.color":ge,"note2.reverse.cull":!1,"note2.transparent":!1,"note2.autorotate":!1,shape3d:A,"shape3d.color":Mo,"shape3d.top.color":A,"shape3d.bottom.color":A,"shape3d.from.color":A,"shape3d.to.color":A,"shape3d.image":A,"shape3d.image.projection":A,"shape3d.top.image":A,"shape3d.bottom.image":A,"shape3d.from.image":A,"shape3d.to.image":A,"shape3d.light":!0,"shape3d.side":0,"shape3d.side.from":A,"shape3d.side.to":A,"shape3d.smooth":A,"shape3d.visible":!0,"shape3d.from.visible":!0,"shape3d.to.visible":!0,"shape3d.top.visible":!0,"shape3d.bottom.visible":!0,"shape3d.torus.radius":.17,"shape3d.resolution":0,"shape3d.blend":A,"shape3d.opacity":A,"shape3d.reverse.flip":!1,"shape3d.reverse.color":ge,"shape3d.reverse.cull":!1,"shape3d.transparent":!1,"shape3d.uv.offset":A,"shape3d.uv.scale":A,"shape3d.uv.rotation":A,"shape3d.top.uv.offset":A,"shape3d.top.uv.scale":A,"shape3d.top.uv.rotation":A,"shape3d.bottom.uv.offset":A,"shape3d.bottom.uv.scale":A,"shape3d.bottom.uv.rotation":A,"shape3d.from.uv.offset":A,"shape3d.from.uv.scale":A,"shape3d.from.uv.rotation":A,"shape3d.to.uv.offset":A,"shape3d.to.uv.scale":A,"shape3d.to.uv.rotation":A,"shape3d.top.cap":A,"shape3d.bottom.cap":A,"shape3d.start.angle":0,"shape3d.sweep.angle":S,"shape3d.point.epsilon":1e-6,"shape3d.discard.selectable":!0,"shape3d.top.discard.selectable":!0,"shape3d.bottom.discard.selectable":!0,"shape3d.from.discard.selectable":!0,"shape3d.to.discard.selectable":!0,"shape3d.scaleable":!0,"shape3d.reflector":!1,"shape3d.reflector.color":"rgb(128,128,128)","shape3d.reflector.blur":0,"shape3d.reflector.blur.iterations":1,"shape3d.reflector.background":null,"shape3d.reflector.clip":.003,"camera.type":"perspective","camera.aspect":1,"camera.fovy":A,"camera.ortho.width":A,"camera.near":A,"camera.far":A,"camera.background":0,"camera.renderSky":!0,"camera.renderAxis":!1,"camera.renderGrid":!1,"camera.renderEdit":!1,"camera.onlySky":!1,"texture.mipmap.max":A,"texture.filter":A,"texture.filter.min":A,"texture.filter.mag":A,"texture.wrap":A,"points.image":"rect","points.color":"white","points.transparent":!1,"points.size":20,"points.opacity":1,"points.uv.scale":[1,1],"points.uv.offset":[0,0],"points.discard.selectable":!1,"all.light":!0,"all.visible":!0,"all.color":Mo,"all.image":A,"all.blend":A,"all.opacity":A,"all.reverse.flip":!1,"all.reverse.color":ge,"all.reverse.cull":!1,"all.transparent":!1,"all.uv":A,"all.uv.offset":A,"all.uv.scale":A,"all.uv.rotation":A,"all.discard.selectable":!0,mat:A,"left.mat":A,"right.mat":A,"top.mat":A,"bottom.mat":A,"front.mat":A,"back.mat":A,"edge.source.anchor.elevation":A,"edge.target.anchor.elevation":A},!0);var Bj,fd=!1,Ig=[0,0,0,0],wl=function(x){return x instanceof Dl},el=function(q){return[q.x,q.e||0,q.y]},Vj=function(K,h,V){for(var h=Jn(h||0),w=h[0],A=h[1],O=h[2];V--;)K.push(w,A,O)
},He=function(q,_,J){for(var _=Jn(_||0),D=_[0],Q=_[1],L=_[2],f=_[3];J--;)q.push(D,Q,L,f)},Oh=function(c,C,g){if(C)for(var q,i,K,y=C[0],Q=C[1],J=C[2],H=C[4],d=C[5],G=C[6],j=C[8],l=C[9],m=C[10],v=C[12],t=C[13],Y=C[14],F=g.length,u=0,u=0;F>u;u+=3)q=g[u],i=g[u+1],K=g[u+2],c.push(y*q+H*i+j*K+v,Q*q+d*i+l*K+t,J*q+G*i+m*K+Y);else Zf(c,g)},nb=function(P,f,I){var _=f.s("light.intensity"),V=Jn(f.s(Od)),J=V[0],M=V[1],N=V[2];1!==_&&(J*=_,M*=_,N*=_);var G=f.s("light.disabled");P.push(J,M,N,G?1:0),I.c.push(J,M,N),I.g.push(G?-1:f.s("light.group")),I.e.push(G?1:0)},qp=function(Z,M){var p=li.for(M),f=p.directUniforms(),T=Z._lastLightUploadInfo={c:[],g:[],e:[]};f.uHeadlightRange=Z._headlightRange,f.uHeadlightAmbientIntensity=Z._headlightAmbientIntensity;var s=Z._headlightIntensity,S=Jn(Z._headlightColor);1!==s&&(S=[S[0]*s,S[1]*s,S[2]*s]);var G;f.uHeadlightColor=[S[0],S[1],S[2],(G=Z._headlightDisabled)?1:0],T.c.push(S[0],S[1],S[2]),T.g.push(G?-1:Z._headlightGroup),T.e.push(G?1:0);var O=Z._59O,h=Z._spots,Q=Z._dirs;if(O.length){var X=[],j=[],E=[];O.forEach(function(S){nb(X,S,T),Zf(j,Z._transformPointToViewSpace(S.p3())),E.push(S.s("light.range"))}),f.uPointColor=X,f.uPointRange=E,f.uPointPosition=j}if(h.length){var J=[],i=[],v=[],N=[],z=[],w=[];h.forEach(function(K){nb(J,K,T),Zf(i,Z._transformPointToViewSpace(K.p3())),Zf(z,Z._transformDirectionToViewSpace(K.p3(),K.s("light.center"))),v.push(K.s("light.range")),N.push($(K.s("light.angle")/2)),w.push(K.s("light.exponent"))}),f.uSpotColor=J,f.uSpotRange=v,f.uSpotAngle=N,f.uSpotExponent=w,f.uSpotPosition=i,f.uSpotDirection=z}if(Q.length){var H=[],q=[];Q.forEach(function(S){nb(H,S,T),Zf(q,Z._transformDirectionToViewSpace(S.p3()))}),f.uDirColor=H,f.uDirDirection=q}Z._lastLightMask=xc},Sc=function(K,j,e){if(e!==K._lastLightMask){K._lastLightMask=e;var c=K._lastLightUploadInfo;if(c){var d,L,x,S=c.g,P=c.e,N=S.length,k=new Array(N),T=!1;for(L=0;N>L;L++)d=S[L],x=0>d||d>=32?1:e&1<<d?0:1,k[L]=x,x!==P[L]&&(T=!0);if(T){c.e=P=k;var U=c.c;j.uHeadlightColor=[U[0],U[1],U[2],P[0]];var l,i=K._59O,_=K._spots,Y=K._dirs,M=3,q=1;if(N=i.length){for(L=0,l=[];N>L;L++)l.push(U[M++],U[M++],U[M++],P[q++]);j.uPointColor=l}if(N=_.length){for(L=0,l=[];N>L;L++)l.push(U[M++],U[M++],U[M++],P[q++]);j.uSpotColor=l}if(N=Y.length){for(L=0,l=[];N>L;L++)l.push(U[M++],U[M++],U[M++],P[q++]);j.uDirColor=l}}}}},bh=function(t,B){return Math.max(t.getRotateMinPhi()+_j,Math.min(t.getRotateMaxPhi()-_j,B))},Zd=function(){return.05+Vp()/2},ep=function(N,s,x,$){var h,d=N.getEye();return N.isOrtho()?(h=ik(N.getCenter(),d),h[0]+=$[0],h[1]+=$[1],h[2]+=$[2]):h=d,me(s,x,$,h)},me=function(M,j,$,u){var s=gf(M,j),K=ik(u,$,!0),n=gf(K,j);if(z(n)<_j)return h;var v=(s-gf($,j))/n;return[$[0]+K[0]*v,$[1]+K[1]*v,$[2]+K[2]*v]},Sd=function(u,y){return{x:2*u.x-y.x,y:2*u.y-y.y}},Se=function(N,u,i,c){var T,U;if(!N)return T=tj(u.y-i.y,i.x-u.x),{x:u.x+c*e(T),y:u.y+c*$(T)};if(!i)return T=tj(N.y-u.y,u.x-N.x),{x:u.x+c*e(T),y:u.y+c*$(T)};var y=ik([N.x,N.y,0],[u.x,u.y,0],!0),n=ik([i.x,i.y,0],[u.x,u.y,0],!0),Q=-(y[0]+n[0])/2,K=-(y[1]+n[1])/2,A=R(Q*Q+K*K);if(_j>A)return T=tj(N.y-u.y,u.x-N.x),{x:u.x+c*e(T),y:u.y+c*$(T)};var Y=N.x-u.x,d=N.y-u.y,J=i.x-u.x,z=i.y-u.y,r=R(Y*Y+d*d),x=R(J*J+z*z);T=q(gf(y,n))/2,U=y[1]*n[0]-y[0]*n[1]>0?-1:1,Q/=A,K/=A;var D=c/e(T),B=k(r,x)/$(T);A=Math.min(D,B);var Z={x:u.x+U*A*Q,y:u.y+U*A*K};return i.b&&D>x/$(T)&&(Z.adjust=!0),Z},km=function(j){var k=j[1],N=j[2],q=j[3],w=j[6],n=j[7],z=j[11];j[1]=j[4],j[2]=j[8],j[3]=j[12],j[4]=k,j[6]=j[9],j[7]=j[13],j[8]=N,j[9]=w,j[11]=j[14],j[12]=q,j[13]=n,j[14]=z},oq=function(W){var p=W[0],V=W[1],U=W[2],J=W[3],H=W[4],A=W[5],$=W[6],f=W[7],w=W[8],t=W[9],r=W[10],g=W[11],L=W[12],S=W[13],K=W[14],k=W[15],i=p*A-V*H,E=p*$-U*H,z=p*f-J*H,l=V*$-U*A,u=V*f-J*A,T=U*f-J*$,D=w*S-t*L,y=w*K-r*L,b=w*k-g*L,Z=t*K-r*S,c=t*k-g*S,d=r*k-g*K,n=i*d-E*c+z*Z+l*b-u*y+T*D;return n?(n=1/n,W[0]=(A*d-$*c+f*Z)*n,W[1]=(U*c-V*d-J*Z)*n,W[2]=(S*T-K*u+k*l)*n,W[3]=(r*u-t*T-g*l)*n,W[4]=($*b-H*d-f*y)*n,W[5]=(p*d-U*b+J*y)*n,W[6]=(K*z-L*T-k*E)*n,W[7]=(w*T-r*z+g*E)*n,W[8]=(H*c-A*b+f*D)*n,W[9]=(V*b-p*c-J*D)*n,W[10]=(L*u-S*z+k*i)*n,W[11]=(t*z-w*u-g*i)*n,W[12]=(A*y-H*Z-$*D)*n,W[13]=(p*Z-V*y+U*D)*n,W[14]=(S*E-L*l-K*i)*n,W[15]=(w*l-t*E+r*i)*n,void 0):h},Jm=function(P,$){if($){var o=$[0],R=$[1],g=$[2];P[12]=P[0]*o+P[4]*R+P[8]*g+P[12],P[13]=P[1]*o+P[5]*R+P[9]*g+P[13],P[14]=P[2]*o+P[6]*R+P[10]*g+P[14],P[15]=P[3]*o+P[7]*R+P[11]*g+P[15]}},bl=function(A,y){if(y){var Q=y[0],E=y[1],f=y[2];A[0]=A[0]*Q,A[1]=A[1]*Q,A[2]=A[2]*Q,A[3]=A[3]*Q,A[4]=A[4]*E,A[5]=A[5]*E,A[6]=A[6]*E,A[7]=A[7]*E,A[8]=A[8]*f,A[9]=A[9]*f,A[10]=A[10]*f,A[11]=A[11]*f}},Nd=function(C,R,n){var S=R[0],w=R[1],_=R[2],s=R[3],Y=R[4],B=R[5],K=R[6],b=R[7],l=R[8],c=R[9],I=R[10],H=R[11],M=R[12],m=R[13],P=R[14],f=R[15],o=n[0],X=n[1],v=n[2],p=n[3];return C[0]=o*S+X*Y+v*l+p*M,C[1]=o*w+X*B+v*c+p*m,C[2]=o*_+X*K+v*I+p*P,C[3]=o*s+X*b+v*H+p*f,o=n[4],X=n[5],v=n[6],p=n[7],C[4]=o*S+X*Y+v*l+p*M,C[5]=o*w+X*B+v*c+p*m,C[6]=o*_+X*K+v*I+p*P,C[7]=o*s+X*b+v*H+p*f,o=n[8],X=n[9],v=n[10],p=n[11],C[8]=o*S+X*Y+v*l+p*M,C[9]=o*w+X*B+v*c+p*m,C[10]=o*_+X*K+v*I+p*P,C[11]=o*s+X*b+v*H+p*f,o=n[12],X=n[13],v=n[14],p=n[15],C[12]=o*S+X*Y+v*l+p*M,C[13]=o*w+X*B+v*c+p*m,C[14]=o*_+X*K+v*I+p*P,C[15]=o*s+X*b+v*H+p*f,C},ys=function(K,P,I,r){var Z,N,k,u,C,D,m,b,L,A,i=P[0],_=P[1],G=P[2],O=r[0],T=r[1],J=r[2],j=I[0],S=I[1],l=I[2];return z(i-j)<_j&&z(_-S)<_j&&z(G-l)<_j?Uq(K):(m=i-j,b=_-S,L=G-l,A=1/R(m*m+b*b+L*L),m*=A,b*=A,L*=A,Z=T*L-J*b,N=J*m-O*L,k=O*b-T*m,A=R(Z*Z+N*N+k*k),A?(A=1/A,Z*=A,N*=A,k*=A):(Z=0,N=0,k=0),u=b*k-L*N,C=L*Z-m*k,D=m*N-b*Z,A=R(u*u+C*C+D*D),A?(A=1/A,u*=A,C*=A,D*=A):(u=0,C=0,D=0),K[0]=Z,K[1]=u,K[2]=m,K[3]=0,K[4]=N,K[5]=C,K[6]=b,K[7]=0,K[8]=k,K[9]=D,K[10]=L,K[11]=0,K[12]=-(Z*i+N*_+k*G),K[13]=-(u*i+C*_+D*G),K[14]=-(m*i+b*_+L*G),K[15]=1,K)},ei=function(C,l,o,z,N){var G=1/Ph(l/2),r=1/(z-N);return C[0]=G/o,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=G,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=(N+z)*r,C[11]=-1,C[12]=0,C[13]=0,C[14]=2*N*z*r,C[15]=0,C},Xb=function(D,U,h,$,e,w,O){var A=1/(U-h),u=1/($-e),E=1/(w-O);return D[0]=-2*A,D[1]=0,D[2]=0,D[3]=0,D[4]=0,D[5]=-2*u,D[6]=0,D[7]=0,D[8]=0,D[9]=0,D[10]=2*E,D[11]=0,D[12]=(U+h)*A,D[13]=(e+$)*u,D[14]=(O+w)*E,D[15]=1,D},yr=function(w,$){var i=$[0],J=$[1],T=$[2],K=$[3],U=i*i+J*J+T*T+K*K,p=U?1/U:0;return w[0]=-i*p,w[1]=-J*p,w[2]=-T*p,w[3]=K*p,w},Qe=function(U,B){var i=B[0]+B[5]+B[10],H=0;return i>0?(H=2*Math.sqrt(i+1),U[3]=.25*H,U[0]=(B[6]-B[9])/H,U[1]=(B[8]-B[2])/H,U[2]=(B[1]-B[4])/H):B[0]>B[5]&B[0]>B[10]?(H=2*Math.sqrt(1+B[0]-B[5]-B[10]),U[3]=(B[6]-B[9])/H,U[0]=.25*H,U[1]=(B[1]+B[4])/H,U[2]=(B[8]+B[2])/H):B[5]>B[10]?(H=2*Math.sqrt(1+B[5]-B[0]-B[10]),U[3]=(B[8]-B[2])/H,U[0]=(B[1]+B[4])/H,U[1]=.25*H,U[2]=(B[6]+B[9])/H):(H=2*Math.sqrt(1+B[10]-B[0]-B[5]),U[3]=(B[1]-B[4])/H,U[0]=(B[8]+B[2])/H,U[1]=(B[6]+B[9])/H,U[2]=.25*H),U},Ln=function(o,H,n){var M=H[0],Z=H[1],i=H[2],w=H[3],_=M+M,h=Z+Z,k=i+i,m=M*_,Q=M*h,u=M*k,t=Z*h,O=Z*k,V=i*k,Y=w*_,f=w*h,a=w*k;return o[0]=1-(t+V),o[1]=Q+a,o[2]=u-f,o[3]=0,o[4]=Q-a,o[5]=1-(m+V),o[6]=O+Y,o[7]=0,o[8]=u+f,o[9]=O-Y,o[10]=1-(m+t),o[11]=0,o[12]=n[0],o[13]=n[1],o[14]=n[2],o[15]=1,o},td=function(S,C){if(S.isVREnabled()){var Z=S.vr.getViewMatrix(C);if(Z)return Z}return S._camera?S._camera.getViewMatrix(C):ys(C?C:Rb(),S._eye,S._center,S._up)},Mq=function(k,T){if(k.isVREnabled()){var F=k.vr.getProjectMatrix();if(F)return F}if(k._camera)return k._camera.getProjectMatrix();if(!T&&k._computedProjectMatrix)return Kn(k._computedProjectMatrix);var C=k.getAspect(),h=k._near,z=k._far,B=Rb();if(k._ortho){var a=k._orthoWidth/2,g=a/C;Xb(B,-a,a,-g,g,h,z)}else ei(B,k._fovy,C,h,z);return B},ch=function(i,z){if(!i)return h;var P=0,c=1,l=2,F=[],T=0,Y=i.length,t=Y/3;if(z){for(;Y>T;T++)F[T]=0;for(T=0;T<z.length;T+=3){var X=[],A=[],r=[];X[P]=i[3*z[T+1]+P]-i[3*z[T]+P],X[c]=i[3*z[T+1]+c]-i[3*z[T]+c],X[l]=i[3*z[T+1]+l]-i[3*z[T]+l],A[P]=i[3*z[T+2]+P]-i[3*z[T+1]+P],A[c]=i[3*z[T+2]+c]-i[3*z[T+1]+c],A[l]=i[3*z[T+2]+l]-i[3*z[T+1]+l],r[P]=X[c]*A[l]-X[l]*A[c],r[c]=X[l]*A[P]-X[P]*A[l],r[l]=X[P]*A[c]-X[c]*A[P];for(var H=0;3>H;H++)F[3*z[T+H]+P]+=r[P],F[3*z[T+H]+c]+=r[c],F[3*z[T+H]+l]+=r[l]}}else for(T=0;t>T;T+=3){var X=[],A=[],r=[];X[P]=i[3*(T+1)+P]-i[3*T+P],X[c]=i[3*(T+1)+c]-i[3*T+c],X[l]=i[3*(T+1)+l]-i[3*T+l],A[P]=i[3*(T+2)+P]-i[3*(T+1)+P],A[c]=i[3*(T+2)+c]-i[3*(T+1)+c],A[l]=i[3*(T+2)+l]-i[3*(T+1)+l],r[P]=X[c]*A[l]-X[l]*A[c],r[c]=X[l]*A[P]-X[P]*A[l],r[l]=X[P]*A[c]-X[c]*A[P];for(var H=0;3>H;H++)F[3*(T+H)+P]=r[P],F[3*(T+H)+c]=r[c],F[3*(T+H)+l]=r[l]}for(T=0;Y>T;T+=3){var M=[];M[P]=F[T+P],M[c]=F[T+c],M[l]=F[T+l];var e=R(M[P]*M[P]+M[c]*M[c]+M[l]*M[l]);0===e&&(e=_j),M[P]=M[P]/e,M[c]=M[c]/e,M[l]=M[l]/e,F[T+P]=M[P],F[T+c]=M[c],F[T+l]=M[l]}return new Rl(F)},mq=function(j,s,E,D){if(E||(E=j.createTexture()),s){var p=j.TEXTURE_2D,R=j.REPEAT,b=j.CLAMP_TO_EDGE,Y=j.TEXTURE_MIN_FILTER;D=D||Pp;var l=D.minFilter||D.filter||j.LINEAR,i=D.magFilter||D.filter||j.LINEAR;j.activeTexture(j.TEXTURE0),_i(j,E),j.texImage2D(p,0,j.RGBA,j.RGBA,j.UNSIGNED_BYTE,s),Ue(j,j.TEXTURE_MAG_FILTER,i);var z=s.naturalWidth||s.width,T=s.naturalHeight||s.height;xb.isPOT(z)&&xb.isPOT(T)&&!D.clampToEdge&&!s.clampToEdge?(Ue(j,j.TEXTURE_WRAP_S,R),Ue(j,j.TEXTURE_WRAP_T,R),Ue(j,Y,l===j.NEAREST?j.NEAREST_MIPMAP_NEAREST:j.LINEAR_MIPMAP_LINEAR),D.mipmapMaxLevel!==A&&Ue(j,j.TEXTURE_MAX_LEVEL,D.mipmapMaxLevel),j.generateMipmap(p)):(Ue(j,j.TEXTURE_WRAP_S,b),Ue(j,j.TEXTURE_WRAP_T,b),Ue(j,Y,l)),_i(j,h)}return E},hh=function(R,L){var j=new Uint8Array(4);return L=L||R.createTexture(),R.activeTexture(R.TEXTURE0),_i(R,L),Ue(R,R.TEXTURE_MIN_FILTER,R.LINEAR),R.texImage2D(R.TEXTURE_2D,0,R.RGBA,1,1,0,R.RGBA,R.UNSIGNED_BYTE,j),L},_q=function(v,I){var Y=new Uint8Array(4);return I=I||v.createTexture(),v.activeTexture(v.TEXTURE0),v.bindTexture(v.TEXTURE_CUBE_MAP,I),v.texParameteri(v.TEXTURE_CUBE_MAP,v.TEXTURE_MAG_FILTER,v.LINEAR),v.texParameteri(v.TEXTURE_CUBE_MAP,v.TEXTURE_MIN_FILTER,v.LINEAR),v.texImage2D(v.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,v.RGBA,1,1,0,v.RGBA,v.UNSIGNED_BYTE,Y),v.texImage2D(v.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,v.RGBA,1,1,0,v.RGBA,v.UNSIGNED_BYTE,Y),v.texImage2D(v.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,v.RGBA,1,1,0,v.RGBA,v.UNSIGNED_BYTE,Y),v.texImage2D(v.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,v.RGBA,1,1,0,v.RGBA,v.UNSIGNED_BYTE,Y),v.texImage2D(v.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,v.RGBA,1,1,0,v.RGBA,v.UNSIGNED_BYTE,Y),v.texImage2D(v.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,v.RGBA,1,1,0,v.RGBA,v.UNSIGNED_BYTE,Y),I},Pc=function(q){q._26I&&q._prg&&(q._26I.deleteProgram(q._prg),q._prg=h)},Xp=function(Y,S,q,j){var n=Y.createShader(q);return Y.shaderSource(n,j),Y.compileShader(n),Y.attachShader(S,n),n},Zq=function(Y){return Y.createBuffer()},_i=function(B,H){B.bindTexture(B.TEXTURE_2D,H||B._emptyTexture)},Ue=function(b,V,O){b.texParameteri(b.TEXTURE_2D,V,O)},Hc=function(D,a){var s=li.for(D).directState();s.polygonOffset.enabled=!0,s.polygonOffset.value=a},rn=function(B){var w=li.for(B).directState();w.polygonOffset.enabled=!1},$q=function(K,d){if(d){var t=li.for(K).directState();t.color.clear=Jn(d)}},vh=function(C){var q=li.for(C),x=q.directUniforms(),R=q.directAttribs();x.uFix=!0,R.aNormal=!1},tg=function(Y){var r=li.for(Y),C=r.directUniforms();r.directAttribs(),C.uFix=!1},vp=function(U,T,A,L,v,P,C,f){var K=li.for(U),t=K.directState(),W=K.directUniforms();U._picking||(A?(W.uBlend=!0,W.uBlendColor=A):W.uBlend=!1,W.uLight=L==h?!0:L,Id(v)&&1!==v&&(W.uPartOpacity=v),W.uReverseFlip=P==h?!1:P,W.uFixPickReverseColor=C||ge),t.cullFace.enabled=f?!0:!1},$e=function(L){if(!L._picking){var o=li.for(L),E=o.directUniforms();E.uPartOpacity=1}},Di=function(){var f=new L.Math.Matrix2d,C=[1,0,0,0,1,0,0,0,0];return function(g,t,T,s,q,d,b,I,e,V){var E=li.for(g),Z=E.directUniforms(),U=E.directAttribs();return T?(Z.uTexture=!0,Z.uDiscardSelectable=fe(s)?s:!0,U.aUv=ef(g,q,d,h,2),V?(Z.uBlendTexture=!0,Z.uBlendSampler=V):(Z.uBlendTexture=!1,Z.uBlendSampler=g._emptyBlendTexture),Z.uSampler=T,Z.uUvMatrix=b||I||e?Ub(e,b,I,f).toArray9():C,void 0):(Z.uSampler=g._emptyTexture,Z.uBlendSampler=g._emptyBlendTexture,void 0)}}(),bn=function(p,R,g){var q=li.for(p),i=q.directUniforms(),S=q.directAttribs();p.activeTexture(p.TEXTURE0),_i(p,h),p.activeTexture(p.TEXTURE1),_i(p,h),g&&(S.aUv=!1,i.uTexture=!1,i.uSampler=p._emptyTexture,i.uBlendTexture=!1,i.uBlendSampler=p._emptyBlendTexture)},Zn=function(u,e,j,G,a,Z){var l=li.for(u),P=l.directUniforms(),x=l.directAttribs();!j||Up||Um||u.lineWidth(j),G&&!u._picking&&(P.uFixPickReverseColor=G),a&&(x.aPosition=ef(u,a,Z,h))},vq=function(X,k,d,o){Bj&&(o=X[Bj]),X.drawArrays(o==h?X.TRIANGLES:o,k,d);var I=X._renderInfo;I&&(I.calls++,I.vertices+=d,(o==h||o===X.TRIANGLES)&&(I.faces+=d/3),o===X.LINES&&(I.lines+=d/2),o===X.POINTS&&(I.points+=d))},Hg=function(E,q,j,d,$){Bj&&(d=E[Bj]),E.drawElements(d==h?E.TRIANGLES:d,j,$==h?E.UNSIGNED_SHORT:$,q==h?0:2*q);var R=E._renderInfo;R&&(R.calls++,R.vertices+=j,(d==h||d===E.TRIANGLES)&&(R.faces+=j/3),d===E.LINES&&(R.lines+=j/2),d===E.POINTS&&(R.points+=j))},Ni=function(L,P,Z){var d=L.ARRAY_BUFFER;return L.bindBuffer(d,P),Z&&L.bufferData(d,Z,L.STATIC_DRAW),P},ef=function(a,l,L,t,F){return L?Kq(a,a.ARRAY_BUFFER,l,L):Ni(a,l,L,t,F)},Cm=function(L,q,O){var y=L.ELEMENT_ARRAY_BUFFER;L.bindBuffer(y,q),O&&L.bufferData(y,O,L.STATIC_DRAW)},rl=function(M,p,w){Kq(M,M.ELEMENT_ARRAY_BUFFER,p,w)},Kq=function(W,z,x,o){var i=o._bufId;i||(i=o._bufId=L.Math.generateIncreasingID());var x,r=W._bufPool;return(x=r[i])&&x._buf?W.bindBuffer(z,x._buf):(x=r[i]={_buf:Zq(W)},W.bindBuffer(z,x._buf),W.bufferData(z,o,W.STATIC_DRAW)),x._fid=W._renderInfo.frame,x._buf},eo=function($,W){W!=h&&W>=0&&$.enableVertexAttribArray(W)},ap=function(N,H){H!=h&&H>=0&&N.disableVertexAttribArray(H)},Ol=function(W,b){var M=W.getGL(),K=li.for(M),u=K.directUniforms();W._7O=W._8O.pop(),b&&(u.uMVMatrix=W._7O,W._6O=b,u.uNMatrix=b)},ce=function(U,B){return B||(B=Rb()),lo(B,U),oq(B),km(B),B},vg=function(B,Z){var n=B.getGL(),h=B._7O,N=li.for(n),x=N.directUniforms();Z?(B._8O.push(Kn(h)),x.uMMatrix=Z,Nd(h,h,Z),B._7O=h):x.uMMatrix=Wo,x.uMVMatrix=h,x.uNMatrix=ce(h,B._6O)},Cc={body:0,label:1,label2:2,note:3,note2:4,symbol:5},Un=10,Nk=function(j,F,L,f,V,K){var t;if(L){var d=f._pickId;d||(d=f._pickId=F._pickIdUsed,F._pickIdUsed+=Un);var Q,h=Cc[V];if(null!=h)Q=d+h;else{var I=f._pickExtraPartMap;I||(I=f._pickExtraPartMap={}),(Q=I[V])||(Q=I[V]=F._pickIdUsed++)}F[Q]||(F[Q]={data:f,part:V}),t=pq(Q)}else t=Ig;if(!K){var H=li.for(j),l=H.directUniforms();l.uFixPickReverseColor=t}return t},Kj=Nk,zd=function(o,L,i){"target"!==i&&(i="source");var g="target"===i?L.getTargetAgent():L.getSourceAgent(),M="edge."+i+".";if(nf(g)){var I=L.s(M+"anchor.x"),N=L.s(M+"anchor.elevation"),u=L.s(M+"anchor.y"),T=hk(g,o.getMat(g)),P=g.getAnchor3d();return vf([(I===A?.5:I)-P.x,(N===A?.5:N)-P.y,(u===A?.5:u)-P.z],T)}var h=L.s(M+"index"),c=o.getData3dUI(g);if(!c.info||!c.info.list)return!1;if(h>=0){var S,b,l,V,X,v=c.info._lastPointsSegments,j=v.points,Z=v.segments,n=-1,Y=-1;for(l=0,V=Z?Z.length:j.length;V>l;l++){if(b=Z?Z.get(l):1,3===b)X=2;else if(4===b)X=3;else{if(5===b)continue;X=1}if(n+=X,Y++,Y===h){S=j.get(n);break}}return S||(S=j.get(j.length-1)),[S.x,S.e||0,S.y]}var U=L.s(M+"percent")||.5;if(U=Math.max(0,Math.min(U,1)),!c||!c.getCache)return!1;var f=c.getCache(),V=f[f.length-1].length,v=o.getLineOffset(g,U*V),s=v.point;return[s.x,s.y,s.z]},zh=function(){var N={center:function(Y,P,G,H,o){var q=-P[1]/2,J={x:-P[0]/2,y:q,width:P[0],height:P[1]},Z=Rm(Y,J,G);return[Z.x+H,-Z.y-o,Zd()]},front:function(D,K,p,n,N){var P=-K[1]/2,Y={x:-K[0]/2,y:P,width:K[0],height:K[1]},i=Rm(D,Y,p);return[i.x+n,-i.y-N,K[2]/2+Zd()]},back:function(t,J,e,W,V){var F=-J[0]/2,H=-J[1]/2,n={x:F,y:H,width:J[0],height:J[1]},y=Rm(t,n,e);return[-y.x-W,-y.y-V,-J[2]/2-Zd()]},left:function(w,r,O,D,N){var m=-r[1]/2,d={x:-r[2]/2,y:m,width:r[2],height:r[1]},W=Rm(w,d,O);return[-r[0]/2-Zd(),-W.y-N,W.x+D]},right:function(U,v,d,K,F){var Z=-v[2]/2,u=-v[1]/2,O={x:Z,y:u,width:v[2],height:v[1]},T=Rm(U,O,d);return[v[0]/2+Zd(),-T.y-F,-T.x-K]},top:function(W,U,Q,G,c){var s={x:-U[0]/2,y:-U[2]/2,width:U[0],height:U[2]},Y=Rm(W,s,Q);return[Y.x+G,U[1]/2+Zd(),Y.y+c]},bottom:function(y,c,Z,k,R){var z=-c[2]/2,W={x:-c[0]/2,y:z,width:c[0],height:c[2]},L=Rm(y,W,Z);return[L.x+k,-c[1]/2-Zd(),-L.y-R]}};return function(T,l,Y,O,p,F){return N[O](T,l,Y,p||0,F||0)}}(),Zp=function(V,p,q,v,c,r,m,i,t,Y){if(c&&(p[0]+=c[0],p[1]+=c[1],p[2]+=c[2]),Jm(V,q),i){var R=Rb();if(Xl(R,t,Y),vf(p,R),Jm(V,p),V.auto=i,V.pos=vf([0,0,0],V),r){var _=V.mat2=Rb();Xl(_,r,m)}}else Xl(V,t,Y),Jm(V,p),v===tq?Xe(V,-po):v===_h?Xe(V,po):v===xo?_g(V,-po):v===dc?_g(V,po):v===Zj&&Xe(V,g),Xl(V,r,m);return V},Dr=function(A,$){var S=$.auto,d=$.mat2,D=A.gv;if(S){var c,_=Rb(),P=[0,0,0,0];c="string"==typeof S?[S.indexOf("x")<0?D._eye[0]:D._center[0],S.indexOf("y")<0?D._eye[1]:D._center[1],S.indexOf("z")<0?D._eye[2]:D._center[2]]:D._eye,Qe(P,ys(Rb(),c,D._center,D._up)),Ln(_,yr(P,P),$.pos),d&&Nd(_,_,d),vg(D,_)}else vg(D,$)},Tl=function(A,u,n,s,f){var M=A.s,Q=A.gv,_=Q.getGL(),W=Q._prg,G=Q._buffer,Y=Q._1O,C=li.for(_),t=C.directAttribs();mq(_,rs,Y),Dr(A,n),vp(_,W,M(u+".blend"),M(u+".light"),M(u+".opacity"),M(u+".reverse.flip"),M(u+".reverse.color"),M(u+".reverse.cull")),Di(_,W,Y,f,G.uv,Hh),t.aPosition=ef(_,G.vs,s,h),t.aNormal=ef(_,G.ns,oi,h),rl(_,G.is,go),Hg(_,0,go.length),bn(_,W,Y),$e(_,W),Ol(Q)},gn=function(o,L,P){var X=o.gv,U=o.data,H=o[L]={blend:X.getBodyColor(U)||X.getFaceBlend(U,L),light:X.getFaceLight(U,L),color:X.getFaceColor(U,L),opacity:X.getFaceOpacity(U,L),transparent:X.getFaceTransparent(U,L),reverseFlip:X.getFaceReverseFlip(U,L),reverseColor:X.getFaceReverseColor(U,L),reverseCull:X.getFaceReverseCull(U,L),texture:X.getFaceImage(U,L),blendTexture:X.getFaceBlendImage(U,L),discardSelectable:X.getFaceDiscardSelectable(U,L)};if("csg"!==L){H.uv=X.getFaceUv(U,L)||P&&P[L+"Uv"],H.uvScale=X.getFaceUvScale(U,L)||P&&P[L+"UvScale"],H.uvOffset=X.getFaceUvOffset(U,L)||P&&P[L+"UvOffset"],H.uvRotation=X.getFaceUvRotation(U,L)||P&&P[L+"uvRotation"];var k=X.getFaceMat(U,L);if(k){var F=hk(U,k);U.appendAnchorMatrix3d(F),H.mat=F}}return H},fl=function(w,p,n,z,d){var o=w[z];if(o){if(!d(o.transparent))return;var H=w.data,$=w.gv,J=$._buffer,l=$.getTexture(o.texture,H,z),L=$.getTexture(o.blendTexture,H),y=li.for(p),g=y.directUniforms(),T=y.directAttribs();Di(p,n,l,o.discardSelectable,J.uv,o.tuv,o.uvOffset,o.uvScale,o.uvRotation,L),vp(p,n,o.blend,o.light,o.opacity,o.reverseFlip,o.reverseColor,o.reverseCull),o.cs&&!$._batchColorDisabled?(g.uBatchColor=!0,T.aBatchColor=ef(p,J.batchColor,o.cs,n.aBatchColor,4)):g.uDiffuse=o.color||E["color.empty"],T.aPosition=ef(p,J.vs,o.vs,h),T.aNormal=ef(p,J.ns,o.ns,h),vq(p,0,o.vs.length/3),o.cs&&!$._batchColorDisabled&&(g.uBatchColor=!1,ap(p,n.aBatchColor)),$e(p,n),bn(p,n,l)}},nh=function(j,R,l){rm(j)?j.forEach(function(X){nh(X,R,l)}):Pr(j)?nh(Jb(R,j),R,l):Ti(j)?j.shape3d?nh(j.shape3d,R,l):l.push(j):l.push(j)},ls=function(){for(var R=50,g=arguments.length,T=[],S=0;g>S;S++)T[S]=arguments[S];Ee[yo]="Time : "+(new Date).toLocaleString()+", Info :"+T.join(", "),yo=(yo+1)%R,console.error("Failed to create shader.")},Ub=function(){var d=new xb.Matrix2d;return function(t,O,b,h){h||(h=d);var p,s,D,l;return O?(p=O[0],s=O[1]):p=s=0,b?(D=b[0],l=b[1]):D=l=1,h.setFromTransform(t||0,p,s,D,l)}}(),Oo=function(i,y,S,$,o,b){var q,d,h,U,Z,m,C,D,G,_,r,n=[$-y,o-S],R=i?i.length:0;for(h=0;R>h;h++){for(U=2,q=i[h],Z=q[0],m=q[1];U+1<q.length;){if(C=q[U],D=q[U+1],d=um(y,S,$,o,Z,m,C,D,!0)){G=[C-Z,D-m],_=ml(G),G[0]/=_,G[1]/=_,_=gf(n,G),_=_>0?b:-b,r=[G[0]*_,G[1]*_];break}Z=C,m=D,U+=2}if(r)break}if(r)for($=y+r[0],o=S+r[1],h=0;R>h;h++)for(U=2,q=i[h],Z=q[0],m=q[1];U+1<q.length;){if(C=q[U],D=q[U+1],d=um(y,S,$,o,Z,m,C,D,!0))return[0,0];Z=C,m=D,U+=2}return r?r:[$-y,o-S]},hb=function(J){return"nearest"===J?Jh.NEAREST:"linear"===J?Jh.LINEAR:J},hd=L.graph3d={WebGLConstants:Jh},mc=function(Q,s,h){sr(l+".graph3d."+Q,s,h)},tk="~<yfusfw!+!yjsubNQv!>!opjujtpQ`mh!gjeof$!~<6/1!,!*{/mbdpMwVxpmg!,!z/mbdpMwVxpmg!-y/mbdpMwVxpmg)3dfw!>!^j]wVxpmg<{zy/**1/2!-opjujtpQb)5dfw!+!yjsubNNv!+!^j]yjsubNxpmg)!>!mbdpMwVxpmg|!*,,j!<UDFKCP`XPMG`YBN!=!j!<1>j!uoj)spg<mbdpMwVxpmg!4dfw1!?!UDFKCP`XPMG`YBN!gj$!!gjeof$!<*1/2!-opjujtpQb)5dfw!+!yjsubNNv!+!yjsubNxpebit!>!esppDxpebit!QBNXPEBIT`FTV!gfegj$!!gjeof$!~<fdobutjEfojMb!>!fdobutjEfojMw|*itbEv)gj!ITBE!gfegj$!!gjeof$!~<ttfouihjsCidubCb!>!ttfouihjsCidubCw|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!~<eofmCidubCb!>!eofmCidubCw|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!!gjeof$!~<spmpDidubCb!>!spmpDidubCw|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!~<**1/2!-wVb)4dfw!+!yjsubNwVv)3dfw!>!wVw|*fsvuyfUv)gj<*opjujtpQb)4dfw!>!opjujtpQw!gjeof$!~!1!>>!SFQQJMD`YPC`YBN!gj$!<**1/2!-opjujtpQb)5dfw!+!yjsubNNv)4dfw!>!emspXw<*yfusfw)4dfw!>!yfusfWw<**1/2!-mbnspOb)5dfw!+!yjsubNOv)4dfw!>!mbnspOw!gjeof$!|*ldjQva!%%!yjGva)gj!1!>>!SFQQJMD`YPC`YBN!gj$!<*1/2!-opjujtpQb)5dfw!+!yjsubNWNv!>!yfusfw!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<^UDFKCP`XPMG`YBN]wVxpmg!3dfw!hojzsbw<^UDFKCP`XPMG`YBN]yjsubNxpmg!5ubn!nspgjov1!?!UDFKCP`XPMG`YBN!gj$!!gjeof$!<esppDxpebit!5dfw!hojzsbw<yjsubNxpebit!5ubn!nspgjov!QBNXPEBIT`FTV!gfegj$!!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEfojMb!ubpmg!fuvcjsuub<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCb!4dfw!fuvcjsuub<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCb!ubpmg!fuvcjsuub<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCb!5dfw!fuvcjsuub<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<opjujtpQw!4dfw!hojzsbw<emspXw!4dfw!hojzsbw<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<yjGv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjsubNxfjWv!5ubn!nspgjov<yjsubNOv!5ubn!nspgjov<yjsubNQv!5ubn!nspgjov<yjsubNNv!5ubn!nspgjov<yjsubNWNv!5ubn!nspgjov<opjujtpQb!4dfw!fuvcjsuub<mbnspOb!4dfw!fuvcjsuub<wVw!3dfw!hojzsbw<wVb!3dfw!fuvcjsuub<yjsubNwVv!4ubn!nspgjov<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov!YJGFSQ^#CBRBEJxTT87hJFI,,bX1XrIwcn3UM{ZeZ,M6HEN6nLxe2Z72s2:3johr6foKrpqwxNKYkdbJ2CN[mBbf[wXU,T0oGuSEd190ohLZkEn8IuCe[OHoWeKz:Sf,VS7xdSLw23W1YJLU:jdv2{hiDbhDzNNEh9tp3xsuEp94Sl4c3wRzqwShMDRhCLRjCDEBOH5BBVRBCFRE4cJTHrTDH1BNgHJN",ee="~~<eJ!>!spmpDhbsG`mh~<spmpDsfmqnbTwv!>+!eJ<*wVw!-sfmqnbTeofmCv)E3fsvuyfu!>!spmpDsfmqnbTwv!5dfw|!*fsvuyfUeofmCv)!gj!!gjeof$!~<ttfouihjsCidubCw!>+!chs/eJ!!!|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!~<ttfouihjsCv!>+!chs/eJ!!!|*1/2!>a!ttfouihjsCv)gj~~<zujdbqPusbQv!>+!b/eJ!!!|*1/2!>a!zujdbqPusbQv)gj~!gjeof$!<*spudbGhpg!-*x/eJ!-chs/spmpDhpGv)5dfw!-eJ)yjn!>!eJ!gjeof$!<*iuqfe!-sbGhpGv!-sbfOhpGv)qfutiuppnt!>!spudbGhpg!ubpmg!ftmf$!<*iuqfe!+!iuqfe!+!zujtofEhpGv!+!zujtofEhpGv!.)qyf!.!1/2!>!spudbGhpg!ubpmg!3QYF`HPG!gfegj$!<{/yfusfWw.!>!iuqfe!ubpmg!HPG!gfegj$!!gjeof$!~<chs/*^j]wVxpmg!-^j]fsvuyfUxpmg)E3fsvuyfu!!>,!chs/eJ!****1/1)3dfw!-^j]wVxpmg)obiUsfubfsh)mmb!%%!***1/2)3dfw!-^j]wVxpmg)obiUttfm)mmb!%%!^j]efmcboFxpmg)!gj|!*,,j!<UDFKCP`XPMG`YBN!=!j!<1>j!uoj)spg!1!?!UDFKCP`XPMG`YBN!gj$!!gjeof$!~<zujwjudfmgfSv!+!{zy/spmpDwof!>,!chs/eJ!gjeof$!<*spmpDwof)sbfojMpUmfyfUqbNwof!>!spmpDwof<**{z/dfWudfmgfs!-y/dfWudfmgfs)4dfw!-qbNwoFv)fcvDfsvuyfu!>!spmpDwof!5dfw!ftmf$!<**ttfoihvps!-*{z/dfWudfmgfs!-y/dfWudfmgfs.)4dfw!-qbNwoFv)WVfcvDfsvuyfu)CHStpUsbfojM!>!spmpDwof!5dfw!WV`FCVD`FQZU`QBNWOF!gfegj$!<*mbnspOemspx!-yfusfWpUbsfnbd)udfmgfs!>!dfWudfmgfs!4dfw<*yjsubNxfjWv!-O)opjudfsjEnspgtobsUftsfwoj!>!mbnspOemspx!4dfw<*opjujtpQbsfnbDv!.!emspXw)f{jmbnspo!>!yfusfWpUbsfnbd!4dfw|*qbNwoFftVv)!gj!QBNWOF`FTV!gfegj$!!gjeof$!~~~~<chs/^j]spmpDupqTv!+!udfggFupqt!+!fhobSm!+!*1/1!-*mbnspOm.!-O)upe)ybn!>,!chs/eJ<*1/1!-*^j]uofopqyFupqTv!-udfggFupqt)xpq)ybn!>!udfggFupqt|*^j]fmhoBupqTv!?!udfggFupqt)gj<*mbnspOm!-^j]opjudfsjEupqTv)upe!>!udfggFupqt!ubpmg<*spudfWm)f{jmbnspo!>!mbnspOm!4dfw|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSupqTv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSupqTv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQupqTv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDupqTv)gj|!*,,j!<UPQT`YBN!=!j!<1>j!uoj)spg!1!?!UPQT`YBN!gj$!!gjeof$!~~~<chs/^j]spmpDuojpQv!+!fhobSm!+!*1/1!-**spudfWm)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSuojpQv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSuojpQv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQuojpQv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDuojpQv)gj|!*,,j!<UOJPQ`YBN!=!j!<1>j!uoj)spg!1!?!UOJPQ`YBN!gj$!!gjeof$!~~<chs/^j]spmpDsjEv!+!*1/1!-**^j]opjudfsjEsjEv)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!>>!x/^j]spmpDsjEv)gj|!*,,j!<SJE`YBN!=!j!<1>j!uoj)spg!1!?!SJE`YBN!gj$!~<chs/spmpDuihjmebfIv!+!nsfUusfcnbm!>+!chs/eJ!gjeof$!~<fvmbWxpebit!+!zujtofuoJxpebit!.!1/2!>+!nsfUusfcnbm!~!!<osvufs!<esbdtje!!|!*1/1!>>!fvmbWxpebit!%%!mmvDxpebit)!gj<*esppDxpebit!-tvjebSxpebit!-tbjCxpebit!-f{jTxpebit!-qbNxpebit)xpebiTufh!.!1/2!>!fvmbWxpebit!ubpmg|!*fwjfdfSxpebit)!gj!QBNXPEBIT`FTV!gfegj$!~<*1/2!-fhobSuihjmebfIv0*yfusfWw)iuhofm)ojn!.!1/2!!>+!nsfUusfcnbm|*1/1!?!fhobSuihjmebfIv)gj<*1/1!-zujtofuoJuofjcnBuihjmebfIv!,!*zujtofuoJuofjcnBuihjmebfIv!.!1/2)!+!*M.!-O)upe)ybn!>!nsfUusfcnbm!ubpmg|*1/1!>>!x/spmpDuihjmebfIv)gj|*uihjMv)gj~!gjeof$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf~<eofmCidubCw!>+!chs/eJ|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!~~<esbdtje|*1/1!>>!x/eJ)gj!gjeof$!<ftvggjEv!>!eJ!ftmf$!~<ftvggjEv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|ftmf~<spmpDwv!>!eJ|*fsvuyfUv)gj|!ftmf~<spmpDftsfwfSldjQyjGv!>!eJ|*qjmGftsfwfSva!%%!ldbCtj)gj~<fvsu!>!ldbCtj<O.!>!O|*1/1!=!*O!-F)upe)gj<ftmbg!>!ldbCtj!mppc<F.!>!M!4dfw!gjeof$!<*yfusfWw.)f{jmbnspo!>!F!4dfw!ftmf$!<*2!-1!-1)4dfw!>!F!4dfw!DJIQBSHPIUSP!gfegj$!<*mbnspOw)f{jmbnspo!>!O!4dfw|!ftmf~!gjeof$!~~<ftvggjEv!>!eJ|ftmf~<esbdtje|*1/1!>>!x/ftvggjEv)gj|!*fdobutjEitbEv!?!*fdobutjEqbHitbEv!-fdobutjEfojMw)epn!%%!itbEv)!gj!ITBE!gfegj$!!gjeof$!<spmpDftsfwfSldjQyjGv!>!eJ!ftmf$!~<spmpDftsfwfSldjQyjGv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*yjGv)gj<eJ!5dfw|ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDhbsG`mh)!gj!gjeof$!<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh!ftmf$!~<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh|ftmf~<spmpDidubCw!>!spmpDhbsG`mh|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*ldjQv)gj!gjeof$!~~~!<osvufs!<esbdtje!|!****ojNqjmd!-mbdpMw)obiUsfubfsh)mmb!%%!**ybNqjmd!-mbdpMw)obiUttfm)mmb)!>a!^j]sfooJqjmDsfqqjmDv)!gj<**1/2!-emspXw)5dfw!+!^j]yjsubNsfqqjmDv)4dfw!>!mbdpMw|!*,,j!<SFQQJMD`YPC`YBN!=!j!<1>j!uoj)spg<mbdpMw!4dfw|!*qjmDypCfmcboFv)!gj!1!?!SFQQJMD`YPC`YBN!gj$!~~!<esbdtje!|!**sje!-*uofdsfQqjmDv)4dfw)upe!?!*opjujtpQw!-sje)upe)!gj~!<1/2.!>!{/sje!|!*8!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2!>!{/sje!|!*7!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2.!>!z/sje!|!*6!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2!>!z/sje!|!*5!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2.!>!y/sje!|!*4!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2!>!y/sje!|!*3!=!opjudfsjEqjmDv)!gj<*1/1!-1/1!-1/1)4dfw!>!sje!4dfw|!*1!?!opjudfsjEqjmDv)!gj~!<osvufs!<*1/2!-1/1!-1/1!-1/1)5dfw!>!spmpDhbsG`mh!|!*uvpldbmc)!gj~~~!<esbdtje!|!*utfUbiqmBv!>=!b/spmpDwv)!gj!!!!|!ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDwv)!gj!!!!|!*uofsbqtobsUv)!gj<*wVw!-sfmqnbTv)E3fsvuyfu!>!spmpDwv|**fmcbudfmfTesbdtjEv!%%!ldjQv)a!%%!fsvuyfUv)gj<spmpDwv!5dfw|!*ejpw)ojbn!ejpw<uvpldbmc!mppc!nspgjov!gjeof$!<^UDFKCP`XPMG`YBN]wVxpmg!3dfw!hojzsbw<^UDFKCP`XPMG`YBN]efmcboFxpmg!mppc!nspgjov<^UDFKCP`XPMG`YBN]fsvuyfUxpmg!E3sfmqnbt!nspgjov!1!?!UDFKCP`XPMG`YBN!gj$!!gjeof$!!gjeof$!!~~<*1/2!-*Gqjn!-2spmpd!-1spmpd)yjn)5dfw!osvufs<*1/2!,!uoJqjn!-sjEfmqnbt!-qbNwof)WVfcvDsbfojmjc!>!2spmpd!4dfw|!ftmf!~<*1/2!-1spmpd)5dfw!osvufs|!*1/1!>>!Gqjn)!gj<*uoJqjn!-sjEfmqnbt!-qbNwof)WVfcvDsbfojmjc!>!1spmpd!4dfw<*qjn)sppmg!>!uoJqjn!ubpmg<*qjn)udbsg!>!Gqjn!ubpmg<*mfwfMqjNybn`WVfcvd!-1n!-*ttfoihvps)qjNpUttfoihvps)qnbmd!>!qjn!ubpmg|!*ttfoihvps!ubpmg!-sjEfmqnbt!4dfw!-qbNwof!E3sfmqnbt)WVfcvDfsvuyfu!5dfw!~<qjn!osvufs~<*ttfoihvps!+!72/2)3hpm!+!1/3!.!>!qjn|!ftmf!~<6n!,!*7s!.!6s)!0!*6n!.!7n)!+!*ttfoihvps!.!6s)!>!qjn|!*7s!>?!ttfoihvps)!gj!ftmf!~<5n!,!*6s!.!5s)!0!*5n!.!6n)!+!*ttfoihvps!.!5s)!>!qjn|!*6s!>?!ttfoihvps)!gj!ftmf!~<2n!,!*5s!.!2s)!0!*2n!.!5n)!+!*ttfoihvps!.!2s)!>!qjn|!*5s!>?!ttfoihvps)!gj!ftmf!~<1n!,!*2s!.!1s)!0!*1n!.!2n)!+!*ttfoihvps!.!1s)!>!qjn|!*2s!>?!ttfoihvps)!gj<1/1!>!qjn!ubpmg|!*ttfoihvps!ubpmg)qjNpUttfoihvps!ubpmg!1/5!7n!fojgfe$!9411/1!7w!fojgfe$!23/1!7s!fojgfe$!1/4!6n!fojgfe$!721/1!6w!fojgfe$!614/1!6s!fojgfe$!1/3!5n!fojgfe$!751/1!5w!fojgfe$!5/1!5s!fojgfe$!1/2!.!2n!fojgfe$!783/1!2w!fojgfe$!9/1!2s!fojgfe$!1/3!.!1n!fojgfe$!:44/1!1w!fojgfe$!1/2!1s!fojgfe$!~<*z/g!-nc!-nu)yjn!osvufs<*y/g!-sc!-mc)yjn!>!nc!4dfw<*y/g!-su!-mu)yjn!>!nu!4dfw<chs/**wv!-qbNwof)E3fsvuyfu)sbfojMpUmfyfUqbNwof!>!mc!4dfw<f{jTmfyfu!>.!y/wv<chs/**wv!-qbNwof)E3fsvuyfu)sbfojMpUmfyfUqbNwof!>!sc!4dfw<f{jTmfyfu!>,!z/wv<chs/**wv!-qbNwof)E3fsvuyfu)sbfojMpUmfyfUqbNwof!>!su!4dfw<f{jTmfyfu!>,!y/wv<chs/**wv!-qbNwof)E3fsvuyfu)sbfojMpUmfyfUqbNwof!>!mu!4dfw<f{jTmfyfu!>+!wv<*f{jTfdbg!+!1/3!.!f{jTfmjUybn`WVfcvd!-1/1)ybn!+!1/4!>,!y/wv<f{jTfmjUojn`WVfcvd!+!1/3!+!uoJsfumjg!>,!z/wv~<f{jTfmjUybn`WVfcvd!+!1/3!>,!z/wv|!*mfwfMqjNybn`WVfcvd!=!uoJqjn)!gj<f{jTfdbg!+!fdbg!>,!y/wv~<1/4!>.!fdbg<f{jTfdbg!>,!z/wv|!*1/3!?!fdbg)!gj<g!.!6/1!>,!wv<*wv)udbsg!>!g!3dfw<*1/2!.!f{jTfdbg)!+!*fdbg!-opjudfsje)WVufh!>!wv!3dfw<*f{jTfmjUybn`WVfcvd!+!1/4)!0!1/2!>!f{jTmfyfu!ubpmg<*uoJqjn)3qyf!>!f{jTfdbg!ubpmg<*mfwfMqjNojn`WVfcvd!-uoJqjn)ybn!>!uoJqjn<*1/1!-uoJqjn!.!mfwfMqjNojn`WVfcvd)ybn!>!uoJsfumjg!ubpmg<*opjudfsje)fdbGufh!>!fdbg!ubpmg|!*uoJqjn!ubpmg!-opjudfsje!4dfw!-qbNwof!E3sfmqnbt)WVfcvDsbfojmjc!4dfw!~<*1/2!,!wv)!+!6/1!osvufs~<*{/opjudfsje)tcb!0!*z/opjudfsje!-y/opjudfsje)3dfw!>!wv|!ftmf!~<*z/opjudfsje)tcb!0!*{/opjudfsje!-y/opjudfsje!.)3dfw!>!wv|!*1/5!>>!fdbg)!gj!ftmf!~<*y/opjudfsje)tcb!0!*z/opjudfsje!-{/opjudfsje!.)3dfw!>!wv|!*1/4!>>!fdbg)!gj!ftmf!~<*{/opjudfsje)tcb!0!*z/opjudfsje!-y/opjudfsje!.)3dfw!>!wv|!*1/3!>>!fdbg)!gj!ftmf!~<*z/opjudfsje)tcb!0!*{/opjudfsje!.!-y/opjudfsje!.)3dfw!>!wv|!*1/2!>>!fdbg)!gj!ftmf!~<*y/opjudfsje)tcb!0!*z/opjudfsje!-{/opjudfsje)3dfw!>!wv|!*1/1!>>!fdbg)!gj<wv!3dfw|!*fdbg!ubpmg!-opjudfsje!4dfw)WVufh!3dfw!~<fdbg!osvufs~<1/5!;!1/2!@!1/1!?!z/opjudfsje!>!fdbg!ftmf!<1/6!;!1/3!@!1/1!?!{/opjudfsje!>!fdbg!*z/opjudfsjEtcb!?!{/opjudfsjEtcb)!gj|!ftmf!~<1/5!;!1/2!@!1/1!?!z/opjudfsje!>!fdbg!ftmf!<1/4!;!1/1!@!1/1!?!y/opjudfsje!>!fdbg*z/opjudfsjEtcb!?!y/opjudfsjEtcb)!gj|!*{/opjudfsjEtcb!?!y/opjudfsjEtcb)!gj<1/2!.!>!fdbg!ubpmg<*opjudfsje)tcb!>!opjudfsjEtcb!4dfw|!*opjudfsje!4dfw)fdbGufh!ubpmg!1/72!f{jTfmjUojn`WVfcvd!fojgfe$!1/763!f{jTfmjUybn`WVfcvd!fojgfe$!1/5!mfwfMqjNojn`WVfcvd!fojgfe$!1/9!mfwfMqjNybn`WVfcvd!fojgfe$!WV`FCVD`FQZU`QBNWOF!gfegj$!~<*{zy/*yjsubn!+!*1/1!-sje)5dfw))f{jmbnspo!osvufs|!*yjsubn!5ubn!oj!-sje!4dfw!oj)opjudfsjEnspgtobsUftsfwoj!4dfw!gjeof$!~!<*x/fvmbw!-**SPUDBG`BNNBH)4dfw!-{zy/fvmbw)xpq)5dfw!osvufs!|!*fvmbw!5dfw)sbfojMpUmfyfUqbNwof!5dfw!ftmf$!~<*!b/fvmbw!-*!*!*!*!9142411/1!)4dfw!-chs/fvmbw!)mbvrFobiUttfm!)4dfw!-3:/32!+!chs/fvmbw!-*!661/1!)4dfw!.!661/2!+!*!*!77725/1!)4dfw!-chs/fvmbw!)xpq!)yjn!)5dfw!osvufs!|!*!fvmbw!5dfw!oj!)CHStpUsbfojM!5dfw~!<*b/fvmbw!-****65151/1)4dfw!-chs/fvmbw)mbvrFobiUttfm)4dfw!-9194::4881/1!+!chs/fvmbw!-**5/3)4dfw!-*5218342361/1)4dfw!,!79:387985:/1!+!chs/fvmbw)xpq)yjn)5dfw!osvufs!|!*fvmbw!5dfw)sbfojMpUmfyfUqbNwof!5dfw!WV`FCVD`FQZU`QBNWOF!gfegj$!<1/3!>!SPUDBG`BNNBH!ubpmg!utopd!QBNWOF`FTV!gfegj$!!gjeof$!~!!!!!!!!gjeof$!!!!!!!!!!!!<*qe!-*z/f{jTmfyfu!-E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!osvufs!!!!!!!!!!!!!!!!ftmf$!!!!!!!!!!!!<*1/:!0!1/2)!+!*!!!!!!!!!!!!!!!*qe!-*z/f{jTmfyfu!-yyz/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*qe!-*z/f{jTmfyfu!-yyy/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*qe!-*z/f{jTmfyfu!-zyz/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*qe!-*z/f{jTmfyfu!-zyy/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*qe!-*z/f{jTmfyfu!-E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*qe!-*z/f{jTmfyfu!-yzz/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*qe!-*z/f{jTmfyfu!-yzy/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*qe!-*z/f{jTmfyfu!-zzz/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*qe!-*z/f{jTmfyfu!-zzy/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!)!osvufs!!!!!!!!!!!!!!!!<z/f{jTmfyfu!+!tvjebSxpebit!+!*2!-2!.)3dfw!>!uftggp!3dfw!!!!!!!!!!!!!!!!*UGPT`GDQ`FQZU`QBNXPEBIT)efojgfe!}}!*GDQ`FQZU`QBNXPEBIT)efojgfe!gj$!!!!!!!!!!!!<*opjujtpQpUuihjm)f{jmbnspo!>!E4ec!4dfw!!!!!!!!!!!!<tbjCxpebit!>,!qe!!!!!!!!<*sbfObsfnbDxpebit!.!sbGbsfnbDxpebit)!0!*sbfObsfnbDxpebit!.!*opjujtpQpUuihjm)iuhofm)!>!qe!ubpmg!!!!!!!!!!!!<{zy/esppDxpebit!>!opjujtpQpUuihjm!4dfw!!!!!!!!!!!!<**1/3!-1/5)3dfw!+!f{jTqbNxpebit)!0!*1/2)3dfw!>!f{jTmfyfu!3dfw!!!!!!!!!!!!|!*sbGbsfnbDxpebit!ubpmg!-sbfObsfnbDxpebit!ubpmg!-esppDxpebit!5dfw!-tvjebSxpebit!ubpmg!-tbjCxpebit!ubpmg!-f{jTqbNxpebit!3dfw!-qbNxpebit!E3sfmqnbt)xpebiTuojpQufh!ubpmg!!!!!!!!~!!!!!!!!<*68/1!-684/1)3dfw!,!sbobmq!+!*63/1!-632/1)3dfw!osvufs!!!!!!!!!!!!~!!!!!!!!!!!!<1/3!.!Zohjt!+!{/w!>!z/sbobmq!!!!!!!!!!!!!!!!<1/3!,!Zohjt!+!1/3!,!y/w!>!y/sbobmq!!!!!!!!!!!!!!!!<*z/w)ohjt!>!Zohjt!ubpmg!!!!!!!!!!!!!!!!|!*foPutpnmb!>?!z/Wtcb)!gj!ftmf!~!!!!!!!!!!!!<Yohjt!+!1/3!,!Yohjt!+!{/w!>!y/sbobmq!!!!!!!!!!!!!!!!<*y/w)ohjt!>!Yohjt!ubpmg!!!!!!!!!!!!!!!!|!*foPutpnmb!>?!y/Wtcb)!gj!ftmf!~!!!!!!!!!!!!<y/w!.!1/5!>!y/sbobmq!!!!!!!!!!!!!!!!!!!!*1/1!?!{/w)!gj!!!!!!!!!!!!!!!!|!*foPutpnmb!>?!{/Wtcb)!gj!!!!!!!!!!!!<mfyfUButpnmb!.!1/2!>!foPutpnmb!ubpmg!!!!!!!!!!!!<Zf{jTmfyfu!+!6/2!>!mfyfUButpnmb!ubpmg!!!!!!!!!!!!<zy/w!>!sbobmq!3dfw!!!!!!!!!!!!<*Zf{jTmfyfu!+!1/3!.!1/2)!+!fcvDpUfmbdt!>+!w!!!!!!!!!!!!<fcvDpUfmbdt!>+!Wtcb!!!!!!!!!!!!<**{/Wtcb!-z/Wtcb)ybn!-y/Wtcb)ybn!0!1/2!>!fcvDpUfmbdt!ubpmg!!!!!!!!!!!!<*w)tcb!>!Wtcb!4dfw!!!!!!!!!!!!|!*Zf{jTmfyfu!ubpmg!-w!4dfw)WVpUfcvd!3dfw!!!!!!!!~!!!!!!!!<xpebit!osvufs!!!!!!!!!!!!~!!!!!!!!!!!!gjeof$!!!!!!!!!!!!<*{/esppDxpebit!-zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!>!xpebit!!!!!!!!!!!!!!!!ftmf$!!!!!!!!!!!!<*1/:!0!1/2)!+!*!!!!!!!!!!!!!!!*{/esppDxpebit!-*2ze!-2ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*2ze!-1/1)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*2ze!-1ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1/1!-2ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1/1!-1ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1ze!-2ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1ze!-1/1)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1ze!-1ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!)!>!xpebit!!!!!!!!!!!!!!!!<tvjebSxpebit!+!z/f{jTmfyfu!,!>!2ze!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!y/f{jTmfyfu!,!>!2ye!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!z/f{jTmfyfu!.!>!1ze!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!y/f{jTmfyfu!.!>!1ye!ubpmg!!!!!!!!!!!!!!!!<f{jTqbNxpebit!0!*1/2)3dfw!>!f{jTmfyfu!3dfw!!!!!!!!!!!!!!!!*UGPT`GDQ`FQZU`QBNXPEBIT)efojgfe!gjmf$!!!!!!!!!!!!<*1/:!0!1/2)!+!*!!!!!!!!!!!!!!!*{/esppDxpebit!-*2ze!-2ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*2ze!-1/1)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*2ze!-1ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1/1!-2ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1/1!-1ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1ze!-2ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1ze!-1/1)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1ze!-1ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!)!>!xpebit!!!!!!!!!!!!!!!!<tvjebSxpebit!+!z/f{jTmfyfu!,!>!2ze!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!y/f{jTmfyfu!,!>!2ye!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!z/f{jTmfyfu!.!>!1ze!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!y/f{jTmfyfu!.!>!1ye!ubpmg!!!!!!!!!!!!!!!!<f{jTqbNxpebit!0!*1/2)3dfw!>!f{jTmfyfu!3dfw!!!!!!!!!!!!!!!!*GDQ`FQZU`QBNXPEBIT)efojgfe!gj$!!!!!!!!!!!!|!*utfUnvutvsg)!gj!!!!!!!!!!!!<*dfWutfUnvutvsg)mmb!>!utfUnvutvsg!mppc!!!!!!!!!!!!<*1/2!>=!{/esppDxpebit!-nvutvsGoj)3dfwc!>!dfWutfUnvutvsg!3dfwc!!!!!!!!!!!!<*dfWnvutvsGoj)mmb!>!nvutvsGoj!mppc!!!!!!!!!!!!<*1/2!>=!z/esppDxpebit!-1/1!>?!z/esppDxpebit!-1/2!>=!y/esppDxpebit!-1/1!>?!y/esppDxpebit)!5dfwc!>!dfWnvutvsGoj!5dfwc!!!!!!!!!!!!<tbjCxpebit!>,!{/esppDxpebit!!!!!!!!!!!!<x/esppDxpebit!>0!{zy/esppDxpebit!!!!!!!!!!!!<1/2!>!xpebit!ubpmg!!!!!!!!!!!!|!*esppDxpebit!5dfw!-tvjebSxpebit!ubpmg!-tbjCxpebit!ubpmg!-f{jTqbNxpebit!3dfw!-qbNxpebit!E3sfmqnbt)xpebiTufh!ubpmg!!!!!!!!~!!!!!!!!<d!osvufs!!!!!!!!!!!!<*y/g!-c!-b)yjn!>!d!ubpmg!!!!!!!!!!!!<*z/g!-us!-cs)yjn!>!c!ubpmg!!!!!!!!!!!!<*z/g!-um!-cm)yjn!>!b!ubpmg!!!!!!!!!!!!<*6/1!,!f{jt!+!wv)udbsg!>!g!3dfw!!!!!!!!!!!!<*fsbqnpd!-zz/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe)fsbqnpDE3fsvuyfu!>!us!ubpmg!!!!!!!!!!!!<*fsbqnpd!-yz/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe)fsbqnpDE3fsvuyfu!>!cs!ubpmg!!!!!!!!!!!!<*fsbqnpd!-zy/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe)fsbqnpDE3fsvuyfu!>!um!ubpmg!!!!!!!!!!!!<*fsbqnpd!-yy/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe)fsbqnpDE3fsvuyfu!>!cm!ubpmg!!!!!!!!!!!!<f{jt!0!*6/1!,!f{jt!+!wv)sppmg!>!WVejpsuofd!3dfw!!!!!!!!!!!!<f{jt!0!*1/2)3dfw!>!f{jTmfyfu!3dfw!!!!!!!!!!!!<*1/2!-1/1)3dfw!>!uftggp!3dfw!utopd!!!!!!!!!!!!|!*fsbqnpd!ubpmg!-wv!3dfw!-f{jt!3dfw!-tiuqfe!E3sfmqnbt)qsfMxpebiTE3fsvuyfu!ubpmg!!!!!!!!~!!!!!!!!<***wv!-tiuqfe)E3fsvuyfu)iuqfEpUBCHSldbqov!-fsbqnpd)qfut!osvufs!!!!!!!!!!!!|!*fsbqnpd!ubpmg!-wv!3dfw!-tiuqfe!E3sfmqnbt)fsbqnpDE3fsvuyfu!ubpmg!!!!!!!!~!!!!!!!!<*tspudbGldbqoV!-w)upe!osvufs|!*w!5dfw!oj!utopd)iuqfEpUBCHSldbqov!ubpmg!!!!!!!!<*/2!-tspudbGldbQ)5dfw!0!fmbdtoxpEldbqoV!>!tspudbGldbqoV!5dfw!utopd!!!!!!!!<*/763!!-/763!+!/763!-/763!+!/763!+!/763)4dfw!>!tspudbGldbQ!4dfw!utopd!!!!!!!!<*2!hojevmdyf)!opjudbsg!?.!2//1!00!</763!0!/663!>!fmbdtoxpEldbqoV!ubpmg!utopd!!!!!!!!<*2!hojevmdoj)!2//1!?.!opjudbsg!00!</663!0!/763!>!fmbdtqVldbQ!ubpmg!utopd!!!!!!!!<esppDxpebit!5dfw!hojzsbw<fwjfdfSxpebit!mppc!nspgjov<tvjebSxpebit!ubpmg!nspgjov<tbjCxpebit!ubpmg!nspgjov<zujtofuoJxpebit!ubpmg!nspgjov<f{jTxpebit!3dfw!nspgjov<qbNxpebit!E3sfmqnbt!nspgjov<mmvDxpebit!mppc!nspgjov!QBNXPEBIT`FTV!gfegj$!!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEqbHitbEv!ubpmg!nspgjov<fdobutjEitbEv!ubpmg!nspgjov<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!!gjeof$!<sbGhpGv!ubpmg!nspgjov<sbfOhpGv!ubpmg!nspgjov!ftmf$!<zujtofEhpGv!ubpmg!nspgjov!3QYF`HPG!gfegj$!<spmpDhpGv!5dfw!nspgjov!HPG!gfegj$!!gjeof$!<*6/1!-6/1!-6/1)4dfw!>!ybNqjmd!4dfw!utopd<*6/1.!-6/1.!-6/1.)4dfw!>!ojNqjmd!4dfw!utopd<^SFQQJMD`YPC`YBN]yjsubNsfqqjmDv!5ubn!nspgjov<^SFQQJMD`YPC`YBN]sfooJqjmDsfqqjmDv!mppc!nspgjov<qjmDypCfmcboFv!mppc!nspgjov!1!?!SFQQJMD`YPC`YBN!gj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]fhobSupqTv!ubpmg!nspgjov<^UPQT`YBN]fmhoBupqTv!ubpmg!nspgjov<^UPQT`YBN]uofopqyFupqTv!ubpmg!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]fhobSuojpQv!ubpmg!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<spmpDuihjmebfIv!5dfw!nspgjov<zujtofuoJuofjcnBuihjmebfIv!ubpmg!nspgjov<fhobSuihjmebfIv!ubpmg!nspgjov<emspXw!4dfw!hojzsbw<opjujtpQbsfnbDv!4dfw!nspgjov<yjsubNxfjWv!5ubn!nspgjov!gjeof$!!gjeof$!<qbNwoFv!fcvDsfmqnbt!nspgjov!ftmf$!<ttfoihvps!ubpmg!nspgjov<qbNwoFv!E3sfmqnbt!nspgjov!WV`FCVD`FQZU`QBNWOF!gfegj$!<zujwjudfmgfSv!ubpmg!nspgjov<qbNwoFftVv!mppc!nspgjov!QBNWOF`FTV!gfegj$!<opjujtpQw!4dfw!hojzsbw<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<ftvggjEv!5dfw!nspgjov<zujdbqPusbQv!ubpmg!nspgjov<ttfouihjsCv!ubpmg!nspgjov<uihjMv!mppc!nspgjov<spmpDeofmCv!5dfw!nspgjov<eofmCv!mppc!nspgjov<uofdsfQqjmDv!ubpmg!nspgjov<opjudfsjEqjmDv!uoj!nspgjov<sfmqnbTeofmCv!E3sfmqnbt!nspgjov<sfmqnbTv!E3sfmqnbt!nspgjov<wVw!3dfw!hojzsbw<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov<uofsbqtobsUv!mppc!nspgjov<utfUbiqmBv!ubpmg!nspgjov<spmpDftsfwfSldjQyjGv!5dfw!nspgjov<qjmGftsfwfSv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjGv!mppc!nspgjov<fmcbudfmfTesbdtjEv!mppc!nspgjov!YJGFSQ!gjeof$!!gjeof$!!<ubpmg!qnvjefn!opjtjdfsq!!ftmf$!!<ubpmg!qihji!opjtjdfsq!!IHJI`OPJTJDFSQ`UOFNHBSG`MH!gfegj$!!TF`MH!gfegj$!";
th(r,{setBatchInfo:function(v,D){kh[v]=D},getBatchInfo:function(D){return kh[D]},getBatchInfoMap:function(){return kh},setBatchInfoMap:function(e){kh=e}},!0);var qc=[1,1,1],om=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],eb=[1,0,0,0,0,1,0,1,1,1,1,0],Qi=[-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5],Ap=[.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5],sg=[.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5],us=[.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5],hp=[.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5],ko=[-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5],np=function(y,Z){var R=y._40Q;R.each(function(p){p.ivBatch(Z)})},hj=function(C,f,$){var Q=$._id,S=f[Q];if(S){var W=S.batch,x=C[W],H=x.ds,w=S.index;if(x.invalidate=!0,delete f[Q],H.splice(w,1),Hj(H))return delete C[W],void 0;for(var A=S.begin,G=S.size,e=3*A,g=3*G,n=4*A,M=4*G,d=x.vs,P=x.ps,o=x.uv,Y=x.cs,r=x.bs,c=x.rs,I=x.ns,s=x.ls;w<H.length;w++)S=f[H[w]._id],S.index--,S.begin-=G;d.splice(e,g),P.splice(n,M),o&&o.splice(2*A,2*G),Y&&Y.splice(n,M),r&&r.splice(e,g),c&&c.splice(A,G),I&&I.splice(e,g),s&&s.splice(A,G)}},Dq=function(D,E,s,I,L){if(!I)return h;var W=E[I];if(!W){var z=L.getBatchInfo(I)||Pp,b=z.image?[]:h;W=E[I]={vs:[],ns:[],uv:b,cs:b?h:z.color?h:[],bs:z.blend?[]:h,ps:[],rs:z.brightness?[]:h,ds:[]}}return W.invalidate=!0,D[s._id]={index:W.ds.length,begin:W.vs.length/3,batch:I},W.ds.push(s),W},ak=function(E,U){return U!=h&&1!==U?[E[0]*U,E[1]*U,E[2]*U,E[3]]:E},Vm=function(u){var g=u.shapeModel;g||(g=Jb(u)),g&&(g._ctlineModel=[],g._lineModel=A)},qf=function(){var G;return function(V,_,m){var Y=V.getData3dUI(_),z=Y.shapeModel;if(z||(z=Jb(Y)),z||!Y.shapeName){var c,R=_.s("wf.combineTriangle");if(m.geometry){if(!z&&(_ instanceof L.Node&&!(_ instanceof L.Shape)?(G||(G={vs:Wk,is:Pi,uv:vd}),z=G):z=[Y.left,Y.front,Y.right,Y.back,Y.top,Y.bottom],!z))return A;if(R){var t=_.s("wf.normEpsilon");isNaN(t)&&(t=2),R=0|Math.min(3,Math.max(1,isNaN(R)?1:R)),c=uq[R-1](z,Y,180/(Math.PI*t))}else c=Dd(z,Y);if(!c||0===c.length)return}else c=m.short?nn:cn;var n=V.getBrightness(_),S=_.s("bloom"),g=_.s("3d.reflectable"),Q=Jn(m.color||"white"),v=Q[3]<1,y=Math.ceil(m.width)||1,r=_.s("3d.clipbox.enabled")&&!_.s("3d.clipbox"),s=(v?"T":"O")+(S?"_1":"_0")+(g?"1_":"0_")+(r?"1_":"0_")+y,N=_.getRenderLayer(),q=V._40Q.get(N),J=q.wireframeIndexMap,w=q.wireframeModelMap,K=w[s];K||(K=w[s]={vs:[],cs:[],ps:[],ds:[],T:v,B:S,clipboxEnabled:r,reflectable:!!g,W:y}),K.invalidate=!0;var D=K.vs,k=K.cs,x=K.ds,W=J[_._id]={index:x.length,begin:D.length/3,batch:s};x.push(_);var o=Y.mat;_ instanceof L.Edge||!(!o||!m.geometry&&_ instanceof L.Shape)||(o=hk(_,m.mat),_.appendAnchorMatrix3d(o)),Oh(D,o,c);var j=W.size=D.length/3-W.begin;He(k,ak(Q,n),j)}}}(),Zo=function(z,M,o,j,D,V,K,S,I){var P=z.getBrightness(M);P==h&&(P=1);var C=ak(Jn(j),P),$=C[3]<1;V=Math.ceil(V)||1;var x=($?"T":"O")+V;if(K){var d=K[0],O=(K[1]||d)+d;x+="-"+d+"-"+O,I&&(x+="-"+Bc(I)+"-"+P,I=ak(Jn(I),P))}var N=M.getRenderLayer(),k=z._40Q.get(N),T=k.polylineIndexMap,e=k.polylineModelMap,Q=e[x];Q||(Q=e[x]={vs:[],cs:[],ps:[],ds:[],ls:K?[]:h,T:$,W:V},K&&(Q.D=d,Q.G=O,Q.A=I)),Q.invalidate=!0;var q,l=Q.vs,J=Q.cs,u=Q.ds,w=Q.ls,X=T[M._id]={index:u.length,begin:l.length/3,batch:x};u.push(M),Zf(l,o);var f,p=X.size=l.length/3-X.begin,A=o.length,b=0,F=[];if(K||D)for(q=0;A>q;q+=6)f=ml([o[q],o[q+1],o[q+2]],[o[q+3],o[q+4],o[q+5]]),F.push(f),b+=f;if(b&&D){var m,y=ak(Jn(D),P),G=[y[0]-C[0],y[1]-C[1],y[2]-C[2],y[3]-C[3]],E=0;for(q=0;A>q;q+=6)m=E/b,He(J,[C[0]+G[0]*m,C[1]+G[1]*m,C[2]+G[2]*m,C[3]+G[3]*m],1),E+=F[q/6],m=E/b,He(J,[C[0]+G[0]*m,C[1]+G[1]*m,C[2]+G[2]*m,C[3]+G[3]*m],1)}else He(J,C,p);if(K)for(E=S||0,q=0;A>q;q+=6)w.push(E),E+=F[q/6],w.push(E)},Gc=function(M,t,r){if(t){var D=4*t.begin,a=r[t.batch].ps;if(a[D]!==M[0]||a[D+1]!==M[1]||a[D+2]!==M[2]||a[D+3]!==M[3]){for(var y=0;y<t.size;y++)a[D++]=M[0],a[D++]=M[1],a[D++]=M[2],a[D++]=M[3];a._invalidateThisFrame=!0}}},pk=function(){var W=new L.Math.Vector3,v=new L.Math.Vector3;return function(Q,P){var D=P+["32"],t=Q[P],w=Q[D];if(t){if(r.extractBatchTranslation&&"vs"===P){v.set(0,0,0);for(var l=t.length,I=0;l>I;I+=3)v.add(W.fromArray(t,I));v.divideScalar(l/3);for(var z=v.x,B=v.y,b=v.z,e=new Array(l),I=0;l>I;I+=3)e[I]=t[I]-z,e[I+1]=t[I+1]-B,e[I+2]=t[I+2]-b;t=e,Q.translate=[z,B,b]}w&&w.length===t.length?(w.set(t),w._bufId=null):Q[D]=new Rl(t)}else delete Q[D]}}(),Uj=function(x,Y,y,m,p,M,Q,B){if(rm(y))y.forEach(function(F){Uj(x,Y,F,m,p,M,Q,B)});else if(Pr(y))Uj(x,Y,Jb(m,y),m,p,M,Q,B);else if(Ti(y)){var c,o=zm(y.mat,Y,x),s=zm(y.s3,Y,x),i=zm(y.t3,Y,x),E=zm(y.r3,Y,x);if((s||E||i||o)&&(c=Qr(o,s,E,zm(y.rotationMode,Y,x),i),M.push(c)),y.shape3d)Uj(x,Y,y.shape3d,m,p,M,Q,y);else{var X=m.s;B=B||Pp;var L=M[0],H=M.length,T=X("shape3d.color",y.color,B.color);if(p||(p=X("shape3d.blend",y.blend,B.blend)),H>1){L=Kn(L);for(var q=1;H>q;q++)Nd(L,L,M[q])}var r=L?ce(L):h;y.vs&&X(jp,y.visible,B.visible)&&bo(L,Q,y.vs,y.uv,y.is,y.ns,r,p,T),y.top_vs&&X(js,y.topVisible,B.topVisible)&&bo(L,Q,y.top_vs,y.top_uv,y.top_is,y.top_ns,r,p,X("shape3d.top.color",y.topColor,B.topColor)||T),y.bottom_vs&&X(Qc,y.bottomVisible,B.bottomVisible)&&bo(L,Q,y.bottom_vs,y.bottom_uv,y.bottom_is,y.bottom_ns,r,p,X("shape3d.bottom.color",y.bottomColor,B.bottomColor)||T),y.from_vs&&X(Lp,y.fromVisible,B.fromVisible)&&bo(L,Q,y.from_vs,y.from_uv,y.from_is,y.from_ns,r,p,X("shape3d.from.color",y.fromColor,B.fromColor)||T),y.to_vs&&X(qr,y.toVisible,B.toVisible)&&bo(L,Q,y.to_vs,y.to_uv,y.to_is,y.to_ns,r,p,X("shape3d.to.color",y.toColor,B.toColor)||T)}c&&M.pop()}},bo=function(f,p,Q,T,n,V,J,E,N){var I,r=p.cs,x=p.uv,G=p.bs,C=p.ns,X=p.vs;if(V&&0!==V.length||(V=ch(Q,n)),n){I=n.length;for(var g=0;I>g;g++){var z=n[g],U=3*z;Oh(X,f,[Q[U],Q[U+1],Q[U+2]]),Oh(C,J,[V[U],V[U+1],V[U+2]]),x&&Zf(x,[T[2*z],T[2*z+1]])}}else I=Q.length/3,Oh(X,f,Q),Oh(C,J,V),x&&Zf(x,T);r&&He(r,N,I),G&&(E?Vj(G,E,I):Zf(G,qc,I))},Kr=function(g,A,d,_){_?Uj(g.gv,g.data,_,g,g.getBodyColor(),[A],d):(he(g,tq,A,d),he(g,_h,A,d),he(g,Ic,A,d),he(g,Zj,A,d),he(g,xo,A,d),he(g,dc,A,d),he(g,"csg",A,d))},he=function(S,p,R,I){var A=S[p];if(A){var U=A.tuv;if(U){var J=A.uvScale,m=A.uvOffset,O=A.uvRotation;if(J||m||O){var x,P,g,a=Ub(O,m,J),G=a.a,u=a.b,v=a.c,E=a.d,e=a.tx,$=a.ty,i=U.length;for(g=0;i>g;g+=2)x=U[g],P=U[g+1],U[g]=G*x+v*P+e,U[g+1]=u*x+E*P+$}}bo(R,I,A.vs,U,h,h,R?ce(R):h,A.blend,A.color)}},wk=function(x,z,Z,J,v,P,Q,o){var f,d=Z.cs,b=Z.uv,I=Z.bs,O=Z.vs,k=Z.ns,T=ch(o);if(x.getFaceVisible(z,Q)){var $=x.getFaceMat(z,Q);if($&&(v=hk(z,$),P=ce(v)),Oh(O,v,o),Oh(k,P,T),d&&He(d,x.getFaceColor(z,Q),6),b){var W=x.getFaceUv(z,Q)||J[Q+"Uv"],w=x.getFaceUvScale(z,Q)||J[Q+"UvScale"],p=x.getFaceUvOffset(z,Q)||J[Q+"UvOffset"],A=x.getFaceUvRotation(z,Q)||J[Q+"UvRotation"];W=W?[W[6],W[7],W[0],W[1],W[2],W[3],W[2],W[3],W[4],W[5],W[6],W[7]]:eb;var t=W[0],q=W[1],G=W[2],L=W[3],S=W[4],u=W[5],j=W[6],F=W[7],D=W[8],y=W[9],g=W[10],X=W[11];if(w||p||A){var a=Ub(A,p,w),s=a.a,m=a.b,Y=a.c,B=a.d,N=a.tx,e=a.ty;t=s*t+Y*q+N,q=m*t+B*q+e,G=s*G+Y*L+N,L=m*G+B*L+e,S=s*S+Y*u+N,u=m*S+B*u+e,j=s*j+Y*F+N,F=m*j+B*F+e,D=s*D+Y*y+N,y=m*D+B*y+e,g=s*g+Y*X+N,X=m*g+B*X+e}b.push(t,q,G,L,S,u,j,F,D,y,g,X)}I&&(f=x.getBodyColor(z)||x.getFaceBlend(z,Q),f?Vj(I,f,6):Zf(I,qc,6))}},mr=function(F,r,Q,Y){var Q=F._picking?F.pickColorMap:null,N=F.getGL(),O=F._prg,d=F._buffer;if(!ic(r)){vg(F,om),vh(N,O);for(var b in r){var M=r[b];if(!(Y&&!M.T||!Y&&M.T||F.isReflecting(N)&&M.reflectable===!1)){M.invalidate?(M.invalidate=!1,pk(M,"vs"),pk(M,"cs"),pk(M,"ls"),pk(M,"ps")):Q&&M.ps&&M.ps._invalidateThisFrame&&(M.ps._invalidateThisFrame=!1,pk(M,"ps"));var P=M.translate;P&&vg(F,[1,0,0,0,0,1,0,0,0,0,1,0,P[0],P[1],P[2],1]);var H=M.vs32,e=Q?M.ps32:M.cs32;Zn(N,O,M.W,h,d.vs,H);var w=li.for(N),W=w.directUniforms(),Z=w.directAttribs(),u=M.D,$=!F._dashDisabled&&u;W.uAlphaTest=E.alphaTest,N._blooming&&!M.B&&(W.blackout=!0),W.uEnableBoxClip=M.clipboxEnabled!==!1,$&&(W.uDash=!0,W.uDashDistance=u,W.uDashGapDistance=M.G,W.uDiffuse=M.A||E["color.empty"],Z.aLineDistance=ef(N,d.lineDistance,M.ls32,h,1));var j=!F._batchColorDisabled;j&&e.length?(W.uBatchColor=!0,Z.aBatchColor=ef(N,d.batchColor,e,h,4)):(W.uBatchColor=!1,Z.aBatchColor=!1),Di(N),vq(N,0,H.length/3,N.LINES),bn(N),j&&(W.uBatchColor=!1,Z.aBatchColor=!1),$&&(W.uDash=!1,Z.aLineDistance=!1),N._blooming&&!M.B&&(W.blackout=!1),P&&Ol(F)}}tg(N,O),Ol(F)}},Jo=function(r){r.invalidate=!1,pk(r,"vs"),pk(r,"ns"),pk(r,"cs"),pk(r,"rs"),pk(r,"ps"),pk(r,"bs"),pk(r,"uv")},qi=function(f,n,z,v,g){var W,x,D,X,b,t,j,F,y,Q,k,N,z=f._picking?f.pickColorMap:null,G=f.getGL(),R=f._prg,s=li.for(G),q=s.directUniforms(),o=s.directAttribs(),c=f._buffer;if(!ic(n)&&!f.drawFilter){vg(f,om);for(W in n)if(x=f.getBatchInfo(W)||Pp,x.visible!==!1&&!(v&&!x.transparent||!v&&x.transparent||f.isReflecting(G)&&x.reflectable===!1)){var u=x.renderLayerMask;if(u==h&&(u=gp),g==h&&(g=gp),zi(g,u)&&(D=n[W],z||!x.transparentMask)){var d=v&&x.autoSort===!0&&(f._33Q||D.invalidate);if(D.invalidate?Jo(D):z&&D.ps&&D.ps._invalidateThisFrame&&(D.ps._invalidateThisFrame=!1,pk(D,"ps")),b=D.vs32,t=z?D.ps32:D.cs32,y=D.uv32,j=D.bs32,F=D.rs32,k=b.length/3,d){var Z=ai(b,f.getEye(),f);Z?(D.is=Z.is,D.elementTypeUint=Z.useUint32):(D.is=null,D.elementTypeUint=null)}if(k){N=D.translate,N&&vg(f,[1,0,0,0,0,1,0,0,0,0,1,0,N[0],N[1],N[2],1]),X=x.light,Q=f.getTexture(x.image),vp(G,R,h,x.light,x.opacity,x.reverseFlip,x.reverseColor,x.reverseCull),t?f._batchColorDisabled?(q.uBatchColor=!1,o.aBatchColor=!1):(q.uBatchColor=!0,o.aBatchColor=ef(G,c.batchColor,t,h,4)):(q.uBatchColor=!1,q.uDiffuse=x.color||E["color.empty"]);var w=x.alphaTest;q.uAlphaTest=w===A?E.alphaTest:w,q.shadowReceive=!z&&x.shadowReceive!==!1,q.uEnableBoxClip=x.clipboxEnabled!==!1,Sc(f,q,x.lightMask===A?xc:x.lightMask),G._blooming&&!x.bloom&&(q.blackout=!0),x.envmap!==A?(q.uUseEnvMap=!0,q.uReflectivity=x.envmap,q.roughness=x.roughness||0,f._setEnvmapByProbeId(q,x.envmapProbe||0)):(q.uUseEnvMap=!1,q.uReflectivity=0);var r=j&&!f._batchBlendDisabled;r&&(q.uBatchBlend=!0,o.aBatchBlend=ef(G,c.batchBlend,j,h));var L=F&&!f._batchBrightnessDisabled;L&&(q.uBatchBrightness=!0,o.aBatchBrightness=ef(G,c.batchBrightness,F,h,1)),y?Di(G,R,Q,x.discardSelectable,c.uv,y,x.uvOffset,x.uvScale,x.uvRotation):Di(G),o.aPosition=ef(G,c.vs,b,h),o.aNormal=ef(G,c.ns,D.ns32,h),D.is?(Cm(G,c.is,D.is),Hg(G,0,k,null,D.elementTypeUint?G.UNSIGNED_INT:null)):vq(G,0,k),y?bn(G,R,Q):bn(G),t&&!f._batchColorDisabled&&(q.uBatchColor=!1,o.aBatchColor=!1),r&&(q.uBatchBlend=!1,o.aBatchBlend=!1),L&&(q.uBatchBrightness=!1,o.aBatchBrightness=!1),G._blooming&&!x.bloom&&(q.blackout=!1),$e(G,R),N&&Ol(f)}}}Ol(f)}},ai=function(v,D,F){var c=v.length/3,$=c>65535,B=F._glCapabilities.elementTypeUint&&$;if(!B&&$)return null;for(var w=new Array(c),M=c/3,W=new Array(M),m=0;M>m;m++)W[m]=m;W.sort(function(Z,R){var i=9*Z,M=[(v[i]+v[i+3]+2*v[i+6])/4,(v[i+1]+v[i+4]+2*v[i+7])/4,(v[i+2]+v[i+5]+2*v[i+8])/4];i=9*R;var e=[(v[i]+v[i+3]+2*v[i+6])/4,(v[i+1]+v[i+4]+2*v[i+7])/4,(v[i+2]+v[i+5]+2*v[i+8])/4],F=ml(D,M)-ml(D,e);return F>0?-1:0>F?1:0});for(var m=0;M>m;m++){var A=3*m,i=3*W[m];w[A]=i,w[A+1]=i+1,w[A+2]=i+2}return{useUint32:B,is:B?new Uint32Array(w):new Tb(w)}},zg={obj:function(I,s){var Z={mat:I.mat,s3:I.s3,r3:I.r3,rotationMode:I.rotationMode,t3:I.t3,cube:I.cube==h?!0:I.cube,center:I.center==h?!0:I.center,ignoreMtls:I.ignoreMtls,ignoreTransparent:I.ignoreTransparent,ignoreColor:I.ignoreColor,ignoreImage:I.ignoreImage,ignoreNormal:I.ignoreNormal,prefix:I.prefix,flipY:I.flipY,flipFace:I.flipFace,reverseFlipMtls:I.reverseFlipMtls,finishFunc:function(K,j){if(K){var j=[];for(var L in K){var J=K[L];j.rawS3=J.rawS3,J.center&&(j.center=J.center),j.push(J),I.eachModel&&I.eachModel(L,J)}j.json=I,s(j)}else s()}};r.loadObj(I.obj,I.mtl,Z)},bin:function(j,B){var c={finishFunc:function(E){E?B(E):B()}};r.loadBin(j.url,c)}};r.getModelTypeHandlers=function(){return zg},r.setModelTypeHandler=function(I,y){zg[I]=y},r.getModelTypeHandler=function(N){return zg[N]},r.handleModelLoaded=function(){},r.handleUnfoundModel=function(){};var Cs=h,ps=h,_c=function(k){Cs&&!k._loadingModelView_&&(ps||(ps={}),ps[k._loadingModelView_=og()]=k)},Bl=function(K,M){Cs||(Cs={});var b=Cs[K];if(b){if(b.url===M)return;b.request.onload=kb,b.request.onerror=kb}if(M.indexOf(".bin")===M.length-4)return jj(K,{modelType:"bin",url:M},M);if(M=r.beforeLoadURL(M),M.data){var i=r.parse(M.data);jj(K,i,M)}else{var q=new Uf;Cs[K]={request:q,url:M},q.onload=function(){if(200===this.status||0===this.status){delete Cs[K];var I=r.parse(q.getResponseText());jj(K,I,M)}else Zr(K,r.handleUnfoundModel(K,M)||h)},q.onerror=function(){Zr(K,r.handleUnfoundModel(K,M)||h)};var V={};V.url=encodeURI(M),V.sync=!1,q.send(V)}},jj=function(x,R,i){var N=R.modelType;if(!N)return Zr(x,R),r.handleModelLoaded(x,R),void 0;var n=r.getModelTypeHandler(N);if(n){if(Cs||(Cs={}),Cs[x])return;Cs[x]=!0;var d=function($){$?(Zr(x,$),r.handleModelLoaded(x,$)):Zr(x,r.handleUnfoundModel(x,i,R)||h)};n(R,d)}else Zr(x,r.handleUnfoundModel(x,i,R)||h)},Zr=function(a,x){if(delete Cs[a],Pr(x)&&be.test(x))return Bl(a,x),void 0;if(No[a]=x,ic(Cs)&&(Cs=h,ps)){for(var R in ps){var K=ps[R];K.invalidateAll&&K.invalidateAll(A,"modelLoaded",a),K.redraw&&K.redraw(),K.iv(),delete K._loadingModelView_}ps=h}if(x&&ps)for(var R in ps){var K=ps[R];K.invalidateAll&&K.invalidateAll(A,"modelLoading",a),K.redraw&&K.redraw(),K.iv()}},Hh=new Rl([0,0,0,1,1,1,1,0]),oi=new Rl([0,0,1,0,0,1,0,0,1,0,0,1]),go=new Tb([0,1,2,2,3,0]),Wk=new Rl([-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5]),Pi=new Tb([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),vd=new Rl([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]),ar=ch(Wk,Pi),ns=(new Rl([-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,-.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5]),new Tb([0,1,2,3,0,7,5,4,6,7,5,3,2,4,6,1]),[tq,Ic,_h,Zj,xo,dc]),cn=[-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5],nn=[-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4],Xh=function(a,F,C,u,H,X,Z){X=X||16,a=a||16,F=F||0,C=C||a;var I,Q,P,w,W,A,E,c,r,l=.5,x=[],j=[],N=S/a,J=g/X;for(I=0;X>I;I++)for(A=I+1,w=I*J,r=A*J,Q=F;C>Q;Q++)E=Q+1,P=Q*N,c=E*N,x.push(l*e(w)*$(P),l*$(w),-l*e(w)*e(P),l*e(r)*$(c),l*$(r),-l*e(r)*e(c),l*e(w)*$(c),l*$(w),-l*e(w)*e(c),l*e(w)*$(P),l*$(w),-l*e(w)*e(P),l*e(r)*$(P),l*$(r),-l*e(r)*e(P),l*e(r)*$(c),l*$(r),-l*e(r)*e(c)),j.push(Q/a,I/X,E/a,A/X,E/a,I/X,Q/a,I/X,Q/a,A/X,E/a,A/X);if(Z){var v=[];for(I=0,W=x.length;W>I;I+=3)v.push(2*x[I],2*x[I+1],2*x[I+2])}if(u){var m=[],n=[];for(P=F*N,I=0;X>I;I++)A=I+1,w=I*J,r=A*J,m.push(0,0,0,l*e(r)*$(P),l*$(r),-l*e(r)*e(P),l*e(w)*$(P),l*$(w),-l*e(w)*e(P)),n.push(0,.5,F/a,A/X,F/a,I/X)}if(H){var L=[],R=[];for(P=C*N,I=0;X>I;I++)A=I+1,w=I*J,r=A*J,L.push(0,0,0,l*e(w)*$(P),l*$(w),-l*e(w)*e(P),l*e(r)*$(P),l*$(r),-l*e(r)*e(P)),R.push(1,.5,C/a,I/X,C/a,A/X)}var _={vs:x,uv:j,from_vs:m,from_uv:n,to_vs:L,to_uv:R};return Z&&(_.ns=v),_},$f=function(Q,j,T){Q=Q||.17,j=j||12,T=T||18,0>Q?Q=0:Q>.25&&(Q=.25);var Y,o,z,K,s,q,u,V=.5,M=[],n=[],N=[],A=S/T,F=S/j,h=V-Q;for(o=0;j>=o;o++)for(K=-g+o*F,q=$(K),s=e(K),Y=0;T>=Y;Y++)z=Y*A,u=h+Q*q,M.push($(z)*u,s*Q,-e(z)*u),n.push(Y/T,1-o/j);for(o=0;j>o;o++){var B=o*(T+1),w=(o+1)*(T+1);for(Y=0;T>Y;Y++)N.push(B+Y,w+Y+1,w+Y,B+Y,B+Y+1,w+Y+1)}return{vs:M,uv:n,is:N}},bc=function(m,z,E,v,X,Y,l,x){l=l||12,m=m||18,z=z||0,E=E||m,Y=Y||.17,0>Y?Y=0:Y>.25&&(Y=.25);var b,s,L,H,W,I,a,C,q,T,d=.5,D=[],P=[],k=S/m,M=S/l,j=d-Y,p=x?[]:A;for(L=0;l>L;L++)for(H=L+1,a=-g+L*M,C=-g+H*M,b=z;E>b;b++)s=b+1,W=b*k,I=s*k,q=j+Y*$(a),T=j+Y*$(C),D.push($(W)*q,e(a)*Y,-e(W)*q,$(I)*q,e(a)*Y,-e(I)*q,$(I)*T,e(C)*Y,-e(I)*T,$(W)*q,e(a)*Y,-e(W)*q,$(I)*T,e(C)*Y,-e(I)*T,$(W)*T,e(C)*Y,-e(W)*T),P.push(b/m,1-L/l,s/m,1-L/l,s/m,1-H/l,b/m,1-L/l,s/m,1-H/l,b/m,1-H/l),x&&p.push($(W)*$(a),e(a),-e(W)*$(a),$(I)*$(a),e(a),-e(I)*$(a),$(I)*$(C),e(C),-e(I)*$(C),$(W)*$(a),e(a),-e(W)*$(a),$(I)*$(C),e(C),-e(I)*$(C),$(W)*$(C),e(C),-e(W)*$(C));if(v){var i=[],N=[];for(L=0;l>L;L++)H=L+1,a=-g+L*M,C=-g+H*M,W=z*k,q=j+Y*$(a),T=j+Y*$(C),i.push($(W)*q,e(a)*Y,-e(W)*q,$(W)*T,e(C)*Y,-e(W)*T,$(W)*j,0,-e(W)*j),N.push(.5+.5*$(a),.5-.5*e(a),.5+.5*$(C),.5-.5*e(C),.5,.5)}if(X){var t=[],w=[];for(L=0;l>L;L++)H=L+1,a=-g+L*M,C=-g+H*M,W=E*k,q=j+Y*$(a),T=j+Y*$(C),t.push($(W)*q,e(a)*Y,-e(W)*q,$(W)*j,0,-e(W)*j,$(W)*T,e(C)*Y,-e(W)*T),w.push(.5-.5*$(a),.5-.5*e(a),.5,.5,.5-.5*$(C),.5-.5*e(C))}var G={vs:D,uv:P,from_vs:i,from_uv:N,to_vs:t,to_uv:w};return x&&(G.ns=p),G},Mp=function(C,z){for(var U,N,X,o,Q,x=.5,h=16,r=[],p=[],s=[],t=[],i=S/h,q=0;h>=q;q++)U=q*i,N=$(U),o=N*x,X=e(U),Q=X*x,r.push(o,-x,Q,o,x,Q),s.push(N,0,X,N,0,X),p.push(1-q/h,1,1-q/h,0);for(q=0;h>q;q++)t.push(2*q,2*q+1,2*q+3,2*q,2*q+3,2*q+2);if(z){var J=[],k=[],O=[];for(J.push(0,-x,0),k.push(.5,.5),q=0;h>=q;q++)U=q*i,N=$(U),X=e(U),J.push(N*x,-x,-X*x),k.push(.5+.5*N,.5+.5*X);for(q=0;h>q;q++)O.push(0,q+2,q+1)}if(C){var A=[],b=[],V=[];for(A.push(0,x,0),b.push(.5,.5),q=0;h>=q;q++)U=q*i,N=$(U),X=e(U),A.push(N*x,x,-X*x),b.push(.5+.5*N,.5-.5*X);for(q=0;h>q;q++)V.push(0,q+1,q+2)}return{vs:r,uv:p,is:t,ns:s,bottom_vs:J,bottom_uv:k,bottom_is:O,top_vs:A,top_uv:b,top_is:V}},ok=function(l,P,R,J,U,c,z,E){l=l||12,P=P||0,R=R||l;for(var N,v,d,i,w,f,r,Z,X,u=.5,x=[],s=[],C=S/l,h=P;R>h;h++)N=h+1,v=h*C,d=N*C,i=$(v)*u,w=e(v)*u,f=$(d)*u,r=e(d)*u,x.push(i,-u,-w,f,-u,-r,i,u,-w,f,-u,-r,f,u,-r,i,u,-w),s.push(h/l,1,N/l,1,h/l,0,N/l,1,N/l,0,h/l,0);if(E){var t=[];for(h=0,X=x.length;X>h;h+=3)t.push(2*x[h],0,2*x[h+2])}if(z){var O=[],k=[];for(h=P;R>h;h++)v=C*h,d=C*(h+1),i=$(v),w=e(v),f=$(d),r=e(d),O.push(i*u,-u,-w*u,0,-u,0,f*u,-u,-r*u),k.push(.5+.5*i,.5+.5*w,.5,.5,.5+.5*f,.5+.5*r)}if(c){var n=[],I=[];for(h=P;R>h;h++)v=C*h,d=C*(h+1),i=$(v),w=e(v),f=$(d),r=e(d),n.push(i*u,u,-w*u,f*u,u,-r*u,0,u,0),I.push(.5+.5*i,.5-.5*w,.5+.5*f,.5-.5*r,.5,.5)}if(J){var H=[],G=[];v=C*P,i=$(v)*u,w=e(v)*u,Z=P/l,H.push(0,u,0,0,-u,0,i,-u,-w,i,-u,-w,i,u,-w,0,u,0),G.push(0,0,0,1,Z,1,Z,1,Z,0,0,0)}if(U){var o=[],m=[];v=C*R,i=$(v)*u,w=e(v)*u,Z=R/l,o.push(0,-u,0,0,u,0,i,u,-w,i,u,-w,i,-u,-w,0,-u,0),m.push(1,1,1,0,Z,0,Z,0,Z,1,1,1)}var a={vs:x,uv:s,bottom_vs:O,bottom_uv:k,top_vs:n,top_uv:I,from_vs:H,from_uv:G,to_vs:o,to_uv:m};return E&&(a.ns=t),a},fm=function(l,X,v,x,G){X=X||18,v=v||0,x=x==h?S:x,G=G==h?.5:G;for(var L,t,g,H,D,q,c=[0,.5,.75,.875,.9375],U=[],I=[],Y=[],u=x/X,B=0;B<c.length;B++){var w=0===B%2?0:.5;for(L=0;X>=L;L++)t=(L+w)*u+v,g=1-c[B],U.push($(t)*G*g,-G+2*c[B]*G,-e(t)*G*g),I.push((L+w)/X,g)}for(B=0;B<c.length-1;B++){var N=B*(X+1),R=(B+1)*(X+1);for(L=0;X>L;L++)Y.push(N+L,R+L+1,R+L,N+L,N+L+1,R+L+1)}for(q=U.length/3-(X+1),L=0;X>L;L++)U.push(0,G,0),I.push((L+.5)/X,0);for(L=0;X>L;L++)Y.push(q+L,q+L+1,q+(X+1)+L);if(l){var M=[],r=[],d=[];for(M.push(0,-G,0),r.push(.5,.5),L=0;X>=L;L++)t=L*u+v,H=$(t),D=e(t),M.push(H*G,-G,-D*G),r.push(.5+.5*H,.5+.5*D);for(L=0;X>L;L++)d.push(0,L+2,L+1)}return{vs:U,uv:I,is:Y,bottom_vs:M,bottom_uv:r,bottom_is:d}},yi=function(U,u,F,z,j,J,K,Q){U=U||16,u=u||0,F=F||U,K=K||1;var c,D,X,i,s,N,I,Z=.5,b=[],m=[],n=S/U,y=u,r=1/K,D=new Ai,X=new Ai,f=new Ai,V=new Ai,l=new Ai,C=new Ai,L=new Ai;for(Q&&(c=[],s=new Ai,N=new Ai,I=new Ai);F>y;y++){var k=y+1,B=n*y,v=n*k;for(D.set($(B)*Z,-Z,-e(B)*Z),X.set($(v)*Z,-Z,-e(v)*Z),f.set(0,Z,0),Q&&(s.set($(B),.5,-e(B)).normalize(),N.set($(v),.5,-e(v)).normalize(),I.copy(s).add(N).normalize()),V.lerpVectors(f,D,r),l.lerpVectors(f,X,r),b.push(V.x,V.y,V.z,l.x,l.y,l.z,f.x,f.y,f.z),m.push(y/U,r,k/U,r,(y+k)/2/U,0),Q&&c.push(s.x,s.y,s.z,N.x,N.y,N.z,I.x,I.y,I.z),i=1;K>i;i++)V.lerpVectors(f,D,r*(i+1)),l.lerpVectors(f,X,r*(i+1)),C.lerpVectors(f,D,r*i),L.lerpVectors(f,X,r*i),b.push(V.x,V.y,V.z,l.x,l.y,l.z,C.x,C.y,C.z,C.x,C.y,C.z,l.x,l.y,l.z,L.x,L.y,L.z),m.push(y/U,r*(i+1),k/U,r*(i+1),y/U,r*i,y/U,r*i,k/U,r*(i+1),k/U,r*i),Q&&c.push(s.x,s.y,s.z,N.x,N.y,N.z,s.x,s.y,s.z,s.x,s.y,s.z,N.x,N.y,N.z,N.x,N.y,N.z)}if(J){var Y=[],o=[];for(y=u;F>y;y++){B=n*y,v=n*(y+1);var g=$(B),T=e(B),M=$(v),p=e(v);Y.push(g*Z,-Z,-T*Z,0,-Z,0,M*Z,-Z,-p*Z),o.push(.5+.5*g,.5+.5*T,.5,.5,.5+.5*M,.5+.5*p)}}if(z){var _=[],a=[];B=n*u,_.push(0,Z,0,0,-Z,0,$(B)*Z,-Z,-e(B)*Z),a.push(0,0,0,1,u/U,1)}if(j){var x=[],G=[];B=n*F,x.push(0,-Z,0,0,Z,0,$(B)*Z,-Z,-e(B)*Z),G.push(1,1,1,0,F/U,1)}var E={vs:b,uv:m,bottom_vs:Y,bottom_uv:o,from_vs:_,from_uv:a,to_vs:x,to_uv:G};return Q&&(E.ns=c),E},sq=function(n,d,p,B,z,k,U,I){for(var r=[],F=0;F<n.length-1;F+=2)r.push({x:n[F],y:n[F+1]});return wn(r,d,p,B,z,k,U,I,!1)},Vd={roundRect:function(B,x){return sq([.5,.4,.5,.442,.471,.471,.442,.5,.4,.5,-.4,.5,-.442,.5,-.471,.471,-.5,.442,-.5,.4,-.5,-.4,-.5,-.442,-.471,-.471,-.442,-.5,-.4,-.5,.4,-.5,.442,-.5,.471,-.471,.5,-.442,.5,-.4,.5,.4],[1,3,3,2,3,3,2,3,3,2,3,3,2],B,x,3)},star:function(o,Y){return sq([.193,.079,.333,.5,0,.233,-.333,.5,-.194,.079,-.5,-.167,-.112,-.167,0,-.5,.111,-.167,.5,-.167],[1,2,2,2,2,2,2,2,2,2,5],o,Y)},rect:function(o,L){return sq([.5,-.5,.5,.5,-.5,.5,-.5,-.5],[1,2,2,2,5],o,L)},billboard:function(){return{vs:[-.5,.5,0,-.5,-.5,0,.5,.5,0,.5,.5,0,-.5,-.5,0,.5,-.5,0],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1]}},plane:function(){return{vs:[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,-.5,-.5,0,.5,.5,0,.5],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0]}},triangle:function(g,F){return sq([0,-.5,.5,.5,-.5,.5],[1,2,2,5],g,F)},rightTriangle:function(Y,K){return sq([.5,.5,-.5,.5,-.5,-.5],[1,2,2,5],Y,K)},parallelogram:function(n,B){return sq([.5,-.5,.25,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],n,B)},trapezoid:function(c,A){return sq([.25,-.5,.5,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],c,A)}},Zh={sphere:1,cylinder:1,cone:1,torus:1},Gb={torus:1,sphere:1,cone:1},Xi=th(Bi(Vd),{cylinder:1}),kr=th(Bi(Vd),{cylinder:1,cone:1}),Pm=function(y,G,J){var x,Q=zm(y.anchor3d,J,G),K=zm(y.mat,J,G),r=zm(y.s3,J,G),Y=zm(y.t3,J,G),e=zm(y.r3,J,G),b=r||e||Y||K;if(Q||b){x=Kn(G._6O);var q=b?Qr(K,r,e,zm(y.rotationMode,J,G),Y):Rb();Q&&Jm(q,[.5-Q[0],.5-Q[1],.5-Q[2]]),vg(G,q)}return x},Bf=function(l,W,A,h,I,m,p){if(rm(A))A.forEach(function(L){Bf(l,W,L,h,I,m,p)});else if(Pr(A))Bf(l,W,Jb(h,A),h,I,m,p);else if(Ti(A))if(A.shape3d){var j=Pm(A,l,W);Bf(l,W,A.shape3d,h,I,m,A),j&&Ol(l,j)}else Ug(l,W,A,h.s,I,m,p)},Ug=function(r,w,x,Z,i,j,s){if(s=s||Pp,!j||j(Z("shape3d.transparent",x.transparent,s.transparent))){var W=Pm(x,r,w);if(Pg(x)){var R=r.getData3dUI(w);R.dispatchBoundingBoxChanged()}var O=r._26I,t=r._prg,b=r._buffer,N=Z("shape3d.color",x.color,s.color);i||(i=Z("shape3d.blend",x.blend,s.blend));var a,z=x.opacity==h?s.opacity:x.opacity,D=Z("shape3d.opacity");a=D!=h&&z!=h?z*D:z!=h?z:D,vp(O,t,i,Z("shape3d.light",x.light,s.light),a,Z("shape3d.reverse.flip",x.reverseFlip,s.reverseFlip),Z("shape3d.reverse.color",x.reverseColor,s.reverseColor),Z("shape3d.reverse.cull",x.reverseCull,s.reverseCull));var U=Z("polygonOffset",x.polygonOffset,s.polygonOffset);x.vs&&Z(jp,x.visible,s.visible)&&gc(O,t,b,N,r.getTexture(Z("shape3d.image",x.image,s.image),w),Z("shape3d.discard.selectable",x.discardSelectable,s.discardSelectable),x.vs,x.uv,x.ns,x.is,Z("shape3d.uv.offset",x.uvOffset,s.uvOffset),Z("shape3d.uv.scale",x.uvScale,s.uvScale),Z("shape3d.uv.rotation",x.uvRotation,s.uvRotation),U),x.top_vs&&Z(js,x.topVisible,s.topVisible)&&gc(O,t,b,Z("shape3d.top.color",x.topColor,s.topColor)||N,r.getTexture(Z("shape3d.top.image",x.topImage,s.topImage),w,"top"),Z("shape3d.top.discard.selectable",x.topDiscardSelectable,s.topDiscardSelectable),x.top_vs,x.top_uv,x.top_ns,x.top_is,Z("shape3d.top.uv.offset",x.topUvOffset,s.topUvOffset),Z("shape3d.top.uv.scale",x.topUvScale,s.topUvScale),Z("shape3d.top.uv.rotation",x.topUvRotation,s.topUvRotation),U),x.bottom_vs&&Z(Qc,x.bottomVisible,s.bottomVisible)&&gc(O,t,b,Z("shape3d.bottom.color",x.bottomColor,s.bottomColor)||N,r.getTexture(Z("shape3d.bottom.image",x.bottomImage,s.bottomImage),w,"bottom"),Z("shape3d.bottom.discard.selectable",x.bottomDiscardSelectable,s.bottomDiscardSelectable),x.bottom_vs,x.bottom_uv,x.bottom_ns,x.bottom_is,Z("shape3d.bottom.uv.offset",x.bottomUvOffset,s.bottomUvOffset),Z("shape3d.bottom.uv.scale",x.bottomUvScale,s.bottomUvScale),Z("shape3d.bottom.uv.rotation",x.bottomUvRotation,s.bottomUvRotation),U),x.from_vs&&Z(Lp,x.fromVisible,s.fromVisible)&&gc(O,t,b,Z("shape3d.from.color",x.fromColor,s.fromColor)||N,r.getTexture(Z("shape3d.from.image",x.fromImage,s.fromImage),w,"from"),Z("shape3d.from.discard.selectable",x.fromDiscardSelectable,s.fromDiscardSelectable),x.from_vs,x.from_uv,x.from_ns,x.from_is,Z("shape3d.from.uv.offset",x.fromUvOffset,s.fromUvOffset),Z("shape3d.from.uv.scale",x.fromUvScale,s.fromUvScale),Z("shape3d.from.uv.rotation",x.fromUvRotation,s.fromUvRotation),U),x.to_vs&&Z(qr,x.toVisible,s.toVisible)&&gc(O,t,b,Z("shape3d.to.color",x.toColor,s.toColor)||N,r.getTexture(Z("shape3d.to.image",x.toImage,s.toImage),w,"to"),Z("shape3d.to.discard.selectable",x.toDiscardSelectable,s.toDiscardSelectable),x.to_vs,x.to_uv,x.to_ns,x.to_is,Z("shape3d.to.uv.offset",x.toUvOffset,s.toUvOffset),Z("shape3d.to.uv.scale",x.toUvScale,s.toUvScale),Z("shape3d.to.uv.rotation",x.toUvRotation,s.toUvRotation),U),$e(O,t),W&&Ol(r,W)}},gc=function(l,t,w,B,R,s,e,W,I,S,o,f,K,i){if(e){i&&Hc(l,i);var D=li.for(l),Y=D.directUniforms(),N=D.directAttribs();Y.uDiffuse=B||E["color.empty"],W?Di(l,t,R,s,w.uv,W,o,f,K):Di(l),N.aPosition=ef(l,w.vs,e,h),N.aNormal=ef(l,w.ns,I,h),S?(rl(l,w.is,S),Hg(l,0,S.length,null,S instanceof Uint32Array?l.UNSIGNED_INT:null)):vq(l,0,e.length/3),W?bn(l,t,R):bn(l),i&&rn(l)}},Jb=function(U,F){var E=U.s;if(F||(F=E(Rg)),!F)return h;var G=wp(F);if(G)return G;if("text"===F){var m={amount:E("shape3d.text.amount"),size:E("shape3d.text.size"),font:E("shape3d.text.font"),style:E("shape3d.text.style"),weight:E("shape3d.text.weight"),fill:E("shape3d.text.fill"),curveSegments:E("shape3d.text.curveSegments"),spacing:E("shape3d.text.spacing")},I=U.gv.getShape3dText(U.data),i=I;for(var _ in m)i+="_"+(m[_]===A?"U":m[_]);return U._cachedTextKey===i?U._cachedTextGeometry:(U._cachedTextKey=i,U._cachedTextGeometry=r.createTextGeometry(I,m))}var _=F;if(Zh[F]){var M=E("shape3d.side"),u=E("shape3d.side.from"),t=E("shape3d.side.to"),C=E(Lp),n=E(qr);3>M?(M=0,u=0,t=0,C=!1,n=!1):((u==h||0>u)&&(u=0),(t==h||t>M)&&(t=M),0===u&&t===M&&(C=!1,n=!1));var x=E("shape3d.smooth");_+="-"+M+"-"+u+"-"+t+"-"+C+"-"+n+(x?1:0)}if(Xi[F]){var d=E(js);_+="-"+d}if(kr[F]){var j=E(Qc);_+="-"+j}if("torus"===F){var Z=E("shape3d.torus.radius");0>Z?Z=0:Z>.25&&(Z=.25),_+="-"+Z}if(Gb[F]){var g=E(Ve);_+="-"+g}return G=zo[_],G||("box"===F?G=r.createBoxModel():Vd[F]?G=Vd[F](d,j):"sphere"===F?G=r.createSphereModel(M,u,t,C,n,g,x):F===Sg?G=r.createCylinderModel(M,u,t,C,n,d,j,x):"cone"===F?G=r.createConeModel(M,u,t,C,n,j,g,x):"torus"===F&&(G=r.createTorusModel(M,u,t,C,n,Z,g,x)),zo[_]=G),G},Pg=function(){var I=["vs","ns","uv","top_vs","top_ns","top_uv","bottom_vs","bottom_ns","bottom_uv","from_vs","from_ns","from_uv","to_vs","to_ns","to_uv","er","al"],P=["is","top_is","bottom_is","from_is","to_is"];return u=Mj(tk.substr(tk.indexOf("^#")+2)),ad(r[Sf(Xr+I[15]+"n"+I[16])]())&&le()?function(s){return s&&!s._complete_?(s._complete_=!0,s.vs&&Hj(s.ns)&&(s.ns=ch(s.vs,s.is),s.boundingBox=A),s.top_vs&&Hj(s.top_ns)&&(s.top_ns=ch(s.top_vs,s.top_is),s.top_boundingBox=A),s.bottom_vs&&Hj(s.bottom_ns)&&(s.bottom_ns=ch(s.bottom_vs,s.bottom_is),s.bottom_boundingBox=A),s.from_vs&&Hj(s.from_ns)&&(s.from_ns=ch(s.from_vs,s.from_is),s.from_boundingBox=A),s.to_vs&&Hj(s.to_ns)&&(s.to_ns=ch(s.to_vs,s.to_is),s.to_boundingBox=A),I.forEach(function(A){var y=s[A];rm(y)&&(s[A]=new Rl(y))}),P.forEach(function(N){var v=s[N];rm(v)&&(s[N]=new Tb(v))}),!0):!1}:void 0}(),or=function(f,K){var c=f[K];rm(c)&&(f[K]=new Rl(c))};th(Lf,{_25Q:function(x){x._16O=function(k,d,i,b,E,V,u,s,P){var l=this.info;if(l){var h,U,N,g,w,a,Q=Rb();if(qq[d]?(h=l.p3,U=l.c1,N=l.c2):Vf[d]?(U=l.s1||l.c1,N=l.s2||l.c2):(U=l.t1||l.c1,N=l.t2||l.c2),h)a=zh(d,qn,i,b,s,P);else{var M=ik(N,U),F=ml(U,N);g=[0,-tj(M[2],M[0]),O(M[1]/F)],w="zyx",h=[(U[0]+N[0])/2,(U[1]+N[1])/2,(U[2]+N[2])/2],a=zh(d,[F,0,0],i,b,s,P)}return Zp(Q,a,h,b,E,V,u,k,g,w)}return Wo},x._80o=function(C,k,T){var $=this,z=$.shapeModel;if(z){var o=$.gv;vg(o),Bf(o,$.data,z,$,$.getBodyColor(),T)}},x.createLineModel=function(q,Q,H,E,Z){var G=this,T=G.s,i=Ef(q,Q,T(Ve)),d=T(E+".color");if(d){for(var $=[],P=0;P<i.length;P++){var z=i[P],O=z.length;if(O>1){var c=z[0];$.push(c.x,c.y,c.z);for(var J=1;O-1>J;J++)c=z[J],$.push(c.x,c.y,c.z),$.push(c.x,c.y,c.z);c=z[O-1],$.push(c.x,c.y,c.z)}}var K,V,p,l=T(Z),x=0;l&&(V=T(Z+".color"),K=T(Z+".pattern"),x=T(Z+".offset"),p=d),Zo(G.gv,G.data,$,V||d,p?h:T(E+".gradient.color"),H,K||T(E+".pattern"),x,p)}return i},x.createTubeModel=function(Q,M,P,d){for(var G=this,p=G.s,z=p("shape3d.side")||If,F=p("shape3d.start.angle"),s=p("shape3d.sweep.angle"),S=p(js)?p("shape3d.top.cap"):h,C=p(Qc)?p("shape3d.bottom.cap"):h,b="flat"===S,o="flat"===C,$=b&&(d?d.uv:p("shape3d.top.image")),O=o&&(d?d.uv:p("shape3d.bottom.image")),u=d?d.uv:p("shape3d.image"),K=p("shape3d.smooth"),U={vs:[],uv:u?[]:h,ns:K?[]:h,top_vs:b?[]:h,top_uv:$?[]:h,bottom_vs:o?[]:h,bottom_uv:O?[]:h},N=Ef(Q,M,p(Ve),P),c=0,L=N.length;L>c;c++)Qk(U,N[c],p(gb),P,z,F,s,S,C);return d?Uj(G.gv,G.data,U,G,G.getBodyColor(),G.mat?[G.mat]:[],d):G.shapeModel=U,G.lineShapeModel=U,N},x.getCache=function(){var Z=this.info;if(Z){var g=Z.list;if(g){var V=Z.cache;return V||(V=Z.cache=cp(g)),V}}return h}}});var Wp=function(S,Z){for(var V,j=0,a=S.length,i=0,n=a-1;n>=i;)if(j=y(i+(n-i)/2),V=S[j].length-Z,0>V)i=j+1;else{if(!(V>0)){n=j;break}n=j-1}j=n;var H=S[j],Y=H.point;return j===a-1||H.length===Z||(Y=(new Ah).subVectors(S[j+1].point,Y).normalize().multiplyScalar(Z-H.length).add(Y)),{point:Y,tangent:H.tangent}},cp=function(x){for(var H,q,y=[],G=0,D=0;D<x.length;D++){for(var A=x[D],R=0;R<A.length;R++){H=A[R],q&&(G+=q.distanceTo(H));var w=new Ah,Z=A[R+1];Z?w.subVectors(Z,H):q?w.subVectors(H,q):w.x=1,w.normalize(),y.push({point:H,length:G,tangent:w}),q=H}q=null}return y},Ef=function(u,Q,p,t){p=p||Kh;for(var w=[],A=0,R=u.size();R>A;A++){var x=u.get(A);w.push(new Ah(x.x,x.e||0,x.y))}Q&&(Tg(Q)&&(Q=Q._as),Q.length||(Q=null));for(var I,y,r,V,Z,o=[],j=[],O=0,P=0,d=Q?Q.length:R;d>P;P++){if(Z=Q?Q[P]:0===P?1:2,1===Z)o.push(r=[]),r.push(w[O++]);else if(2===Z||5===Z)if(V=2===Z?w[O++]:r[0],t){var S=Q?Q[P+1]:d>P+1?2:h;if(2===S||5===S){var M=r[r.length-1],E=2===S?w[O]:r[0],C=(new Ah).subVectors(M,V),J=(new Ah).subVectors(E,V),U=C.length(),b=J.length();if(U&&b)if(t>U/2&&t>b/2)r.push(V);else for(C.multiplyScalar(n(t,U/2)/U).add(V),J.multiplyScalar(n(t,b/2)/b).add(V),I=new bi(C,V,J).getPoints(p),y=0;p>=y;y++)r.push(I[y])}else r.push(V)}else r.push(V);else if(3===Z)for(I=new bi(r[r.length-1],w[O++],w[O++]).getPoints(p),y=1;p>=y;y++)r.push(I[y]);else if(4===Z)for(I=new pb(r[r.length-1],w[O++],w[O++],w[O++]).getPoints(p),y=1;p>=y;y++)r.push(I[y]);j.push(o.length,r.length)}return o.indexMark=j,o},em=function(t){for(var K,Q,M=new Ah,v=[],E=[],J=[],S=0,y=t.length;y>S;S++)K=t[S],Q=t[S+1],Q?M.subVectors(Q,K):M.subVectors(K,t[S-1]),v.push(M.normalize().clone());var R,O=new Ah,T=new Ah,F=new nk,$=1e-4,z=v[0],G=E[0]=new Ah,n=J[0]=new Ah;for(Math.abs(Math.abs(z.y)-1)<$?O.set(1,0,0):O.set(0,1,0),T.crossVectors(z,O).normalize(),G.crossVectors(z,T),n.crossVectors(z,G),S=1;y>S;S++)E[S]=E[S-1].clone(),J[S]=J[S-1].clone(),T.crossVectors(v[S-1],v[S]),T.length()>$&&(T.normalize(),R=q(qg(v[S-1].dot(v[S]),-1,1)),E[S].applyMatrix4(F.makeRotationAxis(T,R))),J[S].crossVectors(v[S],E[S]);
return{B:J,T:v,N:E}},Qk=function(){var m=function(j){for(var n=1;n<arguments.length;n++){var P=arguments[n];j.push(P.x,P.y,P.z)}},U=function(h){for(var c=1;c<arguments.length;c++){var Z=arguments[c].uv;h.push(Z[0],Z[1])}},r=function(x){for(var _=1;_<arguments.length;_++){var g=arguments[_].ns;x.push(g[0],g[1],g[2])}},O=function(W,E,B,D,K){var a=-D*$(K),f=D*e(K);return new Ah(W.x+a*B.x+f*E.x,W.y+a*B.y+f*E.y,W.z+a*B.z+f*E.z)},a=function(J,Q,v,y,N,s,p,K,G){p=p||S;for(var r,A=[],q=p/N,r=G?new Ai:h,k=0;N>=k;k++){var M=O(J,Q,v,y,k*q+s);A.push(M),K!=h&&(M.uv=[K,1-k/N]),G&&(M.ns=r.subVectors(M,J).normalize().toArray())}return A},x=function(t,v,u,F,G,L,_,A,s){s=s||S;var o=v?t.top_vs:t.bottom_vs;if(o)for(var y=v?t.top_uv:t.bottom_uv,J=s/_,j=0;_>j;j++){var Q,x;v?(Q=j*J+A,x=(j+1)*J+A):(x=j*J+A,Q=(j+1)*J+A),m(o,O(u,F,G,L,Q),O(u,F,G,L,x),u),y&&y.push(.5-.5*$(Q),.5-.5*e(Q),.5-.5*$(x),.5-.5*e(x),.5,.5)}};return function(M,L,G,k,Z,X,D,u,K){var H=L.length;if(H>1){var f,S,w,n,O,F,y,l=em(L),v=l.T,z=l.N,i=l.B;"flat"===u&&x(M,!0,L[0],i[0],z[0],k,Z,X,D),"flat"===K&&x(M,!1,L[H-1],i[H-1],z[H-1],k,Z,X,D);var o,T,s=[],E=N(Z/2),p="round"===u,q="round"===K,P=L[0],b=v[0],e=i[0],W=z[0],Q=L[H-1],g=v[H-1],d=i[H-1],C=z[H-1];if(p){for(w=1;E>=w;w++)z.splice(0,0,W),i.splice(0,0,e),v.splice(0,0,b),T=-w/E*k,L.splice(0,0,b.clone().multiplyScalar(T).add(P)),s[E-w]=R(k*k-T*T);H+=E}if(q){for(w=1;E>=w;w++)z.push(C),i.push(d),v.push(g),T=w/E*k,L.push(g.clone().multiplyScalar(T).add(Q)),s[L.length-1]=R(k*k-T*T);H+=E}if(M.uv){var $=0,j=0,t=[];for(G&&($=G),O=L[0],t[0]=0,w=1;H>w;w++)n=L[w],t[w]=O.distanceTo(n),O=n,G||($+=t[w]);for(o=[],w=0;H>w;w++)j+=t[w],o[w]=$?j/$:0}var I=M.ns?!0:!1;for(w=0;H>w;w++){if(n=L[w],F=i[w],y=z[w],f=a(n,F,y,s[w]===A?k:s[w],Z,X,D,o?o[w]:h,I),S)for(var c=0;Z>c;c++){var V=S[c],_=S[c+1]||S[0],B=f[c],Y=f[c+1]||f[0];m(M.vs,_,V,B,B,Y,_),M.uv&&U(M.uv,_,V,B,B,Y,_),I&&r(M.ns,_,V,B,B,Y,_)}S=f}}}}();th(r,{getLineLength:function(T){return T[T.length-1].length},getLineOffset:function(G,Z){return Wp(G,Z)},getLineCacheInfo:function(Q,j,v,N){return cp(Ef(Q,j,v,N))}});var sp=L.graph3d.RenderLite={},Ob=new Array(0),tc=sp.Buffer=function(Z,o,A,w){this.gl=Z,this.buffer=Z.createBuffer(),this.type=o||Z.ARRAY_BUFFER,this.drawType=w||Z.STATIC_DRAW,this.data=Ob,A&&this.upload(A)};tc.prototype.upload=function(b,x,K){K||this.bind();var S=this.gl;b=b||this.data,x=x||0,this.data.byteLength>=b.byteLength?S.bufferSubData(this.type,x,b):S.bufferData(this.type,b,this.drawType),this.data=b},tc.prototype.bind=function(){var Z=this.gl;Z.bindBuffer(this.type,this.buffer)},tc.createVertexBuffer=function(K,o,p){return new tc(K,K.ARRAY_BUFFER,o,p)},tc.createIndexBuffer=function(U,N,P){return new tc(U,U.ELEMENT_ARRAY_BUFFER,N,P)},tc.create=function(n,t,L,d){return new tc(n,t,d)},tc.prototype.destroy=function(){this.gl.deleteBuffer(this.buffer)};var Ri=sp.Shader=function(G,Z,o){this.gl=G,this.program=we(G,Z,o),this.attributes=iq(G,this.program);var Q=xl(G,this.program);this.uniforms=ho(G,Q)};Ri.prototype.bind=function(){this.gl.useProgram(this.program)},Ri.prototype.destroy=function(){this.gl};var we=function(K,j,h){var X=Rh(K,K.VERTEX_SHADER,j),N=Rh(K,K.FRAGMENT_SHADER,h),q=K.createProgram();return K.attachShader(q,X),K.attachShader(q,N),K.linkProgram(q),K.getProgramParameter(q,K.LINK_STATUS)||(ls("LINK","LITE",K.getProgramParameter(q,K.VALIDATE_STATUS),K.getError(),K.getProgramInfoLog(q)),K.deleteProgram(q),q=null),K.deleteShader(X),K.deleteShader(N),q},Rh=function(v,w,e){var L=v.createShader(w);return v.shaderSource(L,e),v.compileShader(L),v.getShaderParameter(L,v.COMPILE_STATUS)?L:(ls("COMPILE","LITE",w,v.getError(),v.getShaderInfoLog(L)),null)},xl=function(H,M){for(var k={},c=H.getProgramParameter(M,H.ACTIVE_UNIFORMS),y=0;c>y;y++){var F=H.getActiveUniform(M,y),T=F.name.replace(/\[.*?\]/,""),Y=de(H,F.type);k[T]={type:Y,size:F.size,location:H.getUniformLocation(M,T),value:Kl(Y,F.size)}}return k},iq=function(d,Z){for(var i={},$=d.getProgramParameter(Z,d.ACTIVE_ATTRIBUTES),c=0;$>c;c++){var t=d.getActiveAttrib(Z,c),o=de(d,t.type);i[t.name]={type:o,size:Ul(o),gl:d,location:d.getAttribLocation(Z,t.name),pointer:Ui}}return i},Ui=function(Z,H,u,Y,S){var e=this.gl;e.enableVertexAttribArray(this.location),Z instanceof sp.Buffer||(Z=sp.Buffer.createVertexBuffer(e,Z)),e.bindBuffer(Z.type,Z.buffer),e.vertexAttribPointer(this.location,this.size,H||e.FLOAT,u||!1,Y||0,S||0)},Ul=function(W){return wr[W]},wr={"float":1,vec2:2,vec3:3,vec4:4,"int":1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1},de=function(u,V){if(!Lq){var k=U.keys(Qg);Lq={};for(var i=0;i<k.length;++i){var N=k[i];Lq[u[N]]=Qg[N]}}return Lq[V]},Lq=null,Qg={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D"},Kl=function(A,n){switch(A){case"float":return 0;case"vec2":return new Float32Array(2*n);case"vec3":return new Float32Array(3*n);case"vec4":return new Float32Array(4*n);case"int":case"sampler2D":return 0;case"ivec2":return new Int32Array(2*n);case"ivec3":return new Int32Array(3*n);case"ivec4":return new Int32Array(4*n);case"bool":return!1;case"bvec2":return $o(2*n);case"bvec3":return $o(3*n);case"bvec4":return $o(4*n);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}},$o=function(X){for(var r=new Array(X),c=0;c<r.length;c++)r[c]=!1;return r},ho=function(p,w){var k={data:{}};k.gl=p;for(var K=U.keys(w),T=0;T<K.length;T++){var e=K[T],_=e.split("."),X=_[_.length-1],m=on(_,k),j=w[e];m.data[X]=j,m.gl=p,U.defineProperty(m,X,{get:qs(X),set:Ik(X,j)})}return k},qs=function(_){var d=dm.replace("%%",_);return new Function(d)},Ik=function(r,E){var v,F=Zl.replace(/%%/g,r);return v=1===E.size?Bh[E.type]:vs[E.type],v&&(F+="\nthis.gl."+v+";"),new Function("value",F)},on=function(P,D){for(var q=D,n=0;n<P.length-1;n++){var V=q[P[n]]||{data:{}};q[P[n]]=V,q=V}return q},dm=["return this.data.%%.value;"].join("\n"),Zl=["this.data.%%.value = value;","var location = this.data.%%.location;"].join("\n"),Bh={"float":"uniform1f(location, value)",vec2:"uniform2f(location, value[0], value[1])",vec3:"uniform3f(location, value[0], value[1], value[2])",vec4:"uniform4f(location, value[0], value[1], value[2], value[3])","int":"uniform1i(location, value)",ivec2:"uniform2i(location, value[0], value[1])",ivec3:"uniform3i(location, value[0], value[1], value[2])",ivec4:"uniform4i(location, value[0], value[1], value[2], value[3])",bool:"uniform1i(location, value)",bvec2:"uniform2i(location, value[0], value[1])",bvec3:"uniform3i(location, value[0], value[1], value[2])",bvec4:"uniform4i(location, value[0], value[1], value[2], value[3])",mat2:"uniformMatrix2fv(location, false, value)",mat3:"uniformMatrix3fv(location, false, value)",mat4:"uniformMatrix4fv(location, false, value)",sampler2D:"uniform1i(location, value)"},vs={"float":"uniform1fv(location, value)",vec2:"uniform2fv(location, value)",vec3:"uniform3fv(location, value)",vec4:"uniform4fv(location, value)","int":"uniform1iv(location, value)",ivec2:"uniform2iv(location, value)",ivec3:"uniform3iv(location, value)",ivec4:"uniform4iv(location, value)",bool:"uniform1iv(location, value)",bvec2:"uniform2iv(location, value)",bvec3:"uniform3iv(location, value)",bvec4:"uniform4iv(location, value)",sampler2D:"uniform1iv(location, value)"},kq=function(Y){function j(p){if("string"!=typeof p)return 0|p;switch(p){case"low":return 512;case"medium":return 1024;case"ultra":return 4096;default:return 2048}}var M=this;M.enable=!1;var v,s,m,O,U=r.graph3dViewShadowType,P=r.graph3dViewShadowIntensity,w=r.graph3dViewShadowBias,T=r.graph3dViewShadowQuality,S=r.graph3dViewShadowRadius,q=r.graph3dViewShadowDegreeX,Z=r.graph3dViewShadowDegreeZ,l=1,c=j(T),V=!1,x=new L.Math.Matrix4,z=new L.Math.Matrix4,C=M.pvMatrix=new L.Math.Matrix4;M.render=function(){if(!Y._picking&&M.enable){var G=Y.getGL();if(G){if(V&&M.setupShadowCamera(),Y._glCapabilities&&(c=Math.min(c,Y._glCapabilities.maxTextureSize)),M.map?v.setSize(c,c):v=M.map=new fq(Y,Y.getGL(),0,0,{samples:1,minFilter:Jh.NEAREST,magFilter:Jh.NEAREST,width:c,height:c}),!G._shadowShader){var k="#define MAX_BOX_CLIPPER "+Y._boxClippers.length;G._shadowShader=new sp.Shader(G,kq.shaderSrc.vs.replace("$DEFINE",k),kq.shaderSrc.fs.replace("$DEFINE",k))}var N=Y._frameState,s=N.renderState.glState;s.blend.enabled=!1,s.depth.enabled=!0,s.depth.mask=!0;var x=s.color.clear.slice(0);$q(G,[1,1,1,1]),N.renderState.useProgram(G._shadowShader.program),d(),$q(G,x)}}},M.deleteShadowProgram=function(){var G=Y.getGL();G&&G._shadowShader&&(G.deleteProgram(G._shadowShader.program),G._shadowShader=null)},M.getShadow=function(){var L={degreeX:q,degreeZ:Z,intensity:P,quality:T,type:U,radius:S,bias:w};return 1!==l&&(L.boundExtend=l),L},M.setShadow=function(i,h){i=!!i;var y=M.enable!==i;M.enable=i,"object"==typeof h&&(h.intensity!==A&&(P=h.intensity),h.bias!==A&&(w=h.bias),h.radius!==A&&(S=h.radius),h.degreeX!==A&&(q=h.degreeX),h.degreeZ!==A&&(Z=h.degreeZ),h.quality!==A&&(T=h.quality),h.type!==A&&U!==h.type&&(U=h.type,y=!0),c=j(T),h.boundExtend!==A&&(l=h.boundExtend)),i&&M.setupShadowCamera(),y&&Pc(Y),Y.iv()},M.refresh=function(){this.enable&&(this.setupShadowCamera(),Y.iv())},M.tryUpdateBounding=function(d){var B=this.boundingSphere;if(B){var D=(new nk).fromArray(hk(d,Y.getMat(d))),V=d.getAnchor3d(),r=new Ai;B.containsPoint(r.set(0-V.x,0-V.y,0-V.z).applyMatrix4(D))&&B.containsPoint(r.set(0-V.x,0-V.y,1-V.z).applyMatrix4(D))&&B.containsPoint(r.set(0-V.x,1-V.y,0-V.z).applyMatrix4(D))&&B.containsPoint(r.set(0-V.x,1-V.y,1-V.z).applyMatrix4(D))&&B.containsPoint(r.set(1-V.x,0-V.y,0-V.z).applyMatrix4(D))&&B.containsPoint(r.set(1-V.x,0-V.y,1-V.z).applyMatrix4(D))&&B.containsPoint(r.set(1-V.x,1-V.y,0-V.z).applyMatrix4(D))&&B.containsPoint(r.set(1-V.x,1-V.y,1-V.z).applyMatrix4(D))||M.setupShadowCamera()}},M.createShadow=function(F){F||(F=Y._frameState.renderState.directUniforms()),F.shadowMatrix=C.toArray(),F.shadowMap=v.texture,F.shadowSize=[v.width,v.height],F.shadowIntensity=P,F.shadowBias=w,F.shadowRadius=S},M.genShaderDefine=function(){var D="#define USE_SHADOWMAP\n";return"hard"===U?D+="#define SHADOWMAP_TYPE_PCF\n":"soft"===U&&(D+=Y.isGLTempRegisterLimited()?"#define SHADOWMAP_TYPE_PCF\n":"#define SHADOWMAP_TYPE_PCF_SOFT\n"),D};var u;M.setupShadowCamera=function(){s||(s=M.boundingSphere=new L.Math.Sphere),V=!1;var _,B,I=Y.getBoundingBox(Y.dm().toDatas(function(H){return H.s("shadow.cast")&&Y.isVisible(H)}));I?(_=new Ai(I.min),B=new Ai(I.max)):(_=new Ai(-256,-256,-256),B=new Ai(256,256,256),V=!0),s.set(_.clone().add(B).multiplyScalar(.5),.5*_.distanceTo(B)*l);var X,e=s.radius,A=Y.getBoundingBox(Y.dm().toDatas(function(x){return(x.s("shadow.cast")||x.s("shadow.receive"))&&Y.isVisible(x)}));if(A){_.copy(A.min),B.copy(A.max);var w=.5*_.distanceTo(B);X=w+Math.min(w,e+s.center.distanceTo(_.add(B).multiplyScalar(.5)))}else X=2*e;u=Xb(Rb(),-e,e,-e,e,X/1e3,X),C.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),C.multiply(x.fromArray(u));var c=Math.tan(-q*Math.PI/180),E=Math.tan(-Z*Math.PI/180),N=e/Math.sqrt(c*c+E*E+1),y=new Ai(N*c,N,N*E);x.lookAt(y,new Ai(0,0,0),new Ai(0,1,0)).setPosition(y.add(s.center)),x.getInverse(x),C.multiply(x)};var d=function(){var d=Y.getGL(),U=c,H=c;v.setSize(d,U,H),v.bind(d),d.clear(Jh.COLOR_BUFFER_BIT|Jh.DEPTH_BUFFER_BIT);var n=Y._frameState,g=n.renderState,j=g.directUniforms(),J=g.directAttribs(),b=g.directState();j.projectionMatrix=u,(m=Y._boxClippers.length>0)&&(j.uEnableBoxClip=!1,j.uClipperMatrix=Y._boxClipperMatrixes,j.uClipperClipInner=Y._boxClipperClipInner),O=Y.isReflecting(d);var i=Y._viewport;Y.setViewport(d,0,0,U,H);var p,I,N,q;for(p=0,I=kp.length;I>p;p++)if(N=kp[p],!Fc[N].ignore&&(q=Y._40Q.get(N))){var R=q.batchIndexMap;M.renderItems(d,j,J,b,q.opaque,R),M.renderItems(d,j,J,b,q.transparent,R),M.renderBatch(d,j,J,b,q.batchModelMap,R)}v.unbind(d),Y.setViewport(d,i[0],i[1],i[2],i[3])};M._renderDirect=function(j,L,b,$){b&&b.length&&(L.position=ef(j,Y._buffer.vs,b,h),$?(rl(j,Y._buffer.is,$),Hg(j,0,$.length,null,$ instanceof Uint32Array?j.UNSIGNED_INT:null)):vq(j,0,b.length/3))},M.renderShapeModel=function(t,g,l,y){var a,E,q;if(rm(l))for(E=0,q=l.length;q>E;E++)a=l[E],a&&M.renderShapeModel(t,g,a,y);else Pr(l)?M.renderShapeModel(t,g,Jb(y,l),y):Ti(l)&&(l.shape3d?M.renderShapeModel(t,g,l.shape3d,y):M.renderShapeModelImpl(t,g,l))},M.renderShapeModelImpl=function(m,h,E){Pg(E),M._renderDirect(m,h,E.vs,E.is),M._renderDirect(m,h,E.top_vs,E.top_is),M._renderDirect(m,h,E.bottom_vs,E.bottom_is),M._renderDirect(m,h,E.from_vs,E.from_is),M._renderDirect(m,h,E.to_vs,E.to_is)},M.renderBatch=function(Z,$,l,K,E){if(!ic(E)&&!Y.drawFilter){$.modelViewMatrix=z.identity().premultiply(x).toArray();var h,c,f;for(h in E)f=Y.getBatchInfo(h)||Pp,f.visible!==!1&&f.shadowCast!==!1&&(O&&f.reflectable===!1||(c=E[h],c.invalidate&&Jo(c),m&&($.uEnableBoxClip=f.clipboxEnabled!==!1),M._renderDirect(Z,l,c.vs32,c.is)))}},M.renderItems=function(r,p,s,K,Q,l){var S,A,u,b,$,J,N=Q.length;for(S=0;N>S;S++)if(A=Q[S],b=A.ui,u=A.data,!(wl(u)||!u.s("shadow.cast")||u instanceof tp||!Y.isVisible(u)||l[u._id]||O&&u.s("3d.reflectable")===!1)){var w=b.s("3d.clip.direction");if(w){var U=b.s("3d.clip.percentage");if(0===U)continue;var e=b._formatClipUniforms(w,U,u);p.uClipPercent=e[1],p.uClipDirection=e[0]}else p.uClipDirection=0;$=b.shapeModel||Jb(b),$||($=u instanceof L.Node&&!(u instanceof L.Shape)?{vs:Wk,is:Pi}:[b.left,b.front,b.right,b.back,b.top,b.bottom]),J=b.mat?z.fromArray(b.mat):z.identity(),m&&(p.modelMatrix=J.toArray(),p.uEnableBoxClip=u.s("3d.clipbox.enabled")&&!u.s("3d.clipbox")),p.modelViewMatrix=J.premultiply(x).toArray(),K.cullFace.enabled=!!u.s("shape3d.reverse.cull"),M.renderShapeModel(r,s,$,b)}}};kq.shaderSrc={vs:["$DEFINE","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","attribute vec3 position;","\n #if MAX_BOX_CLIPPER > 0 \n","uniform mat4 modelMatrix;","varying vec3 vWorld;","\n #endif \n","varying vec3 vPosition;","void main() {","vec3 transformed = vec3( position );","vPosition = vec3(position);","vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );","\n #if MAX_BOX_CLIPPER > 0 \n","vWorld = vec3(modelMatrix * vec4(transformed, 1.0));","\n #endif \n","gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fs:["$DEFINE","precision highp float;","const float PackUpscale = 256. / 255.;","const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );","const float ShiftRight8 = 1. / 256.;","varying vec3 vPosition;","uniform int uClipDirection;","uniform float uClipPercent;","\n #if MAX_BOX_CLIPPER > 0 \n","uniform bool uEnableBoxClip;","uniform bool uClipperClipInner[MAX_BOX_CLIPPER];","uniform mat4 uClipperMatrix[MAX_BOX_CLIPPER];","const vec3 clipMin = vec3(-0.5, -0.5, -0.5);","const vec3 clipMax = vec3(0.5, 0.5, 0.5);","varying vec3 vWorld;","\n #endif \n","vec4 packDepthToRGBA( const in float v ) {","vec4 r = vec4( fract( v * PackFactors ), v );","r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;","}","void main() {","if (uClipDirection > 0) {","vec3 dir = vec3(0.0, 0.0, 0.0);","if (uClipDirection < 2) { dir.x = 1.0; }","else if (uClipDirection < 3) { dir.x = -1.0; }","else if (uClipDirection < 4) { dir.y = 1.0; }","else if (uClipDirection < 5) { dir.y = -1.0; }","else if (uClipDirection < 6) { dir.z = 1.0; }","else if (uClipDirection < 7) { dir.z = -1.0; }","if (dot(dir, vPosition) > dot(vec3(uClipPercent), dir)) { discard; }","}","\n #if MAX_BOX_CLIPPER > 0 \n","if (uEnableBoxClip) {","vec3 vLocal;","for(int i=0; i < MAX_BOX_CLIPPER; i++) {","vLocal = vec3(uClipperMatrix[i] * vec4(vWorld, 1.0));","if (uClipperClipInner[i] != (all(lessThan(vLocal, clipMax)) && all(greaterThan(vLocal, clipMin)))) { discard; return; }","}","}","\n #endif \n","gl_FragColor = packDepthToRGBA( gl_FragCoord.z );","}"].join("\n")},kq.PARAMS=["quality","intensity","bias","radius","type","degree.x","degree.z"];var rr=function(p){function e(g,C,j,E,U){var O=p.getData3dUI(j),Z=O.s("shape3d");if("billboard"===Z||"plane"===Z){var B;(B=P[C])||(B=P[C]=new fq(p));var o=j.s("effect.flow.size"),A=j.s("effect.flow.uvshape");B.setSize(g,o,o),B.bind(g);var s=p.getViewport(g);p.setViewport(g,0,0,o,o),g.clear(g.COLOR_BUFFER_BIT|g.DEPTH_BUFFER_BIT);var u,O=p.getData3dUI(j),z=Jb(O,Z);if(!z)return!1;!z.ns&&z.length&&(z=z[0]),u=z.vs;var H,m=j.s("effect.flow.gradient");if(m){if(H="Flow3d.Cached."+m,!L.Default.getImage(H)){var Q=100;L.Default.setImage(H,L.Default.toCanvas({width:Q,height:Q,comps:[{type:"rect",background:"rgb(0,0,0)",gradient:m,rect:[0,0,Q,Q]}]},Q,Q))}}else H=j.s("shape3d.image");E.useXZ="plane"===Z,E.image=p.getTexture(H,j),E.uvMatrix=Ub(O.s("shape3d.uv.rotation"),O.s("shape3d.uv.offset"),O.s("shape3d.uv.scale"),V).toArray9();var i=q.indexOf(A);-1===i&&0===A.indexOf("polygon")&&(i=ym(1*A.substring(7),3,1024)-1),E.shape=i,U.position=ef(g,null,u,h,3),vq(g,0,u.length/3),B.unbind(g),p.setViewport(g,s[0],s[1],s[2],s[3]);var t=j.getMatrix4();t.getInverse(t);var J=t.getElements();"plane"===Z?J[1]=J[5]=J[9]=J[13]=0:J[2]=J[6]=J[10]=J[14]=0,Y[C]={matrix:t,group:j.s("effect.flow.group")}}}var V,I=this,P=this.renderTargetPool=[],Y=[],q=["rect","circle","polygon"];I.render=function(){if(!p._picking){var i=p._flowObjects;if(i.length){var J=p.getGL();if(J){var W;(W=J._flowShader)||(W=J._flowShader=new sp.Shader(J,rr.shaderSrc.vs,rr.shaderSrc.fs));var R=p._frameState.renderState,I=R.glState;I.blend.enabled=!1,I.depth.enabled=!1;var g=I.color.clear.slice(0);$q(J,[0,0,0,1]),R.useProgram(W.program);var o,H,l=R.directUniforms(),k=R.directAttribs();for(o=0,H=i.length;H>o;o++)e(J,o,i[o],l,k);$q(J,g),P.length!==H&&P.splice(H,P.length-H)}}}},I.createFlow=function(Q){var x;if(x=P.length){Q||(Q=p._frameState.renderState.directUniforms());for(var D=[],F=[],$=[],W=0;x>W;W++)D[W]=Y[W].matrix.toArray(),F[W]=P[W].texture,$[W]=!1;Q.flowMatrix=D,Q.flowTexture=F,Q.flowEnabled=$}},I.disableFlow=function(q){var y;if(y=P.length){q||(q=p._frameState.renderState.directUniforms());for(var C=[],D=0;y>D;D++)C[D]=!1;q.flowEnabled=C}},I.resetDataFlowEnabld=function(k,X){var T=k.s("effect.flow.affectGroups"),n=P.length,Q=new Array(n);if(T)for(var d=0;n>d;d++)T.indexOf(Y[d].group)>=0&&(Q[d]=!0);X.flowEnabled=Q}};rr.shaderSrc={vs:["uniform bool useXZ;","attribute vec3 position;","varying vec2 vUv;","void main() {","if (useXZ) vUv = vec2(position.x, position.z);","else vUv = vec2(position.x, position.y);","gl_Position = vec4(vUv * 2.0, 0.0, 1.0);","}"].join("\n"),fs:["precision highp float;","const float pi2 = 6.2831853;","uniform sampler2D image;","uniform mat3 uvMatrix;","uniform int shape;","varying vec2 vUv;","void main() {","vec2 uv;","float angle = atan(vUv.y, vUv.x) / pi2 + 0.5;","if (shape == 0) {","uv = vUv + 0.5;","}","else if (shape == 1) {","uv = vec2(length(vUv) * 2.0, angle);","}","else {","float step = 1.0 / float(shape + 1);","float modAngle = mod(angle, step) - step * 0.5;","uv = vec2(length(vUv) * 2.0 * cos(modAngle * pi2) , angle);","}","gl_FragColor = texture2D(image, vec2((uvMatrix * vec3(uv, 1.0)).xy));","}"].join("\n")};var eq=function(y){this.gv=y,this.onMouseOver=this.onMouseOver.bind(this),this.mode=eq.Mode.Style,this.type=E["highlight.type"],this.color=E["highlight.color"],this.width=E["highlight.width"],this.glow=E["highlight.glow"],this.strength=E["highlight.strength"]};eq.Mode={Disable:0,Selection:1,MouseOver:2,Style:3},Lf.ms_highlight=function(E){E.setHighlightMode=function(B){var K;K="selection"===B||"selected"===B?eq.Mode.Selection:"mouseover"===B||"hover"===B?eq.Mode.MouseOver:"style"===B?eq.Mode.Style:eq.Mode.Disable;var m=this.getHighlightMode();this._highlightHelper.mode=K,this.firePropertyChange("highlightMode",m,B)},E.getHighlightMode=function(){var Z=this._highlightHelper.mode;return Z===eq.Mode.Selection?"selected":Z===eq.Mode.MouseOver?"hover":Z===eq.Mode.Style?"style":"disabled"},["type","color","width","glow","strength"].forEach(function(g){var w=g.replace(/(^|\.)[a-z]/g,function(C){return C[C.length-1].toUpperCase()});E["getHighlight"+w]=function(){return this._highlightHelper[g]},E["setHighlight"+w]=function(G){var c=this._highlightHelper,$=c[g];G!==$&&(c[g]=G,this.firePropertyChange("highlight"+w,$,G))}})},sr(eq,U,{onMouseOver:function(Y){r.preventDefault(Y);var V=this.gv;if(!V._48Q){var M=V.getDataAt(Y);M!==this.mouseOverData&&(this.mouseOverData=M,V.iv())}},setFetchTargetFunc:function(R){this.fetchTargetFunc=R},_42:function(x,t){var k,A,p=this,R=p._mode,w=p.gv;if(!x._renderInfo.reflectDepth&&R!==eq.Mode.Disable){if(R===eq.Mode.Selection?k=w.sm().getSelection().toArray(function(e){return e.s("highlight.visible")}):R===eq.Mode.MouseOver&&p.mouseOverData&&p.mouseOverData.s("highlight.visible")&&(k=[p.mouseOverData]),p.fetchTargetFunc&&(k=p.fetchTargetFunc(k)),R===eq.Mode.Style)k=k||[],A=function(U){if(k.indexOf(U)>=0)return!1;var d=w.getDataHighlightMode(U);return d===!1?!0:d===!0?!1:"selected"===d?w.isSelected(U)?!1:!0:"hover"===d?U===p.mouseOverData?!1:!0:!0};else{if(!k||!k.length)return;A=function(S){return k.indexOf(S)<0?!0:void 0}}var U=w.isVRPresenting(),$=w.getWidth();if(U){var M=w.getWidth;$/=2,w.getWidth=function(){return $};var m=w.getViewport()}var K,O=w.getDevicePixelRatio(),L=Math.floor($*O),s=Math.floor(w.getHeight()*O);(K=p._renderTarget)?K.setSize(x,L,s):p._renderTarget=K=new hd.RenderTarget(w,x,L,s);var Z="soft"===p.type;if(K.bind(x),Z){var T=x.getParameter(x.COLOR_CLEAR_VALUE);$q(x,[1,1,1,1]),x.clear(x.COLOR_BUFFER_BIT),$q(x,T)}else x.clear(x.COLOR_BUFFER_BIT);w.setViewport(x,0,0,L,s),w.drawFilter=A,Nk=function(T,B,f,g,H,D){var o=[f?0:1,1,1,1];return D||(li.for(T).directUniforms().uFixPickReverseColor=o),o},w.renderPickScene(),Nk=Kj,w.drawFilter=null,K.unbind(x),Up&&ap(x,t.aPosition),ap(x,t.aNormal),U&&(w.getWidth=M,w.setViewport(x,m[0],m[1],m[2],m[3]));var P=w.getHighlightColor();if(p._lastHighlightColor!==P){var c=Bc(p._lastHighlightColor=P);p._highlightColorData=[c[0]/255,c[1]/255,c[2]/255,c[3]/255]}return Z?p.renderSoftOutline(x,L,s):p.renderHardOutline(x,L,s),x.useProgram(t=w._prg),Up&&eo(x,t.aPosition),!0}},_assureShader:function(C,y){var t=C._compiledShader[y];return t||(t=C._compiledShader[y]=new sp.Shader(C,eq.CommonShaderVs,eq[y].fs)),t},renderHardOutline:function(z,Y,i){var N=this,D=N.gv,j=D._postProcessing,n=li.for(z),Z=n.directState();Z.blend.enabled=!0,Z.depth.enabled=!1,j.blitScreen(null,N._renderTarget.texture,N._assureShader(z,"HighlightHard"),{textureSize:[Y,i],edgeWidth:D.getHighlightWidth(),edgeColor:N._highlightColorData},{clear:!1}),Z.blend.enabled=!1,Z.depth.enabled=!0},renderSoftOutline:function($,S,U){var J,t,q,R,N,h=this,k=h.gv,M=k._postProcessing,n=Math.floor(S/2),Q=Math.floor(U/2),z=Math.floor(S/4),L=Math.floor(U/4),O=h._downSampleRenderTarget;O?(J=h._edgeDetectionRenderTarget,t=h._blurV2,q=h._blurH2,R=h._blurV4,N=h._blurH4,(O.width!==n||O.height!==Q)&&(O.setSize(n,Q),J.setSize(n,Q),t.setSize(n,Q),q.setSize(n,Q),R.setSize(z,L),N.setSize(z,L))):(O=h._downSampleRenderTarget=new hd.RenderTarget(k,$,n,Q),J=h._edgeDetectionRenderTarget=new hd.RenderTarget(k,$,n,Q),t=h._blurV2=new hd.RenderTarget(k,$,n,Q),q=h._blurH2=new hd.RenderTarget(k,$,n,Q),R=h._blurV4=new hd.RenderTarget(k,$,z,L),N=h._blurH4=new hd.RenderTarget(k,$,z,L));var u=$.getParameter($.COLOR_CLEAR_VALUE),X=k.getViewport(),A=h.width,I=h.strength,G=h.glow,Y=li.for($).glState,W=Y.depth,E=Y.blend,p=W.enabled;$q($,[1,1,1,1]),W.enabled=!1,E.apply({func:[$.SRC_ALPHA,$.ONE]}),M.blitScreen(O,h._renderTarget.texture),M.blitScreen(J,O.texture,h._assureShader($,"EdgeDetection"),{texSize:[n,Q],color:h._highlightColorData}),M.blitScreen(q,J.texture,h._assureShader($,"Blur"),{direction:[1,0],texSize:[n,Q],radius:A}),M.blitScreen(t,q.texture,h._assureShader($,"Blur"),{direction:[0,1],texSize:[n,Q],radius:A}),M.blitScreen(N,t.texture,h._assureShader($,"Blur"),{direction:[1,0],texSize:[z,L],radius:A}),M.blitScreen(R,N.texture,h._assureShader($,"Blur"),{direction:[0,1],texSize:[z,L],radius:A}),E.apply({enabled:!0}),k.setViewport($,X[0],X[1],X[2],X[3]),M.blitScreen(null,h._renderTarget.texture,h._assureShader($,"BlendTogether"),{edgeTexture1:t.texture,edgeTexture2:R.texture,edgeStrength:I*A,edgeGlow:G},{clear:!1}),E.apply({func:[$.SRC_ALPHA,$.ONE_MINUS_SRC_ALPHA,$.ONE,$.ONE_MINUS_SRC_ALPHA]}),W.enabled=p,$q($,u)}}),U.defineProperties(eq.prototype,{mode:{get:function(){return this._mode},set:function(V){var i=this._mode;if(V!==i){this._mode=V;var h=i===eq.Mode.MouseOver||i===eq.Mode.Style,W=V===eq.Mode.MouseOver||V===eq.Mode.Style;W&&h||(h&&D(this.gv.getView(),"mousemove",this.onMouseOver),W&&C(this.gv.getView(),"mousemove",this.onMouseOver))}}}}),eq.CommonShaderVs=["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),eq.HighlightHard={fs:["precision highp float;","uniform sampler2D image;","uniform vec2 textureSize;","uniform float edgeWidth;","uniform vec4 edgeColor;","varying vec2 vUv;","float getCol(vec2 coord) {","return texture2D(image, coord).a;","}","void main() {","vec2 cc = vUv;","float center = getCol(cc);","float dx = edgeWidth / textureSize.x;","float dy = edgeWidth / textureSize.y;","vec2 coord;","float topLeft = getCol(cc+vec2(-dx, -dy));","float top = getCol(cc+vec2(0.0, -dy));","float topRight = getCol(cc+vec2(dx, -dy));","float left = getCol(cc+vec2(-dx, 0.0));","float right = getCol(cc+vec2(dx, 0.0));","float bottomLeft = getCol(cc+vec2(-dx, dy));","float bottom = getCol(cc+vec2(0.0, dy));","float bottomRight = getCol(cc+vec2(dx, dy));","float v = -topLeft-2.0*top-topRight+bottomLeft+2.0*bottom+bottomRight;","float h = -bottomLeft-2.0*left-topLeft+bottomRight+2.0*right+topRight;","float edge = sqrt(h * h + v * v);","edge = smoothstep(0.9, 1.0, edge);","if (edge < 0.5) {","discard;","}","gl_FragColor = edgeColor;","}"].join("\n")},eq.EdgeDetection={fs:["precision highp float;","uniform sampler2D image;","varying vec2 vUv;","uniform vec2 texSize;","uniform vec4 color;","void main() {","vec2 invSize = 1.0 / texSize;","vec4 uvOffset = vec4(1.0, 0.0, 0.0, 1.0) * vec4(invSize, invSize);","vec4 c1 = texture2D( image, vUv + uvOffset.xy);","vec4 c2 = texture2D( image, vUv - uvOffset.xy);","vec4 c3 = texture2D( image, vUv + uvOffset.yw);","vec4 c4 = texture2D( image, vUv - uvOffset.yw);","float diff1 = (c1.r - c2.r)*0.5;","float diff2 = (c3.r - c4.r)*0.5;","float d = length( vec2(diff1, diff2) );","gl_FragColor = color * vec4(d);","}"].join("\n")},eq.Blur={fs:["#define MAX_RADIUS 4","precision highp float;","varying vec2 vUv;","uniform sampler2D image;","uniform vec2 texSize;","uniform vec2 direction;","uniform float radius;","float gaussianPdf(in float x, in float sigma) {","return 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;","}","void main() {","vec2 invSize = 1.0 / texSize;","float weightSum = gaussianPdf(0.0, radius);","vec4 diffuseSum = texture2D( image, vUv) * weightSum;","vec2 delta = direction * invSize * radius/float(MAX_RADIUS);","vec2 uvOffset = delta;","for( int i = 1; i <= MAX_RADIUS; i ++ ) {","float w = gaussianPdf(uvOffset.x, radius);","vec4 sample1 = texture2D( image, vUv + uvOffset);","vec4 sample2 = texture2D( image, vUv - uvOffset);","diffuseSum += ((sample1 + sample2) * w);","weightSum += (2.0 * w);","uvOffset += delta;","}","gl_FragColor = diffuseSum/weightSum;","}"].join("\n")},eq.BlendTogether={fs:["precision highp float;","varying vec2 vUv;","uniform sampler2D image;","uniform sampler2D edgeTexture1;","uniform sampler2D edgeTexture2;","uniform float edgeStrength;","uniform float edgeGlow;","void main() {","vec4 edgeValue1 = texture2D(edgeTexture1, vUv);","vec4 edgeValue2 = texture2D(edgeTexture2, vUv);","vec4 edgeValue = edgeValue1 + edgeValue2 * edgeGlow;","float vv = texture2D(image, vUv).r;","vec4 finalColor = edgeStrength * vv * edgeValue;","gl_FragColor = finalColor;","}"].join("\n")};var Dl=L.Light=function(){oc(Dl,this),this.s(Od,E[Od]),this.s(Rg,"sphere"),this.s("shape3d.reverse.cull",!0),this.s3(20,20,20)};Ci("Light",Zc,{_image:"light_icon",_icon:"light_icon",onStyleChanged:function(Y,y,q){Dl.superClass.onStyleChanged.apply(this,arguments),Y===Od&&this.s("shape3d.color",q)}});var Wq=hd.FrameState=function(L,T){this.renderState=li.for(T),this.picking=!1,this.envmapReflectivity=.5,this.cameraPosition=A,this.projectMatrix=A,this.viewMatrix=A,this.view=L,this.defaultProgram=A,this.pickColorMap=A,this._pvStack=[],this._renderStateStack=[]};Wq.prototype.savePV=function(){var M=this.view;this._pvStack.push([Kn(this.projectMatrix),Kn(this.viewMatrix),M._18Q,Kn(M._7O)])},Wq.prototype.restorePV=function(){var I=this._pvStack.pop();if(I){var o=this.view;this.projectMatrix=o._projectMatrix=I[0],this.viewMatrix=o._viewMatrix=I[1],o._18Q=I[2],o._7O=I[3]}},Wq.prototype.setPV=function(c,t){var A=this.view,x=!1;if(c&&(this.projectMatrix=A._projectMatrix=c,x=!0),t&&(this.viewMatrix=A._viewMatrix=t,A._7O=Kn(t),x=!0),x){var M=A.getWidth(),Z=A.getHeight(),I=Kn(this.projectMatrix);A._18Q=Nd(I,I,t),A._18Q._wh=M/Z}},Wq.prototype.syncEnv=function(b){var e=this,k=e.view;e.envmapReflectivity=k._envmapReflectivity||.5,e.cameraPosition=k.getEye(),e.projectMatrix=k._projectMatrix,e.viewMatrix=k._viewMatrix,e.pickColorMap=b,e.picking=k.getGL()._picking},Wq.prototype.setGLState=function(){var u=[0,0,0,0],U=[!0,!0,!0,!0],k=[-1,1],D=[Jh.FUNC_ADD,Jh.FUNC_ADD],V=[Jh.SRC_ALPHA,Jh.ONE_MINUS_SRC_ALPHA,Jh.ONE,Jh.ONE_MINUS_SRC_ALPHA];return function(N,h){var c=this,y=c.renderState.gl,I=c.renderState.glState;I.dither=!1,h?I.color.mask=U:I.color.reset(),I.pixelStore.reset(),I.blend.color=u,I.blend.equation=D,I.blend.func=V,I.cullFace.enabled=!1,I.scissor.enabled=!1,I.depth.enabled=!0,I.depth.clear=1,I.depth.func=y.LEQUAL,I.depth.range=k,I.stencil.enabled=!1,I.polygonOffset.enabled=!1,N?(I.depth.mask=!1,I.blend.enabled=!0):(I.depth.mask=!0,I.blend.enabled=!1)}}(),Wq.prototype.setUniforms=function(i){var X=this,B=X.view,e=X.renderState,n=e.gl,W=e.uniforms;W.uBrightness=1,W.uOpacity=1,W.uPartOpacity=1,W.uPick=X.picking,W.uTexture=!1,W.uBlendTexture=!1,W.uAlphaTest=E.alphaTest,W.uTransparent=!!i,W.uFix=!1,W.uBatchColor=!1,W.uBatchBlend=!1,W.uBatchBrightness=!1,W.uReflectivity=X.envmapReflectivity||.5,W.uCameraPosition=X.cameraPosition,W.uPMatrix=X.projectMatrix,W.uViewMatrix=X.viewMatrix,W.uEnvMap=null,W.uEnableBoxClip=!1,W.uClipperMatrix=B._boxClipperMatrixes,W.uClipperClipInner=B._boxClipperClipInner,B._envmapRenderer.resetUniformCache(),X.picking||(qp(B,n,A),B._fogDisabled||(W.uFogColor=B._fogColor,W.uFogDensity=B._fogDensity,W.uFogNear=B._fogNear,W.uFogFar=B._fogFar))},Wq.prototype.drawLayer=function(H){return this.view.renderLayers(H,!0)},Wq.prototype.drawData=function(e,C,t){var b=this.view;if(b.isVisible(e)){var H=this.renderState,S=H.uniforms,o=b.getData3dUI(e);if(o){var F=H.gl,N=F._picking,E=b._picking,L=e._pickId;t&&(e._pickId=t),S.uPick=F._picking=b._picking=!!t,S.uTransparent=!!C,o._42(H.gl,H.program,C?f:v),S.uPick=F._picking=N,b._picking=E,e._pickId=L}}};var Li=hd.Graph3dView=function(T,b){var S=this;S._webGLVersion=1,S._attributes=b||r.graph3dViewAttributes,S._25I={},S._view=eh(1,S);var Q=S._canvas=gi(S._view);C(Q,"webglcontextlost",function(K){K.preventDefault(),Pc(S),S._26I&&S._doBufferGC(S._26I,!0),S._26I=h,S._1o.onContextLost(),S._35O=!0}),C(Q,"webglcontextrestored",function(){S._35O=!1,S.iv()}),S._40Q=new ws,S._43Q={},S._44Q=-1,S._batchIndexMap={},S._batchModelMap={},S._wireframeIndexMap={},S._wireframeModelMap={},S._wireframeIndexMapSwap={},S._wireframeModelMapSwap={},S._polylineIndexMap={},S._polylineIndexMap={},S._polylineIndexMapSwap={},S._polylineIndexMapSwap={},S._8O=[],S._7O=Rb(),S._6O=Rb(),S._1o=new yb(S),S._30O=new Fs(S),S._31O=new Ds(S),S._32O=new Es(S),S._raycaster=new Qs(S),S._highlightHelper=new eq(S),S._postProcessing=new $s(S),S._41Q=[],S._42Q=0,S._frameRenderOptionStack=[],hd.VR?(S.vr=new hd.VR(S),S.isVREnabled=function(){return this.vr.enable
},S.isVRPresenting=function(){return this.vr.isPresenting()}):(S.vr={enable:!1,isPresenting:o},S.isVREnabled=o,S.isVRPresenting=o),S.shadowMap=new kq(S),S.flowMap=new rr(S),S._33Q=!0,S._eye=Bi(r.graph3dViewEye),S._center=Bi(r.graph3dViewCenter),S._up=Bi(r.graph3dViewUp),S._lightChanged=!1,S._59O=[],S._spots=[],S._dirs=[],S._boxClippers=[],S._flowObjects=[],S._frameId=0,S._picking=!1,S._batchInfoMap={},S.overlappingBox=new Kf(S),S.dm(T?T:new Eb),S._coreInteractor=new dj(this),S._envmapRenderer=new hd.EnvmapRenderer(this),S.setInteractors([new Lm(S)]),S._initView()},Ij={fogDisabled:1,fogMode:1,dashDisabled:1,batchColorDisabled:1,batchBlendDisabled:1,batchBrightnessDisabled:1,ortho:1},hn=0;mc("Graph3dView",U,{ms_v:1,ms_tip:1,ms_gv:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_51o:1,ms_shadow:1,ms_highlight:1,ms_quickVisible:1,ms_ac:["devicePixelRatio","boundaries","moveStep","rotateStep","editHelperDisabled","blockSelectable","sizeEditableFunc","rotationEditableFunc","editableFunc","rotatable","zoomable","pannable","walkable","resettable","mouseRoamable","zoomToCenter",ol,Yp,"firstPersonMode",Bg,"movableFunc","gridVisible","gridSize","gridGap","gridColor","originAxisVisible","centerAxisVisible","axisXColor","axisYColor","axisZColor","editSizeColor","rectSelectable","rectSelectBackground","headlightRange","headlightColor","headlightIntensity","headlightAmbientIntensity","headlightDisabled","headlightGroup","ortho","orthoWidth","syncEyeWithOrthoWidth","fovy","near","far",tf,Sb,"up","aspect","fogDisabled","fogMode","fogDensity","fogColor","fogNear","fogFar","pickerResolution","dashDisabled","batchColorDisabled","batchBlendDisabled","batchBrightnessDisabled","hoverDelay","batchInfoMap","rotateMinPhi","rotateMaxPhi","sortable","sortFunc"],_editable:!1,_sortable:r.graph3dViewSortable,_editHelperDisabled:r.graph3dViewEditHelperDisabled,_blockSelectable:r.graph3dViewBlockSelectable,_devicePixelRatio:A,_boundaries:A,_moveStep:r.graph3dViewMoveStep,_rotateStep:r.graph3dViewRotateStep,_rotateMinPhi:r.graph3dViewMinPhi===A?r.graph3dViewRotateMinPhi:r.graph3dViewMinPhi,_rotateMaxPhi:r.graph3dViewMaxPhi===A?r.graph3dViewRotateMaxPhi:r.graph3dViewMaxPhi,_pannable:r.graph3dViewPannable,_rotatable:r.graph3dViewRotatable,_walkable:r.graph3dViewWalkable,_resettable:r.graph3dViewResettable,_zoomable:r.graph3dViewZoomable,_zoomToCenter:!0,_firstPersonMode:r.graph3dViewFirstPersonMode,_mouseRoamable:r.graph3dViewMouseRoamable,_gridVisible:r.graph3dViewGridVisible,_gridSize:r.graph3dViewGridSize,_gridGap:r.graph3dViewGridGap,_gridColor:r.graph3dViewGridColor,_originAxisVisible:r.graph3dViewOriginAxisVisible,_centerAxisVisible:r.graph3dViewCenterAxisVisible,_axisXColor:r.graph3dViewAxisXColor,_axisYColor:r.graph3dViewAxisYColor,_axisZColor:r.graph3dViewAxisZColor,_ortho:r.graph3dViewOrtho,_orthoWidth:r.graph3dViewOrthoWidth,_syncEyeWithOrthoWidth:r.graph3dViewSyncEyeWithOrthoWidth,_fovy:r.graph3dViewFovy,_near:r.graph3dViewNear,_far:r.graph3dViewFar,_headlightColor:r.graph3dViewHeadlightColor,_headlightIntensity:r.graph3dViewHeadlightIntensity,_headlightRange:r.graph3dViewHeadlightRange,_headlightGroup:r.graph3dViewHeadlightGroup,_headlightAmbientIntensity:r.graph3dViewHeadlightAmbientIntensity,_headlightDisabled:r.graph3dViewHeadlightDisabled,_rectSelectable:r.graph3dViewRectSelectable,_rectSelectBackground:r.graph3dViewRectSelectBackground,_editSizeColor:r.graph3dViewEditSizeColor,_autoMakeVisible:Ae,_fogDisabled:r.graph3dViewFogDisabled,_fogMode:r.graph3dViewFogMode,_fogDensity:r.graph3dViewFogDensity,_fogColor:r.graph3dViewFogColor,_fogNear:r.graph3dViewFogNear,_fogFar:r.graph3dViewFogFar,_pickerResolution:r.graph3dViewPickerResolution,_dashDisabled:r.graph3dViewDashDisabled,_batchColorDisabled:r.graph3dViewBatchColorDisabled,_batchBlendDisabled:r.graph3dViewBatchBlendDisabled,_batchBrightnessDisabled:r.graph3dViewBatchBrightnessDisabled,addCamera:function(g){var H=this,Y=U.freeze({id:H._42Q++,priority:g.priority||0,ignoreInPick:!!g.ignoreInPick,render:g.render});g.switch3DStatus&&(H._43Q[Y.id]=!0),H._41Q.push(Y),H._41Q.sort(function(E,I){return E.priority!==I.priority?E.priority-I.priority:E.id-I.id})},setEye:function(v,A,Y){1===arguments.length&&(A=v[1],Y=v[2],v=v[0]);var L=this._eye;L[0]=v,L[1]=A,L[2]=Y,this.fp(tf,h,L)},setCenter:function(F,z,i){1===arguments.length&&(z=F[1],i=F[2],F=F[0]);var e=this._center;e[0]=F,e[1]=z,e[2]=i,this.fp(Sb,h,e)},setUp:function(F,s,t){1===arguments.length&&(s=F[1],t=F[2],F=F[0]);var K=this._up;K[0]=F,K[1]=s,K[2]=t,this.fp("up",h,K)},getDevicePixelRatio:function(){return this._picking?this._1o._resolution:this._devicePixelRatio||rg},isTransparentMask:function(l){return l.s("transparent.mask")},getCoreInteractor:function(){return this._coreInteractor},getHighlightHelper:function(){return this._highlightHelper},getRaycaster:function(){return this._raycaster},getAspect:function(){var I=this,v=I._aspect;return v?v:(v=I.getWidth()/I.getHeight(),v||1.2)},getCanvas:function(){return this._canvas},setDataModel:function(m){var I=this,e=I._dataModel,z=I._selectionModel;e!==m&&(e&&(e.ump(I.handleDataModelPropertyChange,I),e.umm(I.handleDataModelChange,I),e.umd(I.handleDataPropertyChange,I),z||e.sm().ums(I.handleSelectionChange,I)),I._dataModel=m,m.mp(I.handleDataModelPropertyChange,I),m.mm(I.handleDataModelChange,I),m.md(I.handleDataPropertyChange,I),z?z._21I(m):m.sm().ms(I.handleSelectionChange,I),I._postProcessing.handleDataModleChange(e,m),I._tryInvalidateEnvmap(),I.invalidateAll(!0),I.invalidateLight(),I.invalidateboxClipper(),I.invalidateFlowObjects(),I._49Q(),I.fp(Re,e,m),I._canvas.style.background=m.getBackground()||"")},handleDataModelPropertyChange:function(O){var C=O.property;if("background"===C){var j=this._canvas.style.background,V=O.newValue||"";this._canvas.style.background=V,this.fp("canvasBackground",j,V)}else"envmapType"===C?this._tryInvalidateEnvmap():"envmap"===C&&this.iv()},handleDataPropertyChange:function(p){var H=p.data;this.invalidateData(H);var F=p.property;wl(H)&&"s:light.type"===F?this.invalidateLight():"s:3d.clipbox"===F?this.invalidateboxClipper(H):"s:effect.flow"===F?this.invalidateFlowObjects(H):"s:shadow.cast"===F?this.shadowMap.tryUpdateBounding(H):"s:3d.visible"===F&&this.invalidateQuickVisible(H)},invalidateboxClipper:function(N){var D=this._boxClippers,K=D.length;if(N)if(N.s("3d.clipbox"))D.indexOf(N)<0&&D.push(N);else{var g=D.indexOf(N);g>=0&&D.splice(g,1)}else D=this._boxClippers=[],this.dm().each(function(U){U.s("3d.clipbox")&&D.push(U)});K!==D.length&&(Pc(this),this.shadowMap.deleteShadowProgram(),this._updateBoxClipperMatrix()),this.iv()},_updateBoxClipperMatrix:function(){for(var r,B,e=this._boxClippers,X=this._boxClipperMatrixes=[],d=this._boxClipperClipInner=[],I=new nk,H=0,q=e.length;q>H;H++)r=e[H],r.appendAnchorMatrix3d(B=hk(r,this.getMat(r))),X.push(I.getInverse(I.fromArray(B)).toArray()),d.push("inner"===r.s("3d.clipbox"))},_49Q:function(){this._4AQ||this._48Q||this.dm().size()<r.graph3dViewDataNumWarningLine||(this._48Q=!0,console.log("Too many datas so than disable some feature to speed up.\nYou can set global Default.graph3dViewDataNumWarningLine to largeEnoughNum to avoid this, or call graph3dView.quitDataNumWarning() to quit.\n"),this.enableQuickVisibleMode(),this.getHighlightHelper().mouseOverData=null)},quitDataNumWarning:function(){this.disableQuickVisibleMode(),this._48Q=!1,this._4AQ=!0},invalidateFlowObjects:function(e){var Z=this._flowObjects,q=Z.length;if(e)if(e.s("effect.flow"))Z.indexOf(e)<0&&Z.push(e);else{var R=Z.indexOf(e);R>=0&&Z.splice(R,1)}else Z=this._flowObjects=[],this.dm().each(function(P){P.s("effect.flow")&&Z.push(P)});q!==Z.length&&Pc(this),this.iv()},invalidateLight:function(){this._lightChanged||(this._lightChanged=!0,this.iv())},onPropertyChanged:function(R){var g=this,$=R.property;g.iv(),g._18Q=h,"eye"===$?g._33Q=!0:"devicePixelRatio"===$?g._42(g.getDevicePixelRatio()):Ij[$]&&Pc(g)},_5O:function(V){var j=V._22Q();return j?new j(this,V):h},getData3dUI:function(F){var d=this._25I[F._id];return d===A&&(d=this._5O(F),this._25I[F._id]=d),d},invalidateAll:function(e){var y=this;if(e){for(var H in y._25I){var _=y._25I[H];_&&_.dispose()}y._25I={},y.iv(),np(y)}else np(y),y.dm().each(function(j){y.invalidateData(j)})},invalidateSelection:function(){var z=this;z.sm().each(function(E){z.invalidateData(E)})},invalidateData:function(U){var Y=this,A=Y.getData3dUI(U);A&&(A.iv(),Y.iv()),np(Y,U)},getShape3dText:function(o){return o.getStyle("shape3d.text")||this.getLabel(o)},invalidateBatch:function(b){var K=this,U=K._40Q;U.each(function(Z){K._invalidateBatch(Z.batchModelMap,Z.batchIndexMap,Z.polylineModelMap,Z.polylineIndexMap,Z.wireframeModelMap,Z.wireframeIndexMap,b),Z.markBatchInvalid()})},_invalidateBatch:function(o,Y,j,d,b,k,J){var V=this,u=o[J],D=[],C={};if(u){u.ds.forEach(function(T){var F=V.getData3dUI(T);F&&F.iv(),delete Y[T._id],D.push(T._id)}),delete o[J];for(var Q,P,S,p,L,g,T,X,N,h=[b,j],Z=[k,d],r=0;r<h.length;r++){var y=h[r],B=Z[r];for(C={},X=0;X<D.length;X++){var s=B[D[X]];if(s){delete B[D[X]],N=s.batch,Q=y[N];var I=s.begin,i=s.size,O=3*I,W=3*i,f=4*I,F=4*i;for(P=Q.ds,S=Q.vs,p=Q.cs,L=Q.ps,g=Q.ls,T=s.index,Q.invalidate=!0,P[T]=A,T=O;O+W>T;T++)S[T]=A;for(T=f;f+F>T;T++)p[T]=A;for(T=f;f+F>T;T++)L[T]=A;if(g)for(T=O;O+W>T;T++)g[T]=A;C[N]=!0}}for(N in C){Q=y[N],P=Q.ds,S=Q.vs,p=Q.cs,L=Q.ps,g=Q.ls;var U=[];for(T=0;T<P.length;T++)P[T]!==A&&U.push(P[T]);if(0===U.length)delete y[N];else{for(Q.ds=U,U=[],T=0;T<S.length;T++)S[T]!==A&&U.push(S[T]);for(Q.vs=U,U=[],T=0;T<p.length;T++)p[T]!==A&&U.push(p[T]);for(Q.cs=U,U=[],T=0;T<L.length;T++)L[T]!==A&&U.push(L[T]);if(Q.ps=U,g){for(U=[],T=0;T<g.length;T++)g[T]!==A&&U.push(g[T]);Q.ls=U}}}}V.iv()}},handleDataModelChange:function(L){var K=this,v=L.kind,G=L.data;if("add"===v)K.invalidateData(G),vm(G)&&G.getEdgeGroup()&&G.getEdgeGroup().eachSiblingEdge(K.invalidateData,K),wl(G)&&K.invalidateLight(),G.s("3d.clipbox")&&K.invalidateboxClipper(G),G.s("effect.flow")&&K.invalidateFlowObjects(G),K._49Q();else if(v===Yk){var W=G._id,s=K._25I[W];s&&(s.dispose(),delete K._25I[W],K.iv()),G===K._currentSubGraph&&K.setCurrentSubGraph(h),np(K,G),wl(G)&&K.invalidateLight(),G.s("3d.clipbox")&&K.invalidateboxClipper(G),G.s("effect.flow")&&K.invalidateFlowObjects(G)}else v===Eh&&(K.invalidateAll(!0),K.setCurrentSubGraph(h),np(K),K.invalidateLight(),K.invalidateboxClipper(),K.invalidateFlowObjects())},toCanvas:function(Z,Y,I){var h=this,l=h.getGL();if(h.validate(),Z){var f=l.getParameter(l.COLOR_CLEAR_VALUE);$q(l,Z)}h._42(1,{renderAxis:!1,renderEdit:!1,renderGrid:!1});var D=h.getWidth()||1,T=h.getHeight()||1,s=new Uint8Array(4*D*T),x=gi(),B=x.getContext("2d");l.readPixels(0,0,D,T,l.RGBA,l.UNSIGNED_BYTE,s),Ir(x,D,T,1);for(var p=B.getImageData(0,0,D,T),o=p.data,R=0;R<o.length;R+=4){var F=R/4,O=y(F/D),Q=F-O*D;F=4*((T-1-O)*D+Q),o[F]=s[R],o[F+1]=s[R+1],o[F+2]=s[R+2],o[F+3]=s[R+3]}if(B.putImageData(p,0,0),Z&&$q(l,f),h._42(h.getDevicePixelRatio()),Y&&I){var J=gi(),L=J.getContext("2d");return Ir(J,Y,I,1),r.drawImage(L,x,0,0,Y,I),J}return x},toDataURL:function(o,y){var X=this,C=X.getGL();if(X.validate(),o){var l=C.getParameter(C.COLOR_CLEAR_VALUE);$q(C,o)}X._42(1,{renderAxis:!1,renderEdit:!1,renderGrid:!1});var K=X._canvas.toDataURL(y||"image/png",1);return o&&$q(C,l),X._42(X.getDevicePixelRatio()),K},getGL:function(){var h=this._26I;if(h)return this.acquireProgram(),h;if(!this._35O){var R=this,D=R._canvas,g=R._attributes;if(!g||g.requestWebGL2!==!1)try{h=D.getContext("webgl2",g)||D.getContext("experimental-webgl2",g),h&&(R._webGLVersion=2,R._26I=h)}catch(L){}if(!h)try{h=D.getContext("webgl",g)||D.getContext("experimental-webgl",g)}catch(L){throw new Error("WebGL not supported")}if(!h)throw new Error("WebGL not supported");R._26I=h;var J=R._frameState=new Wq(this,h);R._glExtensions=new H(h),R._glCapabilities=new p(h,R._glExtensions),R._2O={},h._emptyCubeTexture=_q(h),h._compiledShader={},h._emptyTexture=hh(h),h._emptyBlendTexture=hh(h),h._bufPool={},h._id=++hn,J.setGLState(),R._buffer={vs:Zq(h),ns:Zq(h),is:Zq(h),uv:Zq(h),batchColor:Zq(h),batchBlend:Zq(h),batchBrightness:Zq(h),lineDistance:Zq(h)},R._1O=mq(h);var l=R._cube={vs:Zq(h),ns:Zq(h),is:Zq(h),uv:Zq(h)};return Ni(h,l.vs,Wk),Ni(h,l.ns,ar),Ni(h,l.uv,vd),Cm(h,l.is,Pi),R.acquireProgram(),h._renderInfo={calls:0,vertices:0,faces:0,lines:0,points:0,frame:0,cacheTimeCost:0},h}},getGLCapabilities:function(){var L=this.getGL();return L?this._glCapabilities:void 0},getEnvmap:function(){return this._glCapabilities&&this._glCapabilities.maxVertexTextures<r.graph3dEnvmapCapabilityRequire?null:this.dm().getEnvmap()},getEnvmapType:function(){var X,p=this.dm();return p&&(X=p.getEnvmapType()),X||"legacy"},invalidateEnvmap:function(_){return this._envmapRenderer.invalidateEnvmap(_)},_setEnvmapByProbeId:function(f,v){return this._envmapRenderer.setEnvmapByProbeId(f,v)},_tryInvalidateEnvmap:function(){var b=this.getEnvmapType();b!==this._lastProgramEnvmapType&&(Pc(this),this.iv())},acquireProgram:function(){var H=this,L=H._26I;if(L&&!H._prg){var k=H._prg=L.createProgram();if(!k)return h;var C=H._dirs.length,y=H._spots.length,V=H._59O.length,X=H._boxClippers.length,T=H._flowObjects.length,l=["uPMatrix","uMVMatrix","uMMatrix","uReflectivity","uViewMatrix","uUseEnvMap","uEnvMap","uCameraPosition","uNMatrix","uViewMatrix","aNormal","aUv","uUvMatrix","uDiffuse","uBlend","uBlendColor","uBrightness","uPartOpacity","uAlphaTest","uTransparent","uClipDirection","uClipPercent","uTexture","uBlendTexture","uSampler","uBlendSampler","uDiscardSelectable","uFix","uPick","uReverseFlip","uFixPickReverseColor","uBatchBrightness","aBatchBrightness","uBatchColor","aBatchColor","uBatchBlend","aBatchBlend","uDash","aLineDistance","uDashDistance","uDashGapDistance","uLight","uHeadlightRange","uHeadlightAmbientIntensity","uHeadlightColor","uFogColor","uFogDensity","uFogNear","uFogFar"];C&&l.push("uDirColor","uDirDirection"),y&&l.push("uSpotColor","uSpotRange","uSpotAngle","uSpotExponent","uSpotPosition","uSpotDirection"),V&&l.push("uPointColor","uPointRange","uPointPosition"),fd||(tk=Mj(tk.substring(0,tk.indexOf("^#"))),ee=Mj(ee),fd=!0);var Q=H.getEnvmapType(),_=["#define MAX_DIR "+C,"#define MAX_SPOT "+y,"#define MAX_POINT "+V,"#define MAX_BOX_CLIPPER "+X,"#define MAX_FLOW_OBJECT "+T,H._fogDisabled?"":"#define FOG","exp2"===H.getFogMode()?"#define FOG_EXP2":"",H._dashDisabled?"":"#define DASH","#define USE_ENVMAP","legacy"!==Q?"#define ENVMAP_TYPE_CUBE_UV":"",H.isOrtho()?"#define ORTHOGRAPHIC":"",H._batchColorDisabled?"":"#define BATCHCOLOR",H._batchBlendDisabled?"":"#define BATCHBLEND",H._batchBrightnessDisabled?"":"#define BATCHBRIGHTNESS",H.shadowMap.enable?H.shadowMap.genShaderDefine():"",""].join("\n"),W=Xp(L,k,L.VERTEX_SHADER,tk.replace("PREFIX",_));L.getShaderParameter(W,L.COMPILE_STATUS)||ls("COMPILE",L.VERTEX_SHADER,L.getError(),L.getShaderInfoLog(W));var b=Xp(L,k,L.FRAGMENT_SHADER,ee.replace("PREFIX",_));if(L.getShaderParameter(b,L.COMPILE_STATUS)||ls("COMPILE",L.FRAGMENT_SHADER,L.getError(),L.getShaderInfoLog(b)),Up?l.push("aPosition"):(k.aPosition=0,L.bindAttribLocation(k,0,"aPosition")),L.linkProgram(k),!L.getProgramParameter(k,L.LINK_STATUS)){var E=L.getProgramInfoLog(k);return H._prg=h,E.indexOf("maximum temp register")>=0&&!H._glTempRegisterLimited?(H._glTempRegisterLimited=!0,L.deleteProgram(k),H.acquireProgram()):(ls("LINK",L.getProgramParameter(k,L.VALIDATE_STATUS),L.getError(),E),L.deleteProgram(k),h)}l.forEach(function(D){k[D]=/^u/.test(D)?L.getUniformLocation(k,D):L.getAttribLocation(k,D)});var D=H._frameState;D.renderState.program=D.defaultProgram=k,H._envmapRenderer.changeEnvmapType(H._lastProgramEnvmapType=Q),L.deleteShader(W),L.deleteShader(b)}},isGLTempRegisterLimited:function(){return this._glTempRegisterLimited},getBrightness:function(w){var M=w.s("brightness"),O=this.isSelected(w)?w.s("select.brightness"):h;return M==h?O:O==h?M:M*O},getDataHighlightMode:function(C){return C.s("highlight.mode")},getWireframe:function(P){var C=P.s("wf.visible"),s=P.s("wf.width");return C===!0||s>0&&"selected"===C&&this.isSelected(P)?{color:P.s("wf.color"),width:s,"short":P.s("wf.short"),mat:P.s("wf.mat")}:void 0},_transformPointToViewSpace:function(u){var e=[u[0],u[1],u[2]];return vf(e,this._viewMatrix),e},_transformDirectionToViewSpace:function(I,B){var t=[I[0],I[1],I[2]];vf(t,this._viewMatrix);var X=B?[B[0],B[1],B[2]]:[0,0,0];vf(X,this._viewMatrix);var n=X[0]-t[0],q=X[1]-t[1],Z=X[2]-t[2],r=Math.sqrt(n*n+q*q+Z*Z);return r?[n/r,q/r,Z/r]:[n,q,Z]},getWireframeGeometry:function(R){return R.s("wf.geometry")?{color:R.s("wf.color"),width:R.s("wf.width"),mat:R.s("wf.mat"),geometry:!0}:void 0},getBodyColor:function(p){return p.s("body.color")},getMat:function(f){return f.getMat?f.getMat():f.s("mat")},getFaceMat:function(G,C){return G.getFaceMat?G.getFaceMat(C):G.s(C+".mat")},getFaceBlend:function(k,D){return k.s(D+".blend")||k.s("all.blend")},getFaceColor:function(e,t){return e.s(t+".color")||e.s("all.color")},getFaceImage:function(w,U){return w.s(U+".image")||w.s("all.image")},getFaceBlendImage:function(L,U){return L.s(U+".blend.image")||L.s("all.blend.image")},getFaceDiscardSelectable:function(C,x){var $=C.s(x+".discard.selectable");return $==h?C.s("all.discard.selectable"):$},getFaceUv:function(m,c){return m.s(c+".uv")||m.s("all.uv")},getFaceUvOffset:function(G,I){return G.s(I+".uv.offset")||G.s("all.uv.offset")},getFaceUvScale:function(R,C){return R.s(C+".uv.scale")||R.s("all.uv.scale")},getFaceUvRotation:function(S,b){return S.s(b+".uv.rotation")||S.s("all.uv.rotation")},getFaceLight:function(g,f){var J=g.s(f+".light");return J==h?g.s("all.light"):J},getFaceVisible:function(X,k){var f=X.s(k+".visible");return f==h?X.s("all.visible"):f},getFaceOpacity:function(K,p){var m=K.s(p+".opacity");return m==h?K.s("all.opacity"):m},getFaceTransparent:function(O,R){var I=O.s(R+".transparent");return I==h?O.s("all.transparent"):I},getFaceReverseColor:function(E,g){return E.s(g+".reverse.color")||E.s("all.reverse.color")},getFaceReverseFlip:function(y,M){var m=y.s(M+".reverse.flip");return m==h?y.s("all.reverse.flip"):m},getFaceReverseCull:function(i,y){var G=i.s(y+".reverse.cull");return G==h?i.s("all.reverse.cull"):G},getTextureMap:function(){return this._2O},_2Oi:function(n,C,k){k=k||"";var _;(_=this._2O[n])||(_=this._2O[n]={}),_[k]=C},deleteTexture:function(x){var F=this,V=F._2O[x];if(V){delete F._2O[x];var W=F.getGL();for(var n in V)W.deleteTexture(V[n])}},renderPickScene:function(){var n=this.getGL();this.syncRenderState(),this._picking=n._picking=!0,this.renderScene(),this._picking=n._picking=!1},invalidateCachedTexture:function(o){var B=this.getData3dUI(o);B.invalidateCachedTexture(this.getGL()),this.invalidateData(o)},invalidateShape3dCachedImage:function(G){this.invalidateCachedTexture(G)},invalidateCachedGeometry:function(z){var r=this.getData3dUI(z);r.invalidateCachedGeometry(),this.invalidateData(z)},isInteractive:function(u){return u.s("interactive")},getTexture:function(H,$,z,V){if(!H)return h;var C,m,K=this,P=K.getGL(),Z=K._2O[H];if(Z&&($&&(m=$.s("texture.mipmap.max")),C=Z[m||""]||Z.default),!C){var e=Tj(H);if(V||(V={}),!e)return P._emptyTexture;if($){V.mipmapMaxLevel=m=$.s("texture.mipmap.max");var T=$.s("texture.wrap");V.clampToEdge="clampToEdge"===T?!0:"repeat"===T?!1:A}if(e.uuid||(e.uuid=L.Math.generateUUID()),e.tagName){if(e.dynamic)return mq(P,e,K._1O,V);C=mq(P,e,A,V),K._2Oi(H,C,m)}else{var t,g=$&&($.s("texture.cache")||$.s("shape3d.image.cache")||e.textureCache),Y=K.isVRPresenting();if(Y&&($._textureUpdateFrame===P._renderInfo.frame?g=!0:$._textureUpdateFrame=P._renderInfo.frame),g&&(t=K.getData3dUI($),C=t.getCachedTexture(z),C&&t.interactiveInfo&&C.interactiveInfo&&(t.interactiveInfo[C.interactiveInfo.key]=C.interactiveInfo.info)),!C){var p=P._renderInfo.textureCache;if(g){if(p.time>r.graph3dMaxVectorCacheTime)return K.redraw(),P._emptyTexture;if(!Xd(e,$))return P._emptyTexture}var q;$&&(1!==$.s("texture.scale")?q=$.s("texture.scale"):1!==$.s("shape3d.texture.scale")&&(q=$.s("shape3d.texture.scale"))),q||(q=1);var N=$&&($.s("fixSizeOnScreen")||$.s("shape3d.fixSizeOnScreen")),D=N?P.NEAREST:P.LINEAR;N?"number"==typeof N&&(q*=0>N?1:N):$&&($.s("vector.dynamic")||$.s("shape3d.vector.dynamic"))&&(t||(t=K.getData3dUI($)),N=t.getVectorDynamicSize());var v,b,X,j=$&&$.s("shape3d");"billboard"===j?X=$.getTall()/$.getWidth():"plane"===j&&(X=$.getHeight()/$.getWidth());var I=Xf(e,$);if(N){var s;s=g?K._devicePixelRatio||rg:K.getDevicePixelRatio(),v=N[0]>0?N[0]*s:q*I*s,b=N[1]>0?N[1]*s:q*(X?$m(e,$,K,Math.min(4096,I*X)):$m(e,$))*s}else v=q*I,b=q*(X?$m(e,$,K,Math.min(4096,I*X)):$m(e,$));if(v>=1&&b>=1){var G=0;(g||Y)&&(G=Date.now());var B=K._glCapabilities.maxTextureSize;v=Math.min(v,B),b=Math.min(b,B);var u=Fk(v,b);if(!t&&$&&(t=K.getData3dUI($)),t&&t.interactiveInfo){var M=H;"object"==typeof M&&(M=M.uuid||(M.uuid=L.Math.generateUUID()));var J=t.interactiveInfo[M]={};u.interactiveInfo=J.bodyInfo={compInfos:[],matrix:new Ud,rect:{x:0,y:0,width:v,height:b}}}Nl(u,e,0,0,v,b,$,K),u.interactiveInfo&&(u.interactiveInfo=null),u.restore(),p.count++,p.pixels+=v*b,$?(V.minFilter=hb($.s("texture.filter.min")||$.s("texture.filter"))||D,V.magFilter=hb($.s("texture.filter.mag")||$.s("texture.filter"))||D):V.minFilter=V.magFilter=D,g||Y?(C=mq(P,rs,null,V),t.setCachedTexture(C,z),p.time+=Date.now()-G,J&&(C.interactiveInfo={key:M,info:J}),rs=null):C=mq(P,rs,K._1O,V)}}}}return C},redraw:function(){this.iv()},validateImpl:function(){var t=this;if(t._lightChanged){t._lightChanged=!1;var r=[],L=[],_=[];t.dm().each(function(l){if(wl(l)){var W=l.s("light.type");W===mg?r.push(l):W===fk?L.push(l):W===Wi&&_.push(l)}}),(r.length!==t._59O.length||L.length!==t._spots.length||_.length!==t._dirs.length)&&Pc(t),t._59O=r,t._spots=L,t._dirs=_}var P=t.getAspect();P!==t.__cachedAspect__&&(t._updateSkybox({property:"asceptChanged"}),t.__cachedAspect__=P),t._42(),t._1o.iv()},getRenderInfo:function(){var z=this.getGL();return z?z._renderInfo:void 0},getDebugTip:function(){var Q=this,d=Q.getRenderInfo();if(d){var S=Q.getGL()._validBufCount||0,v="Draw Calls: "+d.calls+"<br/>"+"Vertices: "+d.vertices+"<br/>"+"Faces: "+d.faces+"<br/>"+"Lines: "+d.lines+"<br/>"+(d.points?"Points: "+d.points+"<br/>":"")+"Buffers: "+S+"<br/>"+"Cache Models: "+U.keys(zo).length+"<br/>"+"Shape3d Models: "+U.keys(No).length;if(Q.isVRPresenting()&&(v+="<br/>VR fps: "+Q.vr.getFps()),d.textureCache){var o=d.textureCache.count;if(v+="<br/>2D Dynamic Textures: "+d.textureCache.count,o>0){var j,R=d.textureCache.pixels;j=R>1e6?Math.round(R/1e6)+"M":R>1e3?Math.round(R/1e3)+"K":Math.round(R),v+="<br/>2D Dynamic pixels: "+j}}return v}},getFrameState:function(){return this._frameState},isBoundingBoxInView:function(){var q=new L.Math.Box3,A=new L.Math.Matrix4;return function(i){var M=i;if(M instanceof L.Data&&(M=this.getData3dUI(M)),!M.mat)return!0;var c=M.getBoundingBox();q.copy(c).applyMatrix4(A.fromArray(M.mat));var v=this.getFrustum();return v.intersectsBox(q)}}(),updateScene:function(){var e=this;e._81O=h,e.overlappingBox.clear();var O=e._40Q;O.init();var f=e.getGL(),B=e.dm();if(B.isHierarchicalRendering())B.eachByHierarchical(function(H){var u=e.getData3dUI(H);u&&u.update(e,f,O)});else{var S,j,M,E=B.getDatas().getArray(),A=E.length;for(S=0;A>S;S++)j=E[S],M=e.getData3dUI(j),M&&M.update(e,f,O)}this._updateBoxClipperMatrix(),O.onUpdated()},_pushFrameRenderOptions:function(z){this._frameRenderOptionStack.push(this._currentFrameRenderOptions),this._currentFrameRenderOptions=z},_popFrameRenderOptions:function(){this._currentFrameRenderOptions=this._frameRenderOptionStack.pop()},_getFrameRenderOptions:function(j){var G=this._currentFrameRenderOptions;return G&&G[j]},getRenderLists:function(){return this._40Q},renderScene:function(O){function s(i,E){F.setGLState(i,E),F.setUniforms(i),F.renderState.attribs.disable(),Y=g.directUniforms(),K=g.directAttribs(),K.disable()}function f(h){for(;b>c;c++){var w=v[c];if(!C||!w.ignoreInPick){if(w.priority>=h)break;(!j._43Q[j._44Q=w.id]||Pe[Ck.length])&&(w.render(M,j,F),s())}}}var j=this;j._pushFrameRenderOptions(O),j.shadowMap.render(),j.flowMap.render();var M=j.getGL();j._envmapRenderer.onBeforeRender(M),j._44Q=-1;var Y,K,F=j._frameState,g=F.renderState,X=g.glState,n=j._prg;j._projectMatrix=Mq(j),td(j,j._7O),j._viewMatrix=Kn(j._7O),j.isReflecting(M)||Nd(j._projScreenMatrix=Rb(),j._projectMatrix,j._viewMatrix),F.syncEnv(this._picking?this.pickColorMap:A),g.useProgram(n),s(!1,!0),M.clear(M.DEPTH_BUFFER_BIT);var C=j._picking,v=this._41Q,c=0,b=v.length;if(f(r.cameraPriority.skybox),C){var l=X.color.clear.slice(0);$q(M,[0,0,0,0])}else $q(M,[0,0,0,0]),X.blend.enabled=!1,X.depth.enabled=!1,X.depth.mask=!1,j._camera&&j._camera.s("camera.renderSky")===!1||j.drawSky(M,n),j._getFrameRenderOptions("renderReflector")!==!1&&j.drawReflectors(M)&&(j._projectMatrix=Mq(j),td(j,j._7O),j._viewMatrix=Kn(j._7O),F.syncEnv(),s()),X.blend.enabled=!1,X.depth.enabled=!0,X.depth.mask=!0,Y.uTransparent=!1,j._getFrameRenderOptions("renderGrid")!==!1&&j._31O._42(M,n);if(!M.textureBatch||Pe[(ONE_FRAME_TIME-6)/2]){C||(j.shadowMap.enable&&j.shadowMap.createShadow(Y),j.flowMap.createFlow(Y));for(var q=0,z=kp.length;z>q;q++){var N=kp[q],p=Fc[N];if(!(!j._camera&&p.ignore||j._camera&&!j._camera.isLayerVisible(N))){var o=p.priority;f(o),this.renderLayer(N)}}f(r.cameraPriority.infinity),j.flowMap.disableFlow(Y),Sc(j,Y,0),Y.uHeadlightColor=[1,1,1,0],Y.uUseEnvMap=!1,X.depth.enabled=!1,Y.uTransparent=!1,Y.shadowReceive=!1,Y.uEnableBoxClip=!1,C?j.drawFilter||j._30O._42(M,n):(j._highlightHelper._42(M,n),this._renderAxisAndEditHelper(j._getFrameRenderOptions("renderAxis")!==!1,j._getFrameRenderOptions("renderEdit")!==!1),X.blend.enabled=!1,X.depth.mask=!0),X.depth.enabled=!0,C&&$q(M,l),Ni(M,h),Cm(M,h),j._44Q=-1,j._popFrameRenderOptions(null)}},_renderAxisAndEditHelper:function(U,Y){if(U||Y){var g=this,z=g.getGL(),n=g._prg,V=g._frameState,D=V.renderState,E=D.glState,d=D.directUniforms();V.renderState.attribs.disable(),E.depth.enabled=!1,d.uTransparent=!1,d.shadowReceive=!1,E.blend.enabled=!1,E.depth.mask=!0,d.uPick=g._picking,U&&g._32O._42(z,n),Y&&g._30O._42(z,n),Ni(z,h),Cm(z,h)}},renderLayers:function(j,C){C&&(j=Mi(j));for(var T=0,H=j.length;H>T;T++)this.renderLayer(j[T])},renderSky:function(){var U=this,M=U._frameState,L=M.renderState,n=L.glState,A=U.getGL(),F=U._prg;U._projectMatrix=Mq(U),td(U,U._7O),U._viewMatrix=Kn(U._7O),Nd(U._projScreenMatrix=Rb(),U._projectMatrix,U._viewMatrix),M.syncEnv(),L.useProgram(F),M.setGLState(!1,!0),M.setUniforms(!1),M.renderState.attribs.disable(),A.clear(A.DEPTH_BUFFER_BIT),$q(A,[0,0,0,0]),n.blend.enabled=!1,n.depth.enabled=!1,n.depth.mask=!1,U.drawSky(A,F),n.depth.mask=!0,n.depth.enabled=!0,Ni(A,h),Cm(A,h)},addRenderLayerListener:function($,P,S){var d=this;d._renderLayerNotifier||(d._renderLayerNotifier=new _e),d._renderLayerNotifier.add($,P,S)},removeRenderLayerListener:function(c,v){this._renderLayerNotifier&&this._renderLayerNotifier.remove(c,v)},fireRenderLayerEvent:function(E,N){var Q=this._renderLayerNotifier;Q&&Q.fire({layer:E,phase:N})},renderLayer:function(o){var z=this,E=z._picking,W=z._40Q.get(o);if(W){z.fireRenderLayerEvent(o,"prepare");var B=z.getGL(),V=Fc[o],L=z._frameState,A=L.renderState,r=A.glState,s=A.directUniforms();!E&&z.isSortable()&&W.sort(z._sortFunc,z._projScreenMatrix);var P,k,$,t=W.opaque,j=W.transparent,Z=W.batchModelMap,Q=W.polylineModelMap,I=W.wireframeModelMap,B=z.getGL(),g=z._prg;E||(r.blend.enabled=!1,r.depth.enabled=!0,r.depth.mask=!0),s.uTransparent=!1,V.clearDepth!==!1&&B.clear(B.DEPTH_BUFFER_BIT);var e=this.drawFilter;if(e)for($=t,P=0,k=$.length;k>P;P++)e($[P].data)!==!0&&$[P].ui._42(B,g,v);else{for($=t,P=0,k=$.length;k>P;P++)$[P].ui._42(B,g,v);if(E)for($=j,P=0,k=$.length;k>P;P++)$[P].ui._46Q(B);qi(z,Z),mr(z,Q),mr(z,I)}if(E||(r.blend.enabled=!0,r.depth.mask=!1),z._45Q=s.uTransparent=!0,e)for($=j,P=0,k=$.length;k>P;P++)e($[P].data)!==!0&&$[P].ui._42(B,g,f);else{for($=j,P=0,k=$.length;k>P;P++)$[P].ui._42(B,g,f);qi(z,Z,null,!0),mr(z,Q,null,!0),mr(z,I,null,!0)}z._45Q=null,z.fireRenderLayerEvent(o,"post")}},_42:function(Q,Z){var j=this;if(!j._35O&&(!Am||Pe(Am))){var r=j.getWidth(),W=j.getHeight();if(r&&W){var p=j.getGL();if(p){var K,e=j._canvas;if(Q?K=!0:Q=j.getDevicePixelRatio(),!j._picking&&(K||r!==e.clientWidth||W!==e.clientHeight)){Ir(e,r,W,Q);var Y=Q;r&&Math.abs(p.drawingBufferWidth-r*Q)>1&&(Y=Math.min(Y,p.drawingBufferWidth/r)),W&&Math.abs(p.drawingBufferHeight-W*Q)>1&&(Y=Math.min(Y,p.drawingBufferHeight/W)),Y!==Q&&(j.setDevicePixelRatio(Q=Y),Ir(e,r,W,Q)),j._18Q=null}p.clear(p.COLOR_BUFFER_BIT);var a=p._renderInfo;a.calls=0,a.vertices=0,a.faces=0,a.lines=0,a.points=0,a.textureCache={time:0,count:0,pixels:0},a.frame=++j._frameId,a.cacheTimeCost=0,a.reflectDepth=0,r*=Q,W*=Q,this.syncRenderState();do{if(j.isVREnabled()&&j.vr.render(p,r,W,Z))break;if(j.updateScene(),j._postProcessing.render(p,r,W,Z))break;j.setViewport(p,0,0,r,W),j.renderScene(Z)}while(!1);j._33Q=!1,j.countFrame(),j._doBufferGC(p)}}}},syncRenderState:function(){var c,d;(c=this._frameState)&&(d=c.renderState)&&d.syncLoss()},drawReflectors:function(H){H._renderInfo.reflectDepth++;var i,P,J,b=this,n=b._dataModel.getReflectors(),e=!1;for(i in n)P=n[i],b.isVisible(P)&&(J=b.getData3dUI(P),J&&J.drawReflector(H)&&(e=!0));return H._renderInfo.reflectDepth--,e},isReflecting:function(s){return s._renderInfo.reflectDepth},getPostProcessing:function(){return this._postProcessing},enablePostProcessing:function(r,b){return this._postProcessing.enableModule(r,b)},getPostProcessingModule:function(n){return this._postProcessing.getModule(n)},getPostProcessingValue:function(q,F){var i=this._postProcessing.getModule(q);return i?i[F]:A},setPostProcessingValue:function(z,L,u){var Z=this.getPostProcessingValue(z,L),B=this._postProcessing.getModule(z);B&&Z!==u&&("enable"===L?this.enablePostProcessing(z,u):B[L]=u,this.firePropertyChange("postProcessing."+z+"."+L,Z,u))},setViewport:function(b,L,r,v,V){this._viewport=[L,r,v,V],li.for(b).directState().viewport=this._viewport},getRenderState:function(){return li.for(this._26I)},getViewport:function(){return this._viewport},setBufferGCInterval:function(D){this._bufferGCInterval=D},_doBufferGC:function(i,I){var v,l,N=i._bufPool,K=0,Y=0,L=i._renderInfo.frame,s=this._bufferGCInterval||10;for(v in N)K++,l=N[v],l&&(I||L-l._fid>s?(i.deleteBuffer(l._buf),l._buf=null,N[v]=null):Y++);if(K/2>Y&&K>128){var m={};for(v in N)N[v]&&(m[v]=N[v]);i._bufPool=m}i._validBufCount=Y},_swapLineMap:function(){var S=this;Aq=S._polylineModelMap,S._polylineModelMap=S._polylineModelMapSwap,S._polylineModelMapSwap=Aq,Aq=S._wireframeModelMap,S._wireframeModelMap=S._wireframeModelMapSwap,S._wireframeModelMapSwap=Aq,Aq=S._polylineIndexMap,S._polylineIndexMap=S._polylineIndexMapSwap,S._polylineIndexMapSwap=Aq,Aq=S._wireframeIndexMap,S._wireframeIndexMap=S._wireframeIndexMapSwap,S._wireframeIndexMapSwap=Aq},_updateSkybox:function(e){if(this._skybox&&e){var W=e.property,c=!1,f=this._skybox;if("eye"===W||"forceUpdate"===W){var E=this._eye;f.p3(E[0],E[1],E[2]),c=!0}if("near"===W||"far"===W||"forceUpdate"===W||"asceptChanged"===W){var T=f.__cachedS3__;T||(T=f.__cachedS3__=f.getFinalScale3d());var X=Math.sqrt(3),L=1/0,Y=-1/0;T.forEach(function(V){V/=2,L=n(V,L),Y=k(V,Y)}),Y*=X;var y=this._near,h=this._far,G=Math.tan(this.getFovy()/2)*y,v=this.getAspect()*G,t=1.1*Math.sqrt(v*v+G*G+y*y),M=1;if(t>L)M=t/L;else if(Y>=h){var j=h*h/(y+h);M=j/Y}if(1!==M){f.__updatingSkybox__=!0;var q=T.map(function(T){return M*T});f.s3(q),f.setScale3d(1,1,1),c=!0,delete f.__updatingSkybox__}}c&&this.invalidateData(f)}},getSkyBox:function(){return this.getSkybox()},setSkyBox:function(R){return this.setSkybox(R)},getSkybox:function(){return this._skybox},setSkybox:function(c){var V=this._skybox;if(V===c)return c&&this._updateSkybox({property:"forceUpdate"}),void 0;if(V&&(this._skyboxStyleMap&&V.setStyleMap(this._skyboxStyleMap),this._skyboxStyleMap=null,this._skyboxAnchor3d&&V.setAnchor3d(this._skyboxAnchor3d),this._skyboxAnchor3d=null,this._skyboxP3&&V.p3(this._skyboxP3),this._skyboxP3=null,this.handleDataModelChange({kind:Yk,data:V})),this._skybox=c,this.ump(this._updateSkybox,this),c){c.dm()&&c.dm().remove(c),this._skyboxStyleMap=L.Default.clone(c.getStyleMap()),this._skyboxAnchor3d=c.getAnchor3d(),c.setAnchor3d(.5,.5,.5),this._skyboxP3=c.p3().slice(0),c.s({"shape3d.reverse.flip":!0,"shape3d.reverse.cull":!1,"all.reverse.flip":!0,"all.reverse.cull":!1,"front.reverse.flip":!0,"front.reverse.cull":!1,"back.reverse.flip":!0,"back.reverse.cull":!1,"left.reverse.flip":!0,"left.reverse.cull":!1,"right.reverse.flip":!0,"right.reverse.cull":!1,"top.reverse.flip":!0,"top.reverse.cull":!1,"bottom.reverse.flip":!0,"bottom.reverse.cull":!1});
var q=c.onPropertyChanged;c.onPropertyChanged=function(s){q.call(c,s),!c.__updatingSkybox__&&["width","height","tall","scale","scaleTall"].indexOf(s.property)>=0&&(c.__cachedS3__=A)},this.mp(this._updateSkybox,this),this._updateSkybox({property:"forceUpdate"})}this.fp("skybox",V,c)},drawSky:function(W,M){var S=this,K=S._skybox;if(K){var k=li.for(W).directUniforms(),X=S._headlightIntensity,Z=Jn(S._headlightColor),M=S._prg;1!==X&&(Z=[Z[0]*X,Z[1]*X,Z[2]*X]),k.uHeadlightColor=[Z[0],Z[1],Z[2],1];var e=S.getData3dUI(K);if(e){var V=S.isOrtho(),Q=V||this._computedProjectMatrix;if(Q){var u=S._projectMatrix;V&&(S._ortho=!1),k.uPMatrix=S._projectMatrix=Mq(S,!0)}var c=K.p3(),x=this.getEye();(c[0]!==x[0]||c[1]!==x[1]||c[2]!==x[2])&&(K._position.x=x[0],K._54O=x[1],K._position.y=x[2]),e.validate(),e._42(W,M,s),Q&&(V&&(S._ortho=!0),k.uPMatrix=S._projectMatrix=u)}W.clear(W.DEPTH_BUFFER_BIT),k.uHeadlightColor=[Z[0],Z[1],Z[2],S._headlightDisabled?1:0]}},getLogicalPoint:function(H){return Ge(H,this._canvas)},isRectOverlapping:function(U){var p=this.getData3dUI(U);return p._rectOverlapping},getHitFaceInfo:function(P){P.target&&(P=this.lp(P));var o=this.getDataInfoAt(P);if(o){var x=this.intersectObject(P,o.data);if(x)return{data:o.data,face:x.part}}return h},unproject:function(c,W){var Z=this,x=Z.getWidth(),X=Z.getHeight(),K=c.target?Z.lp(c):c,L=K.x-x/2,t=K.y-X/2,V=2*(L/x),b=2*(-1*t/X);W=W||0;var p=Rb(),A=Mq(Z),d=td(Z);Nd(p,A,d),oq(p);var P=Qq([V,b,W,1],p);return[P[0]/P[3],P[1]/P[3],P[2]/P[3]]},getDataAt:function(X){var i=this.getDataInfoAt(X);return i?i.data:h},getDataInfoAt:function(f,J,A){return f.target&&(f=this.lp(f)),this._1o.get(kj(f.x,f.y,J),!0,A)},getDatasInRect:function(B,R){return this._1o.get(B,!1,R)},setEditable:function(o){var e=this,r=e._editable;e._editable=o,this.fp(qe,r,o)},isEditable:function(h){var i=this;return h?i._editable?nf(h)?h.s("3d.editable")?i._editableFunc?i._editableFunc(h):!0:!1:!1:!1:i._editable},isSelectable:function(L){return L.s("3d.selectable")&&this.sm().isSelectable(L)},isMovable:function(r){var S=this;return vm(r)&&r.getStyle(Ye)!==Bb?!1:r.s("3d.movable")?S._movableFunc?S._movableFunc(r):!0:!1},isSizeEditable:function(k){return nf(k)?this._sizeEditableFunc?this._sizeEditableFunc(k):!0:!1},isRotationEditable:function(Y){return nf(Y)&&Y.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(Y):!0:!1},handleDelete:function(){this._editable&&this.removeSelection()},zoomIn:function(x){this.setZoom(Vn,x)},zoomOut:function(R){this.setZoom(1/Vn,R)},setZoom:function(){var r=new Ai,p=new Ai,F=new Ai,V=new Ai;return function(j,y){if(1!==j){var D=this;D._14o&&D._14o.stop(!0);var Y,e=1/j;r.copy(D.getCenter()),p.copy(D.getEye());var H=D._ortho;if(H){if(Y=D._orthoWidth,Y<D._moveStep&&j>1)return}else if(r.distanceTo(p)<D._moveStep&&1>e)return;var Z=!1;return D._zoomToCenter===!1&&D._lastZoomLP&&(F.copy(p).sub(r).normalize(),D._81O=null,V.copy(D.getHitPosition(D._lastZoomLP,r.toArray(),F.toArray())),Z=!0,D._lastZoomHit=V),(y=ci(y))?(y.action=function(f){D.fi({kind:D._zooming?"betweenZoom":"beginZoom"}),D._zooming=1;var w=(e-1)*f+1;H&&D.setOrthoWidth(Y*w),Z?(D.setEye(F.lerpVectors(V,p,w).toArray()),D.setCenter(F.lerpVectors(V,r,w).toArray())):H||D.setEye(F.lerpVectors(r,p,w).toArray())},y._37o=function(){delete D._14o,delete D._zooming,D.fi({kind:"endZoom"}),D.onZoomEnded()},D._14o=Hm(y)):(H&&D.setOrthoWidth(Y*e),Z?(D.setEye(F.lerpVectors(V,p,e).toArray()),D.setCenter(F.lerpVectors(V,r,e).toArray())):H||D.setEye(F.lerpVectors(r,p,e).toArray()),void 0)}}}(),setOrthoZoom:function(o,S){return this.setZoom(o,S)},getPositionInfo:function($){var U=this,S=U._eye,G=U._center,E=U.getAspect(),j=$?gf(ik(G,S,!0),ik($,S)):ml(S,G);if(U._ortho){var r=U._orthoWidth;return{length:j,height:r/E,width:r}}var z=2*Ph(U._fovy/2)*j;return{length:j,height:z,width:z*E}},getCenterInfo:function(){var X=this;return X._81O||(X._81O=X.getPositionInfo()),Bi(X._81O)},rotate:function(y,P,l,f){var t=this;if(y||P){f==h&&(f=t._firstPersonMode),t._88O&&t._88O.stop(!0);var c=t._center,Q=t._eye,M=t.getCenterInfo().length,B=f?c:Q,L=f?Q:c,H=ik(B,L),V=tj(H[0],H[2]),C=tj(R(H[0]*H[0]+H[2]*H[2]),H[1]),s=f?Sb:tf;return f&&(P=-P),(l=ci(l))?(l.action=function(p){t.fi({kind:t._rotating?"betweenRotate":"beginRotate"}),t._rotating=1;var K=V+y*p,x=C+P*p;x=f?g-bh(t,g-x):bh(t,x),H[0]=M*e(x)*e(K),H[1]=M*$(x),H[2]=M*e(x)*$(K),B[0]=L[0]+H[0],B[1]=L[1]+H[1],B[2]=L[2]+H[2],t.fp(s,h,B)},l._37o=function(){delete t._88O,delete t._rotating,t.fi({kind:"endRotate"}),t.onRotateEnded()},t._88O=Hm(l)):(V+=y,C+=P,C=f?g-bh(t,g-C):bh(t,C),H[0]=M*e(C)*e(V),H[1]=M*$(C),H[2]=M*e(C)*$(V),B[0]=L[0]+H[0],B[1]=L[1]+H[1],B[2]=L[2]+H[2],t.fp(s,h,B),void 0)}},pan:function(J,M,S,$){if(J||M){var Q=this;$==h&&($=Q._firstPersonMode),Q._89O&&Q._89O.stop(!0);var A=td(Q),e=[A[0]*J,A[4]*J,A[8]*J],W=[A[1]*M,A[5]*M,A[9]*M],i=e[0]+W[0],u=e[1]+W[1],x=e[2]+W[2],V=Q._center,N=Q._eye;if($){var w=Oo(Q.getBoundaries(),N[0],N[2],N[0]+i,N[2]+x,R(i*i+x*x));i=w[0],x=w[1]}if(S=ci(S)){var s=Bi(N),d=Bi(V);return S.action=function(Z){Q.fi({kind:Q._panning?"betweenPan":"beginPan"}),Q._panning=1,V[0]=d[0]+i*Z,V[1]=d[1]+u*Z,V[2]=d[2]+x*Z,N[0]=s[0]+i*Z,N[1]=s[1]+u*Z,N[2]=s[2]+x*Z,Q.fp(tf,h,N),Q.fp(Sb,h,V)},S._37o=function(){delete Q._89O,delete Q._panning,Q.fi({kind:"endPan"}),Q.onPanEnded()},Q._89O=Hm(S)}V[0]+=i,V[1]+=u,V[2]+=x,N[0]+=i,N[1]+=u,N[2]+=x,Q.fp(tf,h,N),Q.fp(Sb,h,V)}},walk:function(d,k,G){if(d){var D=this;G==h&&(G=D._firstPersonMode),D._90O&&D._90O.stop(!0);var R=D._center,i=D._eye,u=ik(R,i,!0);if(G){var U=Oo(D.getBoundaries(),i[0],i[2],i[0]+u[0]*d,i[2]+u[2]*d,z(d));if(d=ml(U),!d)return;u=[U[0]/d,0,U[1]/d]}if(k=ci(k)){var j=Bi(i),y=Bi(R);return k.action=function(U){D.fi({kind:D._walking?"betweenWalk":"beginWalk"}),D._walking=1;var $=d*U;i[0]=j[0]+u[0]*$,i[1]=j[1]+u[1]*$,i[2]=j[2]+u[2]*$,R[0]=y[0]+u[0]*$,R[1]=y[1]+u[1]*$,R[2]=y[2]+u[2]*$,D.fp(tf,h,i),D.fp(Sb,h,R)},k._37o=function(){delete D._90O,delete D._walking,D.fi({kind:"endWalk"}),D.onWalkEnded()},D._90O=Hm(k)}i[0]+=u[0]*d,i[1]+=u[1]*d,i[2]+=u[2]*d,R[0]+=u[0]*d,R[1]+=u[1]*d,R[2]+=u[2]*d,D.fp(tf,h,i),D.fp(Sb,h,R)}},handleScroll:function(p,P){ae(p);var k=this,i=k._moveStep,Y=k.getDataInfoAt(p);if(Y){var j=Y.data;if(j&&k.isInteractive(j)){var L=k.intersectObject(p,j);if(L){var h=L.part,e=Tj(j.s(h+".image")||j.s("shape3d."+h+".image")||j.s("all.image")||j.s("shape3d.image"));if(e&&zm(e.scrollable,j,k))return}}}return k.isFirstPersonMode()?(k.isPannable()&&k.pan(0,P>0?i:-i),void 0):(k.isZoomable()&&(k._lastZoomLP=k.lp(p),k.setZoom(0>P?1/Dm:Dm),k._lastZoomLP=k._lastZoomHit=null),void 0)},handlePinch:function(C,P){if(this.isZoomable()){if(Math.abs(C-P)<r.pinchZoomThreshold)return;this.setZoom(P>C?1/ks:ks)}},reset:function(i){this.setUp(r.graph3dViewUp),this.moveCamera(r.graph3dViewEye,r.graph3dViewCenter,i)},moveSelection:function(e,b,v){var m=this;m.dm().beginTransaction(),Cn(this.sm().toSelection(this.isMovable,this),e,b,v),m.dm().endTransaction()},getMoveMode:function(M,j){var p=j.s("3d.move.mode");if(p)return p;var H="88",V="89",A="90";return Fr(M)||bq[H]&&bq[V]&&bq[A]?"xyz":bq[H]&&bq[V]?"xy":bq[H]&&bq[A]?"xz":bq[V]&&bq[A]?"yz":bq[H]?"x":bq[V]?"y":bq[A]?"z":"xz"},handleTick:function(){var D=this,n=!1,M=D._moveStep,e=M,T=!1,J=!0,C=D._rotateStep*(J?-1:1);if(D.isWalkable()||(e=0),D.isPannable()||(M=0),D.isRotatable()||(C=0),D._32Q){var E=(qh()-D._32Q)/50;e*=E,M*=E,C*=E}D._31Q&&(ye(D._31Q),delete D._31Q,delete D._32Q),Ho()&&(n=!0,D.pan(-M,0,T,J)),vc()&&(n=!0,D.pan(M,0,T,J)),Hf()&&(n=!0,Fr()?D.pan(0,M,T,J):D.walk(e,T,J)),sh()&&(n=!0,Fr()?D.pan(0,-M,T,J):D.walk(-e,T,J)),oo()&&(n=!0,D.rotate(-C,0,T,J)),Qm()&&(n=!0,D.rotate(C,0,T,J)),qo()&&(n=!0,D.rotate(0,-C/2,T,J)),zj()&&(n=!0,D.rotate(0,C/2,T,J)),n&&(D._32Q=qh(),D._31Q=Tq(D.handleTick,D))},handleKeyDown:function($){var t=this;!mj($)&&lq[$.keyCode]?t.handleTick():Mk($)?t.selectAll():Of($)?t.handleDelete($):ph($)&&this.isResettable()&&t.reset()},checkDoubleClickOnNote:function(V,B,C){var b=this;if(C===mi){if(B.s("note.toggleable"))return B.s(io,!B.s(io)),b.fi({kind:"toggleNote",event:V,data:B,part:C}),!0}else if(C===ql&&B.s("note2.toggleable"))return B.s(Tk,!B.s(Tk)),b.fi({kind:"toggleNote2",event:V,data:B,part:C}),!0;return!1},checkDoubleClickOnRotation:function(C,F,S){return S===Js?(F.setRotationX(0),!0):S===Ks?(F.setRotationY(0),!0):S===Ls?(F.setRotationZ(0),!0):!1},onRotateEnded:function(){},onWalkEnded:function(){},getViewRatio:function(H){var O=this;if(O.isOrtho())return O.getWidth()/O.getOrthoWidth();var o=O.getCenter(),h=O.getHeight(),C=O.getEye(),m=[o[0]-C[0],o[1]-C[1],o[2]-C[2]],Z=[H[0]-C[0],H[1]-C[1],H[2]-C[2]],K=Math.sqrt(m[0]*m[0]+m[1]*m[1]+m[2]*m[2]),N=1/Math.tan(O.getFovy()/2);return h*K*N/(Z[0]*m[0]+Z[1]*m[1]+Z[2]*m[2])},inViewSpace:function(V){var X,R=this,C=R._transformPointToViewSpace(V),B=R.getAspect(),T=R.getNear(),p=R.getFar();return-C[2]<T||-C[2]>p?!1:R.isOrtho()?(X=R.getOrthoWidth()/2,Math.abs(C[0])<=X&&Math.abs(C[1]*B)<=X):(X=Math.sqrt(C[0]*C[0]+C[1]*C[1]+C[2]*C[2])*Math.tan(R.getFovy()/2),Math.abs(C[1]<=X)&&Math.abs(C[0])<=X*B)},getPVMatrix:function(){var p,i=this;return(p=i._18Q)||(p=Mq(i),i._18Q=Nd(p,p,td(i)),i._18Q._wh=i.getWidth()/2/i.getHeight()),p},getFrustum:function(){var u=new nk,f=new Ib,p=new Array(16);return function(){for(var T=this.getPVMatrix(),v=!1,M=0;16>M;M++)T[M]!==p[M]&&(v=!0,p[M]=T[M]);return v&&f.setFromMatrix(u.fromArray(T)),f}}(),toViewPosition:function(s){var j=this,r=j.getWidth()/2,E=j.getHeight()/2,i=j.getPVMatrix();return s=Qq([s[0],s[1],s[2],1],i),{x:r+r*s[0]/s[3],y:E-E*s[1]/s[3],z:s[2]/s[3]}},getHitPosition:function(y,O,j){var K=this,u=K.getWidth(),t=K.getHeight(),Z=y.target?K.lp(y):y,f=Z.x-u/2,F=Z.y-t/2,a=K.getCenterInfo(),G=td(K);O=O?O:[0,0,0],j=j?j:[0,1,0],f=f/u*a.width,F=-1*F/t*a.height;var m=[G[0]*f,G[4]*f,G[8]*f],q=[G[1]*F,G[5]*F,G[9]*F],w=[m[0]+q[0],m[1]+q[1],m[2]+q[2]],V=K.getCenter(),l=ep(K,O,j,[w[0]+V[0],w[1]+V[1],w[2]+V[2]]);return l?l:[0,0,0]},intersectObject:function(S,N){return this._raycaster.intersectObject(S,N)},intersectObjects:function(h,l,C){return this._raycaster.intersectObjects(h,l,C)},getLineLength:function(T){this.validate();var g=this.getData3dUI(T);if(g&&g.getCache){var j=g.getCache();if(j)return j[j.length-1].length}return 0},getLineOffset:function(f,F){var x=this.getData3dUI(f);if(x&&x.getCache){var O=x.getCache();if(O){var y=Wp(O,F);if(!f.r3)return y;var _=f.r3();if(0===_[0]&&0===_[1]&&0===_[2])return y;var o=new Ai(f.p3()),p=new Ai(y.point).sub(o),L=new Ai(y.tangent).add(p),g=(new er).setFromEuler(new to(_,f.getRotationMode(),!0));return p.applyQuaternion(g),L.applyQuaternion(g),{point:p.add(o),tangent:L.sub(p).normalize()}}}return h},isLabelVisible:function(){return!0},isNoteVisible:function(){return!0},moveCamera:function(O,z,h){var k=this,x=k.getEye();x=[x[0],x[1],x[2]];var V=k.getCenter();if(V=[V[0],V[1],V[2]],O||(O=x),z||(z=V),k._flyAnim&&k._flyAnim.stop(!0),h=ci(h),!h)return k.setEye(O[0],O[1],O[2]),k.setCenter(z[0],z[1],z[2]),delete k._flyAnim,!0;var B=[O[0]-x[0],O[1]-x[1],O[2]-x[2]],m=[z[0]-V[0],z[1]-V[1],z[2]-V[2]];return h.action=function(e){k.setCenter(V[0]+m[0]*e,V[1]+m[1]*e,V[2]+m[2]*e),k.setEye(x[0]+B[0]*e,x[1]+B[1]*e,x[2]+B[2]*e)},h._37o=function(){delete k._flyAnim},k._flyAnim=Hm(h)},flyTo:function(){function t(O,k,$){if($ instanceof L.Node){F.fromArray(hk($,k.getMat($)));var x=$.getAnchor3d();O.push((new Ai).set(0-x.x,0-x.y,0-x.z).applyMatrix4(F)),O.push((new Ai).set(0-x.x,0-x.y,1-x.z).applyMatrix4(F)),O.push((new Ai).set(0-x.x,1-x.y,0-x.z).applyMatrix4(F)),O.push((new Ai).set(0-x.x,1-x.y,1-x.z).applyMatrix4(F)),O.push((new Ai).set(1-x.x,0-x.y,0-x.z).applyMatrix4(F)),O.push((new Ai).set(1-x.x,0-x.y,1-x.z).applyMatrix4(F)),O.push((new Ai).set(1-x.x,1-x.y,0-x.z).applyMatrix4(F)),O.push((new Ai).set(1-x.x,1-x.y,1-x.z).applyMatrix4(F))}}var k=new Ai,z=new Ai,W=new Ai,O=new Ai,V=new Ai,F=new nk,w=new L.Math.Quaternion,R=new to,P=new Ng;return function(B,g,x){var K=this;if(x!==A)g={animation:g,ratio:x};else{var Q=typeof g;("boolean"===Q||"object"===Q&&g.duration)&&(g={animation:g})}g=g||{},k.fromArray(K.getEye()),z.fromArray(K.getCenter());var H,G,I=[],m=g.center,r=g.distance===A;if(m&&W.fromArray(m),B||(B=K.dm().getDatas()),1===B.length&&(B=Tg(B)?B.get(0):B[0]),B instanceof L.Node)m||W.fromArray(B.p3()),r&&(t(I,K,B),H=I.length);else{if(!B.length)return;if((r||!m)&&(I=[],B.forEach(function(y){t(I,K,y)}),H=I.length,!H))return;m||(P.setFromPoints(I),W.copy(P.min).add(P.max).multiplyScalar(.5))}if(K.setCenter(W.x,W.y,W.z),O.subVectors(k,z),g.direction||g.worldDirection){!g.worldDirection&&B instanceof L.Node?w.setFromEuler(R.set(B.r3(),B.getRotationMode(),!0)):w.set(0,0,0,1);var $=O.length();O.fromArray(g.worldDirection||g.direction).applyQuaternion(w).setLength($)}var M=0;if(r){var S,f,s,x=g.ratio||.8,q=g.xRatio||x,o=g.yRatio||x;if(V.copy(O),K.isOrtho()){var p=-1/0;for(K._eye[0]=O.x+W.x,K._eye[1]=O.y+W.y,K._eye[2]=O.z+W.z,S=Mq(K),Nd(S,S,td(K)),G=0;H>G;G++)s=I[G],f=Qq([s.x,s.y,s.z,1],S),p=Math.max(p,Math.max(Math.abs(f[0])/q,Math.abs(f[1])/o));M=K.getOrthoWidth()*p}else{for(var Y,l,h=K.getNear(),j=10;j--;){for(K._eye[0]=O.x+W.x,K._eye[1]=O.y+W.y,K._eye[2]=O.z+W.z,S=Mq(K),Nd(S,S,td(K)),Y=!0,l=-1/0,G=0;H>G;G++){if(s=I[G],f=Qq([s.x,s.y,s.z,1],S),f[3]<h&&j){O.multiplyScalar(2),Y=!1;break}l=Math.max(l,Math.max(Math.abs(f[0])/q,Math.abs(f[1])/o)-f[3])}if(Y)break}O.setLength(l+O.length())}O.manhattanLength()<1e-6&&O.copy(V)}else O.setLength(g.distance);var d=O.add(W);K._flyAnim&&K._flyAnim.stop(!0);var U=ci(g.animation);if(U){K.setEye(k.x,k.y,k.z),K.setCenter(z.x,z.y,z.z);var e=(new Ai).subVectors(d,k),D=(new Ai).subVectors(W,z);if(M)var u=K.getOrthoWidth();var Z=new Ai,F=new Ai,i=U.action,X=U._37o,a=k.clone(),T=z.clone();return U.action=function(c,n){Z.copy(a).addScaledVector(e,c),F.copy(T).addScaledVector(D,c),K.setCenter(F.x,F.y,F.z),K.setEye(Z.x,Z.y,Z.z),M&&K.setOrthoWidth((M-u)*c+u),i&&i(c,n)},U._37o=function(){delete K._flyAnim,X&&X()},{lastEye:k,lastCenter:z,eye:d,center:W,orthoWidth:M,animation:K._flyAnim=Hm(U)}}return K.setEye(d.x,d.y,d.z),M&&K.setOrthoWidth(M),delete K._flyAnim,{lastEye:k,lastCenter:z,eye:d,center:W,orthoWidth:M}}}(),getBoundingBox:function(){function u(I,Y,S){N.fromArray(hk(S,Y.getMat(S)));var h=S.getAnchor3d();I.push((new Ai).set(0-h.x,0-h.y,0-h.z).applyMatrix4(N)),I.push((new Ai).set(0-h.x,0-h.y,1-h.z).applyMatrix4(N)),I.push((new Ai).set(0-h.x,1-h.y,0-h.z).applyMatrix4(N)),I.push((new Ai).set(0-h.x,1-h.y,1-h.z).applyMatrix4(N)),I.push((new Ai).set(1-h.x,0-h.y,0-h.z).applyMatrix4(N)),I.push((new Ai).set(1-h.x,0-h.y,1-h.z).applyMatrix4(N)),I.push((new Ai).set(1-h.x,1-h.y,0-h.z).applyMatrix4(N)),I.push((new Ai).set(1-h.x,1-h.y,1-h.z).applyMatrix4(N))}var N=new nk;return function(Q){if(Q=Q||this.sm().getSelection(),Q instanceof L.Node&&(Q=[Q]),0===Q.length)return h;var G=[];Q.forEach(function(Z){nf(Z)&&u(G,this,Z)},this);var A=[1/0,1/0,1/0],g=[-1/0,-1/0,-1/0];return G.forEach(function(F){A[0]=Math.min(F.x,A[0]),A[1]=Math.min(F.y,A[1]),A[2]=Math.min(F.z,A[2]),g[0]=Math.max(F.x,g[0]),g[1]=Math.max(F.y,g[1]),g[2]=Math.max(F.z,g[2])}),{min:A,max:g}}}(),setBatchInfo:function(x,L){var j=this._batchInfoMap[x];this._batchInfoMap[x]=L,this.fp("batchInfo",j,L)},getBatchInfo:function(v){return this._batchInfoMap[v]||kh[v]},setOrthoWidth:function(F){var R=this._orthoWidth;if(this._orthoWidth=F,this._syncEyeWithOrthoWidth){var D=F/this.getAspect(),T=D/2/Ph(this.getFovy()/2),B=(new Ai).fromArray(this.getEye()),x=(new Ai).fromArray(this.getCenter());B.sub(x).setLength(T).add(x),this.setEye(B.toArray())}this.fp("orthoWidth",R,F)},getCamera:function(R){var H=this;R||(R=H._mainCamera,R||(R=H._mainCamera=new L.Camera)),R.s({"camera.type":H.isOrtho()?"ortho":"perspective","camera.aspect":H.getAspect(),"camera.fovy":H.getFovy(),"camera.ortho.width":H.getOrthoWidth(),"camera.near":H.getNear(),"camera.far":H.getFar()});var U=H.getEye();return R.p3(U.slice()),R.lookAt(H.getCenter(),H.getUp()),R}}),function(){function X(j,L,G){var e=j[L];e&&e.releaseTexture(),j[L]=G}function d(){return["\n #ifdef ENVMAP_TYPE_CUBE_UV \n","#define cubeUV_maxMipLevel 8.0 \n","#define cubeUV_minMipLevel 4.0 \n","#define cubeUV_maxTileSize 256.0 \n","#define cubeUV_minTileSize 16.0 \n","float getFace(vec3 direction) {","vec3 absDirection = abs(direction);","float face = - 1.0;","if (absDirection.x > absDirection.z) {","if (absDirection.x > absDirection.y)","face = direction.x > 0.0 ? 0.0 : 3.0;"," else ","face = direction.y > 0.0 ? 1.0 : 4.0;","} else {","if (absDirection.z > absDirection.y) ","face = direction.z > 0.0 ? 2.0 : 5.0;"," else ","face = direction.y > 0.0 ? 1.0 : 4.0;","}","return face;","} ","vec2 getUV(vec3 direction, float face) {","vec2 uv;","if (face == 0.0) {","uv = vec2(direction.z, direction.y) / abs(direction.x);","} else if (face == 1.0) {","uv = vec2(- direction.x, - direction.z) / abs(direction.y);","} else if (face == 2.0) {","uv = vec2(- direction.x, direction.y) / abs(direction.z);","} else if (face == 3.0) {","uv = vec2(- direction.z, direction.y) / abs(direction.x);","} else if (face == 4.0) {","uv = vec2(- direction.x, direction.z) / abs(direction.y);","} else {","uv = vec2(direction.x, direction.y) / abs(direction.z);","}","return 0.5 * (uv + 1.0);","} ","vec3 bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {","float face = getFace(direction);","float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);","mipInt = max(mipInt, cubeUV_minMipLevel);","float faceSize = exp2(mipInt);","float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);","vec2 uv = getUV(direction, face) * (faceSize - 1.0);","vec2 f = fract(uv);","uv += 0.5 - f;","if (face > 2.0) {","uv.y += faceSize;","face -= 3.0;","}","uv.x += face * faceSize;","if (mipInt < cubeUV_maxMipLevel) {","uv.y += 2.0 * cubeUV_maxTileSize;","}","uv.y += filterInt * 2.0 * cubeUV_minTileSize;","uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);","uv *= texelSize;","vec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;","uv.x += texelSize;","vec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;","uv.y += texelSize;","vec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;","uv.x -= texelSize;","vec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;","vec3 tm = mix(tl, tr, f.x);","vec3 bm = mix(bl, br, f.x);","return mix(tm, bm, f.y);","}","\n #define r0 1.0 \n","#define v0 0.339 \n","#define m0 - 2.0 \n","#define r1 0.8 \n","#define v1 0.276 \n","#define m1 - 1.0 \n","#define r4 0.4 \n","#define v4 0.046 \n","#define m4 2.0 \n","#define r5 0.305 \n","#define v5 0.016 \n","#define m5 3.0 \n","#define r6 0.21 \n","#define v6 0.0038 \n","#define m6 4.0 \n","float roughnessToMip(float roughness) {","float mip = 0.0;","if (roughness >= r1) {","mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;","} else if (roughness >= r4) {","mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;","} else if (roughness >= r5) {","mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;","} else if (roughness >= r6) {","mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;","} else {","mip = - 2.0 * log2(1.16 * roughness);","}","return mip;","} ","vec4 textureCubeUV(sampler2D envMap, vec3 sampleDir, float roughness) {","float mip = clamp(roughnessToMip(roughness), m0, cubeUV_maxMipLevel);","float mipF = fract(mip);","float mipInt = floor(mip);","vec3 color0 = bilinearCubeUV(envMap, sampleDir, mipInt);","if (mipF == 0.0) {","return vec4(color0, 1.0);","} else {","vec3 color1 = bilinearCubeUV(envMap, sampleDir, mipInt + 1.0);","return vec4(mix(color0, color1, mipF), 1.0);","}","} ","\n #endif \n"].join("")}function u(){return["vec4 sRGBToLinear( in vec4 value ) {","return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );","}","vec4 LinearTosRGB( in vec4 value ) {","return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );","}","vec4 inputTexelToLinear( vec4 value ) { return sRGBToLinear( value ); }","vec4 linearToOutputTexel( vec4 value ) { return LinearTosRGB( value ); }","vec4 envMapTexelToLinear( vec4 color ) { return inputTexelToLinear( color ); }"].join("")}function F(){return["precision mediump float;\n","precision mediump int;\n","attribute vec3 position;","attribute vec2 uv;","attribute float faceIndex;","varying vec3 vOutputDirection;","vec3 getDirection( vec2 uv, float face ) {","uv = 2.0 * uv - 1.0;","vec3 direction = vec3( uv, 1.0 );","if ( face == 0.0 ) { direction = direction.zyx; } ","else if ( face == 1.0 ) { direction = direction.xzy; direction.xz *= -1.0; } ","else if ( face == 2.0 ) { direction.x *= -1.0; }","else if ( face == 3.0 ) { direction = direction.zyx; direction.xz *= -1.0; } ","else if ( face == 4.0 ) { direction = direction.xzy; direction.xy *= -1.0; } ","else if ( face == 5.0 ) { direction.z *= -1.0; }","return direction;","}","void main() {","vOutputDirection = getDirection( uv, faceIndex );","gl_Position = vec4( position, 1.0 );","}"].join("")}function k(){return{vs:F(),fs:["precision mediump float;\n","precision mediump int;\n","varying vec3 vOutputDirection;","uniform samplerCube envMap;\n",u(),"\n void main() {","gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );","gl_FragColor.rgb = envMapTexelToLinear( textureCube( envMap, vec3(- vOutputDirection.x, vOutputDirection.yz ) ) ).rgb;","gl_FragColor = linearToOutputTexel( gl_FragColor );","}"].join("")}}function e(){return{vs:F(),fs:["precision mediump float;\n","precision mediump int;\n","varying vec3 vOutputDirection;","uniform sampler2D envMap;","uniform vec2 texelSize;\n",u(),"\n #define RECIPROCAL_PI 0.3183098861837907 \n","\n #define RECIPROCAL_PI2 0.15915494309189535 \n","vec2 equirectUv( in vec3 dir ) {","float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;","float v = 0.5 - asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI;","return vec2( u, v );","}","void main() {","gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );","vec3 outputDirection = normalize( vOutputDirection );","vec2 uv = equirectUv( outputDirection );","vec2 f = fract( uv / texelSize - 0.5 );","uv -= f * texelSize;","vec3 tl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;","uv.x += texelSize.x;","vec3 tr = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;","uv.y += texelSize.y;","vec3 br = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;","uv.x -= texelSize.x;","vec3 bl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;","vec3 tm = mix( tl, tr, f.x );","vec3 bm = mix( bl, br, f.x );","gl_FragColor.rgb = mix( tm, bm, f.y );","gl_FragColor = linearToOutputTexel( gl_FragColor );","}"].join("")}}function K(j){return{vs:F(),fs:["precision mediump float;\n","precision mediump int;\n","#define n "+j+"\n","varying vec3 vOutputDirection;","uniform sampler2D envMap;","uniform int samples;","uniform float weights[ n ];","uniform bool latitudinal;","uniform float dTheta;","uniform float mipInt;","uniform vec3 poleAxis; \n",u(),"\n #define ENVMAP_TYPE_CUBE_UV \n",d(),"\n vec3 getSample( float theta, vec3 axis ) {","float cosTheta = cos( theta );","vec3 sampleDirection = vOutputDirection * cosTheta + cross(axis, vOutputDirection) * sin(theta) + axis * dot(axis, vOutputDirection) * (1.0 - cosTheta);","return bilinearCubeUV( envMap, sampleDirection, mipInt );","}","void main() {","vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );","if ( all( equal( axis, vec3( 0.0 ) ) ) ) {","axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );","}","axis = normalize( axis );","gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );","gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );","for ( int i = 1; i < n; i++ ) {","if ( i >= samples ) { break; }","float theta = dTheta * float( i );","gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );","gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );","}","gl_FragColor = linearToOutputTexel( gl_FragColor );","}"].join("")}}var B=hd.EnvmapRenderer=function(l){this.gv=l,this._envmaps={},this._envmapHash={},this._probeCaptureTime={},this._pingPongRenderTarget=null,this._equirectShader=null,this._cubemapShader=null,this._blurMaterial=null,this._lastCaptureFrame=0};B.prototype={},B.prototype.constructor=B,B.prototype.changeEnvmapType=function(A){"legacy"===A?(this.setEnvmapByProbeId=this.setEnvmapLegacy,this.onBeforeRender=this.onBeforeRenderLegacy):(this.setEnvmapByProbeId=this.setEnvmap,this.onBeforeRender=this.onBeforeRenderNew)},B.prototype.invalidateEnvmap=function(R){var h=this.gv;if("legacy"!==h.getEnvmapType()){var u=h.getGL();u&&(R?(delete this._envmapHash[R],delete this._probeCaptureTime[R]):(this._envmapHash={},this._probeCaptureTime={}),h.iv())}},B.prototype.onBeforeRenderLegacy=function($){this.assureTextureLegacy($)},B.prototype.assureTextureLegacy=function(k){var o=this,A=o.gv,Y=A.getEnvmap();if(Y!==o._lastLegacyImage){if(o._envmapLegacy&&(k.deleteTexture(o._envmapLegacy),o._envmapLegacy=null),!Y)return o._lastLegacyImage=Y,void 0;var K=r.getImage(Y);if(K&&K.tagName){K=r.resizeImagePOT(K,!0);var b=o._envmapLegacy=k.createTexture();k.activeTexture(k.TEXTURE0),k.bindTexture(k.TEXTURE_CUBE_MAP,b),k.texParameteri(k.TEXTURE_CUBE_MAP,k.TEXTURE_MAG_FILTER,k.LINEAR),k.texParameteri(k.TEXTURE_CUBE_MAP,k.TEXTURE_MIN_FILTER,k.LINEAR),k.texImage2D(k.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,k.RGBA,k.RGBA,k.UNSIGNED_BYTE,K),k.texImage2D(k.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,k.RGBA,k.RGBA,k.UNSIGNED_BYTE,K),k.texImage2D(k.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,k.RGBA,k.RGBA,k.UNSIGNED_BYTE,K),k.texImage2D(k.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,k.RGBA,k.RGBA,k.UNSIGNED_BYTE,K),k.texImage2D(k.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,k.RGBA,k.RGBA,k.UNSIGNED_BYTE,K),k.texImage2D(k.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,k.RGBA,k.RGBA,k.UNSIGNED_BYTE,K),k.bindTexture(k.TEXTURE_CUBE_MAP,k._emptyCubeTexture),o._lastLegacyImage=Y}}},B.prototype.setEnvmapLegacy=function(v){v.uEnvMap=this._envmapLegacy},B.prototype.onBeforeRenderNew=function(J){this.assureTextureNew(J),this.resetUniformCache()},B.prototype.assureTextureNew=function(v){var R=this,p=R.gv,o=p.getEnvmap(),F=R._envmapHash,O=R._envmaps,K=v._renderInfo.frame;if(!(this._lastCaptureFrame>=K||p._picking))for(var G in o){var A,z=o[G],_=z.type;switch(_){case"sphere":A=z.image,A!==F[G]&&(_l=r.getImage(A),_l&&(F[G]=A,X(O,G,R.fromEquirectangular(A))));break;case"cube":var a=z.images;if(a&&6===a.length&&(A=a.join(","),A!==F[G])){for(var u=!0,c=0;6>c;c++)if(!r.getImage(a[c])){u=!1;break}u&&(F[G]=A,X(O,G,R.fromCubemap(a)))}break;case"skybox":var d=p.getSkybox();if(d){var M=d.s("shape3d");if(A="sphere"===M?d._id+"_"+d.s("shape3d.image"):d._id+"_"+d.s("front.image"),A!==F[G]){var u;if("sphere"===M)u=r.getImage(d.s("shape3d.image"));else{u=!0;for(var j=["front","back","left","right","top","bottom"],c=0;6>c;c++)if(!r.getImage(d.s(j[c]+".image"))){u=!1;break}}u&&(F[G]=A,X(O,G,R.fromSkybox()))}}break;case"probe":var n=z.pos,P=z.size;if(A=n[0]+"_"+n[1]+"_"+n[2]+"_"+P,A!==F[G]){var L=this._probeCaptureTime[A],m=Date.now();L||(this._probeCaptureTime[A]=L=m),m-L>r.envmapProbeMinWaitTime&&!Vl&&!Cs||m-L>r.envmapProbeMaxWaitTime?(delete this._probeCaptureTime[A],F[G]=A,X(O,G,R.fromSceneProbe(n,P,z.filter))):p.iv()}}}},B.prototype.resetUniformCache=function(){this._frameUniformCache={}},B.prototype.setEnvmap=function(g,K){var t=g.uuid,f=this._frameUniformCache,G=this._envmaps[K];G&&(G=G.texture),f[t]!==G&&(f[t]=G,g.uEnvMap=G)},B.prototype.fromEquirectangular=function(i){var b=L.Default.getImage(i);return this.rectSize=[1/b.width,1/b.height],i=this.gv.getTexture(i),this.fromTexture(i)},B.prototype.fromCubemap=function(h){var d=this.gv.getGL(),o=d.createTexture();d.activeTexture(d.TEXTURE0),d.bindTexture(d.TEXTURE_CUBE_MAP,o),d.texParameteri(d.TEXTURE_CUBE_MAP,d.TEXTURE_MAG_FILTER,d.LINEAR),d.texParameteri(d.TEXTURE_CUBE_MAP,d.TEXTURE_MIN_FILTER,d.LINEAR);for(var v=[],M=b/3,a=0;6>a;a++)v[a]=r.resizeImage(L.Default.getImage(h[a]),M);return d.texImage2D(d.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,d.RGBA,d.RGBA,d.UNSIGNED_BYTE,v[0]),d.texImage2D(d.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,d.RGBA,d.RGBA,d.UNSIGNED_BYTE,v[1]),d.texImage2D(d.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,d.RGBA,d.RGBA,d.UNSIGNED_BYTE,v[2]),d.texImage2D(d.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,d.RGBA,d.RGBA,d.UNSIGNED_BYTE,v[3]),d.texImage2D(d.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,d.RGBA,d.RGBA,d.UNSIGNED_BYTE,v[4]),d.texImage2D(d.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,d.RGBA,d.RGBA,d.UNSIGNED_BYTE,v[5]),d.bindTexture(d.TEXTURE_CUBE_MAP,d._emptyCubeTexture),this.fromTexture(o,!0)},B.prototype.fromTexture=function(v,O){var f=this._allocateTargets();this._pingPongRenderTarget||(this._pingPongRenderTarget=this._allocateTargets());var I=this.gv,a=I.getGL(),s=li.for(a).directState(),B=s.depth.enabled;s.scissor.enabled=!0,s.depth.enabled=!1;var A=I.getViewport(a);return this._textureToCubeUV(v,f,O),this._applyPMREM(f),f.unbind(a),I.setViewport(a,A[0],A[1],A[2],A[3]),s.depth.enabled=B,s.scissor.enabled=!1,f},B.prototype.fromSkybox=function(){return this._fromCamera(function(E){E.s({"camera.onlySky":!0})})},B.prototype.fromScene=function(y){return this._fromCamera(function($){$.s({"camera.onlySky":!1}),y&&y($)})},B.prototype.fromNode=function(G){var o=this.gv.getData3dUI(G),T=o._42;o._42=kb;var B=this.gv.getSkybox(),e=G.p3();if(B){var v=B.p3();B.p3(e)}var Z=this.fromScene(function(E){E.p3(e)});return o._42=T,B&&B.p3(v),Z},B.prototype.fromSceneProbe=function(m,e,V){var a=this.gv,g=a.getSkybox();if(g){var M=g.p3();g.p3(m)}if(V){var v=a.isVisible;a.isVisible=function(D){var G=V(D);return G!==A?G:v.call(a,D)}}var D=this.fromScene(function(H){H.p3(m),H.s("camera.near",e)});return V&&(a.isVisible=v),g&&g.p3(M),D},B.prototype._fromCamera=function(N){var Y=this.gv,A=Y.getCamera();N&&N(A);var d=new fq(Y,b,b,{cube:!0}),M=Y.getGL(),h=Y.getViewport(M),S=this.setEnvmapByProbeId,I=this.onBeforeRender;this.setEnvmapByProbeId=function(x){x.envMap=M._emptyTexture},this.onBeforeRender=kb,A.attachRenderTarget(d),A.render(Y),A.detachRenderTarget(),this.setEnvmapByProbeId=S,this.onBeforeRender=I,Y.setViewport(M,h[0],h[1],h[2],h[3]);var T=this.fromTexture(d.texture,!0);return d.releaseTexture(),T},B.prototype._allocateTargets=function(){return new fq(this.gv,3*t,3*t,{magFilter:Jh.NEAREST,minFilter:Jh.NEAREST})},B.prototype._textureToCubeUV=function(A,d,x){var g,N=this.gv;x?null==(g=this._cubemapShader)&&(this._cubemapShader=g=this.createShader(k())):null==(g=this._equirectShader)&&(this._equirectShader=g=this.createShader(e()));var R=N.getGL();d.bind(R),this._setViewport(d,0,0,3*t,2*t);var B=N.getRenderState();B.useProgram(g);var s=B.directUniforms(),b=B.directAttribs();s.envMap=A,x||(s.texelSize=this.rectSize);var i=_[0];b.position=ef(R,null,i.vs,h,3),b.uv=ef(R,null,i.uv,h,2),b.faceIndex=ef(R,null,i.faceIs,h,1),vq(R,0,i.vs.length/3)},B.prototype._applyPMREM=function(l){for(var y,z,d,y=1;G>y;y++)z=Math.sqrt(Y[y]*Y[y]-Y[y-1]*Y[y-1]),d=n[(y-1)%n.length],this._blur(l,y-1,y,z,d)},B.prototype._setViewport=function(r,d,c,H,K){var R=this.gv;R.setViewport(R.getGL(),d,c,H,K),R.getRenderState().directState().scissor.box=[d,c,H,K]},B.prototype._blur=function(Y,l,Q,p,J){var b=this._pingPongRenderTarget;this._halfBlur(Y,b,l,Q,p,"latitudinal",J),this._halfBlur(b,Y,Q,Q,p,"longitudinal",J)},B.prototype.createShader=function(f){var D=this.gv;return D.getPostProcessing().createShader(D.getGL(),f).program},B.prototype._halfBlur=function(e,A,Z,F,I,V,z){var p=this.gv,m=this._blurMaterial;if("latitudinal"===V||"longitudinal"===V){m||(this._blurMaterial=m=this.createShader(K(i)));var f=p.getGL();A.bind(f);var Y=3,x=p.getRenderState();x.useProgram(m);var R,P,b,y=x.directUniforms(),j=x.directAttribs(),L=U[Z]-1,W=isFinite(I)?Math.PI/(2*L):2*Math.PI/(2*i-1),X=I/W,k=isFinite(I)?1+Math.floor(Y*X):i,c=[],T=0;for(R=0;i>R;++R)P=R/X,b=Math.exp(-P*P/2),c.push(b),0==R?T+=b:k>R&&(T+=2*b);for(R=0;R<c.length;R++)c[R]=c[R]/T;y.envMap=e.texture,y.samples=k,y.weights=c,y.latitudinal="latitudinal"===V,z&&(y.poleAxis=z),y.dTheta=W,y.mipInt=N-Z;var Q=U[F],P=3*Math.max(0,t-2*Q),w=(0===F?0:2*t)+2*Q*(F>N-v?F-N+v:0);
this._setViewport(A,P,w,3*Q,2*Q);var q=_[F];j.position=ef(f,null,q.vs,h,3),j.uv=ef(f,null,q.uv,h,2),j.faceIndex=ef(f,null,q.faceIs,h,1),vq(f,0,q.vs.length/3),A.unbind(f)}};var v=4,N=8,t=Math.pow(2,N),M=[.125,.215,.35,.446,.526,.582],G=N-v+1+M.length,i=20,z=(1+Math.sqrt(5))/2,g=1/z,n=[new Ai(1,1,1),new Ai(-1,1,1),new Ai(1,1,-1),new Ai(-1,1,-1),new Ai(0,z,g),new Ai(0,z,-g),new Ai(g,0,z),new Ai(-g,0,z),new Ai(z,g,0),new Ai(-z,g,0)],W=function(){for(var P=[],D=[],R=[],S=N,k=0;G>k;k++){var $=Math.pow(2,S);D.push($);var b=1/$;k>N-v?b=M[k-N+v-1]:0==k&&(b=0),R.push(b);for(var T=1/($-1),w=-T/2,z=1+T/2,q=6,p=[],f=[],W=[],L=0;q>L;L++){var r=2*(L%3)/3-1,t=L>2?0:-1;p.push(r,t,0,r+2/3,t,0,r+2/3,t+1,0,r,t,0,r+2/3,t+1,0,r,t+1,0),f.push(w,w,z,w,z,z,w,w,z,z,w,z),W.push(L,L,L,L,L,L)}P.push({vs:new Rl(p),uv:new Rl(f),faceIs:new Rl(W)}),S>v&&S--}return{_lodPlanes:P,_sizeLods:D,_sigmas:R}}(),_=W._lodPlanes,U=W._sizeLods,Y=W._sigmas,b=r.EnvmapTextureSize}();var se=["left","front","right","back","top","bottom"],Ym=hd._RenderList=function(){function Q(){X.length=0,d.length=0,p={}}function z(p){var N,i,L,q,J=p.gv,$=p.data,r=p.shapeModel;if(r){var R,u,d,C=$.s("shape3d.transparent")||$.s("points.transparent");for(rm(r)||(R=zm(r.transparent,$,J),r=[r]),L=0,q=r.length;q>L;L++)d=r[L],u=zm(d.transparent,$,J),u===A&&(u=R),u===A&&(u=C),u?i=!0:N=!0}for(L=0,q=se.length;q>L;L++){var Z=p[se[L]];Z&&(Z.transparent?i=!0:N=!0)}J.isLabelVisible($)&&(p.labelInfo&&($.s(cc+".transparent")?i=!0:N=!0),p.label2Info&&($.s(Jc+".transparent")?i=!0:N=!0)),J.isNoteVisible($)&&(p.noteInfo&&($.s(mi+".transparent")?i=!0:N=!0),p.note2Info&&($.s(ql+".transparent")?i=!0:N=!0)),p._38o&&(i=N=!0),i||(N=!0),p._renderParams={opaque:N,transparent:i}}function l(S,G){G&&z(S);var n=S.data,i=n._id;if(!p[i]){p[i]=!0;var H=S._renderParams;H&&H.visible!==!1&&(S={ui:S,data:n,z:0,id:i},H.opaque&&X.push(S),H.transparent&&d.push(S))}}function j(T,u){if(d.length>1){for(var _,h,F=[0,0,0,0],E=0,P=d.length;P>E;E++)_=d[E].data,(h=_._position)?(F[0]=h.x,F[1]=_._54O,F[2]=h.y,F[3]=1,Qq(F,u),d[E].z=F[2]/F[3]):d[E].z=0;d.sort(T||V)}}function e(O){O?(hj(T,b,O),hj(Z,G,O),hj(r,D,O)):(T=this.batchModelMap={},b=this.batchIndexMap={},Z=this.polylineModelMap={},G=this.polylineIndexMap={},r=this.wireframeModelMap={},D=this.wireframeIndexMap={}),this.markBatchInvalid()}function q(D){D?hj(T,b,D):(T=this.batchModelMap={},b=this.batchIndexMap={}),this.markBatchInvalid()}function K(X){X?hj(Z,G,X):(Z=this.polylineModelMap={},G=this.polylineIndexMap={}),this.markBatchInvalid()}function o(W){W?hj(r,D,W):(r=this.wireframeModelMap={},D=this.wireframeIndexMap={}),this.markBatchInvalid()}function H(){return this._batchInvalid}function O(){this._batchInvalid=!0}function i(){this._batchInvalid=null}var X=[],d=[],T={},b={},Z={},G={},r={},D={},p={};return{opaque:X,transparent:d,init:Q,push:l,batchModelMap:T,batchIndexMap:b,polylineModelMap:Z,polylineIndexMap:G,wireframeModelMap:r,wireframeIndexMap:D,ivBatch:e,ivModelBatch:q,ivPolylineBatch:K,ivWireframeBatch:o,markBatchInvalid:O,isBatchInvalid:H,onUpdated:i,sort:j}},ws=hd._RenderLists=function(){function L(){for(var M in k)k[M].init()}function s(){for(var X in k)k[X].onUpdated()}function H($,A){$=$||"main";var J=k[$];return!J&&A&&(J=k[$]=new Ym),J}function t(B,w){var O=B.data.getRenderLayer(),M=H(O,!0);M.push(B,w)}function T(C){for(var h in k)C(k[h])}var k={};return{init:L,onUpdated:s,get:H,push:t,each:T,lists:k}},fq=hd.RenderTarget=function(x,F,S,g){var E,W=this;null!=F&&F.canvas?(E=F,F=S,S=g,g=arguments[4]):E=x.getGL(),g=g||{},g.cube===!!g.cube,g.samples=g.cube?0:Math.min(x._glCapabilities.maxSamples,g.samples&&g.samples>1&&2===x._webGLVersion?g.samples:0),W.options=g,W.uuid=L.Math.generateUUID(),W.gv=x,W.init(x,E,g),W.format=g.format||Jh.RGBA,W.generateMipmaps=!!g.generateMipmaps,g.samples&&!x._glCapabilities._maxSamplesChecked?W.setSize(E,F||1,S||1):W.setSize(E,F,S)};U.assign(hd.RenderTarget.prototype,{bind:function(g,B){var G=this.options;if(G.autoSize){var q=this.gv,H=q.getDevicePixelRatio(),L=q.getWidth()*H,n=q.getHeight()*H;this.setSize(g,L,n)}G.cube?uf(g,this.frame[B]):uf(g,this.options.samples?this._MSAAFbo:this.frame)},unbind:function(A){cf(A),this.options.samples&&(A.bindFramebuffer(A.READ_FRAMEBUFFER,this._MSAAFbo),A.bindFramebuffer(A.DRAW_FRAMEBUFFER,this.frame),A.blitFramebuffer(0,0,this.width,this.height,0,0,this.width,this.height,A.COLOR_BUFFER_BIT,A.NEAREST),A.bindFramebuffer(A.READ_FRAMEBUFFER,null),A.bindFramebuffer(A.DRAW_FRAMEBUFFER,null))},isCube:function(){return this.options.cube},init:function(F,e,j){var G=this,X=j.samples,a=j.cube,r=G.texture=e.createTexture(),c=a?Jh.TEXTURE_CUBE_MAP:Jh.TEXTURE_2D;e.activeTexture(e.TEXTURE0),e.bindTexture(c,r),e.texParameteri(c,e.TEXTURE_WRAP_S,j.wrapS||e.CLAMP_TO_EDGE),e.texParameteri(c,e.TEXTURE_WRAP_T,j.wrapT||e.CLAMP_TO_EDGE);var B=X?e.NEAREST:e.LINEAR;if(e.texParameteri(c,e.TEXTURE_MIN_FILTER,j.minFilter||B),e.texParameteri(c,e.TEXTURE_MAG_FILTER,j.magFilter||B),e.bindTexture(c,null),a){G.depth=[],G.frame=[];for(var D=0;6>D;D++)G.depth[D]=e.createRenderbuffer(),G.frame[D]=e.createFramebuffer()}else G.depth=e.createRenderbuffer(),G.frame=e.createFramebuffer();G.assureTexture()},assureTexture:function(){var O=this;O.gv._2Oi(O.uuid,O.texture,"default")},releaseTexture:function(){this.gv.deleteTexture(this.uuid)},setSize:function(O,T,Q){var n=this;if(T=Math.round(T),Q=Math.round(Q),T&&Q&&(n.width!==T||n.height!==Q)){n.width=T,n.height=Q;var G=O.RENDERBUFFER,A=O.FRAMEBUFFER,v=n.options.samples,o=n.options.cube,k=o?Jh.TEXTURE_CUBE_MAP:Jh.TEXTURE_2D;if(v){var H=n.gv._glCapabilities;if(!H._maxSamplesChecked){for(O.bindRenderbuffer(G,n.depth),O.getError();v>1&&(O.renderbufferStorageMultisample(G,v,O.DEPTH_COMPONENT16,T,Q),O.getError());)v=Math.floor(v>>1);1>=v&&(v=0,O.texParameteri(k,O.TEXTURE_MIN_FILTER,n.options.minFilter||O.LINEAR),O.texParameteri(k,O.TEXTURE_MAG_FILTER,n.options.magFilter||O.LINEAR),O.renderbufferStorage(G,O.DEPTH_COMPONENT16,T,Q)),H._maxSamplesChecked=!0,H.maxSamples=n.options.samples=v,O.bindRenderbuffer(G,h)}}if(v&&(n._MSAAFbo||(n._MSAAFbo=O.createFramebuffer(),n._MSAARbO=O.createRenderbuffer()),O.bindRenderbuffer(G,n._MSAARbO),O.renderbufferStorageMultisample(O.RENDERBUFFER,v,O.RGBA8,T,Q),O.bindFramebuffer(A,n._MSAAFbo),O.framebufferRenderbuffer(A,O.COLOR_ATTACHMENT0,G,n._MSAARbO),O.framebufferRenderbuffer(A,O.DEPTH_ATTACHMENT,G,n.depth),O.bindFramebuffer(A,null),O.bindRenderbuffer(G,null)),O.activeTexture(O.TEXTURE0),O.bindTexture(k,n.texture),o)for(var J=O.TEXTURE_CUBE_MAP_POSITIVE_X,q=0;6>q;q++)n.setupFrameBufferTextureAndDepth(O,n.frame[q],n.depth[q],J+q);else n.setupFrameBufferTextureAndDepth(O,n.frame,n.depth,O.TEXTURE_2D);if(n.generateMipmaps&&(2===gv._webGLVersion||xb.isPOT(T)&&xb.isPOT(Q))){O.generateMipmap(k);var E=n.options.minFilter||(v?O.NEAREST:O.LINEAR);O.texParameteri(k,O.TEXTURE_MIN_FILTER,E===O.NEAREST?O.NEAREST_MIPMAP_NEAREST:O.LINEAR_MIPMAP_LINEAR)}O.bindTexture(k,null)}},setupFrameBufferTextureAndDepth:function(K,f,w,Q){var I=this,E=I.format;K.texImage2D(Q,0,E,this.width,this.height,0,E,K.UNSIGNED_BYTE,null),K.bindFramebuffer(K.FRAMEBUFFER,f),K.framebufferTexture2D(K.FRAMEBUFFER,K.COLOR_ATTACHMENT0,Q,I.texture,0),this.setupRenderBufferStorage(K,w),K.bindFramebuffer(K.FRAMEBUFFER,null)},setupRenderBufferStorage:function(t,X){var A=this,P=t.RENDERBUFFER;t.bindRenderbuffer(P,X);var e=A.options.samples;e?t.renderbufferStorageMultisample(P,e,t.DEPTH_COMPONENT16,A.width,A.height):(t.renderbufferStorage(P,t.DEPTH_COMPONENT16,A.width,A.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,P,X)),t.bindRenderbuffer(t.RENDERBUFFER,null)},toCanvas:function(){var y=this,A=y.gv.getGL();uf(A,y.frame);var f=y.width,R=y.height,l=new Uint8Array(4*f*R);A.readPixels(0,0,f,R,y.format,A.UNSIGNED_BYTE,l),cf(A);var J=F.createElement("canvas");J.width=f,J.height=R;var B=J.getContext("2d"),O=B.createImageData(f,R);return O.data.set(l),B.putImageData(O,0,0),J}});var cg=hd.Interactor=function(R){this.gv=this.g3d=R};mc("Interactor",U,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners()},fi:function(Z){this.gv.fi(Z)},startDragging:function(U){Qb(this,U)}});var Lm=hd.DefaultInteractor=function(b){oc(Lm,this,[b])};mc("DefaultInteractor",cg,{getState:function(){return this._62O},setState:function(j){this._62O=j},getDataInfoAt:function(Z,o){var f=this.gv,u=f.getDataInfoAt(Z);if(!f.isBlockSelectable()||!u||!u.data)return u;if(!o&&f.isSelected(u.data))return u;for(var U=u.data;(U=U.getParent())&&U instanceof L.Block&&f.isSelectable(U);){var I=f.isSelected(U);if(I&&o)break;if(u={data:U,part:u.part},I&&!o)break}return u},handle_contextmenu:function(b){ae(b)},handle_mousewheel:function(s){this.gv.handleScroll(s,s.wheelDelta/40)},handle_DOMMouseScroll:function(s){2===s.axis&&this.gv.handleScroll(s,-s.detail)},handle_keydown:function(j){this.gv.handleKeyDown(j)},handle_mousedown:function(N){this.handle_touchstart(N)},handle_touchstart:function(s){ae(s);var O=this,r=O.gv,S=Yf(s),Q=O.getDataInfoAt(s),l=Q?Q.data:h,F=Q?Q.part:h,j=r.sm(),B=Dg(s),m=kl(s);r.setFocus(s)&&(O._62O=h,O._57I=h,O.pendingClickThrough=h,O.__lastClientPoint__=ao(s),l?mj(s)?j.co(l)?j.rs(l):j.as(l):j.co(l)?l instanceof so&&l.isClickThroughEnabled()&&Yf(s)&&(O.pendingClickThrough=ao(s)):j.ss(l):S&&(mj(s)?r.isRectSelectable()&&(O._62O=Nh):O._57I=ao(s)),O._31Q&&(ye(O._31Q),delete O._31Q,delete O._32Q),O._62O||(r.isFirstPersonMode()&&(Fr(s)||Hq(s)||m>2?O._62O="pan":r.isMouseRoamable()||Qp(s)?(O._62O="roaming",O.foward=B&&Yf(s),O._32Q=qh(),O._31Q=Tq(O.tick,O)):S||(O._62O="roaming")),O._62O||(S&&B&&Ps[F]?(O._62O=F,O.p3=l.p3()):S&&B&&nf(l)&&r.isSelected(l)?r.isMovable(l)?(O._62O="move",O.p3=l.p3(),O.movedata=l):r._39Q(l)&&(O._62O="none"):Qp(s)&&(m>2?O._62O="pan":2===m&&(O.dist=Yq(s),O._62O="pinch")))),O.point=r.lp(s),Qb(O,s),We(s)?r.handleDoubleClick(s,l,F):r.handleClick(s,l,F))},tick:function(){var j=this,X=j.gv,L=X._moveStep;j.point&&X.isWalkable()&&(j._32Q&&(L*=(qh()-j._32Q)/50),X.walk(j.foward?L:-L),j._32Q=qh(),j._31Q=Tq(j.tick,j))},handle_mouseup:function(y){this.handle_touchend(y)},handle_touchend:function(T){var L=this._57I;if(L&&(ml(L,ao(T))<=1&&this.gv.sm().cs(),this._57I=h),L=this.pendingClickThrough){if(ml(L,ao(T))<=1){var o=this.getDataInfoAt(T);o&&o.data instanceof so&&o.data.isClickThroughEnabled()&&(o=this.getDataInfoAt(T,!0),o&&(T.clickThrough=!0,this.gv.sm().ss(o.data)))}this.pendingClickThrough=null}},handleWindowMouseMove:function(G){this.handleWindowTouchMove(G)},handleWindowTouchMove:function(v){var K,f,w=this,V=w.gv,b=w._62O,a=w.point,N=V.dm(),o=V.lp(v),s=o.x-a.x,e=o.y-a.y,x=V.getWidth(),U=V.getHeight();if(x&&U){var j=ao(v),Z=Io(V,j,w.__lastClientPoint__),R=ml({x:0,y:0},Z),q=-S*s/x,F=-S*e/U;if("roaming"===b)w.rotate(v,q/2,F/2);else if(b===Js||b===Ks||b===Ls)V._86O||N.beginTransaction(),V.fi({kind:V._86O?"betweenEditRotation":"beginEditRotation",event:v}),V._86O=1,V.sm().each(function(C){if(nf(C)&&V.isRotationEditable(C)){var n=z(q)>z(F)?q:F;b===Js?C.setRotationX(C.getRotationX()+n):b===Ks?C.setRotationY(C.getRotationY()+n):b===Ls&&C.setRotationZ(C.getRotationZ()+n)}});else if("move"===b||Ps[b]){if(b===Ms||b===Ns||b===Os)V._87O||N.beginTransaction(),V.fi({kind:V._87O?"betweenEditScale":"beginEditScale",event:v}),V._87O=1;else{if(!V._moving){if(R<r.touchMoveThreshold)return;N.beginTransaction()}V.fi({kind:V._moving?"betweenMove":"beginMove",event:v}),V._moving=1}var B,m=w.p3,D=V.getPositionInfo(m),y=td(V);B=b===Gs?"x":b===Hs?"y":b===Is?"z":b===Ms?"sx":b===Ns?"sy":b===Os?"sz":V.getMoveMode(v,w.movedata),s=s/x*D.width,e=-1*e/U*D.height;var c,C,u=[y[0]*s,y[4]*s,y[8]*s],h=[y[1]*e,y[5]*e,y[9]*e],k=u[0]+h[0],p=u[1]+h[1],I=u[2]+h[2],Y=[m[0]+k,m[1]+p,m[2]+I],G=ik(V.getEye(),Y,!0);if("xyz"===B?(c=Y,V.moveSelection(k,p,I)):"xz"===B?(c=ep(V,m,[0,1,0],Y),c&&V.moveSelection(c[0]-m[0],0,c[2]-m[2])):"xy"===B?(c=ep(V,m,[0,0,1],Y),c&&V.moveSelection(c[0]-m[0],c[1]-m[1],0)):"yz"===B?(c=ep(V,m,[1,0,0],Y),c&&V.moveSelection(0,c[1]-m[1],c[2]-m[2])):"x"===B||"sx"===B?(G[0]=0,c=ep(V,m,G,Y),c&&(C=c[0]-m[0],"x"===B?V.moveSelection(C,0,0):V.sm().each(function(Z){nf(Z)&&V.isSizeEditable(Z)&&(K=Z.getScaleX()+C/100,f=K/Z.getScaleX(),Z.setScaleX(K),Fr(v)&&(Z.setScaleY(Z.getScaleY()*f),Z.setScaleTall(Z.getScaleTall()*f)))}))):"y"===B||"sy"===B?(G[1]=0,c=ep(V,m,G,Y),c&&(C=c[1]-m[1],"y"===B?V.moveSelection(0,C,0):V.sm().each(function(x){nf(x)&&V.isSizeEditable(x)&&(K=x.getScaleTall()+C/100,f=K/x.getScaleTall(),x.setScaleTall(K),Fr(v)&&(x.setScaleY(x.getScaleY()*f),x.setScaleX(x.getScaleX()*f)))}))):("z"===B||"sz"===B)&&(G[2]=0,c=ep(V,m,G,Y),c&&(C=c[2]-m[2],"z"===B?V.moveSelection(0,0,C):V.sm().each(function(T){nf(T)&&V.isSizeEditable(T)&&(K=T.getScaleY()+C/100,f=K/T.getScaleY(),T.setScaleY(K),Fr(v)&&(T.setScaleX(T.getScaleX()*f),T.setScaleTall(T.getScaleTall()*f)))}))),!c)return;w.p3=c}else if(b===Nh){var M=w.div;M||(M=w.div=Sq(),Bm(w.getView(),M),M.op=a,M.style.background=V.getRectSelectBackground()),V.fi({kind:V._rectSelecting?"betweenRectSelect":"beginRectSelect",event:v}),V._rectSelecting=1,M.rect=Jk(M.op,o),xq(M,M.rect)}else if("pinch"===b&&2===kl(v)){V.fi({kind:V._pinching?"betweenPinch":"beginPinch",event:v}),V._pinching=1;var C=Yq(v);V._lastZoomLP||(V._lastZoomLP=rq(v)),V.handlePinch(C,w.dist),w.dist=C}else"pan"===b||Fr(v)||Hq(v)?w.pan(v,s,e):"none"===b||V.isFirstPersonMode()||w.rotate(v,q,F);w.point=o}},pan:function(j,v,h){var e=this.gv;if(e.isPannable()){var R=e.getWidth(),H=e.getHeight();if(!R||!H)return;var n=e.getCenterInfo(),o=v/R*n.width,Q=-1*h/H*n.height;e.fi({kind:e._panning?"betweenPan":"beginPan",event:j}),e._panning=1,e.pan(-o,-Q)}},rotate:function(M,k,G){var u=this.gv;u.isRotatable()&&(u.fi({kind:u._rotating?"betweenRotate":"beginRotate",event:M}),u._rotating=1,u.rotate(k,G))},handleWindowMouseUp:function(q){this.handleWindowTouchEnd(q)},handleWindowTouchEnd:function($){var H=this,X=H.gv,x=X.dm(),p=H.div;if(p){var D=X.getDatasInRect(p.rect);if(!D.isEmpty()){var U=X.sm(),B=U.toSelection(),t=Fr($),i=$.altKey;D.each(function(p){U.co(p)?(!t||t&&i)&&B.remove(p):(!i||t&&i)&&B.add(p)}),U.ss(B)}fo(p)}X._moving&&(delete X._moving,X.fi({kind:"endMove",event:$}),X.onMoveEnded(),x.endTransaction()),X._panning&&(delete X._panning,X.fi({kind:"endPan",event:$}),X.onPanEnded()),X._rotating&&(delete X._rotating,X.fi({kind:"endRotate",event:$}),X.onRotateEnded()),X._86O&&(delete X._86O,X.fi({kind:"endEditRotation",event:$}),x.endTransaction()),X._87O&&(delete X._87O,X.fi({kind:"endEditScale",event:$}),x.endTransaction()),X._pinching&&(delete X._pinching,X.fi({kind:"endPinch",event:$}),X.onPinchEnded()),X._rectSelecting&&(delete X._rectSelecting,X.fi({kind:"endRectSelect",event:$}),X.onRectSelectEnded()),X._walking&&(delete X._walking,X.fi({kind:"endWalk",event:$}),X.onWalkEnded()),X._lastZoomLP=X._lastZoomHit=null,H.dist=H.point=H._62O=H.p3=H.movedata=H.div=H._57I=H.pendingClickThrough=H._32Q=H._31Q=H.foward=h,H.__lastClientPoint__=h}});var Xc=hd.MapInteractor=function(r){oc(Xc,this,[r]),this._keepHorizon=!0,this._threshold=2,this._touchScaleThreshold=.05,this._touchRotateThreshold=.03,this._touchScaleCheckAccuracy=.01,this._panButton="right",this._minPhi=0,this._maxPhi=5*Math.PI/12};mc("MapInteractor",cg,{setUp:function(){Xc.superClass.setUp.call(this);var f=this.gv;this.__oldMinPhi__=f.getRotateMinPhi(),this.__oldMaxPhi__=f.getRotateMaxPhi(),f.setRotateMinPhi(this._minPhi),f.setRotateMaxPhi(this._maxPhi)},tearDown:function(){Xc.superClass.tearDown.call(this);var J=this.gv;J.setRotateMinPhi(this.__oldMinPhi__),J.setRotateMaxPhi(this.__oldMaxPhi__),delete this.__oldMinPhi__,delete this.__oldMaxPhi__},handle_contextmenu:function(j){ae(j)},handle_mousewheel:function(X){this.gv.handleScroll(X,X.wheelDelta/40)},handle_DOMMouseScroll:function(K){2===K.axis&&this.gv.handleScroll(K,-K.detail)},handle_keydown:function(v){this.gv.handleKeyDown(v)},handle_mousedown:function(h){this.handle_touchstart(h)},handle_touchstart:function(y){ae(y);var u=this,o=u.gv;if(o.setFocus(y)){var c=o.getDataInfoAt(y),C=c?c.data:h,U=c?c.part:h,P=u.editing={point:o.lp(y)};Qp(y)?P.touch=!0:(P.touch=!1,P.clickLeft=Yf(y),P.pan=Hq(y)?!0:"left"===this.panButton===P.clickLeft),C&&o._39Q(C)&&(P.preventDefault=!0),Qb(u,y),We(y)?o.handleDoubleClick(y,C,U):o.handleClick(y,C,U)}},handle_mouseup:function(P){this.handle_touchend(P)},handle_touchend:function(){},handleWindowMouseMove:function(V){this.handleWindowTouchMove(V)},handleWindowTouchMove:function(j){var O=this,A=O.gv,w=O.editing;if(w){var k=A.lp(j),V=w.point,F=k.x-V.x,U=k.y-V.y;if(!w.moved){if(Math.abs(F)<O.threshold&&Math.abs(U)<O.threshold&&!(j.touches&&j.touches.length>1))return;w.moved=!0}if(!w.preventDefault)if(w.point=k,w.touch){var G=j.touches.length;if(2!==G)O.pan(j,F,U);else{if(1>=G)return;var W=j.touches,y={x:W[0].clientX,y:W[0].clientY},I={x:W[1].clientX,y:W[1].clientY},Q={x:I.x-y.x,y:I.y-y.y},x=w.lastCenter,Y=Math.atan2(Q.y,Q.x),o=w.theta,$=0;o==h?o=w.theta=Y:($=Y-o,w.thetaStarted||Math.abs($)>O.touchRotateThreshold?(w.thetaStarted=!0,w.theta=Y):$=0);var Z=g*(y.y+I.y)/2/A.getHeight(),N=w.phi,X=0;N==h?N=w.phi=Z:(X=Z-N,w.phiStarted||Math.abs(X)>O.touchRotateThreshold?(w.phiStarted=!0,w.phi=Z):X=0);var s,H=Math.sqrt(Q.x*Q.x+Q.y*Q.y),p=w.vlen;if(p){var K=y.x-x.x,l=y.y-x.y,u=I.x-x.x,q=I.y-x.y,z=Math.sqrt(K*K+l*l),L=Math.sqrt(u*u+q*q),f=p/2,M=O._sign2(z-f),m=O._sign2(L-f);0>M*m||0===M&&0===m?(s=1,w.vlen=H):(s||(s=H/p),w.scaleStarted||Math.abs(s-1)>O.touchScaleThreshold?(w.vlen=H,w.scaleStarted=!0):s=1)}else p=w.vlen=H,s=1;1!==s&&A.setZoom(s),(X||$)&&O.rotate(j,$,-X),w.lastCenter={x:(I.x+y.x)/2,y:(I.y+y.y)/2}}}else if(w.pan)O.pan(j,F,U);else{var c=A.getWidth(),D=A.getHeight();if(!c||!D)return;var C=-S*F/c,B=-S*U/D;O.rotate(j,C,B)}}},_sign2:function(g){return Math.abs(g)<this._touchScaleCheckAccuracy?0:g>0?1:-1},handleWindowMouseUp:function(E){this.handleWindowTouchEnd(E)},getDataInfoAt:function(w,g){var h=this.gv,F=h.getDataInfoAt(w);if(!h.isBlockSelectable()||!F||!F.data)return F;if(!g&&h.isSelected(F.data))return F;for(var f=F.data,u=F.part;(f=f.getParent())&&f instanceof L.Block&&h.isSelectable(f);){var H=h.isSelected(f);if(H&&g)break;if(F={data:f,part:u},H&&!g)break}return F},handleWindowTouchEnd:function(S){var w=this,s=w.editing;if(w.editing=null,s){var i=w.gv;if(s.moved||!s.clickLeft&&!s.touch)i._panning=null,i._rotating=null,i.fi({kind:s.pan?"endPan":"endRotate",event:S});else{var M=w.getDataInfoAt(S),B=M&&M.data;B instanceof so&&B.isClickThroughEnabled()&&(M=w.getDataInfoAt(S,!0),M&&(B=M.data)),B?i.sm().setSelection([B]):i.sm().clearSelection()}}},pan:function(W,u,r){var b=this,F=b.gv;if(F.isPannable()){var z=F.getWidth(),x=F.getHeight();if(z&&x){var Y=F.getCenterInfo(),m=-u/z*Y.width,K=1*r/x*Y.height;F.fi({kind:F._panning?"betweenPan":"beginPan",event:W}),F._panning=1;var t=b.keepHorizon,N=b.editing.touch;if((N&&W.touches&&W.touches.length>1||!N&&Fr(W))&&(t=!t),!t)return F.pan(m,K);if(m||K){var G=td(F),P=[G[0]*m,G[4]*m,G[8]*m],H=[G[1],0,G[9]],M=Math.sqrt(H[0]*H[0]+H[2]*H[2]);M&&(H=[H[0]/M*K,0,H[2]/M*K]);var n=P[0]+H[0],U=P[1]+H[1],d=P[2]+H[2],w=F._center,T=F._eye;w[0]+=n,w[1]+=U,w[2]+=d,T[0]+=n,T[1]+=U,T[2]+=d,F.fp(tf,h,T),F.fp(Sb,h,w)}}}},rotate:function(L,K,M){var D=this,m=D.gv;if(m.isRotatable()){var Y=m._center,N=m._eye,X=ik(N,Y),j=tj(R(X[0]*X[0]+X[2]*X[2]),X[1]),B=bh(m,j+M);M=B-j,m.fi({kind:m._rotating?"betweenRotate":"beginRotate",event:L}),m._rotating=1,m.rotate(K,M)}}}),U.defineProperties(Xc.prototype,{panButton:{get:function(){return this._panButton},set:function(E){this._panButton=E}},minPhi:{get:function(){return this._minPhi},set:function(N){this.gv.setRotateMinPhi(this._minPhi=N)}},maxPhi:{get:function(){return this._maxPhi},set:function(a){this.gv.setRotateMaxPhi(this._maxPhi=a)}},keepHorizon:{get:function(){return this._keepHorizon},set:function(m){this._keepHorizon=m}},threshold:{get:function(){return this._threshold},set:function(X){this._threshold=X}},touchScaleThreshold:{get:function(){return this._touchScaleThreshold},set:function(o){this._touchScaleThreshold=o}},touchRotateThreshold:{get:function(){return this._touchRotateThreshold},set:function(J){this._touchRotateThreshold=J}}});var bp,wb="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAEyUlEQVRYR62XW0xcVRSG/58cmIG2HmstE9N4SX2xtVqBCISoFS/RmDSpKQSvTWNixUStQSqVyBQYJUGttrQVtYkPatuQPmhivMUHqbUBZ2itl1qjTzZpImNUZhDLsUeWWXgOOd2cgcGyk3mYs/de69trr70uxP8YIlJKMi0i9wIgyf0iEiM5PFdxzGeDiBQAuB7AjQBuALCN5NcGQDmANgBfeL8UyYnZ5M8KICJ3AXgAwAlfOMl/VHAQwPtveYAKuQLA2yQ/ngliRgAR2QogA2AvSdcUZAIE50VEYR4BsIDkC7kgQgFE5GIAuwDsJnkk1+aZAPw9IqLX1gjgcZK/m7KmAXjK4wBaSf4ZplxEIgCuA3Cz3gSAfgDHSf6dY/0FAJ4D0G5ChAEcAPBwmHIRqXNd90nLsiocx/k+k8n8oK/Atu2rIpHIStd1v7QsawfJd0Ouywawh6T609Q4B8C788NhZnddt29sbGxBd3f39q6urtNhJ43H48uam5u3lJSUjFiWdV8IxE0Aqki+6M9NAXjefjnJXsOZogBGBgYGttbU1Hw427PS+cHBwbVVVVUJAItJOoa8xwD8RPIT/T4J4L3zfQAeNL1dRMZra2ur+/v7/8pHub+mvr7+wr6+vs8KCgoWGABFAN4EsEHjhA9QBeA2ks8HF6vZk8nkQL4nNwGTyeTa8vLycsuy7jcg1Mk/IpnyAZoBaOQ6FHg+ddlsdqNt201zObm5NpvN7ly0aNHrJN8LyL4FwGqSr/gAOrnej3C60HXdw/F4PJ7L4fKFSiQSl7W0tLQVFRWtCQDoNRwguZ6aWABcorE9sEDf+QjJ1fkqmmmdiHwHoCToXyKiceR0rkhY5TjOq9FoVLPdeY/x8fG+SCSySe/cFKYWCFOyPJ1Or4zFYh3nrR3A8PBwe2lp6TcAfg4DmBYwAFyRTqdXxWKx9nkE+DYUIEyBiFQ6jvNaNBq9Zz4AZruCGIBlJI8ZXpolee18AORwwgoAp/xnqMmjPuilZ8+ePZRIJNo7OztD436+YB0dHZe2trY+W1hYWGsccD/JOh/gKQBHSWpanRwicnc2m91k2/bmfJWFrRsdHd29cOHCXSTfD8i+FcA1JHcEQ/HtJDVnTw3XdfcPDQ0dra6unto8F5hUKrWurKxslWVZG4L7RGQbgA9IDgWT0VsANprJaGJi4kxDQ8OagwcPjsxFeWNj49Le3l6N91qMTA2vmNnr6fovGXkmvxPAlST3hGz4LZVKbausrMzLEnryioqKNpJLzCpJRJ4AcJLkp6rHLEieBjBA8rB5Wtd1942NjS3p6el5qa2t7VSYNdThmpqaWoqLi38xze4dUku4CpLb/f1hJZnWBY+SzJpKRGSdV5LVOI5zIpPJnNQ1tm2viEQiV7uue8SyrJeDDhew8GIAO0me4w9hABdp8ahNBkktyacNr+Qu84pSndfX81VY6e6dXJV3AoiT/CMoMFcyUogeAG+Q/DyX8+VZlqvZHwKw2VQ+zQdCTL4FwBkPZFrJPUtjoildG5PC4J2bOvJpze7QWhHAj4HWbBImpDXTQsPvH5cDeMf39lxWnBXAU6TNqcZu7fn0lyB53GhOdf6ZQHN6bF6a0xxOuJTkrwbA5LdcJ831/V8SOUYQxYGhRwAAAABJRU5ErkJggg==",zs=32,Sj=hd.GlobeInteractor=function(d,U){oc(Sj,this,[d]);var q,f=U.radius||6378137,j=this,b=null;bp||(bp=Sq(),bp.style.border="",bp.style.backgroundImage="url("+wb+")");var s=new er,Q=new Ai,g=new Ai,R=new Ai,Z=new fj,N="number"==typeof f?{x:f,y:f,z:f}:f,p={center:new Ai(0,0,0),radius:N},$=function(B){d._81O=null;var F=d.getHitPosition(B,d.getCenter(),Q.copy(d.getEye()).sub(g.copy(d.getCenter())).toArray());return Z.origin.copy(d.getEye()),Z.direction.copy(F).sub(Z.origin).normalize(),Z.intersectEllipsoid(p)},w=function(M,r){d._81O=null,Z.origin.copy(d.getEye());for(var X,k,I=d.getCenter(),W=Q.copy(d.getEye()).sub(g.copy(d.getCenter())).toArray(),q=1,R=16,F=0,O=1,u={x:0,y:0};R--;){if(u.x=r.x+(M.x-r.x)*q,u.y=r.y+(M.y-r.y)*q,X=d.getHitPosition(u,I,W),Z.direction.copy(X).sub(Z.origin).normalize(),k=Z.intersectEllipsoid(p),k&&1===q)return{hit:k};k?F=q:O=q,q=(F+O)/2}return{hit:k,out:1>q}},J=function(F,z){if(b){var N=Date.now();b.deltaTime=b.lastTime?N-b.lastTime:1e3,b.lastTime=N,b.lastAxis=F,b.lastAngle=z}z&&(s.setFromAxisAngle(F,z),d.setEye(Q.copy(d.getEye()).applyQuaternion(s).toArray()),d.setCenter(Q.copy(d.getCenter()).applyQuaternion(s).toArray()),d.setUp(Q.copy(d.getUp()).applyQuaternion(s).toArray()))};j._showCrossIcon=function(F){Bm(j.getView(),bp),xq(bp,{x:F.clientX-zs/2,y:F.clientY-zs/2,width:zs,height:zs})},j._hideCrossIcon=function(){fo(bp)},j._scrollImpl=function(h,a){b={point:d.lp(h),screen:ao(h),hit:$(h),type:"right"},b.hitNormalize=b.hit?b.hit.clone().normalize():new Ai;var n={clientX:b.screen.x,clientY:b.screen.y+10*a};j._handleMoveImpl(n),j._endMoveImpl(n)},j._startMoveImpl=function(V){q&&(q.stop(!0),q=null),b={point:d.lp(V),screen:ao(V),hit:$(V)},b.hitNormalize=b.hit?b.hit.clone().normalize():new Ai,Qp(V)?1===V.touches.length?b.hit&&(b.type="left"):2===V.touches.length&&(b.type="touch2"):(Yf(V)?b.hit&&(b.type="left"):Yh(V)?b.type="right":Hq(V)&&b.hit&&(b.type="middle"),!b.hit||"right"!==b.type&&"middle"!==b.type||j._showCrossIcon(V)),b.type&&Qb(j,V)},j._handleMoveImpl=function(h){if(b)switch(b.type){case"left":return j._handleLeft(h);case"right":return j._handleRight(h);case"middle":return j._handleMiddle(h);case"touch2":return j._handleTouch2(h)}},j._endMoveImpl=function(){if(b){if(this._hideCrossIcon(),"left"===b.type||"middle"===b.type){var I=1e3*(b.lastAngle/(b.deltaTime||30)),s=b.lastAxis,$=b.lastTime,R=function(){var l=Date.now(),u=(l-$)/1e3;return $=l,I*=Math.pow(Math.abs(j.decelerationRate),3*u),Math.abs(I)<.01?(I=0,q&&q.stop(),void 0):(J(s,I*u),void 0)};q=Hm({action:function(){R(arguments)},duration:5e3})}b=null}},j._handleLeft=function(F){if(!b.finished){var M=ao(F),e=w(M,b.lastScreen||b.screen);if(b.lastScreen=M,!e.hit)return b.finished=!0,j._endMoveImpl(F),void 0;var f=e.hit;f.normalize();var U=b.hitNormalize,n=Math.acos(f.dot(U)),Y=f.cross(U).normalize();J(Y,n),e.out&&(b.finished=!0,j._endMoveImpl(F))}},j._handleRight=function(e){var c=b.lastScreen||b.screen,Z=c.y;c=b.lastScreen=ao(e);var I=c.y,_=I-Z;if(_){var H=Math.min(.5,_*j.scaleSpeed);Q.copy(d.getEye());var r=b.hit;r||(r=Q.clone().divide(N).normalize().multiply(N)),g.copy(Q).lerp(r,H),d.setEye(g.toArray()),Q.copy(d.getUp()),g.normalize();var L=Q.clone().cross(g).normalize();if(R.copy(d.getCenter()),R.sub(L.multiplyScalar(R.dot(L))),d.setCenter(R.toArray()),b.hit){var w=$(b.screen),o=b.hitNormalize;if(w){w.normalize();var X=Math.acos(w.dot(o)),V=w.cross(o).normalize();X&&J(V,X)}}}};var F=function(R){return Math.abs(R)<.01?0:R>0?1:-1};j._handleTouch2=function(m){var T=m.touches.length;if(2===T){var Z=m.touches,p={x:Z[0].clientX,y:Z[0].clientY},n={x:Z[1].clientX,y:Z[1].clientY},S={x:n.x-p.x,y:n.y-p.y},N=b.lastCenter,w=Math.atan2(S.y,S.x),E=b.theta,U=0;E==h?E=b.theta=w:(U=w-E,b.thetaStarted||Math.abs(U)>.03?(b.thetaStarted=!0,b.theta=w):U=0);var j,I=Math.sqrt(S.x*S.x+S.y*S.y),X=b.vlen;if(X){var i=p.x-N.x,Q=p.y-N.y,K=n.x-N.x,B=n.y-N.y,s=Math.sqrt(i*i+Q*Q),M=Math.sqrt(K*K+B*B),G=X/2,C=F(s-G),D=F(M-G);0>C*D||0===C&&0===D?(j=1,b.vlen=I):(j||(j=I/X),b.scaleStarted||Math.abs(j-1)>.05?(b.vlen=I,b.scaleStarted=!0):j=1)}else X=b.vlen=I,j=1;var S=g.copy(d.getEye()).clone();1!==j&&d.setEye(S.setLength((S.length()-f)/j+f).toArray()),U&&J(S.normalize(),U),b.lastCenter={x:(n.x+p.x)/2,y:(n.y+p.y)/2}}},j._handleMiddle=function(r){var v=ao(r),B=b.screen;b.screen=v;var T=(v.y-B.y)/180*Math.PI*j.rollSpeed;g.copy(d.getCenter()).sub(Q.copy(d.getEye())).normalize(),Q.copy(d.getUp()).cross(g).normalize(),g.copy(d.getEye()).sub(b.hit).applyAxisAngle(Q,T).add(b.hit);var q=g.clone();g.copy(d.getCenter()).sub(b.hit).applyAxisAngle(Q,T).add(b.hit);var y=g.clone(),P=g.copy(d.getUp()).applyAxisAngle(Q,T).clone(),o=!1;T>0&&(R.copy(P),g.copy(y).sub(q).normalize(),Q.copy(q).multiplyScalar(-1).normalize(),Q.dot(R)-g.dot(R)>0&&(o=!0)),o||R.copy(b.hit).sub(q).dot(b.hitNormalize)>=0&&(o=!0),o||(d.setEye(q.toArray()),d.setCenter(y.toArray()),d.setUp(P.toArray()));var V=-(v.x-B.x)/180*Math.PI*j.rotateSpeed;J(b.hitNormalize,V)}};mc("GlobeInteractor",cg,{handle_contextmenu:function(G){ae(G)},handle_mousewheel:function(q){this._scrollImpl(q,q.wheelDelta/40)},handle_DOMMouseScroll:function(q){2===q.axis&&this._scrollImpl(q,-q.detail)},handle_keydown:function(A){this.gv.handleKeyDown(A)},handle_mousedown:function(a){this.handle_touchstart(a)},handle_touchstart:function(Z){ae(Z);var C=this.gv;if(C.setFocus(Z)){var r=C.getDataInfoAt(Z),b=r?r.data:h;b&&C.isInteractive(b)||this._startMoveImpl(Z);var y=r?r.part:h;We(Z)?C.handleDoubleClick(Z,b,y):C.handleClick(Z,b,y)}},handle_mouseup:function(E){this.handle_touchend(E)},handle_touchend:function(){},handleWindowMouseMove:function($){this.handleWindowTouchMove($)},handleWindowTouchMove:function(d){this._handleMoveImpl(d)},handleWindowMouseUp:function(x){this.handleWindowTouchEnd(x)},handleWindowTouchEnd:function(P){this._endMoveImpl(P)}}),U.defineProperties(Sj.prototype,{rotateSpeed:{get:function(){return this._rotateSpeed||.3},set:function(c){this._rotateSpeed=c}},rollSpeed:{get:function(){return this._rollSpeed||.1},set:function(x){this._rollSpeed=x}},scaleSpeed:{get:function(){return this._scaleSpeed||.002},set:function(S){this._scaleSpeed=S}},decelerationRate:{get:function(){return this._decelerationRate||.04},set:function(r){this._decelerationRate=r}}});var pq=function(d){var W=2147483648|d;return[(255&W>>16)/255,(255&W>>8)/255,(255&W)/255,(255&W>>24)/255]},yb=function(Y){this.gv=Y,this.gv.pickColorMap={_pickIdUsed:2e3}};sr(yb,U,{_iv:!0,iv:function(){this._iv=!0},get:function(X,w,I){this.validate();var L=this,g=L.gv.getGL();if(!g)return h;var Y,m,U=L._resolution,x=Math.round(X.x*U),O=Math.ceil(X.width*U),G=Math.ceil(X.height*U),C=L.height-Math.round(X.y*U)-G,P=y(O/2),N=new Uint8Array(4*O*G),K=0,R=N.length,W=w?h:new zc,f=w?h:{};if(uf(g,L.frame),g.readPixels(x,C,O,G,g.RGBA,g.UNSIGNED_BYTE,N),cf(g),w){for(;P>=K;K++)for(var T=P-K,$=P+K,b=T;$>=b;b++)for(var q=T;$>=q;q++)if((b===T||b===$||q===T||q===$)&&(Y=L.info(N,4*(b*O+q)))){if(I&&I(Y)===!1)continue;return Y}}else for(;R>K;K+=4)if(Y=L.info(N,K)){if(I&&I(Y)===!1)continue;m=Y.data,f[m._id]||(W.add(m),f[m._id]=m)}return W},info:function(l,H){return this.gv.pickColorMap[(l[H]<<16)+(l[H+1]<<8)+l[H+2]+((127&l[H+3])<<24)]},getResolution:function(){return this._resolution},onContextLost:function(){this.texture=null,this.width=this.height=-1},validate:function(){var w=this,k=w.gv,K=k.getGL();if(K){var c=w._resolution=k._pickerResolution*k.getDevicePixelRatio(),L=Math.round(c*k.getWidth()),B=Math.round(c*k.getHeight()),Y=K.RGBA,T=K.TEXTURE_2D,i=K.RENDERBUFFER,y=K.FRAMEBUFFER;if(w.texture||(w.texture=mq(K),w.render=K.createRenderbuffer(),w.frame=K.createFramebuffer()),(w.width!==L||w.height!==B)&&(K.activeTexture(K.TEXTURE0),_i(K,w.texture),K.texImage2D(T,0,Y,L,B,0,Y,K.UNSIGNED_BYTE,h),Ue(K,K.TEXTURE_MIN_FILTER,K.LINEAR),K.bindRenderbuffer(i,w.render),K.renderbufferStorage(i,K.DEPTH_COMPONENT16,L,B),uf(K,w.frame),K.framebufferTexture2D(y,K.COLOR_ATTACHMENT0,T,w.texture,0),K.framebufferRenderbuffer(y,K.DEPTH_ATTACHMENT,i,w.render),_i(K,h),K.bindRenderbuffer(i,h),cf(K),w.width=L,w.height=B),w._iv){w._iv=!1;var l=!1;k._40Q.each(function(N){!l&&N.isBatchInvalid()&&(l=!0)}),l&&k.updateScene(),uf(K,w.frame),K.clear(K.COLOR_BUFFER_BIT),k.overlappingBox.clear(),k.setViewport(K,0,0,L,B),k.renderPickScene(),cf(K)}}}});var Ds=function(u){this.gv=u};sr(Ds,U,{gap:0,size:0,_42:function(X,Q){var _=this,y=_.gv,g=y._gridGap,t=y._gridSize;if(y._gridVisible){if(_.gap!==g||_.size!==t){for(var J=[],G=y._gridSize/2,M=g*G,x=0;2*G+1>x;x++){var T=6*x,O=6*(2*G+1)+T;J[T]=-M,J[T+1]=0,J[T+2]=-M+x*g,J[T+3]=M,J[T+4]=0,J[T+5]=-M+x*g,J[O]=-M+x*g,J[O+1]=0,J[O+2]=-M,J[O+3]=-M+x*g,J[O+4]=0,J[O+5]=M}_.vs=new Rl(J),_.gap=g,_.size=t}vg(y),vh(X,Q),Di(X),Zn(X,Q,1,y._gridColor,y._buffer.vs,_.vs),vq(X,0,_.vs.length/3,X.LINES),bn(X),tg(X,Q)}else _.vs=_.gap=_.size=h}});var Es=function(u){this.gv=u};sr(Es,U,{_42:function(p,b){var R=this.gv,g=R._buffer.vs,B=R._axisXColor,s=R._axisYColor,z=R._axisZColor,r=R._originAxisVisible,c=R._centerAxisVisible;if(r||c){var H=Up?p.TRIANGLES:p.TRIANGLE_FAN,U=p.LINES;if(vg(R),vh(p,b),Di(p),r){var D=R.getCenterInfo(),t=n(D.width,D.height)/5,x=.8*t,o=.05*t;Zn(p,b,1.5,B,g,new Rl([0,0,0,t,0,0,x,o,0,x,0,o,x,-o,0,x,0,-o,x,o,0,0,0,0,0,t,0,o,x,0,0,x,o,-o,x,0,0,x,-o,o,x,0,0,0,0,0,0,t,o,0,x,0,o,x,-o,0,x,0,-o,x,o,0,x])),vq(p,0,2,U),vq(p,1,6,H),Zn(p,b,h,s),vq(p,7,2,U),vq(p,8,6,H),Zn(p,b,h,z),vq(p,14,2,U),vq(p,15,6,H)}if(c){var I=R._center,F=I[0],v=I[1],O=I[2],D=R.getPositionInfo(I);t=n(D.width,D.height)/20,Zn(p,b,1.5,B,g,new Rl([F,v,O,F+t,v,O,F,v,O,F,v+t,O,F,v,O,F,v,O+t])),vq(p,0,2,U),Zn(p,b,h,s),vq(p,2,2,U),Zn(p,b,h,z),vq(p,4,2,U)}bn(p),tg(p,b)}}});var Fs=function(o){this.gv=o},Gs="edit_tx",Hs="edit_ty",Is="edit_tz",Js="edit_rx",Ks="edit_ry",Ls="edit_rz",Ms="edit_sx",Ns="edit_sy",Os="edit_sz",Ps={};Ps[Gs]=101,Ps[Hs]=102,Ps[Is]=103,Ps[Js]=104,Ps[Ks]=105,Ps[Ls]=106,Ps[Ms]=107,Ps[Ns]=108,Ps[Os]=109,sr(Fs,U,{_42:function(O,F,c){var t=this,w=t.gv,R=w.sm().ld();if(R&&w.isEditable(R)&&!w.isEditHelperDisabled()&&nf(R)&&(!w.isFirstPersonMode()||!w.isMouseRoamable()&&!Xq)){vg(w);var I,A=w.isMovable(R),H=w.isRotationEditable(R),j=w.isSizeEditable(R),v=w._axisXColor,U=w._axisYColor,Q=w._axisZColor,S=w._editSizeColor,z=R.p3();
if(w.isOrtho()){var o=w.getCenterInfo();I=n(o.width,o.height)/8}else I=ml(w.getEye(),z)/10;var q,a,r=I/(c?5:10),X=.7*I,J=.4*X,l=z[0],d=z[1],u=z[2];q=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],A&&t._17O(O,F,R,c,Gs,v,q,[l,d-r,u,l+X,d-r,u,l+X,d,u,l+X,d,u,l,d,u,l,d-r,u,l,d-r,u+r,l+X,d-r,u+r,l+X,d-r,u,l+X,d-r,u,l,d-r,u,l,d-r,u+r]),a=l+X,j&&t._17O(O,F,R,c,Ms,S,q,[a,d-r,u,a+J,d-r,u,a+J,d,u,a+J,d,u,a,d,u,a,d-r,u,a,d-r,u+r,a+J,d-r,u+r,a+J,d-r,u,a+J,d-r,u,a,d-r,u,a,d-r,u+r]),a+=J,H&&t._17O(O,F,R,c,Js,v,q,[a,d-r,u,a+J,d-r,u,a+J,d,u,a+J,d,u,a,d,u,a,d-r,u,a,d-r,u+r,a+J,d-r,u+r,a+J,d-r,u,a+J,d-r,u,a,d-r,u,a,d-r,u+r]),q=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0],A&&t._17O(O,F,R,c,Hs,U,q,[l,d,u,l,d+X,u,l-r,d+X,u,l-r,d+X,u,l-r,d,u,l,d,u,l,d,u,l,d,u-r,l,d+X,u-r,l,d+X,u-r,l,d+X,u,l,d,u]),a=d+X,j&&t._17O(O,F,R,c,Ns,S,q,[l,a,u,l,a+J,u,l-r,a+J,u,l-r,a+J,u,l-r,a,u,l,a,u,l,a,u,l,a,u-r,l,a+J,u-r,l,a+J,u-r,l,a+J,u,l,a,u]),a+=J,H&&t._17O(O,F,R,c,Ks,U,q,[l,a,u,l,a+J,u,l-r,a+J,u,l-r,a+J,u,l-r,a,u,l,a,u,l,a,u,l,a,u-r,l,a+J,u-r,l,a+J,u-r,l,a+J,u,l,a,u]),q=[1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],A&&t._17O(O,F,R,c,Is,Q,q,[l,d,u,l,d,u+X,l,d-r,u+X,l,d-r,u+X,l,d-r,u,l,d,u,l,d-r,u,l-r,d-r,u,l-r,d-r,u+X,l-r,d-r,u+X,l,d-r,u+X,l,d-r,u]),a=u+X,j&&t._17O(O,F,R,c,Os,S,q,[l,d,a,l,d,a+J,l,d-r,a+J,l,d-r,a+J,l,d-r,a,l,d,a,l,d-r,a,l-r,d-r,a,l-r,d-r,a+J,l-r,d-r,a+J,l,d-r,a+J,l,d-r,a]),a+=J,H&&t._17O(O,F,R,c,Ls,Q,q,[l,d,a,l,d,a+J,l,d-r,a+J,l,d-r,a+J,l,d-r,a,l,d,a,l,d-r,a,l-r,d-r,a,l-r,d-r,a+J,l-r,d-r,a+J,l,d-r,a+J,l,d-r,a])}},_17O:function(w,O,M,C,I,F,U,j){var _=this.gv,i=_._buffer,t=li.for(w),s=t.directUniforms(),D=t.directAttribs();if(_._picking){C=_.pickColorMap;var m=Ps[I];C[m]={data:M,part:I},s.uFixPickReverseColor=pq(m)}vp(w,O,h,!0,h,!0,h,!1),s.uDiffuse=F,D.aPosition=Ni(w,i.vs,new Rl(j),h),D.aNormal=Ni(w,i.ns,new Rl(U),h),Di(w),vq(w,0,12),bn(w),$e(w,O)}});var Qs=L.Raycaster=function(T){this.gv=T,this.maxTriangleTest=1/0,this.backfaceCulling=!0};Ci("Raycaster",U,{intersect:function(m){var R=this,A=R.gv,k=A.getDataAt(m);return k?R.intersectObject(m,k):null},intersectObjects:function(k,D,v){var a,C,V,i,h=this,Z=1/0,q=k.origin||(new Ai).fromArray(h.gv.getEye()),n=h.maxTriangleTest,d=[];D.forEach(function(W){v&&v(W)===!1||W.s("intersect")!==!1&&d.push(W)});var R=q.distanceToSquared2([0,0,0]);return d.sort(function(l,U){return(l.p3?q.distanceToSquared2(l.p3()):R)-(U.p3?q.distanceToSquared2(U.p3()):R)}),h.countTriangles=0,d.forEach(function(o){h.countTriangles>n||(a=h.intersectObject(k,o),a&&(C=q.distanceToSquared(a.world),Z>C&&(V=o,i=a,Z=C)))}),h.countTriangles=0,{data:V,intersect:i}},intersectObject:function(P,e){if(P instanceof fj)return this._intersectObjectImpl(P,e);var S=this,K=S.gv,O=K.unproject(P),y=new Ai,i=K.getEye(),u=new Ai;if(K.isOrtho()){var U=new Ai(i);u.copy(K.getCenter()).sub(U).normalize();var H=y.copy(O).sub(U).dot(u);y.copy(u).setLength(-H).add(U.copy(O))}else y.copy(i),u.copy(O).sub(y).normalize();var Z=new L.Math.Ray(y,u);return S._intersectObjectImpl(Z,e)},_intersectObjectImpl:function(){function a(){var Y=new Ai;return Y.subVectors(J,S),R.subVectors(O,S),Y.cross(R).normalize(),Y}function _(U,z,O,L,q,T,S){return pi.barycoordFromPoint(U,z,O,L,Y),q.multiplyScalar(Y.x),T.multiplyScalar(Y.y),S.multiplyScalar(Y.z),q.add(T).add(S),q.clone()}var u=new nk,X=new nk,B=new fj,M=new Ai,t=new Ai,c=new Ai,d=new Ai,U=new Ai,O=new Ai,S=new Ai,J=new Ai,y=new lm,q=new lm,z=new lm,R=new Ai,i={vs:Wk,is:Pi,uv:vd},Y=new Ai,K=ns.slice(0);return K.push("csg"),function(P,j){var g=this.gv.getData3dUI(j),T=j.mat||g.mat;T?u.fromArray(T):u.identity(),X.getInverse(u),B.copy(P).applyMatrix4(X);var f,Q,Y,h="body",w=g.shapeModel;if(!w&&(j instanceof L.Polyline||j instanceof L.Edge)&&g.lineShapeModel&&(w=g.lineShapeModel),w||(w=Jb(g)),w||(L.CSGNode&&j instanceof L.CSGNode||L.CSGShape&&j instanceof L.CSGShape?(Y=!0,w=[g.left,g.front,g.right,g.back,g.top,g.bottom,g.csg]):j instanceof L.Node&&!(j instanceof L.Shape)?(f=!0,w=i):(Q=!0,w=[g.left,g.front,g.right,g.back,g.top,g.bottom])),!w)return console.log("Can not find shape model."),null;rm(w)||(w=[w]);var C,E,A,W,G,p,k,v,$,l,F,Z,D,s,H,r,N=1/0,m=["","top_","bottom_"],n=!1,b=this.backfaceCulling,I=[];for(nh(w,g,I),C=0,E=I.length;E>C;C++)if(D=I[C])for(A=0,W=m.length;W>A;A++)if(s=m[A],k=D[s+"vs"],v=D[s+"is"],$=D[s+"uv"]||D[s+"tuv"],k){if(H=D[s+"boundingBox"]){var F=B.intersectBox(H);if(!F)continue;if(B.origin.distanceTo(F)>N)continue;r=!1}else D[s+"boundingBox"]=H=new L.Math.Box3,r=!0;for(G=0,p=v?v.length:k.length/3;p>G;G+=3)this.countTriangles++,v?(t.fromArray(k,3*v[G]),c.fromArray(k,3*v[G+1]),d.fromArray(k,3*v[G+2])):(t.fromArray(k,3*G),c.fromArray(k,3*(G+1)),d.fromArray(k,3*(G+2))),r&&(H.expandByPoint(t),H.expandByPoint(c),H.expandByPoint(d)),l=B.intersectTriangle(t,c,d,b,M),l&&(Z=B.origin.distanceTo(l),N>Z&&(N=Z,U.copy(l),O.copy(t),S.copy(c),J.copy(d),""!==s?h=s.slice(0,-1):f?h=ns[Math.floor(G/6)]:Q?h=ns[C]:Y&&(h=K[C]),$&&(n=!0,v?(y.fromArray($,2*v[G]),q.fromArray($,2*v[G+1]),z.fromArray($,2*v[G+2])):(y.fromArray($,2*G),q.fromArray($,2*(G+1)),z.fromArray($,2*(G+2))))))}if(!isFinite(N))return null;var o,x=U.clone().applyMatrix4(u);n&&(o=_(U,O,S,J,y,q,z));var R=a(O,S,J),e=a(O.applyMatrix4(u),S.applyMatrix4(u),J.applyMatrix4(u)),V=B.direction.dot(R);return V>0&&(R.multiplyScalar(-1),e.multiplyScalar(-1)),{world:x,local:U.clone(),worldNormal:e,normal:R,uv:o,part:h}}}()});var Rs=function(L,u){this.gv=L,this.s=function(Y,R,j){return R==h&&(R=j),R==h?u.getStyle(Y):zm(R,u,L)},this.data=u};sr(Rs,U,{I3d:!0,ms_icons:1,_iv:!0,_cacheBoundingBox:A,iv:function(){this._iv=!0},update:function(z,n,g){var T=this,R=T.data;if(z||(z=T.gv,n=z.getGL(),g=z._40Q),!T.needValidate(n)||!z.isVisible(R))return g.push(this,!1),void 0;var E,V,x,f,v,_=R._id,u=R._47Q?null:T.s("batch"),A=R.getRenderLayer(),Q=g.get(A,!0),K=Q.batchIndexMap,H=Q.batchModelMap,L=z.getBrightness(R),l=L!=h&&1!==L;E=Dq(K,H,R,u,z);var y=T.validate(E,u?z.getBatchInfo(u)||Pp:h);if(E&&(V=K[_],x=V.size=E.vs.length/3-V.begin,v=E.rs))for(L=l?L:1,f=0;x>f;f++)v.push(L);var t=z.getWireframeGeometry(R);if(t)qf(z,R,t);else if(nf(R)){var W=z.getWireframe(R);W&&qf(z,R,W)}T.labelInfo=T.label2Info=T.noteInfo=T.note2Info=T._38o=h,T._24O(cc,"getLabel"),T._24O(Jc,"getLabel2"),T._26O(mi,"getNote"),T._26O(ql,"getNote2"),T._15O(),T.interactiveInfo=z.isInteractive(R)?{}:h,Q.push(this,!0),y!==!1&&(T._iv=!1)},clearWireframeGeometryCache:function(){var Z=this;Vm(Z),Z.data.iv()},_46Q:function(P){var r=this,C=r.data,u=r.gv;if(u.isVisible(C)){var k=C._id,h=u._40Q.get(C._renderLayer,!0),l=h.batchIndexMap[k],y=h.polylineIndexMap[k],c=h.wireframeIndexMap[k];if(l||y||c){var Q=Nk(P,u.pickColorMap,u.isSelectable(C),C,Td,!0);Q&&(Gc(Q,l,h.batchModelMap),Gc(Q,y,h.polylineModelMap),Gc(Q,c,h.wireframeModelMap))}}},_42:function(C,M,Y){function i(s,F,O){var N=F.getBrightness(O),g=O.s("alphaTest"),y=O.s("envmap"),k=li.for(s),U=k.directUniforms();N!=h&&1!==N&&(U.uBrightness=N),U.uAlphaTest=g,U.uUseEnvMap=y?!0:!1,U.uReflectivity=y||.01,U.roughness=O.s("roughness"),F._setEnvmapByProbeId(U,O.s("envmap.probe")),U.shadowReceive=!d&&O.s("shadow.receive"),U.shadowCull=!d&&!!O.s("shadow.cull"),U.uEnableBoxClip=O.s("3d.clipbox.enabled")&&!O.s("3d.clipbox");var a=x.s("3d.clip.direction");if(a){var e=x.s("3d.clip.percentage");0===e&&(W=!1);var m=x._formatClipUniforms(a,e,O);U.uClipPercent=m[1],U.uClipDirection=m[0]}else U.uClipDirection=0;s._blooming&&!O.s("bloom")&&(U.blackout=!0),d||(F._flowObjects.length&&F.flowMap.resetDataFlowEnabld(O,U),Sc(F,U,O.s("light.mask")))}var x=this,v=x.data,n=x.gv;if(n.isVisible(v)){var H,d=n._picking;if(d)H=n.pickColorMap;else{if(n.isTransparentMask(v)||n.isReflecting(C)&&v.s("3d.reflectable")===!1)return;H=A}if(Rs.getTitle===A){Rs.getTitle=0;for(var z in r)if(z.length===Jc.length+1&&z[Jc.length]===zl[4].toUpperCase()&&z[Jc.length-1]===zl[Jc.length+1].toUpperCase()){Rs.getTitle=Nn;break}}if(!Rs.getTitle||Pe[Jc.length+2]){if(Rs.getHead===A){Rs.getHead=0;for(var z in X){var G="box-sizing";6===z.length&&z[0]===zl[4]&&z[3]===G[0]&&z[4]===G[1]&&z[5]===G[2]&&(Rs.getHead=Nn)}}if(!Rs.getHead||Pe[Jc.length]){var j,m,$=v._id,e=n._40Q.get(v._renderLayer,!0),S=e.batchIndexMap,f=e.batchModelMap,N=n.isSelectable(v),T=!1,W=!0,t=S[$];if(d&&(m=Nk(C,H,N,v,Td,t),m&&!n._45Q&&(Gc(m,t,f),Gc(m,e.polylineIndexMap[$],e.polylineModelMap),Gc(m,e.wireframeIndexMap[$],e.wireframeModelMap))),t||(T||(T=!0,i(C,n,v)),W&&x._80o(C,M,Y)),n.isLabelVisible(v)&&((j=x.labelInfo)&&(d&&Nk(C,H,N,v,cc),T||(T=!0,i(C,n,v)),x._28O(j,cc,Y)),(j=x.label2Info)&&(d&&Nk(C,H,N,v,Jc),T||(T=!0,i(C,n,v)),x._28O(j,Jc,Y))),n.isNoteVisible(v)&&((j=x.noteInfo)&&(d&&Nk(C,H,N,v,mi),T||(T=!0,i(C,n,v)),x._29O(j,mi,Y)),(j=x.note2Info)&&(d&&Nk(C,H,N,v,ql),T||(T=!0,i(C,n,v)),x._29O(j,ql,Y))),(j=x._38o)&&(T||(T=!0,i(C,n,v)),x._99O(C,M,j,H,N,Y)),T){var q=li.for(C).directUniforms();q.uBrightness=1,q.uClipDirection=0,C._blooming&&(q.blackout=!1)}}}}},_formatClipUniforms:function(Y,K,U){switch(Y){case"left":Y=2;break;case"top":Y=3;break;case"bottom":Y=4;break;case"front":Y=5;break;case"back":Y=6;break;case"right":default:Y=1}if(0===Y%2&&(K=1-K),U instanceof L.Shape){var t=U.s3(),B=U.p3(),i=U.getAnchor3d();K=3>Y?(K-i.x)*t[0]+B[0]:5>Y?(K-i.y)*t[1]+B[1]:(K-i.z)*t[2]+B[2]}else K-=.5;return[Y,K]},prepare:function(){var s=this,b=s.data;if(!(b instanceof so)){var z,M,e,i,p,J=s.gv,F=J.getGL(),n=b._id,G=s.s("batch"),g=J._batchIndexMap,c=J._batchModelMap,u=J.getBrightness(b),I=u!=h&&1!==u;if(s.needValidate(F)){if(z=Dq(g,c,b,G,J),s.validate(z,G?J.getBatchInfo(G)||Pp:h),z&&(M=g[n],e=M.size=z.vs.length/3-M.begin,p=z.rs))for(u=I?u:1,i=0;e>i;i++)p.push(u);if(nf(b)){var K=J.getWireframeGeometry(b);if(K)qf(J,b,K);else{var S=J.getWireframe(b);S&&qf(J,b,S)}}s.labelInfo=s.label2Info=s.noteInfo=s.note2Info=s._38o=h,s._24O(cc,"getLabel"),s._24O(Jc,"getLabel2"),s._26O(mi,"getNote"),s._26O(ql,"getNote2"),s._15O(),s.interactiveInfo=J.isInteractive(b)?{}:h,s._iv=!1}}},dispatchBoundingBoxChanged:function(){this._cacheBoundingBox=A},getBoundingBox:function(){var z,l,R,n,O,F;return function(){if(this._cacheBoundingBox)return this._cacheBoundingBox;z||(z={vs:Wk,is:Pi,uv:vd},l=new Ai,R=new Ai,n=new Ai,O=new Ai,F=new Ai);var r=this,M=r.data,H=r.shapeModel;if(H||M instanceof L.Shape||(H=Jb(r)),!H&&M instanceof L.Shape&&(r.prepare(),H=r.shapeModel),H||(M instanceof L.Node&&!(M instanceof L.Shape)?H=z:(r.left||r.front||r.right||r.back||r.top||r.bottom)&&(H=[r.left,r.front,r.right,r.back,r.top,r.bottom])),!H)return A;rm(H)||(H=[H]);var p,I,T,c,e,$,Q,Y,D,b,X,B,q=["","top_","bottom_"],S=new L.Math.Box3,G=!1;if(r._needRecoverPosition){O.set.apply(O,M.p3());var V=M.s3();F.set(1/(V[0]||1),1/(V[1]||1),1/(V[2]||1))}else O.set(0,0,0),F.set(1,1,1);for(p=0,I=H.length;I>p;p++)if(D=H[p])for(T=0,c=q.length;c>T;T++)if(b=q[T],Q=D[b+"vs"],Y=D[b+"is"],Q){if(B=b+"boundingBox",X=D[B],!X)for(D[B]=X=new L.Math.Box3,e=0,$=Y?Y.length:Q.length/3;$>e;e+=3)Y?(l.fromArray(Q,3*Y[e]).sub(O).multiply(F),R.fromArray(Q,3*Y[e+1]).sub(O).multiply(F),n.fromArray(Q,3*Y[e+2]).sub(O).multiply(F)):(l.fromArray(Q,3*e).sub(O).multiply(F),R.fromArray(Q,3*(e+1)).sub(O).multiply(F),n.fromArray(Q,3*(e+2)).sub(O).multiply(F)),!l.isNaN()&&X.expandByPoint(l),!R.isNaN()&&X.expandByPoint(R),!n.isNaN()&&X.expandByPoint(n);S.expandByBox(X),G=!0}return G?(this._cacheBoundingBox=S,U.freeze(S),U.freeze(S.min),U.freeze(S.max),np(r.gv,M),S):A}}(),needValidate:function(){return this._iv},validate:function(){},_16O:function(){return Wo},_80o:function(){},dispose:function(){var k=this,B=k.data,c=B._pickId;if(c){var R=k.gv.pickColorMap;R[c]&&delete R[c]}},getBodyColor:function(I){var v=this.data,p=this.gv.getBodyColor(v);return p?p:I?v.getStyle(I):h},getCachedTexture:function(r){var B=this._cachedTextures;return B?B[r||"main"]:null},setCachedTexture:function(w,C){var M=this._cachedTextures;return M||(M=this._cachedTextures={}),M[C||"main"]=w,w},invalidateCachedTexture:function(n){var G=this._cachedTextures;if(G){for(var M in G)n.deleteTexture(G[M]);this._cachedTextures={}}},invalidateCachedGeometry:function(){},_24O:function(i,c){var m=this,A=m.data,K=m.gv,J=m.s,s=K[c](A);if(s!=h){var k=J(i+".scale"),G=J(i+".max"),V=m[i+"Info"]={label:s,textureScale:J(i+".texture.scale"),color:K[c+"Color"](A),font:J(i+".font"),align:J(i+".align"),background:K[c+"Background"](A)},d=V.rect=xr(V,s);G>0&&G<d.width&&(V.labelWidth=d.width,d.width=G),d.x=d.y=0,d.width*=k,d.height*=k,V.mat=m._16O(J(i+".autorotate"),J(i+".position"),d,J(i+".face"),J(i+".t3"),J(i+".r3"),J(i+".rotationMode"));var R=d.width/2,F=d.height/2;V.vs=new Rl([-R,F,0,-R,-F,0,R,-F,0,R,F,0]),d.width/=k,d.height/=k}},_26O:function(D,C){var $=this,l=$.data,L=$.gv,m=$.s,p=L[C](l);if(p!=h){var V=m(D+".scale"),e=this[D+"Info"]={note:p,textureScale:m(D+".texture.scale"),expanded:m(D+".expanded"),font:m(D+".font"),color:m(D+".color"),align:m(D+".align"),borderWidth:m(D+".border.width"),borderColor:m(D+".border.color"),background:L[C+"Background"](l)};if(e.expanded){var I=m(D+".max"),F=xr(e,p);F.width+=6,F.height+=2,I>0&&I<F.width&&(e.labelWidth=F.width,F.width=I);var w={x:-F.width/2,y:-8-F.height,width:F.width,height:F.height+8}}else w={x:-6,y:-18,width:12,height:18};e.mat=$._16O(m(D+".autorotate"),m(D+".position"),h,m(D+".face"),m(D+".t3"),m(D+".r3"),m(D+".rotationMode")),e.rect=w,1!==V&&(w=Bi(w),w.x*=V,w.height*=V,w.y=-w.height,w.width*=V);var t=w.x,r=w.y,B=w.width,y=w.height;e.vs=new Rl([t,-r,0,t,-r-y,0,t+B,-r-y,0,t+B,-r,0])}},eachShapeModel:function(e,g){function P(y){Pg(y),y.vs&&e(y.vs,y.is,y.ns,y.uv),y.top_vs&&e(y.top_vs,y.top_is,y.top_ns,y.top_uv),y.bottom_vs&&e(y.bottom_vs,y.bottom_is,y.bottom_ns,y.bottom_uv),y.from_vs&&e(y.from_vs,y.from_is,y.from_ns,y.from_uv),y.to_vs&&e(y.to_vs,y.to_is,y.to_ns,y.to_uv)}function T(G){var D,Z,K;if(rm(G))for(Z=0,K=G.length;K>Z;Z++)D=G[Z],D&&T(D);else Pr(G)?T(Jb(A,G),A):Ti(G)&&(G.shape3d?T(G.shape3d):P(G))}var A=this,U=A.data,g=g||A.shapeModel||Jb(A);g||(g=U instanceof L.Node&&!(U instanceof L.Shape)?{vs:Wk,is:Pi}:[A.left,A.front,A.right,A.back,A.top,A.bottom]),T(g)},_28O:function(h,N,R){if(R(this.s(N+".transparent"))){var x=h.rect,d=h.textureScale,r=x.width*d,u=x.height*d;if(r>=1&&u>=1){var q=Fk(r,u);1!==d&&(q.translate(x.x,x.y),q.scale(d,d),q.translate(-x.x,-x.y)),nj(q,h),q.restore(),Tl(this,N,h.mat,h.vs,!0)}}},_29O:function(f,U,i){if(i(this.s(U+".transparent"))){var B=f.rect,p=f.textureScale,S=B.x,E=B.y,g=B.width*p,s=B.height*p;if(g>=1&&s>=1){B.x=B.y=0;var X=Fk(g,s);1!==p&&X.scale(p,p),Dj(X,f),X.restore(),B.x=S,B.y=E,Tl(this,U,f.mat,f.vs,!1)}}},_99O:function(Z,S,b,H,Q,U){if(b){var L=this,q=L.gv,y=L.data,G=q._buffer,I=q._1O,s=b.icons,O=li.for(Z),A=O.directAttribs();for(var x in s){var v=s[x],e=b.rects[x];if(e&&U(zm(v.transparent,y,q))){q._picking&&Nk(Z,H,Q,y,x);var R=zm(v.shape3d,y,q),j=R?[R]:zm(v.names,y,q),d=j?j.length:0,z=zm(v.textureScale,y,q)||1,p=zm(v.light,y,q);p==h&&(p=R?!0:!1),vp(Z,S,zm(v.blend,y,q),p,zm(v.opacity,y,q),zm(v.reverseFlip,y,q),zm(v.reverseColor,y,q),zm(v.reverseCull,y,q));for(var V=0;d>V;V++){var Y=j[V],T=e[V];if(Dr(L,T.mat),R)Bf(q,y,Jb(L,R),L);else{var l=Tj(Y);if(l){var m=T.width*z,N=T.height*z;if(m>=1&&N>=1){var t=Fk(m,N);ms(t,l,zm(v.stretch,y,q),0,0,m,N,y,q),t.restore(),mq(Z,rs,I),Di(Z,S,I,zm(v.discardSelectable,y,q),G.uv,Hh),A.aPosition=Ni(Z,G.vs,T.vs,h),A.aNormal=ef(Z,G.ns,oi,h),rl(Z,G.is,go),Hg(Z,0,go.length),bn(Z,S,I)}}}Ol(q)}$e(Z,S)}}}}});var Ss=function(d,W){oc(Ss,this,[d,W])};sr(Ss,Rs,{_16O:function(i,B,W,t,Y,z,e,n,p){var l=this.data,R=l.getFinalScale3d(),x=zh(B,R,W,t,n,p);if(l.hasOwnProperty("_anchor")||l.hasOwnProperty("_anchorElevation")){var I=l.getAnchor3d();x[0]-=(I.x-.5)*R[0],x[1]-=(I.y-.5)*R[1],x[2]-=(I.z-.5)*R[2]}return Zp(Rb(),x,l.p3(),t,Y,z,e,i,l.getFinalRotation3d(),l.getRotationMode())},clear:function(){var b=this;b.faceMat=b.mat=b.shapeModel=b.left=b.right=b.front=b.back=b.top=b.bottom=b.csg=h},needValidate:function(k){if(this._iv)return this._validateFrameId=k._renderInfo.frame,!0;if(this.data._47Q){var o=k._renderInfo.frame;if(this._validateFrameId!==o)return this._validateFrameId=o,!0}return!1},validate:function(N,L){var b=this,l=b.gv,A=b.data,R=b.shapeName=b.s(Rg),c=Jb(b,R);if(b._updateAutoRotation(),b._updateFixSize2d(),b._updateOverlapping(),b.dispatchBoundingBoxChanged(),A._47Q){var d=A.getRenderLayer(),q=l._40Q.get(d);q&&q.ivWireframeBatch(A)}var $=hk(A,l.getMat(A),c?b.s("shape3d.scaleable"):!0);if(A.appendAnchorMatrix3d($),b.clear(),b.mat=A.mat=$,c||!R)if(b.shapeModel=c,N)if(c)Uj(l,A,c,b,b.getBodyColor(),[$],N);else{var P=ce($);wk(l,A,N,L,$,P,tq,Qi),wk(l,A,N,L,$,P,_h,Ap),wk(l,A,N,L,$,P,xo,sg),wk(l,A,N,L,$,P,dc,us),wk(l,A,N,L,$,P,Ic,hp),wk(l,A,N,L,$,P,Zj,ko)}else c||(b._cubeUvs=null,b.vf(tq,0),b.vf(_h,16),b.vf(Ic,8),b.vf(Zj,24),b.vf(xo,32),b.vf(dc,40))},_updateAutoRotation:function(){var Y=new to,D=new nk,x=new Ai,v=new Ai,C=new Ai;return function(){var u=this,T=u.data,$=u.s("autorotate")||u.s("shape3d.autorotate");if(!$)return T._dynamicRotation&&delete T._dynamicRotation,void 0;var p=u.gv;C.copy(u.s("shape3d.autorotate.up")||p._up);var g;g="string"==typeof $?[$.indexOf("x")<0?p._eye[0]:p._center[0],$.indexOf("y")<0?p._eye[1]:p._center[1],$.indexOf("z")<0?p._eye[2]:p._center[2]]:p._eye;var s=p._center,h=T.p3();x.copy(h),v.set(g[0]-s[0],g[1]-s[1],g[2]-s[2]).add(x),D.lookAt(v,x,C),Y.set(0,0,0,T.getRotationMode(),!0).setFromRotationMatrix(D);var y=T._dynamicRotation;y&&Math.abs(y[0]-Y.x)<1e-5&&Math.abs(y[1]-Y.y)<1e-5&&Math.abs(y[2]-Y.z)<1e-5||(T._dynamicRotation=[Y.x,Y.y,Y.z])}}(),_updateFixSize2d:function(){var m=this,q=m.data,X=m.s("fixSizeOnScreen")||m.s("shape3d.fixSizeOnScreen");if(!X)return q._dynamicScale3d&&delete q._dynamicScale3d,void 0;var V=m.gv,D=hk(q,V.getMat(q)),d=vf([0,0,0],D),r=V.toViewPosition(d);if(!isNaN(r.x)&&!isNaN(r.y)){var I=vf([1,0,0],D),K=V.toViewPosition(I),n=vf([0,1,0],D),C=V.toViewPosition(n),h=K.x-r.x,U=C.y-r.y;if(h&&U){var j,B,w=q._dynamicScale3d||[1,1,1],L=Tj(q.s("shape3d.image"));if(X[0]>0&&(j=X[0]),X[1]>0&&(B=X[1]),!j||!B){var W=X>0?X:1;j||(j=(Xf(L,q)||q.getWidth())*W),B||(B=($m(L,q)||q.getTall())*W)}var k=Math.abs(h/j),M=Math.abs(U/B);Math.abs(k-1)<.001&&Math.abs(M-1)<.001||(q._dynamicScale3d=[w[0]/k,w[1]/M,w[2]])}}},_updateOverlapping:function(){var W=this,q=W.s("hide.overlapping.group");if(!q)return W._rectOverlapping&&(W._rectOverlapping=A),void 0;var k,V,I,h=W.gv,Y=W.data,E=hk(Y,h.getMat(Y)),l=1/0,G=1/0,p=-1/0,z=-1/0,j=Y.getAnchor3d(),R=j.x,b=j.y,O=j.z;for(k=0;8>k;k++){if(V=vf([(k>>2)-R,(1&k>>1)-b,(1&k)-O],E),I=h.toViewPosition(V),isNaN(I.x)||isNaN(I.y))return;l=Math.min(l,I.x),p=Math.max(p,I.x),G=Math.min(G,I.y),z=Math.max(z,I.y)}var B={x:l,y:G,w:p-l,h:z-G};W._rectOverlapping=h.overlappingBox.isOverlapping(q,B)},getVectorDynamicSize:function(){var f,D=this,G=D.s("shape3d"),y=D.data;if("billboard"===G||"plane"===G||(f=y._currentCubeElementId)!=h){var A,g,t=D.gv,e=hk(y,t.getMat(y)),m=y.getAnchor3d(),$=.5-m.x,R=.5-m.y,C=.5-m.z,d=Math.min(D.s("vector.dynamic.maxsize"),t._glCapabilities.maxTextureSize)/t.getDevicePixelRatio(),u=function(J,u){J[0]+=$,J[1]+=R,J[2]+=C,u[0]+=$,u[1]+=R,u[2]+=C;var W=t.toViewPosition(vf(J,e)),U=t.toViewPosition(vf(u,e)),f=W.x-U.x,T=W.y-U.y;return Math.min(d,Math.sqrt(f*f+T*T))};if("billboard"===G)A=u([-.5,0,0],[.5,0,0]),g=u([0,-.5,0],[0,.5,0]);else if("plane"===G)A=u([-.5,0,0],[.5,0,0]),g=u([0,0,-.5],[0,0,.5]);else if(y._currentCubeElementId!=h){var L=3*Pi[f+1],W=3*Pi[f],n=3*Pi[f+2];A=u([Wk[L],Wk[L+1],Wk[L+2]],[Wk[n],Wk[n+1],Wk[n+2]]),g=u([Wk[L],Wk[L+1],Wk[L+2]],[Wk[W],Wk[W+1],Wk[W+2]])}return[A,g]}},vf:function(L,x){var s=this;if(s.gv.getFaceVisible(s.data,L)){var i=gn(s,L);i.mat&&(s.faceMat=!0);var a=i.uv;if(a){var r=s._cubeUvs;r||(r=s._cubeUvs=new Rl([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]));for(var B=0;8>B;B++)r[x+B]=a[B]}return i}},_billboardInView:function(){var g=[-.5,-.5,0,-.5,.5,0,.5,-.5,0,.5,.5,0],f=[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,.5],C=new Ng,E=new Ai,V=new nk;return function(X){var U=this;if(!U.mat)return!0;var j=U.gv.getFrustum(),G="billboard"===X?g:f;C.makeEmpty(),V.fromArray(U.mat);for(var c=0,z=G.length;z>c;c+=3)C.expandByPoint(E.fromArray(G,c).applyMatrix4(V));return j.intersectsBox(C)}}(),_80o:function(R,M,u){var c=this;if(c._rectOverlapping)return!0;var W=c.shapeModel;if(W||!c.shapeName){var _=c.s("shape3d");if(("billboard"===_||"plane"===_)&&!c._billboardInView(_))return!0;var f=c.gv,b=c.data,w=f._cube,C=li.for(R),U=C.directAttribs();if(Uh&&!vl){var D=c.mat;if(D)for(var X=0;X<D.length;X++)c.mat[X]=D[D.length-X-1]}vg(f,c.mat),!R._picking&&c.s("shape3d.reflector")||c.s("effect.flow")||(W?Bf(f,b,W,c,c.getBodyColor(),u):(U.aPosition=Ni(R,w.vs,h,h),U.aNormal=Ni(R,w.ns,h,h),Cm(R,w.is),c._18O(R,M,"left",0,u),c._18O(R,M,"front",6,u),c._18O(R,M,"right",12,u),c._18O(R,M,"back",18,u),c._18O(R,M,"top",24,u),c._18O(R,M,"bottom",30,u))),Ol(f),c.faceMat&&(c._18O(R,M,"left",0,u,!0),c._18O(R,M,"front",6,u,!0),c._18O(R,M,"right",12,u,!0),c._18O(R,M,"back",18,u,!0),c._18O(R,M,"top",24,u,!0),c._18O(R,M,"bottom",30,u,!0))}},_18O:function(B,P,T,w,s,a){var z=this[T];if(z){if(!s(z.transparent))return;if(a&&!z.mat||!a&&z.mat)return;var X=this.data.s("polygonOffset");X&&Hc(B,X),a&&vg(this.gv,z.mat);var Y=this,q=Y.data,o=li.for(B),l=o.directUniforms();q._currentCubeElementId=w;var r=Y.gv,H=r.getTexture(z.texture,q,T),D=z.uv,$=z.uvScale,y=z.uvOffset,d=z.uvRotation,x=z.discardSelectable;H?D?Di(B,P,H,x,r._buffer.uv,Y._cubeUvs,y,$,d):Di(B,P,H,x,r._cube.uv,h,y,$,d):Di(B),vp(B,P,z.blend,z.light,z.opacity,z.reverseFlip,z.reverseColor,z.reverseCull),l.uDiffuse=z.color||E["color.empty"],Hg(B,w,6),$e(B,P),bn(B,P,H),a&&Ol(r),X&&rn(B),q._currentCubeElementId=null}},drawReflector:function(){var X=new Ai,j=new Ai,N=new to,S=new nk,x=new Ai,H=new Ai,D=new Ai,s=new Ai,E=new nk,w=new nk,r=new uk,F=new Op,q=new Op,y=function(w,C,F){w[F]=C[0],w[F+1]=C[1],w[F+2]=C[2]},z=function(B,P){y(B,P.getEye(),0),y(B,P.getCenter(),3),y(B,P.getUp(),6)},J=function(K,H){H._eye=[K[0],K[1],K[2]],H._center=[K[3],K[4],K[5]],H._up=[K[6],K[7],K[8]],H._18Q=h;var F=H._skybox;F&&(F.p3([K[0],K[1],K[2]]),H.getData3dUI(F).iv())};return function(e){var C=this;C._reflectorInfo=null;var T=C.data;if(T._reflecting)return!1;var l=C.gv;if(l._picking)return!1;var I=T instanceof Ei,o=C._reflectorRenderTarget,d=l._canvas.width,P=l._canvas.height;if(o?o.setSize(e,d,P):o=C._reflectorRenderTarget=new hd.RenderTarget(l,e,d,P),I){var Q=T.getPointsMatrix3d().getElements(),L=T.p3();L[1]+=(1-T.getAnchorElevation())*T.getTall(),X.copy(vf(L,Q))}else X.copy(T.p3());if(j.copy(l.getEye()),S.makeRotationFromEuler(N.set(T.r3(),T.getRotationMode(),!0)),!C._reflectNormal){var m;if(I&&T.getThickness()<0){if(!C.shapeModel||!C.shapeModel.top_vs)return!1;m={vs:C.shapeModel.top_vs,ns:C.shapeModel.top_ns}}else{if(m=Jb(C,C.s("shape3d")),!m)return!1;!m.ns&&m.length&&(m=m[0])}if(!m.ns||!m.vs)return!1;C._reflectNormal=[m.ns[0],m.ns[1],m.ns[2]],C._reflectorVbuffer=sp.Buffer.createVertexBuffer(e,new Float32Array(m.vs))}if(x.copy(C._reflectNormal),x.applyMatrix4(S),H.subVectors(X,j),H.dot(x)>0)return!1;H.reflect(x).negate(),H.add(X),D.copy(l.getCenter()).negate().add(X),D.reflect(x).negate(),D.add(X),s.copy(l.getUp()),s.reflect(x);var k=[0,0,0,0,0,0,0,0,0];z(k,l),l._eye=H.toArray(),l._center=D.toArray(),l._up=s.toArray(),l._18Q=h;var R=l._skybox;R&&(R.p3(l._eye),l.getData3dUI(R).iv()),uf(e,o.frame),l.setViewport(e,0,0,o.width,o.height);var $=T.s("shape3d.reflector.background");if($){var Y=e.getParameter(e.COLOR_CLEAR_VALUE);$q(e,$)}else $q(e,[0,0,0,1]);li.for(e).glState.depth.mask=!0,e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT);var v=T.s("shape3d.reflector.clip"),c=v===A?.003:v,K=Mq(l),t=td(l);r.setFromNormalAndCoplanarPoint(x,X.add(x.clone().multiplyScalar(c))),r.applyMatrix4(w.fromArray(t)),F.set(r.normal.x,r.normal.y,r.normal.z,r.constant),w.fromArray(K).getInverse(w),q.set(Math.sign(F.x),Math.sign(F.y),1,1).applyMatrix4(w),F.multiplyScalar(2/F.dot(q)),K[2]=F.x-K[3],K[6]=F.y-K[7],K[10]=F.z-K[11],K[14]=F.w-K[15];var y=l._computedProjectMatrix;l._computedProjectMatrix=K,T._reflecting=!0,l.renderScene({renderAxis:!1,renderEdit:!1,renderGrid:!1}),l._computedProjectMatrix=y,E.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),E.multiply(w.fromArray(l._projectMatrix)),E.multiply(w.fromArray(l._viewMatrix)),$&&$q(e,Y),cf(e),J(k,l);var p=T.s("shape3d.reflector.blur");if(p){var a=l.getPostProcessingModule("Blur");a&&a.drawImpl(e,o,p,p>=3,T.s("shape3d.reflector.blur.iterations"))}var g=e._compiledShader.reflector;g||(g=e._compiledShader.reflector=new sp.Shader(e,ip.Reflector.vs,ip.Reflector.fs)),g.bind(),e.activeTexture(e.TEXTURE0),_i(e,o.texture),g.uniforms.tDiffuse=0,g.uniforms.color=Jn(T.s("shape3d.reflector.color")||"rgb(128,128,128)"),g.uniforms.textureMatrix=E.toArray(),g.uniforms.modelMatrix=I?Q:hk(T),g.uniforms.viewMatrix=td(l),g.uniforms.projectionMatrix=Mq(l);var _=C._reflectorVbuffer;_.upload(),g.attributes.pos.pointer(_);var Z=this.s("shape3d.transparent");if(Z){var O=li.for(e).glState,V=O.depth.mask;O.depth.mask=!1}return e.drawArrays(e.TRIANGLES,0,_.data.length/3),Z&&(O.depth.mask=V),T._reflecting=!1,e.useProgram(l._prg),_i(e,h),!0}}()}),ip.Reflector={vs:["attribute vec3 pos;","uniform mat4 textureMatrix;","uniform mat4 modelMatrix;","uniform mat4 viewMatrix;","uniform mat4 projectionMatrix;","varying vec4 vUv;","void main() {","	vUv = textureMatrix * modelMatrix * vec4( pos, 1.0 );","	gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4( pos, 1.0 );","}"].join("\n"),fs:["precision highp float;","uniform vec3 color;","uniform sampler2D tDiffuse;","varying vec4 vUv;","float blendOverlay( float base, float blend ) {","	return( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );","}","vec3 blendOverlay( vec3 base, vec3 blend ) {","	return vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );","}","void main() {","	vec4 base = texture2DProj( tDiffuse, vUv );","   vec2 tUv = vUv.xy / vUv.w;","   if (tUv.x < .0 || tUv.y < .0 || tUv.x > 1. || tUv.y > 1.) discard;","	gl_FragColor = vec4( blendOverlay( base.rgb, color ), base.a );","}"].join("\n")};var Ts=function(T,s){oc(Ts,this,[T,s])};sr(Ts,Ss,{_80o:function(){}});var Us=function(n,A){oc(Us,this,[n,A])};sr(Us,Rs,{_25Q:1,validate:function(I){var Z=this;if(!Z.s("geometry.cache")||!Z.info){var L=Z.gv,m=Z.data,Y=Z.s,j=Y("edge.width"),t=m._40I,o=m._41I;if(Z.shapeModel=Z.info=Z.lineShapeModel=h,t&&o){var X,w,T,l,x,F,C,d,f,i,e=m.isLooped(),s=Y(Ye),$=r.getEdgeType(s);if($){var b=$(m,cr(Z,L,m,e,s),L,Z._19Q);if(!b.points||b.points.isEmpty())return;F=Z.info={},C=b.segments,x=b.points,d=x.size();for(var q=t.getElevation(),U=o.getElevation(),g=0;d>g;g++){var k=x.get(g);k.e==h&&(k.e=q+(U-q)*g/(d-1))}f=el(x.get(0)),i=el(x.get(d-1));var P=d%2;0===P?(F.c1=el(x.get(d/2-1)),F.c2=el(x.get(d/2))):F.p3=el(x.get((d-P)/2)),F.s1=f,F.s2=el(x.get(1)),F.t1=el(x.get(d-2)),F.t2=i}else{x=new zc,F=Z.info={};var Q=Y("edge.offset"),u=Y("edge.center"),V=Y("edge.source.t3"),D=Y("edge.target.t3"),J=zd(L,m,"source"),c=zd(L,m,"target");if(!J||!c)return L.invalidateData(m),delete Z.info,!1;if(V&&(J[0]+=V[0],J[1]+=V[1],J[2]+=V[2]),D&&(c[0]+=D[0],c[1]+=D[1],c[2]+=D[2]),s===Bb){C=Y("edge.segments");var S=F.points=Y(wm)||Yo;if(d=S.size()){f=el(S.get(0)),i=el(S.get(d-1)),!u&&Q&&(T=ik(f,J,!0),Q=n(Q,ml(J,f)),J=[J[0]+T[0]*Q,J[1]+T[1]*Q,J[2]+T[2]*Q],T=ik(c,i,!0),Q=n(Q,ml(i,c)),c=[c[0]-T[0]*Q,c[1]-T[1]*Q,c[2]-T[2]*Q]);var P=d%2;0===P?(X=el(S.get(d/2-1)),w=el(S.get(d/2))):F.p3=el(S.get((d-P)/2)),F.s1=J,F.s2=f,F.t1=i,F.t2=c}else!u&&Q&&(T=ik(c,J,!0),l=ml(J,c),Q=$n(Q,l),J=[J[0]+T[0]*Q,J[1]+T[1]*Q,J[2]+T[2]*Q],c=[c[0]-T[0]*Q,c[1]-T[1]*Q,c[2]-T[2]*Q]),X=J,w=c;x.add({x:J[0],y:J[2],e:J[1]}),x.addAll(S),x.add({x:c[0],y:c[2],e:c[1]})}else{var v=cr(Z,L,m,e,s);if(Z._19Q||(v=-v),e){var K=J[0],B=J[1],H=J[2],O=t.getTall()/2+v;X=[K-v,B+O,H],w=[K+v,B+O,H],x.add({x:K-v,y:H,e:B}),x.add({x:K-v,y:H,e:B+O}),x.add({x:K+v,y:H,e:B+O}),x.add({x:K+v,y:H,e:B})}else{T=ik(c,J,!0),l=ml(J,c);var G={x:J[0],y:J[2]},M={x:c[0],y:c[2]},R=Se(h,G,M,v),W=R.x-G.x,A=R.y-G.y;Q=$n(Q,l),T[0]*=Q,T[1]*=Q,T[2]*=Q,X=[J[0]+T[0]+W,J[1]+T[1],J[2]+T[2]+A],w=[c[0]-T[0]+W,c[1]-T[1],c[2]-T[2]+A],u?(x.add({x:J[0],y:J[2],e:J[1]}),x.add({x:X[0],y:X[2],e:X[1]}),x.add({x:w[0],y:w[2],e:w[1]}),x.add({x:c[0],y:c[2],e:c[1]})):(x.add({x:X[0],y:X[2],e:X[1]}),x.add({x:w[0],y:w[2],e:w[1]}))}}F.c1=X,F.c2=w}F._lastPointsSegments={points:x,segments:C},F.list=Y(Rg)===Sg?Z.createTubeModel(x,C,j/2,I):Z.createLineModel(x,C,j,"edge","edge.dash")}}},invalidateCachedGeometry:function(){this.info=h}});var Vs=function(i,c){oc(Vs,this,[i,c]),this._needRecoverPosition=!0};sr(Vs,Ss,{_80o:function(n,U,u){var v=this,K=v.mat;if(K&&(!v.s("shape3d.reflector")||n._picking)){var F=v.gv,h=v.shapeModel;vg(F,K),h?Bf(F,v.data,h,v,v.getBodyColor(),u):(fl(v,n,U,"left",u),fl(v,n,U,"front",u),fl(v,n,U,"right",u),fl(v,n,U,"back",u),fl(v,n,U,"top",u),fl(v,n,U,"bottom",u)),Ol(F)}},validate:function(E,u){var S,M,A=this,s=A.s,W=A.data,I=W._thickness/2,a=W.isClosePath(),L=W.getPoints(),z=W.getSegments(),$=s(Ve),y=E&&E.uv;if(A.clear(),A.dispatchBoundingBoxChanged(),0>I){A.s("shape3d.reflector")&&(A._reflectNormal=null);try{var F=s("shape3d.image.projection");if(F&&F[4]){var f=W.p3(),J=f[0],v=f[2];F=[J+F[0],F[1]-v,J+F[2],F[3]-v]}M=A.shapeModel=wn(L,z,s(js),s(Qc),$,s(gb),W.getTall(),W.getShapeElevation(),a,F)}catch(n){M=A.shapeModel={}}s(jp)?s("shape3d.image")||delete M.uv:(delete M.vs,delete M.ns,delete M.uv),s("shape3d.top.image")||delete M.top_uv,s("shape3d.bottom.image")||delete M.bottom_uv}else if(s(Rg)===Sg)S=zn(L,z,$,a),M=A.shapeModel={vs:[]},s("shape3d.image")&&(M.uv=[],M.sum=s(gb)||Qf(S)||1,M.len=0),s(js)&&!a&&(M.top_vs=[],s("shape3d.top.image")&&(M.top_uv=[])),s(Qc)&&!a&&(M.bottom_vs=[],s("shape3d.bottom.image")&&(M.bottom_uv=[])),A._12O(S,I);else{var j,P,H,t,q,r,o,R,e,K;if(S=zn(L,z,$,a),q=A.vf(Ic,y,!1,u),I&&(r=A.vf(Zj,y,!1,u),o=a?h:A.vf(tq,y,!1,u),R=a?h:A.vf(_h,y,!1,u),e=A.vf(xo,y,!1,u),K=A.vf(dc,y,!1,u)),I){for(var d=0,k=S.length;k>d;d++)S[d]=A._tryRemoveBezierPoints(S[d],I);A._12O(S,I)}else q&&S.forEach(function($){if(t=$.length,t>0)for(j=$[0],H=1;t>H;H++)P=$[H],A.addV(q.vs,j,P),j=P});A._20Q(S),E||(q&&(q.ns=ch(q.vs),or(q,"vs"),or(q,rp)),I&&(r&&(r.ns=ch(r.vs),or(r,"vs"),or(r,rp)),o&&(o.ns=ch(o.vs),or(o,"vs"),or(o,rp)),R&&(R.ns=ch(R.vs),or(R,"vs"),or(R,rp)),e&&(e.ns=ch(e.vs),or(e,"vs"),or(e,rp)),K&&(K.ns=ch(K.vs),or(K,"vs"),or(K,rp))))}var p=A.mat=W.getPointsMatrix3d().getElements();E&&(Kr(A,p,E,M),A.clear())},_20Q:function(g){var W,s,H,J,E,A,B,R=this,x=R.front,p=R.back,b=R.top,m=R.bottom,F=x?x.tuv:h,d=p?p.tuv:h,v=b?b.tuv:h,T=m?m.tuv:h,X=0;(F||d||v||T)&&(W=R.s(gb)||Qf(g)||1,g.forEach(function(y){if(s=y.length,s>0)for(A=y[0],H=1;s>H;H++)B=y[H],J=X/W,X+=ml(A,B),E=X/W,R._14O(x,J,E),R._14O(p,1-E,1-J),R._14O(b,J,E),R._14O(m,J,E),A=B}))},_14O:function(U,t,T){if(U){var f=U.uv,e=U.tuv;if(e){if(f)var o=f[0]+(f[6]-f[0])*t,E=f[1]+(f[7]-f[1])*t,K=f[2]+(f[4]-f[2])*t,n=f[3]+(f[5]-f[3])*t,H=f[2]+(f[4]-f[2])*T,C=f[3]+(f[5]-f[3])*T,z=f[0]+(f[6]-f[0])*T,X=f[1]+(f[7]-f[1])*T;else o=t,E=0,K=t,n=1,H=T,C=1,z=T,X=0;e.push(K,n,H,C,z,X,z,X,o,E,K,n)}}},_13O:function(M){var t=M.uv,V=M.tuv;V&&(t?V.push(t[2],t[3],t[4],t[5],t[6],t[7],t[6],t[7],t[0],t[1],t[2],t[3]):V.push(0,1,1,1,1,0,1,0,0,0,0,1))},_tryRemoveBezierPoints:function(U,k){var s=U.length;if(4>s)return U;var N,G,Y,f,Q,B,c=!1,A=function(V){return U[V]},i=function(t){return U[s-1-t]};for(Q=0;1>=Q;Q++)for(B=Q?i:A,G=B(0),Y=B(1),N=2;s-1>N;N++)if(f=B(N),!f.remove)if(f.b){var S=Se(G,Y,f,k);S.adjust?(f.remove=!0,c=!0):(G=Y,Y=f)}else G=Y,Y=f;if(!c)return U;var $=[];for(N=0;s>N;N++)U[N].remove||$.push(U[N]);return $},_12O:function(o,i){var U,b,X,a,T,M=this.s("shape3d.point.epsilon"),m=this;o.forEach(function(W){if(T=W.length,T>0)for(U={p:W[0],n:!0},a=1;T>a;a++)b=W[a],X=T-1>a?W[a+1]:h,X&&Math.abs(b.x-X.x)<M&&Math.abs(b.y-X.y)<M||m.addPoint(U,b,X,i,W)})},addPoint:function(X,s,V,Y,W){var i,U,t,L,a,o,z,p,T,I=this,_=X.p,r=X.f,A=X.b,C=I.s("shape3d.side")||If,n=I.s("shape3d.start.angle"),J=I.s("shape3d.sweep.angle"),B=I.shapeModel,y=I.data.isClosePath();
if(X.n&&(X.n=!1,r=y&&W.length>2?Se(W[W.length-2],_,s,Y):Se(h,_,s,Y),A=Sd(_,r),B?B.top_vs&&I._10O(A,r,C,n,J,B.top_vs,B.top_uv):(i=I.left)&&(I.addV(i.vs,A,r),I._13O(i))),U=V?Se(_,s,V,Y):y&&W.length>2?Se(_,s,W[1],Y):Se(_,s,h,Y),t=Sd(s,U),B){var K,F,b=B.vs,$=B.uv,j=B.sum;for($&&(K=B.len/j,B.len+=ml(_,s),F=B.len/j),o=I._9O(A,r,C,n,J),z=I._9O(t,U,C,n,J),p=0;C>p;p++)T=p+1,Zf(b,o[T]),Zf(b,z[p]),Zf(b,o[p]),Zf(b,z[p]),Zf(b,o[T]),Zf(b,z[T]),$&&(L=p/C,a=T/C,$.push(K,a,F,L,K,L,F,L,K,a,F,a));!V&&B.bottom_vs&&I._10O(t,U,C,n,J,B.bottom_vs,B.bottom_uv,!0)}else!V&&(i=I.right)&&(I.addV(i.vs,U,t),I._13O(i)),(i=I.front)&&I.addV(i.vs,r,U),(i=I.back)&&I.addV(i.vs,t,A),(i=I.top)&&I.addH(i.vs,r,U,t,A,!0),(i=I.bottom)&&I.addH(i.vs,A,t,U,r);X.p=s,X.f=U,X.b=t},_10O:function(n,Z,K,j,W,Q,a,F){var g,B,H=this,A=H.data,Y=H._9O(n,Z,K,j,W),E=(n.x+Z.x)/2,J=(n.y+Z.y)/2,N=A.getShapeElevation(),G=0;for(G=0;K>G;G++)F?(Zf(Q,Y[G]),Zf(Q,Y[G+1])):(Zf(Q,Y[G+1]),Zf(Q,Y[G])),Zf(Q,[E,N,J]),a&&(F?(g=S*(G+1)/K+j,B=S*G/K+j):(g=S*G/K+j,B=S*(G+1)/K+j),a.push(.5-.5*$(B),.5-.5*e(B),.5-.5*$(g),.5-.5*e(g),.5,.5))},_9O:function(P,K,U,v,N){var z,Q,I=this,M=I.data,x=[],B=(P.x+K.x)/2,l=(P.y+K.y)/2,O=M.getTall()/2,q=M.getShapeElevation(),c=0;for(N==h&&(N=S);U>=c;c++)z=N*c/U+v,Q=$(z),x.push([B+(P.x-B)*Q,q+O*e(z),l+(P.y-l)*Q]);return x},addV:function(z,F,j){var f=F.x,E=F.y,x=j.x,q=j.y,B=this.data,X=B.getShapeElevation(),h=B.getTall()/2;z.push(f,X-h,E,x,X-h,q,x,X+h,q,x,X+h,q,f,X+h,E,f,X-h,E)},addH:function(z,s,_,m,w,q){var h=this.data,F=h.getTall()/2,T=h.getShapeElevation()+(q?F:-F);z.push(s.x,T,s.y,_.x,T,_.y,m.x,T,m.y,m.x,T,m.y,w.x,T,w.y,s.x,T,s.y)},vf:function(T,F,V,m){var S,x=this,i=x.gv.getFaceVisible(x.data,T);return(V||i)&&(S=gn(x,T,m),S.vs=[],S.tuv=i&&(S.texture||F)?[]:h,S.visible=i),S}});var Ws=function(G,Y){oc(Ws,this,[G,Y])},Xs={},Ys=function(s){return/\.(png|jpg|gif|jpeg|bmp|svg)$/i.test(s)};sr(Ws,Ss,{validate:function(){var n=this,w=n.gv,x=n.data,V=n.s,u=Jn(V("points.color")),Y=V("points.size"),j=V("points.uv.offset"),i=V("points.image");!i||Ys(i)||Bk.test(i)||(Xs[i]||(Xs[i]=n._createCachedImage(i)),i=Xs[i]);var e,v,M=x._modelDirty,r=V("points.model");if(r){if(n._lastShapeModel!==r||!n.shapeModel){var D=Jb(n,r);if(!D)return;var R=[],g={};n.eachShapeModel(function(z){for(var s=0,N=z.length;N>s;s+=3){var P=z[s],H=z[s+1],l=z[s+2],p=""+P+"_"+H+"_"+l;g[p]||(g[p]=!0,R.push(P,H,l))}},D),n._setShapeModelPoints(new Rl(R)),n._lastShapeModel=r,M=!0}e=n.shapeModel.vs.length,v=e/3}else{var F=x.getPoints();if(v=e=F.length,M||x._pointsDirty||!n.shapeModel){for(var t=[],E=0;v>E;E++){var W=F[E];W&&t.push(W.x,W.e,W.y)}n._setShapeModelPoints(new Rl(t)),x._pointsDirty=!1,n._lastShapeModel=null,M=!0}}if(n.info={mat:hk(x),size:Y,diffuse:u,opacity:V("points.opacity"),texture:i,alphaTest:V("points.transparent")?0:V("alphaTest"),uvScale:V("points.uv.scale"),uvOffset:j,discardSelectable:V("points.discard.selectable")},M||x._colorsDirty){var _=!1,G=x.getColors();if(G&&G.length>0)for(var N=[],E=0;v>E;E++)for(var P=G[E],d=P?(_=!0,Jn(P)):u,s=4*E,B=0;4>B;B++)N[s+B]=d[B];n.shapeModel.cs=_?new Rl(N):null,x._colorsDirty=!1}if(M||x._sizesDirty){var l=!1,X=x.getSizes();if(X&&X.length>0)for(var C,p=[],E=0;v>E;E++)C=X[E],C>=0?(p.push(C),l=!0):p.push(Y);n.shapeModel.ss=l?new Rl(p):null,x._sizesDirty=!1}if(M||x._offsetsDirty){var J=!1,a=x.getUvoffsets();if(a&&a.length>0)for(var Q,f,H,o=[],E=0;v>E;E++)Q=2*E,f=a[Q],H=a[Q+1],f!=A&&H!=A?(o.push(f,H),J=!0):o.push(j[0],j[1]);n.shapeModel.os=J?new Rl(o):null,x._offsetsDirty=!1}if(M||n._lastPointNumber!==v){this.dispose();var m=w.pickColorMap,U=n._startPickId=m._pickIdUsed;m._pickIdUsed=U+v;for(var t=[],E=0;v>E;E++){var q=U+E,S=pq(q);t.push(S[0],S[1],S[2],S[3]),m[q]||(m[q]={data:x,part:E})}n.shapeModel.ps=new Rl(t),n._lastPointNumber=v}x._modelDirty=!1,this.dispatchBoundingBoxChanged()},_setShapeModelPoints:function(j){var N=this,Q=N.shapeModel,H=N.shapeModel={vs:j};if(!Q)return H;var t=j.length,F=Math.round(t/3);return Q.cs&&Q.cs.length==4*F&&(H.cs=Q.cs),Q.ss&&Q.ss.length==F&&(H.ss=Q.ss),Q.os&&Q.os.length==2*F&&(H.os=Q.os),Q.ps&&Q.ps.length==4*F&&(H.ps=Q.ps),H},_createCachedImage:function(X){var O=128,I=gi(),l=I.getContext("2d");Ir(I,O,O,1),Nl(l,{width:O,height:O,comps:[{type:X,background:"white",borderWidth:0,rect:[0,0,O,O]}]},0,0,O,O);var u=L.Math.generateUUID();return Ak[u]=I,u},_80o:function(Q,O){var D=this,t=D.gv,H=t._picking;if(!H||t.isSelectable(D.data)){var u=D.shapeModel,r=D.info;if(u&&u.vs&&u.vs.length){var i=li.for(Q);i.useProgram(D._asureProgram(Q));var n=i.directUniforms(),W=i.directAttribs();n.modelMatrix=r.mat,n.modelViewMatrix=Nd([],t._viewMatrix,r.mat),n.projectionMatrix=t._projectMatrix,n.viewMatrix=t._viewMatrix,n.scale=t.getHeight()/2,n.size=r.size,n.diffuse=r.diffuse,n.opacity=r.opacity,n.map=t.getTexture(r.texture,D.data),n.alphaTest=r.alphaTest,n.resolution=t.getDevicePixelRatio(),n.discardSelectable=r.discardSelectable,n.uvScale=r.uvScale,W.uvOffset=!H&&u.os?ef(Q,t._buffer.os,u.os,h):r.uvOffset,n.blackout=Q._blooming&&!D.data.s("bloom"),W.position=ef(Q,t._buffer.vs,u.vs,h),H?(n.picking=!0,W.pickColor=ef(Q,t._buffer.ps,u.ps,h),n.useColor=!1,W.color=null):(n.picking=!1,W.pickColor=null,u.cs?(n.useColor=!0,W.color=ef(Q,t._buffer.cs,u.cs,h)):(n.useColor=!1,W.color=null)),u.ss?(n.useSizeArray=!0,W.sizeArray=ef(Q,t._buffer.ss,u.ss,h)):(n.useSizeArray=!1,W.sizeArray=null),vq(Q,0,u.vs.length/3,Q.POINTS),i.useProgram(O),W.disable(),t.shadowMap.enable&&t.shadowMap.createShadow(),t.flowMap.createFlow(n)}}},_asureProgram:function(a){return a._pointsShader||(a._pointsShader=this.gv._postProcessing.createShader(a,Ws.shaderSrc)),a._pointsShader.program},dispose:function(){Ws.superClass.dispose.call(this);var S=this._startPickId,v=this._lastPointNumber;if(S&&v){for(var J=this.gv.pickColorMap,z=0;v>z;z++){var R=S+z;J[R]&&delete J[R]}delete this._startPickId,delete this._lastPointNumber}}}),Ws.shaderSrc="!!~v!oj<g*p!s{n/!onpbjuu5j!tnppQewfnm!N.b!u0s!jfym<bd!tv!o)j!g>p+s!nf!{njbTuu5o!jnppQe`fmmhW!j*f!xfNwbjuusdjfyq<ts!fvQotjjg!p)s!ng!jn!bu<5*!!q1s/p2k!f.d!u>j>p!o^N!b4u!s]j^y!<3!!]vyojjsgupbsNno!pnjbuud5f!kwpjsfqx!N)b!u>s!jfyw<ju!dvfoqjtgspfsQnt!jg!mmppbpuc!!tdbm~f!<<o!pbjuuuvsmjpctvfusf!!+w!ffd{4j!tq!p>t!jfu{jjpTou<ojp!Qv`omjhg!ps|n!!fctpmpfm!!~v!tf<Doppmjpusv<mp!tbfusu!s+j!czvbusfs!Bwff{dj5t!!d>p!mfp{sj<Tu!owjbpsQz`jmohh!!w|f!d*5z!bwsDspBmfp{sj<Tft!vb)u!ugsjj!cv<uofp!jwufjdt3p!QvwwnP!g+g!tyfjus<ub!Nwobpsjzujdofhk!pwsfqd!3>!!woPpgjgutjftup<Q`m!hv!oj<goppsjnu!jctpppQmw!nq!j+d!lyjjoshu<bN!xbfujuWsmjfcevpunf!!>w!fodp5j!uqjjtdplQDwpnm!ps<<*!1!/v2o!j-gepfsnns!pggmtpobbus!ut!j){5fd<fw!!v>o!jogppjsunj!tgpmQpwbnu!!5sdfftwp!mv<u*j!poop<ju!jvtopjqg!p)s4nd!fcwp!p>m!!evftnfsTpjg{tfoBbsssub!z4<df!wb!uu<s*jucfvtugfg!Pgwmvp)b3ud!ftwj!{>f!Busfstbgzg<Pw!!c~p!pm<!sjptmQpfds!t>q!fsdpumjpwDfwN!bu|s!j*ys)p!mnpbDuf5t!vn)!!*g!j|!f!tsmffu!vs~o!!n<]s!p3m!p^D]l!d4j!q^!!>>!>s!p.m!p2D/w1!<|!!~*ho!jwlpdjjeq!)n!bgjjo!)*|!^#!!~qs~f!dj<tsjppmop!Difjthvigqg!jgem!p>b!us<pm!p$DehfbgsjGo`fm!hV!TF|`!NfBtQmf!!v~o!jg<psspnm!pwDfwd!5>!!esjpgmgpvDthfb<sG!`vmohj!gp<sens!bgdmtpjbeu!!*p1q/b1d!j>u>z!<b/!svpomjpgDpfstnv!gggmjpeb)u!!gbjm!qi|b!U*fhtouj<ldj!qv)o!jggjp!sn<!ecspbpdmt!jvet!f*DuptmfpUsb<iq!mwbb!s=z!jbo/hs!pwmfpdD5f!twvDgpgmjpes)<!gj!!vogjjgeposfn$!!cp~p!m!<q*jwdvl!j-oqhb<n!!)vEo3jfgspvsuny!fcup!p>m+!!esjptmdpbDsfetTvfgmgfjdeu!bc<muff<tgg!Pvwo!j>g,p!swnv!!cp<pfmm!bcdmTbwdvl!p+v!ue<spp!DvuoojjgppQs`nm!hw!f>d!3w!vv!w3Tddfbwm!f<|!!*wfbmsczbjuodhf!mwffTde3s!bwdPtgjgetaf!u}<}!h$ojjgl!dejfqgaj)o!fgej)!!V*T!FQ`BNNB`QF!T*V!!)veofjogjpgsfne!!tgbjn$q!mf~s!3E<!*n!bzqu<jd$bfqope!j+g!b/wfptjveg!gnjbej!o-){*z!y|/f!tjvgg!g)jcem!b)d5ldpfvwu!*>!!|s!phmmp`DGfstbvhgDgpjmep!s!|>!!fwtfmdf5!)~1!/1<-*!!1z/u1j-d!b1q/p1!-+!!2b//1s*p<m!psDfwu!v-s{oz<y!/~spm!pwDfwd!5)!5edjfgwg!v>t!fsDppmmppDsf<tv!gjggj!e)!aq|j!d*lsjpomhp!D%f%t!v";var Zs=function(B,I){oc(Zs,this,[B,I]),this._needRecoverPosition=!0};sr(Zs,Rs,{_25Q:1,validate:function(b){var D=this,l=D.data,A=D.s,x=l.getPoints(),_=x.size();D.dispatchBoundingBoxChanged();var f=l.p3(),j=D.mat=Rb();Jm(j,f),Xl(j,l.getFinalRotation3d(),l.getRotationMode());var n=l.getScale3d(),K=l._dynamicScale3d;if(K&&(n[0]*=K[0],n[1]*=K[1],n[2]*=K[2]),bl(j,n),Jm(j,Fg(f)),(!D.s("geometry.cache")||!D.shapeModel)&&(D.shapeModel=D.info=D.lineShapeModel=h,_>1)){var B=D.info={},N=l.getSegments(),Q=l.getThickness(),v=el(x.get(0)),m=el(x.get(_-1)),C=_%2;0===C?(B.c1=el(x.get(_/2-1)),B.c2=el(x.get(_/2))):B.p3=el(x.get((_-C)/2)),B.s1=v,B.s2=el(x.get(1)),B.t1=el(x.get(_-2)),B.t2=m,B.list=A(Rg)===Sg?D.createTubeModel(x,N,Q/2,b):D.createLineModel(x,N,Q,"shape.border","shape.dash")}},invalidateCachedGeometry:function(){this.shapeModel=this.info=this.lineShapeModel=h},_80o:function(D,l,W){var U=this,f=U.shapeModel;if(f){var E=U.gv;vg(E,U.mat),Bf(E,U.data,f,U,U.getBodyColor(),W),Ol(E)}}});var $s=L.graph3d.PostProcessing=function(s){function k(){if(!D){var K=s.getGL();D=new hd.RenderTarget(s,K,null,null,{samples:E.renderTextureSamples||1,minFilter:K.LINEAR,magFilter:K.LINEAR}),z=new sp.Shader(K,T.vs,T.fs),f=sp.Buffer.createIndexBuffer(K,new Uint16Array([0,2,1,1,2,3])),c=sp.Buffer.createVertexBuffer(K,new Float32Array([0,0,1,0,0,1,1,1]))}}var D,z,f,c,b=this,j={},q=!1;!function(){U.keys($s).forEach(function(l){j[l]=new $s[l](s)})}(),b.getModule=function(v){return v?j[v]:b},b.getModuleList=function(){return U.keys(j)},b._serializable=!0,b.handleDataModleChange=function(V,t){V&&(b._serializable&&V.setPostProcessingData(b.serialize()),V.removeSerializeListener(b.onDataModelSerialize,b)),t&&(t.addSerializeListener(b.onDataModelSerialize,b),b.deserialize(t))},b.onDataModelSerialize=function(Y){"serialize"===Y.type?b._serializable&&(s.dm()._postProcessingData=b.serialize()):"deserialize"===Y.type&&b.deserialize(s.dm())},b.isDeserializeDisabled=function(R){return!b._serializable||R.a("sceneBloom")!==A},b.isSerializable=function(){return b._serializable},b.setSerializable=function(V){b._serializable=V,V||s.dm().setPostProcessingData(A)},b.serialize=function(){var K,i,E,e,q={};for(i in j)if(E=j[i],e=E.serializeProperties){K={},E.enable&&(K.enable=!0);for(var B in e){var r=E[B];r!=e[B]&&(K[B]=r)}U.keys(K).length&&(q[i.toLowerCase()]=K)}return q},b.deserialize=function(L){var k,Z,I,w,U,B={},N={};for(k in j){I=j[k],w=I.serializeProperties;var r={},p="scene"+k,n=L.a(p);n!==A&&(r.enable=n);for(var U in w)n=L.a(p+U[0].toUpperCase()+U.slice(1)),n!==A&&n!==w[U]&&(r[U]=n);ic(r)||(N[k[0].toLowerCase()+k.slice(1)]=r)}if(ic(N)&&(N=L.getPostProcessingData()),N)for(Z in N)if(Z&&(k=Z[0].toUpperCase()+Z.slice(1),I=j[k])){B[k]=!0,w=N[Z];var J=!!w.enable;b.enableModule(k,J),k="scene"+k,L.a(k,J),I.resetProperties&&I.resetProperties();for(U in w)if("enable"!==U){var n=w[U];I[U]=n,L.a(k+U[0].toUpperCase()+U.slice(1),n)}}for(k in j)B[k]||(I=j[k],I.enable=!1,I.resetProperties&&I.resetProperties())},b.getRenderTarget=function(){return D},b.blitScreen=function(o,E,e,K,$){var T=s.getGL();if(T){o&&(o.bind(T),s.setViewport(T,0,0,o.width,o.height)),$&&$.clear===!1||T.clear(T.COLOR_BUFFER_BIT|T.DEPTH_BUFFER_BIT),k(),e||(e=z),e.bind(),T.activeTexture(T.TEXTURE0+0),_i(T,E||T._emptyTexture);var t=e.uniforms;t.image=0;var S=1;if(K)for(var O in K){var y=K[O];y instanceof WebGLTexture&&(T.activeTexture(T.TEXTURE0+S),_i(T,y),y=S,S++),t[O]=y}if(f.upload(),c.upload(),e.attributes.pos.pointer(c),T.drawElements(T.TRIANGLES,6,T.UNSIGNED_SHORT,0),S>1)for(;--S>=0;)T.activeTexture(T.TEXTURE0+S),_i(T,null);else _i(T,null);o&&o.unbind(T)}},b.decodeShader=function(A){var H,e,c,u="",h="";for(c=0;c<A.length;c++)H=A[c],"%"===H?H="'":"a"===H?H='"':"]"===H&&(H="\\"),e=String.fromCharCode(H.charCodeAt(0)-1),c%2?h+=e:u=e+u;return h+u},b.createShader=function(p,z,K){var G,M;if("string"==typeof z){var Q=z.indexOf("^#");G=b.decodeShader(z.substr(0,Q)),M=b.decodeShader(z.substr(Q+2))}else G=z.vs,M=z.fs;if(K){var t=K(G,M);t&&t.vs&&(G=t.vs),t&&t.fs&&(M=t.fs)}return new sp.Shader(p,G,M)},b.enableModule=function(v,Y){var M,i,c,W=v.split(",");for(M=0,i=W.length;i>M;M++)c=W[M].trim(),j[c]&&(j[c].enable=Y);q=!1;for(c in j)if(j[c].enable){q=!0;break}q&&k()};var T=b.blitScreenShaderSrc={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","varying vec2 vUv;","void main() {","gl_FragColor = texture2D(image, vUv);","}"].join("\n")};b.render=function(W,U,p,T){if(q){D.setSize(W,U,p),D.bind(W);var u=W.getParameter(W.COLOR_CLEAR_VALUE);u&&0===u[0]&&0===u[1]&&0===u[2]&&0===u[3]?u=null:$q(W,[0,0,0,0]),W.clear(W.COLOR_BUFFER_BIT|W.DEPTH_BUFFER_BIT),s.setViewport(W,0,0,U,p),T=T||{};var N=T.renderAxis!==!1,Y=T.renderEdit!==!1;T.renderAxis=T.renderEdit=!1,s.renderScene(T),D.unbind(W);for(var z=0,h=s._glCapabilities.maxAttributes;h>z;z++)W.disableVertexAttribArray(z);var i,C=D;for(i in j)C=j[i]._42(W,C)||C;s.setViewport(W,0,0,U,p),u&&$q(W,u);var P=b.getModule("Fxaa");return P&&P.enable?b.blitScreen(null,C.texture,P.getShader(W),{resolution:[1/U,1/p]}):b.blitScreen(null,C.texture),W.useProgram(s._prg),s._renderAxisAndEditHelper(N,Y),!0}}},_s=L.graph3d.PostProcessing.HueSaturation=function(s){function _(){K=!0;var L=s.getGL();M=new hd.RenderTarget(s,L),p=s._postProcessing.createShader(L,_s.hueSaturationShader),r=sp.Buffer.createIndexBuffer(L,new Uint16Array([0,2,1,1,2,3])),P=sp.Buffer.createVertexBuffer(L,new Float32Array([0,0,1,0,0,1,1,1]))}var r,P,p,M,C=this,Y=!1,K=!1,Q=[],l=[],d=[];this.serializeProperties={hue:[0,0,0,0,0,0,0],saturation:[0,0,0,0,0,0,0],lightness:[0,0,0,0,0,0,0]},this.resetProperties=function(){var E=this.serializeProperties;for(var N in E)this[N]=E[N]},this.resetProperties(),U.defineProperties(C,{enable:{get:function(){return Y},set:function(C){!!Y!=!!C&&(Y=C,C&&!K&&_(),s.iv())}},hue:{get:function(){return Q.map(function(j){return y(180*j)})},set:function(i){if(Q!==i&&7===i.length){for(var c=0;7>c;c++)Q[c]=i[c]/180;s.iv()}}},saturation:{get:function(){return l.map(function(s){return y(100*s)})},set:function(j){if(l!==j&&7===j.length){for(var S=0;7>S;S++)l[S]=j[S]/100;s.iv()}}},lightness:{get:function(){return d.map(function(m){return y(100*m)})},set:function(m){if(d!==m&&7===m.length){for(var R=0;7>R;R++)d[R]=m[R]/100;s.iv()}}}}),C._42=function($,Z){if(Y){K||_();var D=Z.width,z=Z.height;if(D&&z){M.setSize($,D,z),uf($,M.frame),s.setViewport($,0,0,M.width,M.height),$.clear($.COLOR_BUFFER_BIT|$.DEPTH_BUFFER_BIT),p.bind(),$.activeTexture($.TEXTURE0+0),_i($,Z.texture);var N=p.uniforms;return N.image=0,N.hue=Q,N.saturation=l,N.lightness=d,r.upload(),P.upload(),p.attributes.pos.pointer(P),$.drawElements($.TRIANGLES,6,$.UNSIGNED_SHORT,0),_i($,null),cf($),M}}}};_s.hueSaturationShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<j*txj/psop!mipjdh!i-q*!mgtmip)bcuh<s3!mvtoij)g5pdsfnw!!t>b!nsqpmmfpsD3hEb!sjGn`bmhhf!<<!*w!bs*zfjhoohb!Swtftdf3o!uwiVhwj<m!-!^$1e]ftgtjfoofu!iNhBjYm`!S-B{O/HmFt!i8)t!t$feofugijhojfm!`SqBbOnH!F`-B*MfMh!o1bSo!pvjoujbgspvsunb!tg!m-p^b1u]!oipvjfu]bNsBvYu`bStB!O-HzF/^m<ti!)voopjjgupbssnv!ugbmtp`bqub!nt!bu-v*sfbhuojbpSof]vNiB!Y-`^S1B]OfHvFi^!<-y!/vmotjig)pfsvni!`gqmbpnb!u!)m4jdhfiwu!o>f!tmtt]iN!BY`~S!BO~H!F^<<lbf!sgcm!pb<u^!snfbuqo`vipvdf`)fgvmip]btut!fjoouWibhmjvmf!->!!gfmhpobbuS!titvffoBumimh-j!mg!mp<b^us!fiuvofvSpbdo`hffv*i!]|op!jgumbpsbvuu!bwtb!m>v!ff!h>o!bjSooWpbjmuvbfs!v,u!b)ti!vf<B^msmf!u,o!vipvdf`Sfbvoih]ff*v!i0!!>3!/f1h<obS!fjvgi!!)w|b!m*vffh!o=b!s1!/>1>*!!ssffuuovvspod!`wfbvmiv)f!!g,j!!2/|1!<*,!,fsmftufo!vjpgd!`)fwvbim!v<fF!H?O!B2S/`1Y*B!Ns!f=u!vssfou!owvbpmdv`ff!v.i!!2</11!<>!!sffmutofv!psdf`ufvvsio!!uwobjm)v!fs<pg!!~<!2g!m,p!bfuh!onbbsq!`>t!bfuhvosbbsu!jp<o1)!g>m!pfbhuo!bjso!W*b7m!v>f?-!!fghmopbbsu)!!tgbju!vs~b!uj~p!oB<mlmb-f!sgcm!pb<us!ftubouvvpsdb`ufjvpio!S>b!ofhhfo*b!s|!!|g!m*p6b/u1!!w,b!m*vsff!u>o!vjpodW`bfmvvif)!u+b!p)m2g/!1=!!,i!)t!bgujv!sb|u!j*p,o,Bsmfmu!o,v!ptdb`ufvvsib!u<jFpHoOSBbSo`hYfB*N<!=!!ssffuuvosvop!dd`mfbvniq!)<w1b!m>v!fs-f!u1o/v1p-d!`2f/v1i*!<uo!j~)!!sgpmgp!bu!<nfbhqo`bmSjthtifuooufithtj)mg!m-pfbhuo!bjSooWpbjmuvbfs-v!ugbmtp!b-uf!hmojbhSifuvoif!tutbBpmmmg-!!g<m1p!b>u!!fmhjohbisu!oufotjt!Sb<oehmfp*i!t|fs!igum`pfbvui!!wu!b>p!mmgj!hi<u1o/f7t!t+B!mym/!m,t!im!j>h!iiu!oufbtptmSgb!oh<f*<{z!yj/gs!p)mwp!d=)!m1t/i13*ch!ss!f>u!vmstoi!!j4odWfbwm!vf<!*+w!V)ww!!-,f!h2b/n1j*)<E3!ffsmvtufyf!us!f>u!vsspom!pjdo!W5bdmfvwf!!,|!!)*w)!o+j!b)n2!/e1j!p.w!!joW~b!mv<f**m*!<-t!!~-i!)g4mdpfbwu!!oisvvfu3fssh!c)~g!mp<b1u/!7g!20-!!ig!m>p!biu!!g~3!-!<g1m/p7b!u>!,i!vif!*!||!*!1j/g1!!)=i!vif)!!=g!j1!/1*~!!i<vbfu!m,f>E!d2!/01!<*h!!f.m!tsf)!!j,g!!1)/i5v!f>!!?i!!2/|1!*ft!mifv!f~!!.><!b2u/m1f<Ed!!g0m!p*bsu!!.s!fct)<!,!!j1g/!3)!)>7!/i1!!+|!!i*vyfb*N!d=!!>2>/!1h*)!!gsjf!tf!t>m!fg!2~!!,!<)bgu3m!f.E!dg!20*!!*+c!!7./!1h!)+!!>i!vif!<|!!f*mytbfN!dj!g>!>)!)s3)/!1g!j+!!iv<f***!o=j!N2d/!1,*!y!bsNfdt)!!>.!!g13/<3)!!f0m!tbfu!mjfgE!d)!);4!/*1o!j+N!di!v,f!*y!b=N!d3)/!10*!b!usmfftE!d>!!@g!26!/,1!!)=g!3m!!.>!!gt2!*!+<!o)j)N3d/!1.!!0y!b4N/d1!*>!!.b!uimvffE*d!!+u!b7p/m1g<!!|f!m*tofjN!ds!f?t!!y>b!Ngd2)<!g!js!fuv<s1o/!3s!f0t!<*o!j~Nd!!,w!fydb4N!di)t!m>3!smh!c)w<f*d*4c!!i-thm)*y!b|n!!-wsf)dy4b!ns!h>c!<ybN!dj!gu!b)pimtgm!/z<!*>*>c!!1-/h1)*o!j|n!!-ssh)co!j>n!!w>f!do4j)Nidt!mu/b{p*m<g!!~<!cf/mdt!f>!!|c!!ugbmppmbgu!!g<3h</d!!>j!gh!!)uibtpmm/g{!!=<!s1//d6!*>!!sg!3u!b>p!migt!m/<{1!/+1!!)>2!/m1!!u,b!pimtgm!/z<*1</1!!f>m!ttf!u!bgp3m!g>!!i<t1m//2{.!!,>!!iit!mu/bzp!m.g!!it|m!/*zd!!+4!diftwm)/m{t<i3c!hgsm!p4bduf!wg!2!>~!!3/<1c!h+s!!iotsmv/u{f!s.!!g~3!<<*!*s1h/c4/0s1!/>2!)i!v.f!3ys/hmct)ig!2--3!gg!3--2!gi)tcmh/sy3!f,v!i)!2>/!1c0/4c/h1s*!*<<*!ys/hmct/ih!!->3!gi!v-f23gs)hc";var at=L.graph3d.PostProcessing.Bloom=function(n){function D(){var f=n.getGL();if(f)for(var v=n._postProcessing,W=0;Q>W;W++)I[W]=v.createShader(f,at._35Q,function(x,v){return{fs:v.replace(/DEFINE_VALUE/g,m[W]).replace("%OVERRIDE_ALPHA_DEFINE%",w?"#define OVERRIDE_ALPHA":"")}})}function b(){var b=n.getWidth(),O=n.getHeight();if(b&&O){q=[b,O],t=!0;var G,W=n.getGL(),e=Math.round(q[0]/2),F=Math.round(q[1]/2);for(j=new hd.RenderTarget(n,W,e,F),G=0;Q>G;G++)A.push(new hd.RenderTarget(n,W,e,F)),a.push(new hd.RenderTarget(n,W,e,F)),e=Math.round(e/2),F=Math.round(F/2);var Z=n._postProcessing;x=Z.createShader(W,at._34Q),D(),K=Z.createShader(W,at._36Q,function(D,M){return{fs:M.replace(/NUM_MIPS/g,Q)}}),f=Z.createShader(W,at.finalShader),J=sp.Buffer.createIndexBuffer(W,new Uint16Array([0,2,1,1,2,3])),Y=sp.Buffer.createVertexBuffer(W,new Float32Array([0,0,1,0,0,1,1,1]))}}var F,T,_,w,L,J,Y,B,P=this,p=!1,t=!1;this.serializeProperties={strength:1.5,threshold:.55,radius:.4,overrideAlpha:!0,selective:!1},this.resetProperties=function(){var Z=this.serializeProperties;for(var j in Z)this[j]=Z[j]},U.defineProperties(P,{enable:{get:function(){return p},set:function(l){!!p!=!!l&&(p=l,l&&!t&&b(),n.iv())}},strength:{get:function(){return F},set:function(U){F!==U&&(F=U,n.iv())}},threshold:{get:function(){return T},set:function(y){T!==y&&(T=y,n.iv())}},radius:{get:function(){return _},set:function(a){_!==a&&(_=a,n.iv())}},overrideAlpha:{get:function(){return w},set:function(H){!!w!=!!H&&(w=H,t&&D(),n.iv())}},selective:{get:function(){return L},set:function(u){!!L!=!!u&&(L=!!u,n.iv())}}}),this.resetProperties();var j,x,K,f,q=[256,256],A=[],a=[],Q=5,m=[3,5,7,9,11],I=[];P._42=function(h,g){function m(D,q,x,f){uf(h,q.frame),n.setViewport(h,0,0,q.width,q.height),f?f(h):h.clear(h.COLOR_BUFFER_BIT|h.DEPTH_BUFFER_BIT),E!==D&&D.bind();var i=0;for(var T in x){var v=x[T];v instanceof WebGLTexture&&(h.activeTexture(h.TEXTURE0+i),_i(h,v),v=i,i++),D.uniforms[T]=v}for(E!==D&&(J.upload(),Y.upload(),D.attributes.pos.pointer(Y),E=D),h.drawElements(h.TRIANGLES,6,h.UNSIGNED_SHORT,0);i--;)h.activeTexture(h.TEXTURE0+i),_i(h,null);cf(h)}if(p&&(t||(b(),t))){var E;if(L){B||(B=new hd.RenderTarget(n,h)),B.setSize(h,g.width,g.height),B.bind(h);var $=h.getParameter(h.COLOR_CLEAR_VALUE);$&&0===$[0]&&0===$[1]&&0===$[2]&&1===$[3]?$=null:$q(h,[0,0,0,1]),h.clear(h.COLOR_BUFFER_BIT|h.DEPTH_BUFFER_BIT),n.setViewport(h,0,0,g.width,g.height),h._blooming=!0,n.syncRenderState(),n.renderScene({renderAxis:!1,renderGrid:!1,renderEdit:!1}),h._blooming=!1,$&&$q(h,$),B.unbind(h)}m(x,j,{smoothWidth:.01,luminosityThreshold:T,tDiffuse:L?B.texture:g.texture});var e,G=j,v=Math.round(q[0]/2),H=Math.round(q[1]/2);for(e=0;Q>e;e++)m(I[e],A[e],{colorTexture:G.texture,direction:[1,0],texSize:[v,H]}),m(I[e],a[e],{colorTexture:A[e].texture,direction:[0,1],texSize:[v,H]}),v=Math.round(v/2),H=Math.round(H/2),G=a[e];return m(K,A[0],{blurTexture1:a[0].texture,blurTexture2:a[1].texture,blurTexture3:a[2].texture,blurTexture4:a[3].texture,blurTexture5:a[4].texture,bloomStrength:F,bloomRadius:_,bloomTintColor:[1,1,1]}),m(f,g,{image:A[0].texture},function(N){li.for(N).glState.blend.apply({enabled:!0,equation:N.FUNC_ADD,func:[N.SRC_ALPHA,N.ONE]})}),li.for(h).glState.blend.apply({equation:h.FUNC_ADD,func:[h.SRC_ALPHA,h.ONE_MINUS_SRC_ALPHA,h.ONE,h.ONE_MINUS_SRC_ALPHA]}),g}}};at._34Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!jbtijqpmob!!i-jmhfiyqf!ug!m-psbpum<pDvuovjqgupvspn!!)tybjnnq!m>f!ss3pEm!puDEhjbgsgGv`tmfh<<v*o!jwg!p-sinu!egjmXpibuup!pmnvtn!j,o!petmjpuiztUfissifUtziupjmtep<ojvnovjmg!p-senm!pgimtpfbsui!UtznupjptupioXjjnevumi!<)qwfbustzijuophp!nwtf!d>3!!bwiVqwm<b!wupbjpem!gnb<j*o1)/*1!!|-1w/f1d!5-!1u/f1y!f-m1!/>1!)u5fdyfuwv!s>f!3sEp)m!puDEujvgqguvvtpf!-5!dwfVww!<**<!bwnfvdm4!!-m{vznyb/!m>f!ywffud!4))u!p1e/!3>:!:w-!!u1b/p6m9g8-<!*1!/522",at._35Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qsgfjdejotfj$po<!*ibj/hyijqQ!fgsmvpubyuf<u!w-bnsvzTjuoihh!jwffxd03n!vwTVfwt<vgvgojjeg)p5sdnf!wt!b>n!qsmpfmsp3DEh!bdspGm`pmshUffytumvfs$f<<*v1o/j2g!p-snnv!Twufidh3j!fuxf0ynTvjT{fft<vgvgojjeg)p5sdnf!ww!f>d!3s!pemjpsDfhdbusjGp`om<h$BeIfQgMjBo`fF!ELJFSSSOFFWMP`!SgBfEeJgVjT$!E~FG<JxO!F+`!W1B/M3V!F>,$!enfvgTjuoifh!jTfJxHN<Bx!!E+F!G*J3OfFm`qWnBbMtV!F,!&2PfWmFqSnSbJtE)F!`>B,M!QnIvBT`fEtFvGgJgOjFe&<gcmhpsb/u*!uhfbtvgtgtPjwbvo!Q.e!gw)Vjwo!!-gfmspvbuuy!fyU-s!pjmop!dg!m)pEb3uf!stvjuhynfbu*!!>|!3sffmuqvnsbot!!14/d4f:w9:<5c!h+s!/f*yuqf)t!g.g1P/w6v!!+,!!yw!V+w!!y-0f)s!vtujyhfnUbs!p+m!ptdj!h)nEb3*f*s0vtujyhfnub!<>!~2fwmpqjneb!tn!b4jdof)w*!<|y!w+f!df3{!jjTowwoTjj!{+f!!o>p!j2u/d1f!s0j!eu!f>y!Tujf{tfg<gPgwmvp!b3ud!fgwTj<h*nbbn!h>j!Tggm!p-byu))gTeJQHoNbBj*t<tvgbmhp!b>u!!xx!fujbhpimugTv<n*!j>)!uhbbpvmtgt!j>b!oyQ!eugb)p1m/g1-|!!g*T!j,h,n!bj*!<<TwVfJdE5B!Su`fMyFuOvSsFfLQ!j=y!!j>!!<u2f!y>u!vjs!fu3oEj)!!)dsppmgps<UnfvyTuuvishfj-f!xw!V+w!*c<hsw/fydj4Q!fesjvgugyvftuf!T>v!n",at._36Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!j*twjVpwo!!-i6jfhsivqu!ygfmUpsbvum<c)wEb3sfzsjvouhy!fwuf!d+3!!*w1V/w2<!-vsopjmgppDsuno!jtUbnnpqpmmfcs)35Ed!fcwm!v+s!U*f3y/u1v)ssfp2u<dbvGonjpgppmsCnq!stfbmnq!m,f!s*3wEV!wc!m-v5sfUsfvyuuyvfsUfs3v<mcv)oEj3gfpssvnu!ytfbun!q+m!f*s13/E2!!c-msvpsmUpfDyuuovjsUfn4p<pmvco)j5gdpfswn!!+t!b*n5q/m1f)ss3pEu!dcbmGvnspUpfmyCuqvssffm5<!,v!o*jwgVpws!n-!4tfbsnvqumyffsU3sEv!mccm)vEs3Uffsyvuuvysffu6!<+!v*o1j/g2p!s-ns!ptmbpnDqumofjsU3nEp!pemjcs)u5Udffywu!v+s!f*<7/v1o)jsgppusdnb!GgnmpppbmuC!qcsmfpmpn!T,u!s*fwoVhwu!i-<3fvsovjugypfsUns!vgmmcp)bEu3!fcsmvpupynfSub!e+j!v*t1</2v!o-jsgppmspnD!uwofjdU4n!pcpmmpcp)n5Udjfowu!D+p!m*p9s/<1)gsmppubdub!GmnfpspqmCCmqpspfnmGb!d,u!p*sw)Vdwp!o-t2uf!sjvou!ygfmUpsbvum!cg)bEd3ufpssv*u!y|fug!m+p!b*u1!/n2j!s-ssppsmGpbDduuopjsU!n>p!p2m/c3)!5.d!fgwb!d+u!p*s1</2s)fsupvusdob!Gnnjpyp)mgCbqdsufpms!-)!!n+j!sisuphsoGfbsduuTpnsp-p!mccm!p>p!nsSpbmepjDvhtb*s<G`~mhwp|j!e*!)nobj",at.finalShader="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*dwjVtwj!p-of!hibjnhji)qE!3gfmspvbuuy<fuv!o>j!gsppsmnp!DthbbnsqGm`fmsh3E|!!j*n)bohjfb<n!webjspzwjo<hw!Vwwf!d3";var bt=L.graph3d.PostProcessing.Dof=function(m){function y(){M=!0;var R=m.getGL();A=new hd.RenderTarget(m,R),p=m._postProcessing.createShader(R,bt._38Q),Q=sp.Buffer.createIndexBuffer(R,new Uint16Array([0,2,1,1,2,3])),K=sp.Buffer.createVertexBuffer(R,new Float32Array([0,0,1,0,0,1,1,1]))}var A,p,Q,K,g,z,s,u,i=this,O=!1,M=!1,_=xb.generateUUID();this.serializeProperties={aperture:.025,maxblur:1,image:null},this.resetProperties=function(){var V=this.serializeProperties;for(var r in V)this[r]=V[r]},U.defineProperties(i,{enable:{get:function(){return O},set:function(J){!!O!=!!J&&(O=J,J&&!M&&y(),m.iv())}},image:{get:function(){return z},set:function(V){z!==V&&(z=V,g&&(m.deleteTexture(_),g=null),m.iv())}},maxblur:{get:function(){return s},set:function(C){s!==C&&(s=C,m.iv())}},aperture:{get:function(){return u},set:function(w){u!==w&&(u=w,m.iv())}}}),this.resetProperties(),i._42=function(D,r){function k(I,T,c,E){uf(D,T.frame),m.setViewport(D,0,0,T.width,T.height),E?E(D):D.clear(D.COLOR_BUFFER_BIT|D.DEPTH_BUFFER_BIT),N!==I&&I.bind();var p=0;for(var Z in c){var b=c[Z];b instanceof WebGLTexture&&(D.activeTexture(D.TEXTURE0+p),_i(D,b),b=p,p++),I.uniforms[Z]=b}for(N!==I&&(Q.upload(),K.upload(),I.attributes.pos.pointer(K),N=I),D.drawElements(D.TRIANGLES,6,D.UNSIGNED_SHORT,0);p--;)D.activeTexture(D.TEXTURE0+p),_i(D,null);cf(D)}if(O){M||y();var N;if(!g){var c=Tj(this.image);if(!c||!c.comps&&!c.tagName)return r;L.Default.setImage(_,c),g=m.getTexture(_)}var t=r.width,R=r.height;if(t&&R)return A.setSize(D,t,R),k(p,A,{tColor:r.texture,tDepth:g,aspect:t/R,aperture:this.aperture,maxblur:this.maxblur}),A}}};bt._38Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f1d/j2t!j>p!ob!/isjphmipqD!hgbmspGb`um<hw<b1s/z2j5o!h0!!wmfpdd3!!>w!Vswp<mpvDohjbgspGs`nm!hcp<p*m!!5vstvfmEcfgqpuei!<+!v*o!jugdpfssns!ptdbundqfmqftsb3!E+!!u*D!p5m/p1s!<-1v/o1j!g)p3sdnf!wt!b)n!q,m!fzsy3/Ew!VuwE!f-qsupim<pDvuo!j)gEp3sfns!vgumypfbuu!!>n,b!ymcpmdvs<<*!v5osjvgmpcsgnp!eg!m+p!b*u!!ubdqffsssupvdsufd<fqvtobj!g+p!s*n!!:g3m/p1b.u!!-o:f3b/s1D.m!j)q3<dfvwo!j)g!p,s!nz!yg/mwpVbwu!!-gsbpsmDpmDjuq!<)Ev3ofjsgvpusynf!ug!m>p,b!um!pgdpd<v*t!<5svvomjcggppsen!!+g!m*p!buud!fbstsqpfdduud<fqdtpbo!t+u!!*g!m1p/b1u!!-V5o/q1b.d!l)E3pdxfowt!d)b!m,f!!z>y!/3w6V6w/!!-0s!p3m6p7D/u<!!)0E03!f1s/v/u2y!f.u?!!>g,s!bmdpudjp<o*!!)5fsyvdmmcvgepjeo!h+!!2**!uddpfostsup!dwufddf4q!tQbb!d+l!G*b!d:u3p/s1t!!->:!3w/f1d.4!))!33d6f7w/!!)+!!,3!6z7y//!w+V!w3!6-7s/p-m!p3D6u7!/)!E+3!f3s6v7u/y-f!u3!6>7,/!!m*p<dd<p*o!t5us!vwmfcdg5p!eV!o+q!b*d!luGdbfdsusppsdtu!d>f!qVtobq!b+d!l*E!p5x/o1t.d!b-m1f/!10!!)w3fddf5w)!!)Q!b,d!lzGyb/dwuVpws!t--s!p2m/p!D*u<!)gEm3pfbsuv!uvyofqub!d>l,S!HmCpBdUp<E*f!q5usiv)m!cdgppoet!u+!!j*o!!uwdffds5s!pwd!u*d!f|qt!bs!f+u!v*s!o:!3e/p1u.)!!-w:-3!/V1o!q)b3ddlfGwb!d)u!p,s!tz!y*/<wV~w!g-msppbmup!Dhuf!u)EEf3qfusiv)u!ydfpuo!t>u,!!jmop!dwf<d*3!!5tsdvsmfcfgopQep!t+j!u*j!puod!f*s!s|pd\nusdffuqvtsbo!!+v!o*q!b1d/l1S!H-C5B/U1p!E)f3qdufiw)!!)u!f,y!uzvys/fw3VEw)!!-usEpfmqpuDiu-!!)tEd3sffsfvouQypftuj!u>j,p!om!p*d!*<<*!~5sgvmmpcbgup!eq!f+s!t*q!fuddufjswsfpEdfuqdufiqUtpbW!j+f!x*[!):!3d/p1o!t-u:!3j/o1!!g)m3pdbfuw!!j)o!w,D!mzjyq/[w-V!wd!p-ostpum!pjDou!!g)mEp3bfus!voufybfsu-!!>d,p!omtpud!j<o*!!g8mspvbmuc!ggpbes!!+*!!*|!u!dsffsusvpsdou!d)f!qotfbb!s+!!+*!!g5b/s1!!*-!10/!1)!!))3!dgfbws!!).!!,o!fzbys/!w*V!w+!!-jsopwmDpmDjuq![)!E.3!fgsbvsu!y*f<u!~>,g!mmppbdu!<h*f!u8Wsjvfmxc[g)p!ed!p+o!t*u!!ujdof!sgsmppdbuud!feqftqbu!i+!!**!!|:3\n/s1f.u!v-s:o3!/q1f.s!t)q3fddfuwj!w)f!E,f!qzuyi/UwpVWwj!f-xs[p)m!peDfuq!u)iE-3!fosfvbusyDfmuj!q>-,!!gmbpsdDm<j*q!!8*s<vm~cgwppej!e+!!n*b!juod)f*s!s|pdwufddf3q!tebp!g+c!m*v!s1</1w!f-d53/!1b.t!q)f3ddufdwp!s)s!f,d!uz!y>/!wwVfwd!3-)s!p2m/p1D-u!!b)tEq3ffdsuv!u*y<fuj!g>!,)!vmtpfdEf<q*u!i8*s!v|mc!ggpmep!b+u!!*w!jufdxf[s!s>p!dhufdufWqjtfbx![+)!!*h!f:u3E/f1q!u-i:)3!/w1V.w!!)*3!d*f<w!!)g!m,p!bzuy!/gwbVdwu!p-ss!p>m!p)D!ug!p)dEv3tf!s,v!uwyjffux![>!,*!<mp!dep<g*c!m8vssv!m>c!gwpfed!3+!!)*!!dumdbfnsqs)p!dgubddfuqptsb!!++!!b*q!f5s/u1v.s!f--1!/.1n!b)y3cdmfvws!-)!!n,b!yzcym/vwsV!w*!!-*s<pm~pDfum!t)fE!3|fs!veupygfcum!v>s,!!>m!pwdfd<3*!!)8!sdvmmbcngqp)e!!u+f!y*u!vusdff3sEs)p!duuEdffqqutib-!!+w!f*d!3:)3w/V1w./!y--:!32//11!!).3!dwfVww!/)z!*,!!*z/yb/!w+V!wb!q-fsspumvpsDfu-!!).En3bfyscvmuvysf-u!!n>b,y!cmmpvds!<**!!*8<sv~mcwgfpde3!!+e!p*g!cumdvfss:s!p>d!uedpfgqctmbv!s+!!+*!!11//:1<!-w1f5d/31!!e)p3gdcfmwv!s)8!!,>!!zeyp/gwcVmwv!s-!s+p!m1p/D8u<!)wEf3df3s!veupygfcum!v>s,5!!m>p!dep<g*c!m8vssv!m+c!g1p/e5!<+!w*f!du5d!fdspsmp!d>u!dwffqdt5b)!!+1!/*1!!:*3</1d!p-m:!3,/>1!!u)f3ydufvws!f)3!E,)!!zuyD/pwmVpws!--!swpVmwp/Dyuz!!)*E<3fdspvmu!y,f>u!!u>f,y!umvpsdf3<E*)!!:usDvpmmcpgsp-e!!w+V!w*/!yuzd!f,s!s)p!dwufddf3q)t!b1!/+1!-*!!18/45/!1*.!!+-!6b2t/q1f!d)u3ddpfsws!f)d!u,!!*z!y+/!weVpwg!c-msvpsm!p*D<u!d)pEm3!f,s>v!uuyffyuu!v>s,f!3mEp)d!u<D*p!m:pssv-m!cwgVpwe/!y+z!!*,!!u)d!fwsfsdp3d)u!d1f/q2t6b-!!+1!/*4!86!2*/!1+.!!b-t8q4f/d1u.d!p)s3sdffdwu!!)*!!,+!!zeyp/gwcVmwv!s-!s*p<mpdDpum!!),E>3!fusfvyuuyvfsuf!3>E,)!!mupDdpm<p*s!-:!swvVmwc/gypze!!,+!!)*!!wufddf3s)s!p1d/u3d:f-q!t1b/!3+:!!**!!6+2!/b1t!q-f8d4u/d1p!s)s3fddfuw!!*)!!+,!!ezpyg/cwmVvws!!-*s<pmdppDmu!!,)>E!3uffsyvuuvysffu3!E>),!!umDppdmp<s*-!!:wsVvwm/cygzp!e,!!+)!!*w!fudd3f)s!s.p1d/u4d8f-q!t1b/!2+6!!**!!8+4!/b1t!q-f6d2u/d1p.s!s)f3dduf!w*!!)+!!,e!pzgyc/mwvVsw!!*-<spdmppmD!u,!>)!Eu3ffysuvvusyff3uE!)>!,u!Dmppmdps<-*!!w:Vswv/myczg!p,e!!)+!!w*f!du3d)f!s1s/p5d1u-d!f1q/t1b!!*+!!+*!!b8t4q/f1d.u!d-p6s2s/f1d.u!!)*3!d+f!we!p)g!c,m!vzsy!/*w<Vwd!p-ms!p,m>p!Duuf!y)uEv3sffs3vEu)y!fuuD!p>m,p!sm-p!dwV<w*/!y:zs!v,m!c)g!pwef!d+3!)*!!1u/d4f8s-s!p.d1u/d2f6q!t*b!!++!!b*t!q6f2d/u1d.p!s-s8f4d/u1!!*)!3+d!fewp!g)c!m,v!sz!y*/<wVdwp!m-!s,p>m!puDfuy!u)vEs3ff3sEv)u!yufDup!m>p,s!-m!pwdVw</*y!z:!s,v!m)c!gwpfed!3+)!!*1!/u3d:f-s!s.p1d/u3d:f!q*t!b+!!+b!t*q!f6d2u/d1p!s-s8f4d/u1!.*!!)+3!defpwg!c)m!v,s!!z*y</wdVpwm!!-,s>p!mupfDyuu!v)sEf33fEs)v!uuyDfpum!p>s,-!!mwpVdw/<y*z!!:,s!v)m!cwgfpde3!)+!!.*1!/u2d6f-s!s.p1d/u4d8f!q*t!b+!!+b!t*q!f8d4u/d1p!s-s6f2d/u1!!*)!3+d!fewp!g)c!m,v!sz!y*/<wVdwp!m-!s,p>m!puDfuy!u)vEs3ff3sEv)u!yufDup!m>p,s!-m!pwdVw</*y!zs!v,m!c)g!pwef!d+3!)*!!1u/d1f-s!s.p1d/u5d!f*q!t+b!!b+t!q*f!d8u4d/p1s.s!f-d6u2!/*1!!+)!3edpfgwc!m)v!s,!!*z<y/dwpVmw!!,->s!pumfpyDuuv!s)fE33Ef)s!vuuDypfmup!s>-,!!wmVpwd/y<z*!!,s!v)m!cwgfpde3!)+!!.*1!/u2d6f-s!s1p/d4u8d!f*q!t+b!!b+t!q*f!d:u3d/p1s.s!f-d:u3!/*1!.+!!)e3pdgfcwm!v)s!!,*!<zyd/pwmV!w,!>-!supfmypuDvus!f)3EE3)f!suvDupymfpus!->!,w!Vmwp/dyz<!*,!!s)v!mwcfgdp3e)!!+.!1*/!3u:d-f!s1s/p3d:u!d*f!q+t!bb!t+q!f*d!u6d2p/s1s.f!d-u8!4*/!1+.!!e)p3gdcfmwv!s)!!*,<!zdyp/mw!V,w>!!-usfpymupvDsuf!3)EE)3!fusDvpumypfsu-!!>w,V!wm/pydz!<,*!!)s!vwmfcdg3p)e!!1+/!4*8!-u!d1f/s2s6p!d*u!d+f!qbttbq!f+d!u*d!p1s/s1f!d-u5!/*1!.+!!)e3pdgfcwm!v)s!!,*!<zyd/pwmV!w,!>-!supfmypuDvus!f)3E";var ct=L.graph3d.PostProcessing.Blur=function(A){function f(){n=!0;var j=A.getGL();N=new hd.RenderTarget(A,j),p=A._postProcessing.createShader(j,ct.hBlurShader),s=A._postProcessing.createShader(j,ct.vBlurShader)}var p,s,N,t,y,O,Q,r,T,i=this,x=!1,n=!1;this.serializeProperties={value:0,downSample:!1,iterations:1,layer:"main"},this.resetProperties=function(){var Z=this.serializeProperties;for(var S in Z)this[S]=Z[S]},U.defineProperties(i,{enable:{get:function(){return x},set:function(c){!!x!=!!c&&(x=c,c?A.addRenderLayerListener(l,this):A.removeRenderLayerListener(l,this),c&&!n&&f(),A.iv())}},downSample:{get:function(){return Q},set:function(U){Q!==U&&(Q=U,A.iv)}},value:{get:function(){return O},set:function(r){O!==r&&(O=r,A.iv())}},iterations:{get:function(){return r},set:function(m){r!==m&&(r=m,A.iv())}},layer:{get:function(){return T},set:function(f){T!==f&&(T=f,A.iv())
}}}),this.resetProperties();var l=function(p){if(x&&p.layer===T&&"post"===p.phase){var M=A.getGL();if(!A._picking&&!A.isReflecting(M)){var k=A._postProcessing.getRenderTarget();k.unbind(M);for(var d=0,Y=A._glCapabilities.maxAttributes;Y>d;d++)M.disableVertexAttribArray(d);i.drawImpl(M,k),k.bind(M),M.useProgram(A._prg)}}};i._42=function(){},i.drawImpl=function(k,S,u,o,R){n||f();var U,B;if(S?(U=S.width,B=S.height):(U=A._viewport[2],B=A._viewport[3]),U&&B){var Y=A._postProcessing;"boolean"!=typeof o&&(o=Q),u==h&&(u=O),R==h&&(R=r),R=Math.max(1,Math.round(R));var G=li.for(k).glState.depth,q=G.enabled;if(G.enabled=!1,o){u/=2;var X=[U,B];U/=2,B/=2,t||(t=new hd.RenderTarget(A,k),y=Y.createShader(k,ct.downSampleShader)),t.setSize(k,U,B),Y.blitScreen(t,S.texture,y,{texelSize:[1/X[0],1/X[1]]}),S.setSize(k,U,B)}else t&&t.setSize(0,0);N.setSize(k,U,B);for(var l=[],i=0;R>i;i++)l.push(u),u=Math.max(1,Math.floor(u/2));for(var i=0;R>i;i++){var L=l[R-i-1],c=o&&0===i?t.texture:S.texture;Y.blitScreen(N,c,p,{value:L/U}),o&&i===R-1&&S.setSize(k,X[0],X[1]),Y.blitScreen(S,N.texture,s,{value:L/B})}return G.enabled=q,S}}};ct.hBlurShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<jntvjtp!o>!!isjphmipqD!hgbmspGb`um<h!!vo<j2g6p1s/n1!!t+b!n*q!m*f!sz3/Ew!Vjwn!b-hffv<mb!ww!b+s!z1j/o5h!!,w!fyd/3w!VwwV!w)<3d!fvwo!j-gfphsbnn!jg!m)pEb3uf!swvbumyvffu<!>,!!wnpvjte!!n<b9j2o:)1*/!1|!+!!w*f!d*5!!zt/vwnV!w>!!-wffvdm5b)w!!1+/!11!/*4<!,!!yt/vwnV!w,!>)!3udffywu!v-sffh3bEn)j!!j)nEb3hffs-v!uwyffdu3!)>!,w!Vnwv/ty!!.<!655/313!2+/!1w!b+m!v*f!-*!!wzV/ww/Vzw!!*-!f*v!m+b!w1!/+1!612/<3!!,t!vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv!t.!!4</214!6+2!/w1b!m+v!f*-!!*w!Vzw//wzV!w*!!-*f!v+m!b1w/!1+:!219/<2!!,t!vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv!t.!!3</414!7+2!/w1b!m+v!f*-!!*w!Vzw//wzV!w*!!-*y!/+w!V1w/!2)333d5f6w<!-!fthvbnn!j,!>)!Eu3ffysuvvusyff3uE!)>!,j!nnbvhtf!-!<w2f4d632)/!1w!V+w!/*y!!*.!!z2//w1V!w+!!-wfbvm",ct.vBlurShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<jntvjtp!o>!!isjphmipqD!hgbmspGb`um<h!!vo<j2g6p1s/n1!!t+b!n*q!m*f!sf3vEm!bjwn!b+h!f1</5!!w,b!szz/jwoVhw!!w-fyd/3w!VwwV!w)<3d!fvwo!j-gfphsbnn!jg!m)pEb3uf!swvbumyvffu<!>,!!wnpvjte!!n<b9j2o:)1*/!1|!+!!w*f!d*5!!ftvvmnb!w>!!+w!f1d/54)!!,1!/z1/!w*V<w!-!yt/vwnV!w,!>)!3udffywu!v-sffh3bEn)j!!j)nEb3hffs-v!uwyffdu3!)>!,w!Vnwv/ty!-!<w6V5w3/3z2!/.1!!5+/!1*!!+*!!wfbvmmvbfw!!*+!!*1!/+3!!1,/!1z6/2w<Vw!!t-vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv-t!!wV<w2/4z6!2./!14!/+1!!*+!!*w!bfmvvmfb!w*!!+*!!1+/!21!/,1!:z2/9w<Vw!!t-vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv-t!!wV<w4/4z7!2./!13!/+1!!*+!!*w!bzm/vwfV!w*!!-*y!/+w!V1w/!2)333d5f6w<!-!fthvbnn!j,!>)!Eu3ffysuvvusyff3uE!)>!,j!nnbvhtf!-!<w2f4d632)/!1w!V+w!/*y!-*!!wfVvwm/bzw!!.+!!21/",ct.downSampleShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<j1t/j5p!o0!!i*j*h*i1q/!2g!m-p1b/u1<)3!dvfowj!g+p!sfn{!jtTbmnfqymffus!3,E!!wjVnwb!h-ff<hb!nwjb)sEz3jfoshv!uwyffdu3!!w,V!w*<*1!/v2o.j!g-p1s/n1!)w3fddf3w!!u+f!yff{mjTTjm{ffy<fu!!,w!pwjVew!!n-bfjhob)n*j)!E|3f!shvmu`yGfsub!hD,p!m*p*s1!/>1!!)-u1f/y2u.v)s3fd3fEw)!j+n!bfh{fj-T!mwfVywf!u,!!,u!fwyVfwm!T-jf{hfb!n+j!)wEf3df3s)v2u/y1f-u!!1/,1!**";var dt=L.graph3d.PostProcessing.Fxaa=function(F){var h,G=this,e=!1;U.defineProperties(G,{enable:{get:function(){return e},set:function(G){!!e!=!!G&&(e=G,F.iv())}}}),G.getShader=function(A){if(h)return h;var U=F.getPostProcessingModule();return h=U.createShader(A,{vs:U.blitScreenShaderSrc.vs,fs:U.decodeShader(dt.ShaderSourceFs)})},G._42=function(){}};dt.ShaderSourceFs="~!!q<sbf/d*jwtVjwp!o-!fihjbhnijq)!Eg3mfpsbvuu<yf!uv>obj/gsppsmnp!DthbbnsqGm`fmsh3!E!<j*n!bh*f1</1!)v5odjfgwp!sn-!1w/f1d!3!-s1f/t1p!mv-u1j/p1o!<-!4w4b9s1z/j1o!h!-w7f7d23/!1w!Vw-<68/!1$!ef-g*j1o/f1!)G5YdBfBw`!RV-B*M1J/U1Z)`5Qd1f!w2!/1-*!1$/e1f)g5jdoffw!!GY-BoBp`jRuVvBmMpJtUfZs`!Q2-!f2h/b6nj!!$e-ffghjbonfj!!GY-BfBh`bRnVjB!MJ-U*Z1`/Q13)!53d/f1w!!$-ewfVgwj!of)!sGfYeBbBi`TRmVfByMjJQUbZb`yQG4>!s5p/m1pD!h$besfGg`jmohf!!G|Y!B*B)`oRjVbBnM!JeUjZp`wQ!5!~2!3/<1*N!b$nevfmg!j-o{fz!yG/y*bNbtCppqp!m-!ycfpup)mqpU!y$feUfbgbjyoGf)!5GuybbpbmGGmbpbbyuG!!gomspvbuufs!!$e<foghjjoTfi!uGhyobfbmG!m+p!byuj3q!cwvfTdu3ft!g$gePfmgfjyojfq!>G,yzb/bNGtmppqb!u*4o!bwqfTd{4sp!i$!e)fggjj!of<!oGhyjbTbiGumhpobfum5!!+w!fydj5qcv!T$uefftggjgoPfm!fGyyjbqb>T,byu/)Nyt*p!qd!m*bonbqq)Ty{-s!p1i/a1)-g!j2!/1<**I!y$jeqfcgvjto!f-!eGpypbHbuUfftyg!gtPbmnfqymjfqs)3yEbn!>$yejfqgcjvoTfu!fGtygbgbPUmffyyUjpqq!)uub-p!mqG*b!buyfGy!uv<s1f/31E!);u!-u!fqt-g!g1P/m1f*yj!q$!e@f!gojboqfT!eGpypbhb>UefpypPHgugf)tug-g!Pqm-f!ypj-q!!su*b!pumfGybubvysGf!3E<)yuj-q!cqv,T)zpu!j+m!bsv*R-b!b1y/g1!*+!!HGyyjbqbcGvmtp>bIuy!jGqycbvbtM!vunbbp)mGGybbbbyGGm!pb<u65/!1s,h*c*bq*d!S|i!ushfoufvMsoob!qsth.c)b!/+z!<u!t~e)!>GuyfbtbgGgmPpmbfuy5j!qG!yubbbpQmjGybfbmyTGi!be<fGsy)jq!cGvytb!b+G!mGpybjuq3c!vqtp>tH-yj!qGcyvbtb!GumbppbmuG5b!bgyyGb!bD<pQootbpqmTfeQpppthQ!p;t!-Oo!bGqyTbebpUpfhy!!@u!fOyo-pj!uGdyfbsbjUef>yo!bgqyTbebpDppho!tmppmpfC4b7b1yUGf!yF<y*qQCujtbet!O-fOhuPtoef)-oj!nG>yubtbeU!fuyb!pgmyGbbbbDypGo!tp<mQfu4t7e1!U=f!yOFuytqeC>jObotpOjfuhdUfxspj-e!!mGpypbCbbGbmypGb!u3<!iguyhbobfRMvobbmqjtu0z1S/d2q>GqsdbSnifu-ho!fGMyobbbqGtm!pubbup5m!GgbybbybGD!po<tppsmff[SUdMqNGbsnbvnmf!P>qau!-*1!/G1y!b=b!GQmepobFub5n!vgmy)b>bQDopboqtTpempfpShd!qmGpspbCnbfbPyqGu!3-<*!OGuytbeb,GQmuptbeu)5>!iguyhbobfDMpoobtqptm!fu4b7p1mSGdbqbGysGb!nf<Ppqsuf3[-UM!NGbynbvbmG!m>pab!u*!1g/y1b!b=R!vObemojFubznTvvmc)q>jOyo-bq!TGeypbpbhG!mmppbpuC!bgbyybGb!Rv<bzm/jNutzpFqe.hzf/UQitspfqt>iQpumtee-!*!oGbyqbTb{Gsmppibau)!ggjy!bb<Rzv/bOmtjpuqz.Fze/hNftUpiqs>fOtuitpem!e*Nojboq-T{!sGpyibab)Ggmjp!bu<!yg/yNbtbpDqp.oyt/pQmtfpFqe>hQfuTtieb!suqbopfmtGtb-by!GG!yb<byG/mOptbpuq!.gyy/bNbtDppqo>tOpumtfeF!euhbfpUmiGsbfbtyiGp!me~-!!~G!yb~b!Gm<p5bQu`!ZgUyJbMbBDVpRo`tBpBmYfGF!e+h!fzU/iQsOfgtgipp>m,ezN/jQot-pq!!G*yQbfboGpmepab)ug5j!!gy<b5bQD`pZoUtJpMmBfV4R7`1BDBpYoGt!u+E!jys/Q!O*g!g|p>!,Gyy/bQbtGpmqp!b*uQ3f!oqppetaN)<gj!!qp<t*NQ/fyo>pqepat)/!y}<}!!*qOpftoNp/eza>)q>pQtO/fzo<pe!!Gy<b5bQG`mZpUbJuM5B!VsRh`cBzBNY>GG!y+b!bzU/fQyOUgpgqp)>u.fzy/-O!tqppqt!N**O<fo!p$eeaf)ggjjo!f!<m5vQn`bZNU!JsMhBcVzRN`/BzBY!GG!y+b!byG/mQpObgug!pm>v.nyb/TO>tGpyqb!b*MOvfnobp)eGay)bgbjU!fy<Pegfgm)budfTyu-o!fqjpetbNs-h!!G>y?b!b*GQmepobFub3n)v!m1)/t1c-b!>2Q/f1o*p-e!!gy<bebfRmvbbdmTjuuozfSjdeqbGsshb!n>f?/!y*zO*e*o<Fb!nGvymb)btGcmbp>bOuf!ompven!bF<>6G/y1b!b+M!vOnObb)nGvymb.bQUefoyFPbgngv)mu>fQye-o!FqbpntvNm-!!*GQyfbobpGemap)bguj3!)!<26//11-!!+1!/O1O*b-n!vgmy.bObeRovFbbmnjvumz>SOdeqoGFsbbnnvfm/!y*zO*f*o<pe!aG)ygbjb!Gm<p*b*uz!ym/vQntbpOq>!G-yybfbuM)vqnpbU)yGfyUbbbbUyfGy)Pbgngv)Mubfbyy-G!>qQpetoNF-b!nGvymb!b*GQmfpobpue3a))!g1j/!1-<.*2*/z1y*/-O!tgpyqb!b-Ryvfbum)jqupzUSydfqUGbsbbynGf)/bynzv*M*b<by!GG>yObeboGFmbpnbvum!!m*vOnfboXp>eGay)bgbjM!vn|b!)*GQyObfboUpfey)Pggjg!)u<f4yQ-`!ZqUpJtMNB-V!RG`yBbBbYGGm!p+b!uz3/)Q.O2g/g1p->!,1z//1Q*t-p!qg!y*bQbfRovpbemaj)ugzjS!dq<G4sQb`nZfU/JyMzB*V*R<`B!BGYyGb!b+G!myp/bQuO!gngbpy>T,Ny>/nQbtyp)qm!v*nQbfTo-p!emav)ngbjN!*<<*!QGfyobpbeGam)p!b}u}!!n*jOofToNp>enaj)o>)QmOvfnobpTe-!!m<v4nQb`NZ*U<JM!BGVyRb`bBGBmYpGb!u+!!nzb/yQFOTgNg>pn>b.yz)/mOvtnpbqF!-*!OnfboypTeNa*)<gj!!Gy<b4bQG`mZpUbJuM!BnVjRo`FBTBNY>Gn!j+o!)ym/vQnObgFg-p!>n.jyo/TONt*p<q!!*GOyfbobpGemap)bguj!!nb<yeXfOm>bndbTyu)omfvjnebbOs-h!!m>v?n!b*XQ*e<oF!bGnyvbmb)Gtmcpbb>uQ!fnojpoeX!O><nejfom)bmdvTnuboOf-j!embvsnhb!X>*?<!*!OGeyobFbbGnmvpmb)ut!csbb>oOhffoNpbey!>n<b6y/)1n!b+y!XOOO-b!nnvbmy.FQTeNo*F<bn!vGmy>bQbeGomFpbbnuv!ms!b*oQhffoNpjeoa>)ngjjo!)n<j6o/X1O!-+!!nOjOobFnTvNm*.<Oe!oGFybbnbvGmm>pObeuo!Fsbbnovhmf!N*bOyfTodpbemaf)eg>js!bo<h*f*Nzbyy/!Q+t!pgqy!b-byRfvub)mqjpuUzyFfeUhbfbUyiGs)fbtnivpMmbeb<yG!>GQyebobFGbmnpvbmu!!*sQbfoohpfe>as)bgojh!fN<b*y*.zsyb/oOhtfpNqj!o-<yf!uG)yqbpbUGymfpUbbub!ysGb)obhnfvNMbbybDymGb>nOqefoeF>bnnbvym)!g*yObfboRpvebam)jgujz!Fe|h!f*UQiOsffotpiep)mgejN!jo<-3!Qs`bZoUhJfMNBbVyRT`dBbBmYfGe!*+<!z!/GQyObgbgCpp>p,mz!/fQbtspmqz!F*yQjfuo>psebao)hgfj!!=!<s3bQo`hZfUNJbMyBDVmRb`nBqBfYeG<!+!!jyg/)QfObgsgmpz>F,yyj/uQ*tp!qs!f*uQvfsoop!esah)cgzjN!<<!*GQyfbobpGemap)b!u}!}m!v*nObfOoXp>eGay)b>bQMOvfnobp)eG!yb<b3UQf`yZPUgJgM)BuVfRy`-B!BqYpGt!N+-!!zG/yQbObgGgmpp>b.uz3/)O.t2p/q1!-*.O2f/o1p*e-a!)ggyjb!bR<v3bQm`jZuUzJSMdBqVGRs`bBnBfY/Gy!z+*!*y</Q!OGgygbpb>G.myp/bOut!pmqv!n*bOTfFo>pGeyab)bgMjv!nb<)eGfymbbbdUTfuyoPfgjge)busfhy!->!?q!p*tQNe-o!FGbynbvbmG)mtpcbbu>3Q)f!o2p/e1!-!<2e/f1m*b-d!TguyobfbjRevbbsmhj!u>z?S!d*qOGesobFnbfn/vymz)*t*c<b>!OGfyobpbeG!mp<b6u/!1m!v+n!bOOOFb>nGvymb.bQMevonFbb)nGvymb>bQUefoyFPbgngv)mu!f*yQ-f!oqppetaN)-g!jG!yb<b6G/m1p!b+u!3O)O!b2n/v1m-..O2e/o1F*b-n!vgmy>bObeRovFbbmnjvumz!S*dOqfGospbenaf)/gyjz!**<<**!zGyy/bQbtGpmqp!b-uy!fmuv)nqbpTUXy>fGUybbbbyMGv)nbbn)vGMybbbbyUGf>yQPegogF)bunfvym-!!*qQpftoNp-e!aG)ygbjb!Gm<p*b*uz3y)/.O2t/p1q-!!-2y/f1u*)-q!pgUyybfbURbvbbymGj)ubznSvdMqbGbsybGn>fO/eyozF*b*n<vm!!G*yObfboGpmepab)ug!jm!vn|b!O*TQ>OmfvonpbeO),gmjv!nb<T2<Q`!ZGUyJbMbBGVmRp`bBuB!YmGv!n+b!XzF/>QmOvgngbpX>,,mzv/nQbtFp<q!!*GQyfbobpGemap)bguj!!tv<c2qQj`yZSUdJqMSBbVoRh`fB>B2Y/G1!0+s!byo/hQfO<gg!pG>y,byb/GQmtppbqu!!*tQvfcoqpjeyaO)TgXjF!>m<v*nQbfOoTp,emav)n!b}X}F!<*O!fGoypbebaG)m>pQbOuf!ofpeeh!fmIpppsC{b2b>y)G.!3/<12!Q+`!ZmUvJnMbBNV*R,`mBvBnYbGO!T+<!z!/GQyObgbgGpm>p.bzu/!Oftephqf!W*fOsfuo2p>e)a.)3g/j1!!+<!2mQv`nZbUNJ*M,BmVvRn`bBXBFY<G!!+G!yyb/bQGOmgpgbpu>!.myv/nObtOpFqT!F*>OmfvonpbeOaF),gmjv!nb<TeFf<mb!dGTyubobfGjmepbbsuh!!m>v?n!b*OQXeOoFF>bmnvvnmb)OtXc,bm>vQnfboOpFe<!m!pGpyCbbbbGymGp!bu<!effemhbfdITpuso{f3j>e)b.s3h/!1>!?+!!*mOvenobFFb*n,vmmv)ntbcObF>TOFf<op!eG!ymbpbpGCmbpbbyuG!!fe<h6f/W1f!s+u!3O>O)b.n3v/m1>!.+Q!emovFnbbnOv*m,!mv<n6b/O1X!O+F!<OO!bGnyvbmb>G.mOpebouF!bmnvvnmb!OX<T1X/>1m!v=n!bNONXb,nmvvmn>bpTsXf<[U!MGNybbnbvGmm!pmbpup!CmbvbnybGT!XT<FF>ymjvqncbvTtX!,+m!vEnybjTqFc<vt!>GGyybjbqGcmvptb!uu!bfpemhGfbIbpysG{!5><)6b/c1t!)+f!eOhOfbInpvsm{.2N*b!n+v!m3>/N1N*b,nbvcmt!)ufbephmfGIbpbsy{G3!*<<1!/G5y0b1b/G2m!p+b!uu!offejhefbWsfhs>ue5f>m)bbdcTtu)offejhefbWsfhs!uu2b*p!m+G!b3b/y1G*!,b<cTtT)bfnevhmf>WOfOsbun3v*m<!*!OGsyjbbbqGam)pgbju!!f<e*h*fQItppsq{!4->y)f.u3)/q1p!U+y!fmUvbnbbyXG*),bmnvvnMbbObXyTGX><Qe!oGFybbnbvGmm!pubbup!mfGebhbfyWGf!su<4D>y)j.q3c/v1t!!++!!mDvynjbqTc*v,tm>vFnybjTqXcTvFt<!u!bGpymbGbbGbmypGb!u!<f*e*hOftIppqs!{->ybfcut))qfpeUhyffIUpbsb{y4G*),bfnevhMfbIbpysG{>5O<eo!FGbynbvbmG!mupbbpum!GfbebhyfGW!fs<u1>/b4c,t*)DfyejhqfcWvfts+u*41*/,3f.e)h)f>WEfysjuq5c<vt!!GuybbpbmGGmbpbbyuG!!tv<c1qQj`yZOUXJTMXBOVFRT`FB>BmYvGn!b+O!XzT/XQ,Omgvgnpb,OzF/TCFt<pq!>Gzy/bQbtGpmqp!bu<!1mQf`oZhUuJiMTBjVhRo`>BgByYbGb!R+v!bym/jQuOzgSgdpq,Gys/bCntfp/qy><y/!QGtypbqb!Cp<pQmt!piqp!s3{uTbqpbmoG>bfbeyhGf!Ip<s1{Q!`?Z>U!JfMeBhVfRW`fBsBuY<G!!+G!yzb/bQGOmgpgbpu.!zt/vCctqpjqy>Bz>/tOvtcpqqj!yO<T1XQF`!Z+U!J3M/B1V,Rt`vBcBqYjGy!O+X!TyX/OQFOTgFg<p.!yj/gC)tapiqp>sy{/TOqtbpoq*!!m<vOntbpOq>!m3vunbbpXm<Gb!bjygG)!ai<p6s/{1T!q+b!oo*h!jmTvinubhTo>fmmv>n,bzF/<Ct!pjqg!)*iopbsq{TT{qsbpoi*!!)mgfjo!hu<i6T/j1h!o+>!goyhbjbTRivubhmojfumz>S,dyq/GCstbpnqf!/*zo<bq!TG{ysbpbiGam)pgbju!!t<vzc/qfjnybCs>G)qtdvSczqujjymBb!v+R!b)b2y/g1!0;2!31//11*!*@.!m*vonbbqNT<{s!pGiy!b)b>Gzm/pQbOug!ghps!be<jyf/ofunOb>smGvqndbSOz.umjvmnbbvNR<bb!yGgy!b;b!G1m/p1b!u@!!h*sobbeqjTf{osupTi>am)v>nyb/TQ.Omgvgnpb!N<<Q!OGgygbpb!G3mupbbpum!GmbvbnybGO!O><mzv/nNbtOp,qm>vzn/bCNt<pq!!Gy<byb/GNmtppbqu>!ym/vCntbpTqT!>m<vCntbpTq,!m3vunbbpNm<Gb!bGyyGb!bC<p*pfmh!oqbbSjqsdOS>ybjcqtc)vhts!b+e!j*fCoyujOq*c!v?t>)!tbccbt))uhbsTbbebjyfGo>uDTy*j<qc!vGty!bubbGpmmpGbbub!yhGs!be<jofhojuT>inubhyo)fbmc.t>)ohhsjbTeijufhooufOm*!-*!Obscjtb)qh)sgbje!jf<o*u*T",th(r,{accordionViewExpandIcon:si(jk),accordionViewCollapseIcon:si(jk,!0),accordionViewLabelColor:od,accordionViewLabelFont:Si,accordionViewTitleBackground:Ip,accordionViewSelectBackground:ue,accordionViewSelectWidth:3,accordionViewSeparatorColor:A,splitViewDividerSize:1,splitViewDividerBackground:Ip,splitViewDragOpacity:.5,splitViewToggleIcon:{width:16,height:16,comps:[{type:je,rect:[2,2,12,12],background:jk}]},propertyViewLabelColor:oh,propertyViewLabelSelectColor:od,propertyViewLabelFont:Si,propertyViewExpandIcon:si(hg),propertyViewCollapseIcon:si(hg,!0),propertyViewBackground:yc,propertyViewRowLineVisible:!0,propertyViewColumnLineVisible:!0,propertyViewRowLineColor:Mb,propertyViewColumnLineColor:Mb,propertyViewSelectBackground:ue,listViewLabelColor:oh,listViewLabelSelectColor:od,listViewLabelFont:Si,listViewRowLineVisible:!1,listViewRowLineColor:Mb,listViewSelectBackground:ue,treeViewLabelColor:oh,treeViewLabelSelectColor:od,treeViewLabelFont:Si,treeViewExpandIcon:si(_b),treeViewCollapseIcon:si(_b,!0),treeViewRowLineVisible:!1,treeViewRowLineColor:Mb,treeViewSelectBackground:ue,treeViewDoubleClickToToggle:!0,tableViewLabelColor:oh,tableViewLabelSelectColor:od,tableViewLabelFont:Si,tableViewRowLineVisible:!0,tableViewColumnLineVisible:!0,tableViewRowLineColor:Mb,tableViewColumnLineColor:Mb,tableViewSelectBackground:ue,treeTableViewLabelColor:oh,treeTableViewLabelSelectColor:od,treeTableViewLabelFont:Si,treeTableViewExpandIcon:si(_b),treeTableViewCollapseIcon:si(_b,!0),treeTableViewRowLineVisible:!0,treeTableViewColumnLineVisible:!0,treeTableViewRowLineColor:Mb,treeTableViewColumnLineColor:Mb,treeTableViewSelectBackground:ue,tableHeaderLabelColor:oh,tableHeaderLabelFont:Si,tableHeaderColumnLineVisible:!0,tableHeaderColumnLineColor:Rc,tableHeaderBackground:yc,tableHeaderMoveBackground:Cp,tableHeaderInsertColor:ue,tableHeaderSortDescIcon:nq(hg,!0),tableHeaderSortAscIcon:nq(hg),tabViewTabGap:1,tabViewLabelColor:od,tabViewLabelFont:Si,tabViewTabBackground:Ip,tabViewSelectWidth:3,tabViewSelectBackground:ue,tabViewMoveBackground:Cp,tabViewInsertColor:ue,toolbarLabelColor:oh,toolbarLabelSelectColor:od,toolbarLabelFont:Si,toolbarBackground:yc,toolbarSelectBackground:ue,toolbarItemGap:8,toolbarSeparatorColor:ui},!0);var et={translateX:1,sortColumn:1},ft={sortable:1,sortOrder:1,sortFunc:1},gt={focusData:1},ht={dataModel:1,sortColumn:1,sortFunc:1,visibleFunc:1,rootData:1,rootVisible:1},it={dataModel:1,sortFunc:1,visibleFunc:1,categorizable:1},jt=function(y,w){w.add(y),y.hasChildren()&&y.eachChild(function(D){jt(D,w)})},kt=function(W,v,c,z,g,A,U,u,l,d,F){var I,s=c.getValueType(d),L=c.getAlign(d);if(c.getEnumValues(d)){var B=c.toEnumLabel(v,d),t=fs||0,Q=0,P=A,H=r.getTextSize(z,B).width;return I=Tj(c.toEnumIcon(v,d)),I&&(Q=A+fs/2,"center"===L?Q+=(u-(t+H))/2:"right"===L&&(Q=Q+u-(t+H)),ek(W,I,Q,U+l/2,d,F),P=Q+fs/2),B!=h&&(I?jf(W,B,z,g,P,U,u-(P-A),l):jf(W,B,z,g,A,U,u,l,L)),void 0}return v=c.formatValue(v),v!=h?s===Yr?(qd(W,A,U,u,l,v),void 0):s===Ur||!s&&fe(v)?(I=Tj(v?Mc:Wm),ek(W,I,A+u/2,U+l/2,d,F),void 0):(jf(W,v,z,g,A,U,u,l,L),void 0):void 0},lt=function(H,O){var R=O.view,n=sm(H),E=O.column||O.property;R.getDataModel().beginTransaction(),O.editor=H,H.info=O,R.setCurrentEditor(H),R.getView().insertBefore(n,R._79O),xq(H,O.editorRect),H.setFocus?H.setFocus():Cf(H),H.commitValue=function(e,C){H._17Q&&(H=H._17Q),C||R.setValue(O.data,E,H.getValue?H.getValue():H.value),H.close&&H.close(),fo(n)},E.onEditorCreated&&E.onEditorCreated(O)},mt=function(x,d,Y,o,k){var t=br(x,Y),E=d.value,X=d.view,V=k.getValueType(d.data);return t.onblur=t.onchange=function(){X.endEditing()},"input"===x?(E=k.formatValue(E),E!=h&&(t.value=E),t.onkeydown=function(Q){Vc(Q)?X.endEditing():Bs(Q)&&X.endEditing(!0)},(V===Xr||V===vo)&&C(t,cm,r.numberListener)):x===Nh&&o.forEach(function(P){var d=F.createElement("option");d.innerHTML=k.toEnumLabel(P),d.value=P,k.isEnumEqual(E,P)&&(d.selected=!0),Bm(t,d)}),lt(t,d),t},nt=L.widget={},ot=function(i,v,M){sr(l+".widget."+i,v,M)};th(Lf,{ms_value:function(t){t.getValue=function(j){var h=this.getItemById(j),T=h.element;return Pr(T)?T:T?T.getValue?T.getValue():T.value:h.selected},t.setValue=function(T,w){var N=this.getItemById(T);if(N){var h=N.element;h&&!Pr(h)?h.setValue?h.setValue(w):h.value=w:fe(w)?(N.selected=w,this.iv()):(N.element=w,this.iv())}},t.v=function(D,i){var j=this;if(2===arguments.length)j.setValue(D,i);else{if(!Ti(D))return j.getValue(D);for(var f in D)j.setValue(f,D[f])}return j}},_46o:function(e){e._icon=h,e._accessType=h,e._valueType=h,e._editable=!1,e._batchEditable=!0,e._align=tq,e._nullable=!0,e._emptiable=!1,e.setParent=rd,e.formatValue=function(K){var y=this,l=y._valueType;return y.getEnumValues()?y.toEnumLabel(K):l===Ur?!!K:K!=h&&l===Xr?i(K):K},e.setEnum=function(q,i,W,d,z,x,l){var K=this;q&&!rm(q)&&q.values&&(d=q.editable,W=q.icons,i=q.labels,z=q.strict,x=q.maxHeight,l=q.dropDownWidth,q=q.values),Tg(q)&&(q=q._as),Tg(i)&&(i=i._as),Tg(W)&&(W=W._as),K._enumValues=q,K._enumLabels=i,K._enumIcons=W,K._enumEditable=d,K._enumStrict=z==h?!0:z,K._enumMaxHeight=x,K._enumDropDownWidth=l,q&&q.length&&Id(q[0])&&(K._valueType=vo),K.fp("enum",!1,!0)},e.getEnumDropDownWidth=function(){return this._enumDropDownWidth},e.getEnumMaxHeight=function(){return this._enumMaxHeight},e.isEnumEditable=function(){return this._enumEditable},e.getEnumValues=function(){return this._enumValues},e.getEnumLabels=function(){return this._enumLabels},e.getEnumIcons=function(){return this._enumIcons},e.isEnumStrict=function(){return this._enumStrict},e.isEnumEqual=function(H,w){return this._enumStrict?H===w:H==w},e.toEnumLabel=function(x,N){var e=this,B=e.getEnumValues(N),n=e.getEnumLabels(N);if(B&&n)for(var L=0;L<B.length;L++)if(e.isEnumEqual(x,B[L]))return n[L];return x},e.toEnumIcon=function(B,J){var s=this,Q=s.getEnumValues(J),f=s.getEnumIcons(J);if(Q&&f)for(var m=0;m<Q.length;m++)if(s.isEnumEqual(B,Q[m]))return f[m];return A}},_45o:function(C){C._87o=function(u,p,$,z,B,j){if(u){var L=this,l=L._90I,a=Sq(1);L._columnLineVisible&&(B-=1),L._rowLineVisible&&(j-=1),0>=B||0>=j||(L._90I||(l=L._90I={}),l[p]||(l[p]=new zc),xq(a,L.tx()+$,L.ty()+z,B,j),Bm(a,u),L._view.insertBefore(a,L._79O),u.onParentAdded&&u.onParentAdded(a),l[p].add(a))}},C._76o=function(){var q=this,s=q._90I;if(s){for(var C in s)s[C].each(function(V){fo(V)});delete q._90I}},C._77o=function(c){var g=this;if(g._90I){var N=g._90I[c];N&&(N.each(function(G){fo(G)}),delete g._90I[c])}}},_47o:function(N){N.getValue=function(I,T){return T.getValue?T.getValue(I,T,this):Nn(I,T.getAccessType(),T.getName())},N.setValue=function(l,y,s){if(y.isEmptiable(l)||""!==s||(s=A),y.isNullable(l)||s!=h){var Z=this,N=y.getName(l),i=y.getAccessType(l),U=y.getValueType(l);U===Xr&&Pr(s)?s=Tr(s):U===vo&&Pr(s)?s=parseFloat(s):U===Ur&&Pr(s)&&(s="true"===s),Z._batchEditable&&y._batchEditable&&Z.isSelected(l)?Z.sm().each(function($){y.setValue?y.setValue($,y,s,Z):ij($,i,N,s)}):y.setValue?y.setValue(l,y,s,Z):ij(l,i,N,s)}},N.setCurrentEditor=function(t){this.endEditing(),this._currentEditor=t,this.redraw()},N.isEditing=function(M,e){var B=this,w=B._currentEditor;if(!w)return!1;if(e){var H=w.info;return H?(H.column||H.property)===e&&H.data===M:!1}return!0},N.endEditing=function(b){var N=this,L=N._currentEditor;L&&(delete N._currentEditor,L.commitValue&&L.commitValue(L.info,b),N.redraw(),N.getDataModel().endTransaction())},N.beginEditing=function(y){this.endEditing();var e=this,p=y.column||y.property;if(p.beginEditing)p.beginEditing(y);else{var C=y.data,O=y.value,z=e.getSelectBackground(C),R=p.getEnumValues(C),a=p.getSlider(C),u=p.getColorPicker(C);if(a){var H=Tp(nt.Slider,a);return H.setValue(O),H.getView().onblur=function(){e.endEditing()},H.isInstant()&&(H.onValueChanged=function(){e.setValue(C,p,H.getValue())}),lt(H,y),void 0}if(u||p.getValueType(C)===Yr){var m=Tp(nt.ColorPicker,u);return m.setValue(O),m.onClosed=function(){e.endEditing()},m.isInstant()&&(m.onValueChanged=function(m,t){e.setValue(C,p,t)}),lt(m,y),m.open(),void 0}if(R){if(nt.ComboBox){var M=new nt.ComboBox;M.setValue(O),M.setValues(R),M.setLabels(p.getEnumLabels(C)),M.setIcons(p.getEnumIcons(C)),M.setEditable(p.isEnumEditable(C)),M.setStrict(p.isEnumStrict(C)),M.setMaxHeight(p.getEnumMaxHeight(C)),M.setDropDownWidth(p.getEnumDropDownWidth(C)),M.onClosed=function(){e.endEditing()},lt(M,y),M.open()}else mt(Nh,y,z,R,p);return}var t=p.getValueType(C);if(t===Ur||fe(O))return e.setValue(C,p,!O),void 0;if(p.getItemEditor(C)){var j=is(p.getItemEditor(C)),X=new j(C,p,e,y),w=X.getView();return w._17Q=X,X.setValue(O),_r(w),lt(w,y),X.editBeginning&&X.editBeginning(),void 0}mt("input",y,z,h,p)}}},_44o:function(O){O.init=function(b){var z=this,L=z.th=new Dt(b),M=z._view=eh(1,z);z.tv=z._tableView=b,Bm(M,L.getView()),Bm(M,b.getView()),L.mp(function(T){T.property===ll&&z.iv()}),z.iv()},O.getTableView=function(){return this.tv},O.getTableHeader=function(){return this.th},O.getDataModel=function(){return this.tv.dm()},O.getColumnModel=function(){return this.tv.getColumnModel()},O.setColumns=function(f){this.tv.setColumns(f)},O.addColumns=function(b){this.tv.addColumns(b)},O.endEditing=function(){this.tv.endEditing()},O.validateImpl=function(){var M=this,F=M.th,$=lr(F),e={x:0,y:0,width:M.getWidth(),height:$};xq(F,e),e.y=$,e.height=k(0,M.getHeight()-$),xq(M.tv,e)}},ms_vs:function(_){_._41o=function(){return this._29I.height<this._59I},_._43o=function(){var E=this;E._41o()&&(E._58I||(gj(function(){E._94O()},id),E.iv()),E._58I=new Date)},_._94O=function(){var o=this;if(o._58I){var Q=new Date;Q.getTime()-o._58I.getTime()>=id?(delete o._58I,o.iv()):gj(function(){o._94O()},id)}},_._93I=function(){var D=this,d=D._27I;if(D._58I||!D._autoHideScrollBar){d||Bm(D._79O,d=D._27I=Sq());var a=D._29I,f=a.height,V=D._59I,y=D.getScrollBarSize(),v=a.width-y-2,Y=f*(-D.ty()/V),X=f*(f/V),Z=d.style;V>f?(jo>X&&(Y=Y+X/2-jo/2,0>Y&&(Y=0),Y+jo>f&&(Y=f-jo),X=jo),Z.visibility=yj,Z.background=D.getScrollBarColor(),Z.borderRadius=y/2+Fj,xq(d,v,Y,y,X)):Z.visibility=fi}else d&&(d.style.visibility=fi)}},ms_hs:function(o){o._40o=function(){return this._29I.width<this._91I},o._42o=function(){var T=this;T._40o()&&(T._95O||(gj(function(){T._94I()},id),T.iv()),T._95O=new Date)},o._94I=function(){var B=this;if(B._95O){var H=new Date;H.getTime()-B._95O.getTime()>=id?(delete B._95O,B.iv()):gj(function(){B._94I()},id)}},o._92I=function(){var T=this,E=T._28I;if(T._95O||!T._autoHideScrollBar){E||Bm(T._79O,E=T._28I=Sq());var L=T._29I,B=L.width,k=T._91I,N=T.getScrollBarSize(),w=L.height-N-2,z=B*(-T.tx()/k),l=B*(B/k),O=E.style;k>B?(jo>l&&(z=z+l/2-jo/2,0>z&&(z=0),z+jo>B&&(z=B-jo),l=jo),O.visibility=yj,O.background=T.getScrollBarColor(),O.borderRadius=N/2+Fj,xq(E,z,w,l,N)):O.visibility=fi}else E&&(E.style.visibility=fi)}}}),_f(Mc,gh(16,16,[{type:dp,rect:[1,1,14,14],background:ue},{type:An,rect:[1,1,14,14],width:1,color:mo},{type:Tm,points:[13,3,7,12,4,8],borderWidth:2,borderColor:"#FFF"}])),_f(Wm,gh(16,16,{type:An,rect:[1,1,14,14],width:1,color:mo})),_f(Yj,gh(16,16,[{type:yg,rect:[2,2,12,12],borderWidth:1,borderColor:mo,background:"#FFF"},{type:yg,rect:[4,4,8,8],background:ue}])),_f(ld,gh(16,16,{type:yg,rect:[2,2,12,12],borderWidth:1,borderColor:mo})),Lf._15Q=function(U){U._29I=dq,U._59I=0,U._91I=0,U._5o=function($){var d=this;d._30I=new zc,d._rows=new zc,d._rowMap={},d._31I=0,d._14I=0,d._view=eh(1,d),d._canvas=gi(d._view),Bm(d._view,d._79O=Sq()),d.dm($?$:new Eb)},U.getCheckIcon=function(I){var C=this.sm(),y=C.co(I);return C.sg()?Tj(y?Yj:ld):Tj(y?Mc:Wm)},U.checkData=function(o){var k=this.sm(),d=k.co(o);k.sg()&&d||(this._32o=1,d?k.rs(o):k.as(o),delete this._32o)},U.getDataAt=function(E){E.target&&(E=this.lp(E));var v=y(E.y/this._rowHeight),c=this._rows;return 0>v||v>=c.size()?h:c.get(v)},U.onDataDoubleClicked=function(){},U.onDataClicked=function(){},U.adjustTranslateX=function(){return 0},U.adjustTranslateY=function(B){var A=this.getHeight()-this._59I;return A>B&&(B=A),B>0?0:i(B)},U.onPropertyChanged=function(J){var H=this,f=J.property;ht[f]?H.ivm():gt[f]||H.redraw(),f===md?H._42o():f===Yb&&H._43o()},U.getLabel=function(E){return E.toLabel()},U.getLabelFont=function(){return this._labelFont},U.getLabelColor=function(g){var Q=this;if(Q.isCheckMode()){if(Q._focusData===g)return Q._labelSelectColor}else if(Q.isSelected(g))return Q._labelSelectColor;return Q._labelColor},U.getStartRowIndex=function(){return this._31I},U.getEndRowIndex=function(){return this._14I},U.getRowDatas=function(){return this._rows},U.getRowIndex=function(j){return this._rowMap[j._id]},U.getRowSize=function(){return this._rows.size()},U.getViewRect=function(){return Bi(this._29I)},U.isVisible=function($){return this._visibleFunc?this._visibleFunc($):!0},U.getCurrentSortFunc=function(){return this._sortFunc},U.setDataModel=function(J){var t=this,s=t._dataModel,W=t._selectionModel;s!==J&&(s&&(s.umm(t.handleDataModelChange,t),s.umd(t.handleDataPropertyChange,t),s.umh(t.handleHierarchyChange,t),W||s.sm().ums(t.handleSelectionChange,t)),t._dataModel=J,J.mm(t.handleDataModelChange,t),J.md(t.handleDataPropertyChange,t),J.mh(t.handleHierarchyChange,t),W?W._21I(J):J.sm().ms(t.handleSelectionChange,t),t.fp("dataModel",s,J))},U.validateModel=function(){var V=this;V._rows.clear(),V._rowMap={},V.buildChildren(V._dataModel._roots);var f=V._rows=V._rows.toList(V.isVisible,V),y=0,s=V.getCurrentSortFunc(),K=f.size();for(s&&f.sort(s);K>y;y++)V._rowMap[f.get(y)._id]=y},U.buildChildren=function(f){var j=this;f.each(function(s){j._rows.add(s),j.buildChildren(s._children)})},U.handleDataModelChange=function(){this.ivm()},U.handleDataPropertyChange=function(w){"parent"===w.property?this.ivm():this.invalidateData(w.data)},U.handleHierarchyChange=function(){this.ivm()},U.handleSelectionChange=function(t){t.datas.each(this.invalidateData,this),this.onSelectionChanged(t)},U.onSelectionChanged=function(f){var K=this,l=K.sm();!K.isAutoMakeVisible()||1!==l.size()||"set"!==f.kind&&"append"!==f.kind||K._32o||K.makeVisible(l.ld())},U.handleBackgroundClick=function(r){Yf(r)&&!this.isCheckMode()&&this.sm().cs()},U.makeVisible=function(H){H&&(this._23I=H,this.iv())},U.scrollToIndex=function(J){var j=this,n=j._29I,A=n.height,x=j._rowHeight,z=x*J;J>=0&&J<j._rows.size()&&A>0&&(z+x>n.y+A?j.ty(-z+A-x):z<n.y&&j.ty(-z))},U.autoScroll=function(M,L){var c=this,o=c._rowHeight,T=o,p=o/4,U=c._29I,r=c.lp(M),i={x:c.tx(),y:c.ty()};return o>0&&U&&(r.x-U.x<T?c.translate(p,0):U.x+U.width-r.x<T&&c.translate(-p,0),r.y-U.y<T?c.translate(0,p):U.y+U.height-r.y<T&&c.translate(0,-p)),i.x=c.tx()-i.x,i.y=c.ty()-i.y,L&&(L.x+=i.x,L.y+=i.y),i},U.getTopRowOrderSelection=function(){var C=this.sm().getTopSelection(),w={},k=new zc;return C.each(function(T){w[T._id]=T}),this._rows.each(function(v){w[v._id]&&k.add(v)}),k},U.getRowOrderSelection=function(){var c=new zc;return this._rows.each(function(L){this.isSelected(L)&&c.add(L)},this),c},U.ivm=function(){this.invalidateModel()},U.invalidateModel=function(){var z=this;z._96I||(z._96I=1,z._32I=1,delete z._24I),z.iv()},U.redraw=function(){var q=this;q._32I||(q._32I=1,delete q._24I,q.iv())},U.invalidateData=function(c){var C=this;no?C.redraw():C._32I||(C._24I||(C._24I={}),C._24I[c._id]=c,C.iv())},U.getFocusData=function(){return this._focusData},U.setFocusDataById=function(m){this.setFocusData(this.dm().getDataById(m))},U.setFocusData=function(P){var V=this,Y=V._focusData;Y!==P&&(V._focusData=P,V.fp("focusData",Y,P),Y&&V.invalidateData(Y),P&&(V.invalidateData(P),V.isAutoMakeVisible()&&V.makeVisible(P)))},U.drawRowBackground=function(n,L,b,V,x,w,G){var k=this,r=k.isCheckMode();(L===k._focusData&&r||b&&!r)&&qd(n,V,x,w,G,k.getSelectBackground(L))},U.drawData=function(u,v,P){var D=this,Q=D._rowHeight,r=Q*P,g=D._29I,f=g.x,M=g.width;u.save(),u.beginPath(),u.rect(f,r,M,Q),u.clip(),D._87o(D.drawRow(u,v,D.isSelected(v),f,r,M,Q),P,f,r,M,Q),u.restore(),D._rowLineVisible&&qd(u,f,r+Q-1,M,1,D._rowLineColor)},U._12I=function(N){var l=this,C=l._31I,h=l._29I,Z=h.x,i=h.y,t=h.width,F=h.height;for(N.beginPath(),N.rect(Z,i,t,F),N.clip(),N.clearRect(Z,i,t,F),l._76o(),l._93db(N);C<l._14I;C++)l.drawData(N,l._rows.get(C),C);l._92db(N)},U._13I=function(G){for(var s,S=this,Y=S._rowHeight,c=S._29I,j=c.x,W=c.width,t=S._31I,J=S._30I;t<S._14I;t++)s=S._rows.get(t),S._24I[s._id]&&J.add({data:s,index:t});J.isEmpty()||(G.beginPath(),J.each(function(I){G.rect(j,I.index*Y,W,Y)}),G.clip(),J.each(function(p){G.clearRect(j,p.index*Y,W,Y)}),J.each(function(U){S._77o(U.index)}),S._93db(G),J.each(function(J){S.drawData(G,J.data,J.index)}),S._92db(G),J.clear())},U.preValidateModel=function(){this.endEditing&&this.endEditing()},U.validateImpl=function(){var W=this,$=W._canvas,r=W.getWidth(),J=W.getHeight(),L=W._rowHeight,m=W._32I;(r!==$.clientWidth||J!==$.clientHeight)&&(Ir($,r,J),m=1),W._96I&&(W.preValidateModel(),W.validateModel());var b=W._29I,V={x:-W.tx(),y:-W.ty(),width:r,height:J},u=W._rows.size(),P=df($),o=W._23I;m||xk(V,b)||(m=1),W._29I=V,W._59I=u*L,W._31I=y(V.y/L),W._14I=N((V.y+V.height)/L),W._31I<0&&(W._31I=0),W._14I>u&&(W._14I=u),W._99I&&m&&W._99I();var D=W.tx(),l=W.ty();(W._40o()||W._41o())&&(W._59I+=W.getScrollBarSize(),W._99I&&m&&(W._91I+=W.getScrollBarSize())),Uh&&!vl&&(P.save(),Oc(P,r/Sg.length,J/Sg.length,1)),Oc(P,D,l,1),m?W._12I(P):W._24I&&W._13I(P),W._93I(),W._92I(),P.restore(),W._32I=W._24I=W._96I=h,o&&(W.scrollToIndex(W.getRowIndex(o)),delete W._23I),W.tx(W.tx()),W.ty(W.ty())},U.canHandleSelectMode=function(){return!0}},Lf._48o=function(W){W._rootVisible=!0,W._rootData=h,W._35o=function(){this._expandMap={},this._levelMap={}},W.validateModel=function(){var t=this,V=t._rootData;t._rows.clear(),t._levelMap={},t._rowMap={},t._currentLevel=0,V?t._rootVisible?t.isVisible(V)&&t.buildData(V):t.buildChildren(V):t.buildChildren(),delete t._currentLevel},W.buildData=function(j){var C=this,P=j._id,f=C._rows;C._rowMap[P]=f.size(),f.add(j),C._levelMap[P]=C._currentLevel,C.isExpanded(j)&&(C._currentLevel++,C.buildChildren(j),C._currentLevel--)},W.buildChildren=function(u){var f=this,L=u?u._children:f._dataModel._roots,$=f.getCurrentSortFunc();$&&f.isChildrenSortable(u)?L.toList(f.isVisible,f).sort($).each(f.buildData,f):L.each(function(t){f.isVisible(t)&&f.buildData(t)})},W.getLevel=function(X){return this._levelMap[X._id]},W.getToggleIcon=function(o){var i=this,b=i._loader,y=i._collapseIcon;return b&&!b.isLoaded(o)?y:o.hasChildren()?i.isExpanded(o)?i._expandIcon:y:h},W.isCheckMode=function(){return this._checkMode!=h},W.isChildrenSortable=function(){return!0},W.handleDataModelChange=function(C){var N=this;C.kind===Yk?delete N._expandMap[C.data._id]:C.kind===Eh&&(N._expandMap={}),N.ivm()},W.toggle=function(K){var l=this;l.isExpanded(K)?l.collapse(K):l.expand(K)},W.isExpanded=function(Q){return 1===this._expandMap[Q._id]},W.expand=function(D){var H=this,j=H._loader;H.isExpanded(D)||(j&&!j.isLoaded(D)&&j.load(D),H._expandMap[D._id]=1,H.ivm(),H.onExpanded(D))},W.onExpanded=function(){},W.collapse=function(y){var Q=this;Q.isExpanded(y)&&(delete Q._expandMap[y._id],Q.ivm(),Q.onCollapsed(y))},W.onCollapsed=function(){},W.expandAll=function(T){if(T)this.expand(T),T.eachChild(function(h){this.expandAll(h)},this);else{var A=this;A._dataModel.each(function(m){m.hasChildren()&&(A._expandMap[m._id]=1)}),A.ivm()}},W.collapseAll=function(){this._expandMap={},this.ivm()},W.makeVisible=function(Z){if(Z){var M=this;if(!M._rootData||Z.isDescendantOf(M._rootData)){for(var K=Z._parent;K;)M.expand(K),K=K._parent;M._23I=Z,M.iv()}}},W.checkData=function(t){var n,e=this,w=e._checkMode,B=e.sm(),l=B.co(t);if(!B.sg()||!l){if(e._32o=1,w===Bo)l?B.rs(t):B.as(t);else if(w===bj)n=new zc(t),n.addAll(t._children);else if("descendant"===w)n=new zc,jt(t,n);else if("all"===w&&(n=new zc,jt(t,n),!l))for(var G=t._parent;G;)n.add(G),G=G._parent;n&&(l?B.rs(n):B.as(n)),delete e._32o}},W.drawTree=function(r,D,G,S,K,k,i){var s=this,j=s._indent,$=s._levelMap[D._id],y=s.getIconWidth(D),m=Tj(s.getToggleIcon(D));m?(S+=j*$,ek(r,m,S+j/2,K+i/2,D,s),S+=j):S+=j*($+1),s._checkMode&&(ek(r,s.getCheckIcon(D),S+j/2,K+i/2,D,s),S+=j),s.drawIcon(r,D,S,K,y,i),s.drawLabel(r,D,S+y,K,i)}},Lf._14Q=function(b){b.getIcon=function(F){return F.getIcon()},b.getIconWidth=function(N){return this.getIcon(N)?this._indent:0
},b.drawIcon=function(N,C,S,P,p,E){if(p){var e=this,_=e.getBodyColor(C),G=Tj(e.getIcon(C),_);G&&(E-=e.isRowLineVisible()?1:0,ms(N,G,Om,S,P,p,E,C,e,_),wh(N,e.getBorderColor(C),S,P,p,E))}},b.drawLabel=function(o,W,Q,m,i){var z=this;jf(o,z.getLabel(W),z.getLabelFont(W),z.getLabelColor(W),Q,m,0,i)}},Lf._50o=function(c){c._98I=function(){var z=this,Z=z._39o=new Eb;z._60I=new zc,Z.mm(z._17o,z),Z.md(z._18o,z),Z.mh(z._19o,z)},c.setColumns=function(c){this._39o.clear(),this.addColumns(c)},c.addColumns=function(g){var i=this._39o;g.forEach(function(m){if(!(m instanceof qt)){var C=is(m.className);m=Tp(C?C:qt,m)}i.add(m)})},c.onColumnClicked=function(){},c.onCheckColumnClicked=function(){},c._3Q=function(y){for(var T,o=0,n=this._60I,U=n.size();U>o;o++)if(T=n.get(o),T.column===y)return T;return h},c.getColumnAt=function(x){var e=this._4Q(x);return e?e.column:h},c._4Q=function(U){for(var s=this,q=U.target?s.lp(U).x:U.x,z=s._60I,m=0;m<z.size();m++){var f=z.get(m),R=f.startX;if(q>=R&&q<R+f.column.getWidth())return f}return h},c.getToolTip=function(q){var c=this,A=c.getDataAt(q),s=c.getColumnAt(q);return A&&s?s.getToolTip(A,c):h},c.adjustTranslateX=function(q){var W=this.getWidth()-this._91I;return W>q&&(q=W),q>0?0:i(q)},c._99I=function(){var w=this,Q=w._29I,I=w._60I;I.clear(),w._91I=0,w._39o._roots.each(function(j){if(j.isVisible()){var W=w._91I+j.getWidth();w._91I<=Q.x+Q.width&&W>=Q.x&&I.add({column:j,startX:w._91I}),w._91I=W}})},c.drawData=function(w,W,Z){var t=this,$=t._rowHeight,e=$*Z,h=t.isSelected(W),m=t._29I,x=m.x,j=m.width;t.drawRowBackground(w,W,h,x,e,j,$),t._60I.each(function(n){var T=n.column,F=n.startX,u=T.getWidth();u>0&&!t.isEditing(W,T)&&(w.save(),w.beginPath(),w.rect(F,e,u,$),w.clip(),t._87o(t.drawCell(w,W,h,T,F,e,u,$),Z,F,e,u,$),t._columnLineVisible&&qd(w,F+u-1,e,1,$,t._columnLineColor),w.restore())}),t._rowLineVisible&&qd(w,x,e+$-1,j,1,t._rowLineColor)},c.drawCell=function(t,G,S,J,N,h,y,g){var K=this;if(J.drawCell)return J.drawCell(t,G,S,J,N,h,y,g,K);var Y=K.getValue(G,J);kt(t,Y,J,K.getLabelFont(G,J,Y),K.getLabelColor(G,J,Y),N,h,y,g,G,K)},c.getColumnModel=function(){return this._39o},c._17o=function(){this.redraw()},c._18o=function(q){var K=this;q.data===K._sortColumn&&ft[q.property]?K.ivm():(K._42o(),K.redraw())},c._19o=function(){this.redraw()},c.getCurrentSortFunc=function(){var R=this,p=R._sortColumn;if(p&&p.isSortable()){var I=p.getSortFunc(),J=zr===p.getSortOrder()?1:-1;return I||(I=Wh),function(n,S){return I.call(R,R.getValue(n,p),R.getValue(S,p),n,S)*J}}return R._sortFunc},c.isCellEditable=function(W,A,O){return A.isEditable()&&this.isEditable()?A.isCellEditable?A.isCellEditable(W,A,O,this):!0:!1},c._37O=function(l,h){if(Yf(h))for(var n=this,q=n.lp(h),I=n._60I,a=n._rowHeight,Y=n._29I,W=Y.x,A=Y.y,x=Y.width,r=Y.height,K=0;K<I.size();K++){var S=I.get(K),d=S.startX,F=S.column,E=F.getWidth();if(F!==n._31o&&F!==n._4o&&q.x>=d&&q.x<d+E&&n.isCellEditable(l,F,h)){var f={x:d,y:n.getRowIndex(l)*a,width:E,height:a},$={x:f.x+n.tx(),y:f.y+n.ty(),width:f.width,height:f.height},Q=0,v=0;return f.x<W?Q=f.x-W:f.x+f.width>W+x&&(Q=f.x+f.width-W-x),Q&&(n.tx(n.tx()-Q),$.x-=Q),f.y<A?v=f.y-A:f.y+a>A+r&&(v=f.y+a-A-r),v&&(n.ty(n.ty()-v),$.y-=v),n.beginEditing({data:l,column:F,value:n.getValue(l,F),event:h,rect:f,editorRect:$,view:n}),void 0}}}},nt.BaseItemEditor=function(b,i,y,n){this._data=b,this._column=i,this._master=y,this._editInfo=n},ot("BaseItemEditor",U,{ms_ac:["data","column","master","editInfo"],editBeginning:function(){},getView:function(){},getValue:function(){},setValue:function(){}});var pt=L.Tab=function(){oc(pt,this)};Ci("Tab",Xm,{ms_ac:["view","closable","disabled","visible"],_icon:h,_closable:!1,_disabled:!1,_visible:!0,setParent:rd});var qt=L.Column=function(){oc(qt,this)};Ci("Column",Xm,{_46o:1,ms_ac:["accessType","valueType",yj,qe,Nf,Nq,"align",Yr,"sortOrder",op,"sortable","clickable","nullable","emptiable","slider","colorPicker","itemEditor"],_visible:!0,_width:80,_sortOrder:zr,_sortFunc:h,_sortable:!0,_clickable:!0,setWidth:function(V){16>V&&(V=16);var W=this._width;this._width=V,this.fp(Nq,W,V)},getToolTip:function(g,v){return this.formatValue(v.getValue(g,this))}});var rt=L.Property=function(){oc(rt,this)};Ci("Property",Xm,{_46o:1,ms_ac:["accessType","valueType",qe,Nf,"categoryName",Yr,"align","nullable","emptiable","slider","itemEditor","colorPicker"],_categoryName:h,getToolTip:function(L,e,S){var n=this;return e?n.formatValue(S.getValue(L,n)):S.getPropertyName(n)}}),nt.AccordionView=function(){var F=this;F._20o={},F._21o=new zc,F._10o=h,F._9o=h,F._11o=h,F._view=eh(0,F),F.iv()},ot("AccordionView",U,{ms_v:1,ms_fire:1,ms_ac:[pm,Og,"titleHeight",Vi,Co,"titleBackground","selectWidth",Xo,"orientation","separatorColor"],_expandIcon:r.accordionViewExpandIcon,_collapseIcon:r.accordionViewCollapseIcon,_titleHeight:To,_labelColor:r.accordionViewLabelColor,_labelFont:r.accordionViewLabelFont,_titleBackground:r.accordionViewTitleBackground,_selectBackground:r.accordionViewSelectBackground,_selectWidth:r.accordionViewSelectWidth,_orientation:"v",_separatorColor:r.accordionViewSeparatorColor,onPropertyChanged:function(){this.iv()},getView:function(){return this._view},getTitles:function(){return this._21o},getCurrentTitle:function(){return this._10o},add:function(O,h,K,l){var M=this,j=Sq(),q={content:h,div:j,canvas:gi(j),icon:l};if(M._20o[O])throw O+" already exists";var k=q.downEventFunc=function(w){ae(w)},b=q.upEventFunc=function(i){ae(i),Yf(i)&&(M._10o===O?M.collapse():M.expand(O))};[wd,yl].forEach(function(U){C(j,U,k)}),[hr,dn].forEach(function(N){C(j,N,b)}),j.style.cursor=dh,Bm(M._view,j),M._20o[O]=q,M._21o.add(O),K&&M.expand(O),M.iv()},remove:function(s){var e=this,f=e._20o[s];if(f){var B=f.div;fo(B),[wd,yl].forEach(function(s){D(B,s,f.downEventFunc)}),[hr,dn].forEach(function(W){D(B,W,f.upEventFunc)}),delete e._20o[s],e._21o.remove(s),e.iv()}},clear:function(){var h=this;h._21o.toArray().forEach(h.remove,h),h._20o={},h._21o.clear(),h.iv()},isExpanded:function(c){return this._10o===c},expand:function(W){var r=this;r._20o[W]&&r._10o!==W&&(r._10o=W,r.onExpanded(W),r.iv())},onExpanded:function(){},collapse:function(){var K=this;K._10o&&(K.onCollapsed(K._10o),delete K._10o,K.iv())},onCollapsed:function(){},initCanvas:function(w,e,r){Ir(w,e,r);var y=df(w);return Oc(y,0,0,1),y.clearRect(0,0,e,r),y},drawTitle:function(_,w,Z,x,K){var s=this,k=Tj(K.icon),q=s.isExpanded(w),O=s._titleHeight,d=s._titleBackground,B=s._selectWidth,f=s._separatorColor,D=Tj(q?s._expandIcon:s._collapseIcon),E=B+4;qd(_,0,0,Z,x,d),q&&B&&qd(_,0,0,B,x,s._selectBackground),(q||s._21o.get(s._21o.size()-1)!==w)&&qd(_,0,x-1,Z,1,f?f:Eo(d)),k&&(ek(_,k,E+Xf(k)/2,O/2),E+=Xf(k)+2),jf(_,w,s.getLabelFont(w),s.getLabelColor(w),E,0,0,O),D&&ek(_,D,Z-Xf(D)/2-4,O/2)},validateImpl:function(){var Z=this,E=Z._view,u=0,q=0,n=Z.getWidth(),R=Z.getHeight(),$=Z._titleHeight,A=Z._21o.size()*$,B=Z._11o,m=Z._9o;delete Z._11o,delete Z._9o,Z._21o.each(function(S){var F,l,I=Z._20o[S],w=I.content,W=Z._10o===S;So(Z)?(xq(I.div,u,0,$,R),F=Z.initCanvas(I.canvas,$,R),Br(F,0,R),Ec(F,-po),Z.drawTitle(F,S,R,$,I),F.restore(),W?(l=k(0,n-A),w&&(Z._11o=w,Z._9o=sm(w),xq(w,u+$,0,l,R)),u+=$+l):u+=$):(xq(I.div,0,q,n,$),F=Z.initCanvas(I.canvas,n,$),Z.drawTitle(F,S,n,$,I),F.restore(),W?(l=k(0,R-A),w&&(Z._11o=w,Z._9o=sm(w),xq(w,0,q+$,n,l)),q+=$+l):q+=$)});var e=Z._9o;B&&B!==Z._11o&&B.endEditing&&B.endEditing(),e&&e!==m&&Bm(E,e),m&&m!==e&&fo(m)}}),nt.SplitView=function(p,H,C,$){var X=this,b=X._dividerDiv=Sq(),L=X._60O=gi(),x=X._61O=gi(),w=L.style,S=x.style;X._view=eh(1,X),Bm(X._view,b),w.msTouchAction=xp,w.pointerEvents=xp,w.cursor=dh,S.msTouchAction=xp,S.pointerEvents=xp,S.cursor=dh,p&&X.setLeftView(p),H&&X.setRightView(H),C&&X.setOrientation(C),$!=h&&X.setPosition($),X.setStatus(Wc),new st(X)},ot("SplitView",U,{ms_v:1,ms_fire:1,ms_ac:["continuousLayout","dividerSize","dividerBackground","toggleIcon","togglable","dragOpacity","orientation","draggable","status"],_continuousLayout:!1,_position:.5,_togglable:!0,_orientation:"h",_draggable:!0,_dividerSize:r.splitViewDividerSize,_dividerBackground:r.splitViewDividerBackground,_dragOpacity:r.splitViewDragOpacity,_toggleIcon:r.splitViewToggleIcon,onPropertyChanged:function(){this.iv()},getDividerDiv:function(){return this._dividerDiv},getPosition:function(){return this._position},setPosition:function(P,W){var C=this,h=C._position;isNaN(P)||(W||(C._82O=0>P?-1:P>1?1:0),C._position=P,C.fp(Fb,h,P))},getLeftView:function(){return this._leftView},setLeftView:function(P){var t=this,g=t._leftView,m=t._view;if(t._leftView!==P){if(g&&g!==t._rightView){var Q=sm(g);Q.parentNode===m&&fo(Q)}if(t._leftView=P,P){var s=sm(P);s.parentNode!==m&&m.insertBefore(s,t._dividerDiv)}t.fp("leftView",g,P)}},getRightView:function(){return this._rightView},setRightView:function(R){var K=this,g=K._rightView,T=K._view;if(K._rightView!==R){if(g&&g!==K._leftView){var C=sm(g);C.parentNode===T&&fo(C)}if(K._rightView=R,R){var Q=sm(R);Q.parentNode!==T&&T.insertBefore(Q,K._dividerDiv)}K.fp("rightView",g,R)}},validateImpl:function(){var s=this,P=s._draggable,U=s._position,d=s.getWidth(),u=s.getHeight(),D=s._dividerSize,T=s._dividerBackground,Q=Xq?18:8,e=s._dividerDiv,o=s._82O,W=s._60O,f=s._61O,_=s._toggleIcon,r=s._status,Y=e.style,l=null,c=Xq?20:4,F=_.comps[0];D>=Q||0===D?s._coverDiv&&(fo(s._coverDiv),delete s._coverDiv):s._coverDiv||(s._coverDiv=Sq(),Up&&(s._coverDiv.style.background=Ed),Bm(e,s._coverDiv)),s._togglable?W.parentNode||(Bm(e,W),Bm(e,f)):(fo(W),fo(f));var H=s._coverDiv,q=s._leftView,O=s._rightView;if(So(s)){if(D>d&&(D=d),r===Wc)if(1===o)var S=n(U,d),y=k(0,d-D-S);else-1===o?(y=n(-U,d),S=k(0,d-D-y)):(S=i((d-D)*U),y=k(0,d-D-S));else"cl"===r?(S=0,y=k(0,d-D)):"cr"===r&&(y=0,S=k(0,d-D));q&&xq(q,0,0,S,u),O&&xq(O,S+D,0,y,u),xq(e,S,0,D,u),s._22o=S,H&&(xq(H,D/2-Q/2,0,Q,u),H.style.cursor=P?cs:""),e.style.cursor=P?cs:"";var E=e.clientHeight/2,p=e.clientWidth;Ir(W,p,p),xq(W,0,E-p-c,p,p),l=df(W),Oc(l,0,0,1),F.rotation=-po,Nl(l,_,0,0,p,p),l.restore(),Ir(f,p,p),xq(f,0,E+c,p,p),l=df(f),Oc(l,0,0,1),F.rotation=po,Nl(l,_,0,0,p,p),l.restore()}else{if(D>u&&(D=u),r===Wc)if(1===o)var h=n(U,u),J=k(0,u-D-h);else-1===o?(J=n(-U,u),h=k(0,u-D-J)):(h=i((u-D)*U),J=k(0,u-D-h));else"cl"===r?(h=0,J=k(0,u-D)):"cr"===r&&(J=0,h=k(0,u-D));q&&xq(q,0,0,d,h),O&&xq(O,0,h+D,d,J),xq(e,0,h,d,D),s._22o=h,H&&(xq(H,0,D/2-Q/2,d,Q),H.style.cursor=P?qj:""),Y.cursor=P?qj:"";var K=e.clientWidth/2,p=e.clientHeight;Ir(W,p,p),xq(W,K-p-c,0,p,p),l=df(W),Oc(l,0,0,1),F.rotation=0,Nl(l,_,0,0,p,p),l.restore(),Ir(f,p,p),xq(f,K+c,0,p,p),l=df(f),Oc(l,0,0,1),F.rotation=g,Nl(l,_,0,0,p,p),l.restore()}Y.background=T}});var st=function(p){this.sv=p,this.addListeners()};sr(st,U,{ms_listener:1,getView:function(){return this.sv.getView()},handle_touchstart:function(G){var y=this,i=y.sv,V=i._dividerDiv,M=i._60O,d=i._61O,I=i._status,D=G.target;if(D===M)I===Wc?i.setStatus("cl"):"cr"===I&&i.setStatus(Wc);else if(D===d)I===Wc?i.setStatus("cr"):"cl"===I&&i.setStatus(Wc);else if(Dg(G)&&(D===V||D===i._coverDiv)&&(ae(G),i.isDraggable())){i.getLeftView(),i.getRightView();var T=y.maskDiv=Sq();if(T.style.left=0,T.style.top=0,T.style.width=i.getWidth()+"px",T.style.height=i.getHeight()+"px",i.getView().appendChild(T),!i.isContinuousLayout()){var Z=y.resizeDiv=Sq();Z.style.left=V.style.left,Z.style.top=V.style.top,Z.style.width=V.style.width,Z.style.height=V.style.height,Z.style.opacity=i.getDragOpacity(),Z.style.background=i.getDividerBackground(),Bm(y.getView(),Z)}y._lastAbsPosition=i._22o,y._86o=So(i)?ao(G).x:ao(G).y,Qb(y,G)}},handleWindowTouchMove:function(P){Dg(P)&&this.update(P,this.sv.isContinuousLayout())},handleWindowTouchEnd:function(x){var W=this;W.update(x,!0),W.sv.setStatus(Wc),W.maskDiv&&fo(W.maskDiv),W.resizeDiv&&fo(W.resizeDiv),W.maskDiv=W.resizeDiv=h},handle_mousedown:function(w){Yf(w)&&this.handle_touchstart(w)},handleWindowMouseMove:function(E){this.handleWindowTouchMove(E)},handleWindowMouseUp:function(F){this.handleWindowTouchEnd(F)},update:function(R,d){var e=this,X=e.sv,z=So(X)?X.getWidth():X.getHeight(),S=X._dividerSize,s=e._lastAbsPosition-e._86o;So(X)?(s+=ao(R).x,s>z-S&&(s=z-S),0>s&&(s=0),e.resizeDiv&&(e.resizeDiv.style.left=s+Fj)):(s+=ao(R).y,s>z-S&&(s=z-S),0>s&&(s=0),e.resizeDiv&&(e.resizeDiv.style.top=s+Fj)),d&&z!==S&&(1===X._82O?X.setPosition(s,1):-1===X._82O?X.setPosition(s-z+S,1):X.setPosition(s/(z-S),1))}}),nt.TabView=function(){var b=this,c=b._view=eh(1,b),g=b._91O=Sq(1),r=b._tabModel=new Eb,O=r.sm(),$=b.invalidate;b._7o=new zc,b._canvas=gi(g),Bm(c,g),Bm(c,b._92O=Sq(1)),O.setSelectionMode(bf),O.ms(b.handleSelectionChange,b),r.mm($,b),r.mh($,b),r.md($,b),b._interactor=new tt(b),b.iv()},ot("TabView",U,{ms_v:1,ms_fire:1,ms_tx:1,ms_ty:1,ms_lp:1,ms_ac:["movable","tabGap","tabHeight","tabPosition",Vi,Co,"tabHPadding","tabBackground","selectWidth",Xo,"moveBackground","insertColor"],_tabHPadding:0,_tabPosition:xo,_tabHeight:To,_tabGap:r.tabViewTabGap,_labelColor:r.tabViewLabelColor,_labelFont:r.tabViewLabelFont,_tabBackground:r.tabViewTabBackground,_selectWidth:r.tabViewSelectWidth,_selectBackground:r.tabViewSelectBackground,_moveBackground:r.tabViewMoveBackground,_insertColor:r.tabViewInsertColor,_movable:!0,handleSelectionChange:function(){this._selectionChanged=!0,this.invalidate()},getContentDiv:function(){return this._92O},getTitleDiv:function(){return this._91O},getTabModel:function(){return this._tabModel},add:function(e,B,C){var V,n=this._tabModel;return e instanceof pt?(V=e,B&&V.setView(B)):(V=new pt,V.setName(e),V.setView(B)),n.add(V),C&&n.sm().ss(V),V},getLabel:function(N){return N.toLabel()},onPropertyChanged:function(){this.iv()},_7Q:function(j){this._23o=j,this.iv()},get:function(g){var F=this,P=F._tabModel;if(Id(g))return P._roots.get(g);if(Pr(g)){var a;return P.each(function(K){g===F.getLabel(K)&&(a=K)}),a}return g instanceof pt?g:h},select:function(F){this._tabModel.sm().ss(this.get(F))},remove:function(_){var o=this;if(_=o.get(_)){var z=o._tabModel,x=z._roots.indexOf(_);o._tabModel.remove(_),o.selectByIndex(--x)}},getCurrentTab:function(){return this._8o},hideTabView:function(r,$){$.parentNode===this._92O&&($p($)?($.style.display=Ji,$._tab_=r):fo($),pp())},showTabView:function(d,v){$p(v)&&(v.style.display="block",v._tab_=d),v.parentNode!==this._92O&&(Bm(this._92O,v),pp())},_24o:function(){var H,y=this,e=y._8o,A=y._9o,o=y._tabModel.sm().ld();o&&(H=sm(o.getView())),H!==A&&(A&&(e.getView()&&e.getView().endEditing&&e.getView().endEditing(),y.hideTabView(e,A)),H&&y.showTabView(o,H)),y._8o=o,y._9o=H,e!==o&&y.onTabChanged(e,o)},onTabClosing:function(){return!0},onTabChanged:function(){},onTabClosed:function(W,P){this.selectByIndex(--P)},selectByIndex:function(S){var m=this,M=m._tabModel,j=M.size();if(j&&!M.sm().ld()){S==h&&(S=0),S>=j&&(S=j-1),0>S&&(S=0);for(var W=S;W>=0;W--){var K=m.get(W);if(!K.isDisabled())return m.select(K),K}for(W=S+1;j>W;W++)if(K=m.get(W),!K.isDisabled())return m.select(K),K}},getTabWidth:function(R){var D=this.getTabHPadding(),$=4+2*D,u=Tj(R.getIcon());u&&($+=Xf(u,R)+4);var X=this.getLabel(R);return X&&($+=Ne(this.getLabelFont(R),X).width+4),R.isClosable()&&($+=10),$},drawTab:function(h,i,B,r,C,e,m){var R,V=this,G=V._tabPosition,O=this.getTabHPadding(),v=B+4+O,f=V._selectWidth,x=Tj(i.getIcon()),H=i.isDisabled(),X=V.getLabelColor(i),Q=V.getLabelFont(i),z=V.getLabel(i),p=V._selectBackground,a=G===tq+"-vertical",l=G===_h+"-vertical";(a||l)&&(v=r+4+O),H&&(h.globalAlpha=sb),qd(h,B,r,C,e,m),i===V._8o&&f&&(G===xo?qd(h,B,r+e-f,C,f,p):G===tq?qd(h,B+C-f,r,f,e,p):G===_h?qd(h,B,r,f,e,p):a?qd(h,B+C-f,r,f,e,p):l?qd(h,B,r,f,e,p):qd(h,B,r,C,f,p));var c=C/2;if(a&&(Br(h,c,r+e/2),Ec(h,g),Br(h,-c,-r-e/2)),x){var U=$m(x,i),L=Xf(x,i);if(a||l){var j=B+C/2,A=v+U/2;Br(h,j,A),Ec(h,po),Br(h,-j,-A),ek(h,x,B+C/2,v+U/2,i,V),Br(h,j,A),Ec(h,-po),Br(h,-j,-A),v+=U+4}else ek(h,x,v+L/2,r+e/2,i,V),v+=L+4}return a||l?(Br(h,C/2,v+C/2),Ec(h,po),Br(h,-C/2,-v-C/2),jf(h,z,Q,X,B,v,e,C),Br(h,C/2,v+C/2),Ec(h,-po),Br(h,-C/2,-v-C/2)):jf(h,z,Q,X,v,r,C,e),a&&(Br(h,c,r+e/2),Ec(h,-g),Br(h,-c,-r-e/2)),i.isClosable()&&(R=l?{x:B+C-12,y:r+e-12,width:12,height:12}:{x:B+C-12,y:r+2,width:12,height:12},this.drawCloseIcon(i,h,X,R)),H&&(h.globalAlpha=1),R},drawCloseIcon:function(Z,$,s,r){var H=r.x,S=r.y;$.strokeStyle=s,$.lineWidth=1,$.beginPath(),$.moveTo(H+2,S+8),$.lineTo(H+8,S+2),$.moveTo(H+8,S+8),$.lineTo(H+2,S+2),$.stroke()},getTabAt:function(D){var G=this._interactor._8Q(D);return G?G.tab:null},validateImpl:function(){var b=this;b._24o();var T,p=b._canvas,A=b._tabPosition,U=b._91O,c=b._92O,h=b._tabModel,e=b.getWidth(),u=b.getHeight(),x=b._tabHeight,C=b._7o,o=b._tabGap,Z=A===xo,a=A===tq,P=A===_h,n=A===tq+"-vertical",M=A===_h+"-vertical",O=b._23o,w=0;if((a||P)&&h._roots.each(function(F){w=k(b.getTabWidth(F),w)}),Z?(xq(U,0,0,e,x),T={x:0,y:x,width:e,height:k(0,u-x)}):a?(xq(U,0,0,w,u),T={x:w,y:0,width:k(0,e-w),height:u}):P?(xq(U,e-w,0,w,u),T={x:0,y:0,width:k(0,e-w),height:u}):n?(xq(U,0,0,x,u),T={x:x,y:0,width:k(0,e-x),height:u}):M?(xq(U,e-x,0,x,u),T={x:0,y:0,width:k(0,e-x),height:u}):(xq(U,0,u-x,e,x),T={x:0,y:0,width:e,height:k(0,u-x)}),xq(c,T),n||M){b._9o&&(T.x=0,xq(b._8o.getView(),T)),Ir(p,x,u);var W=df(p),B=0;if(Oc(W,0,b.ty(),1),W.clearRect(0,0,x,u),C.clear(),h._roots.each(function(h){if(h.isVisible()){var G,c=b.getTabWidth(h);if(!O||O.tab!==h){var J=b.getTabBackground(h);G=b.drawTab(W,h,0,B,x,c,J)}C.add({_75o:G,tab:h,startY:B,endY:B+c,height:c}),B+=c+o}}),b._23Q=k(0,B-o),O){var y=O.position;b.drawTab(W,O.tab,0,O.startY,x,O.height,b._moveBackground),qd(W,0,y,x,1,b._insertColor)}if(W.restore(),b._selectionChanged){b._selectionChanged=!1;for(var Y=b.ty(),r=0;r<C.size();r++){var t=C.get(r);if(t.tab===b._8o){if(t.endY+Y<0){b.ty(-t.startY);break}if(t.startY+Y>u){b.ty(u-t.endY);break}}}}b.ty(b.ty())}else if(a||P){b._9o&&(T.x=0,xq(b._8o.getView(),T)),Ir(p,w,u);var W=df(p),B=0;if(Oc(W,0,b.ty(),1),W.clearRect(0,0,w,u),C.clear(),h._roots.each(function(Z){if(Z.isVisible()){var T;if(!O||O.tab!==Z){var k=b.getTabBackground(Z);T=b.drawTab(W,Z,0,B,w,x,k)}C.add({_75o:T,tab:Z,startY:B,endY:B+x,height:x}),B+=x+o}}),b._23Q=k(0,B-o),O){var y=O.position;b.drawTab(W,O.tab,0,O.startY,w,O.height,b._moveBackground),qd(W,0,y,w,1,b._insertColor)}if(W.restore(),b._selectionChanged){b._selectionChanged=!1;for(var Y=b.ty(),r=0;r<C.size();r++){var t=C.get(r);if(t.tab===b._8o){if(t.endY+Y<0){b.ty(-t.startY);break}if(t.startY+Y>u){b.ty(u-t.endY);break}}}}b.ty(b.ty())}else{b._9o&&(T.y=0,xq(b._8o.getView(),T)),Ir(p,e,x);var W=df(p),Q=0;if(Oc(W,b.tx(),0,1),W.clearRect(0,0,e,x),C.clear(),h._roots.each(function(B){if(B.isVisible()){var d,p=b.getTabWidth(B);if(!O||O.tab!==B){var a=b.getTabBackground(B);d=b.drawTab(W,B,Q,0,p,x,a)}C.add({_75o:d,tab:B,startX:Q,endX:Q+p,width:p}),Q+=p+o}}),b._64I=k(0,Q-o),O){var y=O.position;b.drawTab(W,O.tab,O.startX,0,O.width,x,b._moveBackground),fh(W,b._insertColor,y,0,x)}if(W.restore(),b._selectionChanged){b._selectionChanged=!1;for(var m=b.tx(),r=0;r<C.size();r++){var t=C.get(r);if(t.tab===b._8o){if(t.endX+m<0){b.tx(-t.startX);break}if(t.startX+m>e){b.tx(e-t.endX);break}}}}b.tx(b.tx())}for(var d=[],L=c.children,r=0;r<L.length;r++){var s=L[r],v=s._tab_;v&&!h.contains(v)&&d.push(s)}d.forEach(function(Q){c.removeChild(Q)})}});var tt=function(m){this.tv=m,this.addListeners()};sr(tt,U,{ms_listener:1,getView:function(){return this.tv._91O},handle_mousewheel:function(r){this.handleScroll(r,10*(r.wheelDelta/40))},handle_DOMMouseScroll:function(O){this.handleScroll(O,10*-O.detail)},handleScroll:function(t,x){ae(t);var l=this.tv,w=l._tabPosition;!l._40o()||w!==xo&&w!==dc||l.tx(this.tv.tx()+x),!l._41o()||w!==tq&&w!==_h&&w!==tq+"-vertical"&&w!==_h+"-vertical"||l.ty(this.tv.ty()+x)},_8Q:function(T){var K,v,A=this.tv,a=A._tabPosition,G=A._7o;if(a===xo||a===dc){var w=A.lp(T).x;for(K=0;K<G.size();K++)if(v=G.get(K),v.startX<=w&&w<=v.endX)return v}else if(a===tq||a===_h||a===tq+"-vertical"||a===_h+"-vertical"){var L=A.lp(T).y;for(K=0;K<G.size();K++)if(v=G.get(K),v.startY<=L&&L<=v.endY)return v}return h},isClickable:function(e){var z=this.tv,Y=z._tabPosition,B=this._73o=this._8Q(e);return!z._40o()||Y!==xo&&Y!==dc?!z._41o()||Y!==tq&&Y!==_h&&Y!==tq+"-vertical"&&Y!==_h+"-vertical"?B&&(!B.tab.isDisabled()||z.isMovable()):!0:!0},handle_mousemove:function(f){var o=this;Hn?o._74o=o._8Q(f):o.getView().style.cursor=o.isClickable(f)?dh:""},handle_mousedown:function(v){this.handle_mousemove(v),this.handle_touchstart(v)},handle_touchstart:function(i){var C=this,P=C.tv,O=P._tabPosition;ae(i),Yf(i)&&C.isClickable(i)&&(O===xo||O===dc?(C.x=ao(i).x,C.lp=P.lp(i),C.tx=P.tx()):(C.y=ao(i).y,C.lp=P.lp(i),C.ty=P.ty()),Qb(C,i))},handle_mouseup:function(d){this.handle_touchend(d)},handle_touchend:function(i){if(Hq(i)){var U=this._73o;if(!U)return;var p=this.tv,w=p.getTabModel(),J=U.tab;if(!J.isDisabled()&&J.isClosable()){var Y=function(){var N=w._roots.indexOf(J);w.remove(J),p.onTabClosed(J,N)};p.onTabClosing(J,Y)&&Y()}}},handleWindowMouseMove:function(o){this.handleWindowTouchMove(o)},handleWindowTouchMove:function(y){var I,Z=this,W=Z.tv,R=W._tabPosition,r=Z._73o;if(R===xo||R===dc){if(I=ao(y).x-Z.x,!Z._25o&&!Z.moving&&z(I)>2&&(W._40o()&&!mj(y)?Z._25o=1:r&&W.isMovable()&&(Z.moving=1)),Z._25o)W.tx(Z.tx+I);else if(Z.moving){var q=Z.lp.x+I,X=W._tabGap/2;W._7o.each(function(y){var N=y.endX,x=q-y.startX<N-q;q>=y.startX&&N>=q&&W._7Q({tab:r.tab,startX:r.startX+I,width:r.width,front:x,insertTab:y.tab,position:x?k(0,y.startX-X):n(W._64I,N+X)})})}}else if(I=ao(y).y-Z.y,!Z._25o&&!Z.moving&&z(I)>2&&(W._41o()&&!mj(y)?Z._25o=1:r&&W.isMovable()&&(Z.moving=1)),Z._25o)W.ty(Z.ty+I);else if(Z.moving){var w=Z.lp.y+I,X=W._tabGap/2;W._7o.each(function(g){var y=g.endY,L=w-g.startY<y-w;w>=g.startY&&y>=w&&W._7Q({tab:r.tab,startY:r.startY+I,height:r.height,front:L,insertTab:g.tab,position:L?k(0,g.startY-X):n(W._23Q,y+X)})})}},handleWindowMouseUp:function(u){this.handleWindowTouchEnd(u)},handleWindowTouchEnd:function(){var e=this,s=e.tv,x=s._tabPosition,S=s.getTabModel(),$=S._roots,K=e._73o;if(e.moving){var T=s._23o;if(T&&T.insertTab!==T.tab){var O=T.tab,b=$.remove(O),W=$.indexOf(T.insertTab);W>=0&&(T.front||W++,W<=$.size()&&($.add(O,W),S._38I(O,b,W)))}s._7Q(h),delete e.moving}else if(!e._25o&&K){O=K.tab;var G=e._74o;if(!G||G.tab===O)if(!O.isDisabled()&&Uk(K._75o,e.lp)){var v=function(){var L=$.indexOf(O);S.remove(O),s.onTabClosed(O,L)};s.onTabClosing(O,v)&&v()}else O.isDisabled()||s._8o===O||S.sm().ss(O)}e._25o=e._73o=e._74o=x===xo||x===dc?e.x=e.lp=e.tx=h:e.y=e.lp=e.ty=h}}),nt.PropertyView=function(y){var f=this;f._view=eh(1,f),f._canvas=gi(f._view),Bm(f._view,f._79O=Sq()),f._rows=new zc,f._28o=new zc,f._26o={},f._26Q={};var u=f._propertyModel=new Eb,i=f.ivm;u.mm(i,f),u.md(i,f),u.mh(i,f),f.dm(y?y:new Eb),new ut(f)},ot("PropertyView",U,{ms_ac:[Vi,_k,Co,qe,Nf,"categorizable",sd,op,Bg,pm,Og,_p,Sl,cd,"selectRowIndex",Xo,"background",Ce,Mg,dg,Sm,zl],ms_v:1,ms_dm:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,_45o:1,_47o:1,ms_tip:1,_29I:dq,_59I:0,_9I:0,_selectRowIndex:-1,_editable:!0,_batchEditable:!0,_categorizable:!0,_indent:fs,_background:r.propertyViewBackground,_expandIcon:r.propertyViewExpandIcon,_collapseIcon:r.propertyViewCollapseIcon,_scrollBarColor:wi,_scrollBarSize:Fp,_autoHideScrollBar:bk,_selectBackground:r.propertyViewSelectBackground,_rowHeight:Sp,_rowLineVisible:r.propertyViewRowLineVisible,_rowLineColor:r.propertyViewRowLineColor,_10I:.5,_columnLineVisible:r.propertyViewColumnLineVisible,_columnLineColor:r.propertyViewColumnLineColor,_labelColor:r.propertyViewLabelColor,_labelSelectColor:r.propertyViewLabelSelectColor,_labelFont:r.propertyViewLabelFont,getRows:function(){return this._rows},getColumnPosition:function(){return this._10I},setColumnPosition:function(Z){0>Z&&(Z=0),Z>1&&(Z=1);var Q=this,E=Q._10I;Q._10I=Z,Q.fp("columnPosition",E,Z)},getPropertyName:function(H){return H.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(U,D,Q){return Q===this._selectRowIndex?this._labelSelectColor:this._labelColor},getPropertyFont:function(){return this._labelFont},getPropertyColor:function(D,y){return y===this._selectRowIndex?this._labelSelectColor:D.getColor()||this._labelColor},getCategoryFont:function(){return this._labelFont},getCategoryColor:function(){return this._labelColor},adjustTranslateX:function(){return 0},adjustTranslateY:function(Y){var S=this.getHeight()-this._59I;return S>Y&&(Y=S),Y>0?0:i(Y)},isExpanded:function(S){if(!S)return!0;var W=this._26o[S];return W?W.isExpanded:!(this._26Q[S]===!1)},toggle:function(k){var Y=this;Y.isExpanded(k)?Y.collapse(k):Y.expand(k)},expandAll:function(){this.validate();for(var s in this._26o)this.expand(s)},expand:function($){if($&&$!==Ji){var M=this,m=M._26o[$];m&&!m.isExpanded&&(m.isExpanded=!0,M.onExpanded($),M.ivm())}},onExpanded:function(){},collapseAll:function(){this.validate();for(var c in this._26o)this.collapse(c)},collapse:function(D){if(D&&D!==Ji){var T=this,Q=T._26o[D];Q&&Q.isExpanded&&(Q.isExpanded=!1,T.onCollapsed(D),T.ivm())}},onCollapsed:function(){},getCategoryName:function(e){if(!this.isCategorizable())return Ji;var T=e.getCategoryName();return T?T:Ji},getPropertyModel:function(){return this._propertyModel},handleSelectionChange:function(){this.ivm()},setDataModel:function($){var U=this,C=U._dataModel;C!==$&&(C&&(C.umd(U.handlePropertyChange,U),U._selectionModel||C.sm().ums(U.handleSelectionChange,U)),U._dataModel=$,$.md(U.handlePropertyChange,U),U._selectionModel?U._selectionModel._21I($):$.sm().ms(U.handleSelectionChange,U),U.fp(Re,C,$))},isVisible:function(t){return this._visibleFunc?this._visibleFunc(t):!0},onPropertyChanged:function(p){var D=this,y=p.property;it[y]?D.ivm():D.iv(),y===Yb&&D._43o()},getCurrentData:function(){return this._27o},updateCurrentData:function(){this._27o=this.sm().ld()},getRawProperties:function(){return this._27o?this._propertyModel._roots:Yo},handlePropertyChange:function(I){this._27o===I.data&&this.iv()},ivm:function(){this.invalidateModel()},invalidateModel:function(){var L=this;L._96I||(L.setSelectRowIndex(-1),L._96I=1,L.iv())},redraw:function(){this.iv()},validateModel:function(){var o=this,F=o._rows,U=o._28o,h={},Z=new zc,$=o._27o;o.updateCurrentData(),$!==o._27o&&o.endEditing(),F.clear(),U.clear(),o.getRawProperties().each(function(v){if(o.isVisible(v)){Z.add(v);var W=o.getCategoryName(v);h[W]||(U.add(W,W===Ji?0:A),h[W]={isExpanded:o.isExpanded(W),properties:new zc})}}),o._sortFunc&&Z.sort(o._sortFunc);for(var H in o._26o)o._26Q[H]=o.isExpanded(H);o._26o=h,U.each(function(v){v!==Ji&&F.add(v);var W=h[v];W.isExpanded&&Z.each(function(L){o.getCategoryName(L)===v&&(W.properties.add(L),F.add({property:L,data:o._27o}))},o)})},validateImpl:function(){var d=this;d._76o(),d._96I&&(d.validateModel(),delete d._96I);var B=d._canvas,p=d.getWidth(),n=d.getHeight(),u=-d.ty(),j=d._rowHeight,S=d._indent,k=p-S,t=d._rows,C=t.size(),X=d._9I=S+k*d._10I,U=d._59I=C*j;Ir(B,p,n),d._29I={x:0,y:u,width:p,height:n},d._31I=y(u/j),d._14I=N((u+n)/j),d._31I<0&&(d._31I=0),d._14I>C&&(d._14I=C);var J,V=df(B),W=d._background;Oc(V,0,-u,1),V.beginPath(),V.rect(0,u,p,n),V.clip(),V.clearRect(0,u,p,n),d._93db(V),W&&qd(V,0,0,S,U,W);for(var a=d._31I;a<d._14I;a++){var w=t.get(a),u=j*a;if(Pr(w))W&&qd(V,S,u,k,j,W),J=Tj(d.isExpanded(w)?d._expandIcon:d._collapseIcon),J&&ms(V,J,Om,0,u,S,j),V.save(),V.beginPath(),V.rect(S,u,k,j),V.clip(),d.drawCategoryName(V,w,a,S,u,k,j),V.restore();else{var R=w.property,g=w.data,J=Tj(R.getIcon()),H=d._selectRowIndex===a?d.getSelectBackground():h;if(J&&ms(V,J,Om,0,u,S,j),H&&qd(V,S,u,k,j,H),V.save(),V.beginPath(),V.rect(S,u,X-S,j),V.clip(),d.drawPropertyName(V,R,a,S,u,X-S,j),V.restore(),!d.isEditing(g,R)){var A=X+1,M=p-X-1;V.save(),V.beginPath(),V.rect(A,u,M,j),V.clip(),d._87o(d.drawPropertyValue(V,R,d.getValue(g,R),a,A,u,M,j,g),a,A,u,M,j),V.restore()}}d._rowLineVisible&&qd(V,S,u+j-1,k,1,d._rowLineColor)}d._columnLineVisible&&(qd(V,X,0,1,U,d._columnLineColor),qd(V,p-1,0,1,U)),d._92db(V),d._93I(),V.restore(),d.ty(d.ty())},drawCategoryName:function(G,s,J,S,H,$,X){jf(G,s,this.getCategoryFont(s),this.getCategoryColor(s),S,H,$,X)},drawPropertyName:function(C,x,o,D,F,s,v){return x.drawPropertyName?(x.drawPropertyName(C,x,o,D,F,s,v,this),void 0):(jf(C,this.getPropertyName(x),this.getPropertyFont(x,o),this.getPropertyColor(x,o),D,F,s,v),void 0)},drawPropertyValue:function(N,u,F,U,d,J,l,t,s){return u.drawPropertyValue?u.drawPropertyValue(N,u,F,U,d,J,l,t,s,this):(kt(N,F,u,this.getLabelFont(u,F,U),this.getLabelColor(u,F,U),d,J,l,t,s,this),void 0)},isPropertyEditable:function(P){return P.isEditable()&&this.isEditable()},setProperties:function(b){this._propertyModel.clear(),this.addProperties(b)},addProperties:function(y){if(y){var w=this._propertyModel;y.forEach(function(I){if(!(I instanceof rt)){var q=is(I.className);I=Tp(q?q:rt,I)}w.add(I)})}},getRowIndexAt:function(q){var P=this,d=y(P.lp(q).y/P._rowHeight);return d>=0&&d<P._rows.size()?d:-1},getPropertyAt:function(w){var Q=this,I=Q.getRowIndexAt(w);return I>=0?Q._rows.get(I).property:h},getToolTip:function(X){var W=this,y=W.getPropertyAt(X),R=W._27o;return y&&R?y.getToolTip(R,W._9I<W.lp(X).x,W):h}});var ut=function(O){this.pv=O,this.addListeners()};sr(ut,U,{ms_listener:1,getView:function(){return this.pv._view},setCursor:function(J){this.getView().style.cursor=J},clear:function(){var E=this;E._62O=E.cp=E.ty=E.p=h,E.setCursor(Bo)},handle_mousedown:function(j){this.handle_touchstart(j)},handle_touchstart:function(L){var u=this,O=u.pv;ae(L),O.setFocus(L)&&(Yf(L)?(u.cp=ao(L),u.ty=O.ty(),u.p=O.getColumnPosition(),u.handle_touchmove(L)):O.setSelectRowIndex(O.getRowIndexAt(L)))},handleWindowMouseUp:function(){this.clear()},handleWindowTouchEnd:function(){this.clear()},handle_mouseup:function(X){this.handle_touchend(X)},handle_touchend:function(Q){var G=this;if(G.cp&&!G._62O){var q=G.pv,W=q.lp(Q),$=W.x,C=W.y,I=q._indent,P=q.getRowIndexAt(Q),E=q._9I;if(P>=0){var u=q._rowHeight,i=u*P,z=q._rows.get(P),B=z.property;if(Pr(z))Tj(q.isExpanded(z)?q._expandIcon:q._collapseIcon)&&$>=0&&I>=$&&C>=i&&i+u>=C?q.toggle(z):We(Q)&&q.toggle(z);else if($>E&&q.isPropertyEditable(B,Q)){var X={x:E+1,y:i,width:q.getWidth()-E-1,height:u},f={x:X.x+q.tx(),y:X.y+q.ty(),width:X.width,height:X.height},n=0,s=q._29I;X.y<s.y?n=X.y-s.y:X.y+u>s.y+s.height&&(n=X.y+u-s.y-s.height),n&&(q.ty(q.ty()-n),f.y-=n),q.beginEditing({data:z.data,property:B,value:q.getValue(z.data,B),event:Q,rect:X,editorRect:f,view:q})}}q.setSelectRowIndex(P)}G.clear()},handleWindowMouseMove:function(F){this.handleWindowTouchMove(F)},handleWindowTouchMove:function(m){var U=this,h=U.pv,Q=U.ty,q=U.cp,p=ao(m),I=U._62O;if("p"===I)h.setTranslateY(Q+p.y-q.y);else if("c"===I){var d=h.getWidth()-h._indent;if(d>16){var l=U.p-(q.x-p.x)/d,E=16/d;E>l&&(l=E),l>1-E&&(l=1-E),h.setColumnPosition(l)}}else"s"===I&&h.setTranslateY(Q+(q.y-p.y)*h._59I/h._29I.height)},handle_mousemove:function(l){this.handle_touchmove(l)},handle_touchmove:function(H){if(!Hn&&Yf(H)){var Y=this,h=Y.pv,i=z(h.lp(H).x-h._9I)<=(Xq?8:3);Y.cp?Y._62O||(i?(Y._62O="c",Qb(Y,H)):z(ao(H).y-Y.cp.y)>=2&&(Y._62O=Y.isV(H)?"s":"p",Qb(Y,H))):(i?Y.setCursor(cs):Y.setCursor(Bo),Y.isV(H)&&h._43o())}},isV:function(B){var H=this.pv,K=H._29I;return H._41o()&&K.x+K.width-H.lp(B).x<Lg},handle_mousewheel:function(j){this.handleScroll(j,j.wheelDelta/40)},handle_DOMMouseScroll:function(n){2===n.axis&&this.handleScroll(n,-n.detail)},handleScroll:function(d,v){var k=this.pv;ae(d),k.endEditing(),k.translate(0,v*k.getRowHeight())},handle_keydown:function(y){var j=this.pv,o=j._rows.size(),K=j._selectRowIndex+(qo(y)?-1:1);(qo(y)||zj(y))&&(0>K&&(K=0),K>=o&&(K=o-1),j.setSelectRowIndex(K))}}),nt.ListView=function(E){this._5o(E),new vt(this)},ot("ListView",U,{ms_ac:[Vi,_k,Co,Ce,sd,Mg,dg,op,Bg,_p,Sl,cd,Yp,Xo],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,_14Q:1,ms_dm:1,_45o:1,_checkMode:!1,_indent:fs,_rowHeight:Sp,_rowLineVisible:r.listViewRowLineVisible,_rowLineColor:r.listViewRowLineColor,_scrollBarColor:wi,_scrollBarSize:Fp,_autoMakeVisible:Ae,_autoHideScrollBar:bk,_selectBackground:r.listViewSelectBackground,_labelColor:r.listViewLabelColor,_labelSelectColor:r.listViewLabelSelectColor,_labelFont:r.listViewLabelFont,isCheckMode:function(){return this._checkMode
},setCheckMode:function(Y){var W=this,N=W._checkMode;W._checkMode=Y,W.fp(xm,N,Y)},drawRow:function(c,p,Q,N,T,F,f){var C=this,Z=0,G=C._indent,O=C.getIconWidth(p);C.drawRowBackground(c,p,Q,N,T,F,f),C._checkMode&&(ek(c,Tj(C.getCheckIcon(p)),Z+G/2,T+f/2,p,C),Z+=G),C.drawIcon(c,p,Z,T,O,f),C.drawLabel(c,p,Z+O,T,f)}});var vt=function(C){this.list=C,this.addListeners()};sr(vt,U,{ms_listener:1,getView:function(){return this.list._view},clear:function(W){var k=this,e=k.list;W&&"d"===k._62O&&!k.dragCancel&&e.handleDragAndDrop(W,"end"),e.draggingData&&(e.draggingData=null,e.redraw()),k.dragCancel=k._62O=k._isV=k._isH=k.cp=k.tx=k.ty=h},handle_mousedown:function(V){this.handle_touchstart(V)},handle_touchstart:function(n){var E=this,G=E.list;if(ae(n),G.setFocus(n)){var H=G.getDataAt(n);E.cp=ao(n),E.tx=G.tx(),E.ty=G.ty(),Yf(n)?H&&G.handleDragAndDrop&&!E.isV(n)&&!E.isH(n)&&(G.draggingData=H,G.redraw(),G.handleDragAndDrop(n,"prepare")):(H?E._33o(n,H):this._cancelDataDoubleSelect(),E.clear(n))}},handleWindowMouseUp:function(I){this.clear(I)},handleWindowTouchEnd:function(Y){this.clear(Y)},handle_mouseup:function(i){this.handle_touchend(i)},handle_touchend:function(J){var A=this,m=A.list;if(!A._isV&&!A._isH&&A.cp&&!A._62O){var E=m.getDataAt(J);E?(m.isCheckMode()?A._34o(J,E):A._33o(J,E),We(J)?m.onDataDoubleClicked(E,J):m.onDataClicked(E,J)):(A._cancelDataDoubleSelect(),m.handleBackgroundClick(J))}A.clear(J)},handleWindowMouseMove:function(j){this.handleWindowTouchMove(j)},handleWindowTouchMove:function(S){var x=this,o=x.list,I=x._62O,b=x.tx,F=x.ty,C=x.cp,E=ao(S),w=o._29I;"p"===I?o.setTranslate(b+E.x-C.x,F+E.y-C.y):"v"===I?o.ty(F+(C.y-E.y)*o._59I/w.height):"h"===I?o.tx(b+(C.x-E.x)*o._91I/w.width):"d"===I&&(x.dragCancel||o.handleDragAndDrop(S,"between"))},handle_mousemove:function(n){this.handle_touchmove(n)},handle_touchmove:function(X){if(!Hn&&Yf(X)){var J=this,Y=J.list;if(J._isV=J.isV(X),J._isH=J.isH(X),J.cp){if(!J._62O){if(ml(ao(X),J.cp)<2)return;J._isV?J._62O="v":J._isH?J._62O="h":Y.draggingData&&!this.dragCancel?(J._62O="d",Y.handleDragAndDrop(X,"begin")):J._62O="p",J._62O&&"d"!==J._62O&&Y.draggingData&&(Y.draggingData=null,Y.redraw()),Qb(J,X)}}else J._isV&&Y._43o(),J._isH&&Y._42o()}},isV:function(B){var D=this.list,u=D._29I;return D._41o()&&u.x+u.width-D.lp(B).x<Lg},isH:function(C){var Q=this.list,S=Q._29I;return Q._40o()&&S.y+S.height-Q.lp(C).y<Lg},handle_mousewheel:function(F){this.handleScroll(F,F.wheelDelta/40,F.wheelDelta!==F.wheelDeltaX)},handle_DOMMouseScroll:function(L){this.handleScroll(L,-L.detail,1)},handleScroll:function(p,C,y){var b=this.list;ae(p),b.endEditing&&b.endEditing(),y&&b._41o()?b.translate(0,C*b.getRowHeight()):b._40o()&&b.translate(10*C,0)},handle_keydown:function(t){if(!r.isInput(t.target)){var o,Y=this.list,E=Y.sm(),W=Y._rows,s=W.size();if(Mk(t))Y.selectAll();else if(Of(t))Y.handleDelete&&Y.handleDelete(t);else if(Bs(t))"d"!==this._62O||this.dragCancel||(Y.handleDragAndDrop(t,"cancel"),this.dragCancel=!0);else if(ph(t))Y.isCheckMode()&&(o=Y.getFocusData(),o&&Y.checkData(o));else if(qo(t)||zj(t)){var J=Y.isCheckMode();if(o=J?Y.getFocusData():E.ld()){var S=Y.getRowIndex(o);S>=0&&(qo(t)?0!==S&&(o=W.get(S-1),J?Y.setFocusData(o):E.ss(o)):S!==s-1&&(o=W.get(S+1),J?Y.setFocusData(o):E.ss(o)))}else s>0&&(o=W.get(0),J?Y.setFocusData(o):E.ss(o))}}},_34o:function(W,F){var T=this.list,E=T.lp(W).x;return E>=0&&E<=T._indent?(T.checkData(F),void 0):(T.setFocusData(F),void 0)},_33o:function(W,J){var n=this.list,r=n.sm(),h=r.ld();if(!n.canHandleSelectMode(W,J))return this._cancelDataDoubleSelect(),void 0;if(mj(W))n.isSelected(J)?r.rs(J):r.as(J);else if(Fr(W))if(h)for(var B=n.getRowIndex(h),l=n.getRowIndex(J);B!==l;)B+=l>B?1:-1,r.as(n._rows.get(B));else r.ss(J);else Yf(W)?(r.contains(J)?n.handleDataDoubleSelect&&(this._handleDataDoubleSelect(W,J),We(W)&&this._cancelDataDoubleSelect()):this._cancelDataDoubleSelect(),r.ss(J)):r.contains(J)||r.ss(J)},_handleDataDoubleSelect:function(j,D){this._cancelDataDoubleSelect(),this._doubleSelectTimer=gj(function(){this.list.handleDataDoubleSelect(j,D),this._doubleSelectTimer=A}.bind(this),r.doubleClickSpeed)},_cancelDataDoubleSelect:function(){this._doubleSelectTimer&&(Wb(this._doubleSelectTimer),this._doubleSelectTimer=A)}}),nt.TreeView=function(V){var H=this;H._35o(),H._5o(V),new wt(H)},ot("TreeView",U,{ms_ac:[Vi,_k,Co,"rootVisible",xm,"rootData",op,Bg,_p,Sl,cd,sd,Ce,Mg,dg,pm,Og,Yp,Xo,"loader","doubleClickToToggle"],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,_48o:1,_14Q:1,_45o:1,_checkMode:h,_indent:fs,_rowHeight:Sp,_rowLineVisible:r.treeViewRowLineVisible,_rowLineColor:r.treeViewRowLineColor,_scrollBarColor:wi,_scrollBarSize:Fp,_autoHideScrollBar:bk,_expandIcon:r.treeViewExpandIcon,_collapseIcon:r.treeViewCollapseIcon,_autoMakeVisible:Ae,_selectBackground:r.treeViewSelectBackground,_labelColor:r.treeViewLabelColor,_labelSelectColor:r.treeViewLabelSelectColor,_labelFont:r.treeViewLabelFont,_doubleClickToToggle:r.treeViewDoubleClickToToggle,drawRow:function($,H,l,E,M,X,i){var O=this;O.drawRowBackground($,H,l,E,M,X,i),O.drawTree($,H,l,0,M,X,i)},isOnToggleIcon:function(j){var Z=this.getDataAt(j);if(Z){var Y=this.getIndent(),h=this.lp(j).x;if(Tj(this.getToggleIcon(Z))){var n=Y*this.getLevel(Z);if(h>=n&&n+Y>=h)return!0}}return!1}});var wt=function(U){oc(wt,this,[U])};sr(wt,vt,{toggle:function(Z,g,k,d){var V=this.list,F=V.lp(Z).x;if(Tj(V.getToggleIcon(g))){var K=k*d;if(F>=K&&K+k>=F)return V.toggle(g),!0}return V.isDoubleClickToToggle()&&We(Z)?(V.toggle(g),!0):!1},_34o:function(H,A){var y=this.list,k=y.lp(H).x,r=y._levelMap[A._id],E=y._indent,c=E*(r+1);return k>=c&&c+E>=k?(y.checkData(A),void 0):(this.toggle(H,A,E,r)||y.setFocusData(A),void 0)},_33o:function(k,S){var W=this,v=W.list;if(!W.toggle(k,S,v._indent,v.getLevel(S)))if(Fr(k)){var J=v.sm();if(J.size()>0){for(var q=v._rows,H=null,s=0,j=q.size();j>s;s++)if(v.isSelected(q.get(s))){H=s;break}for(var G=null,s=q.size()-1;s>=0;s--)if(v.isSelected(q.get(s))){G=s;break}var r,B,e=v.getRowIndex(S);for(H>e?(r=e-1,B=H):e>G?(r=G,B=e):(r=H,B=G);r!==B;)r++,J.as(v._rows.get(r))}else J.ss(S)}else wt.superClass._33o.call(W,k,S)},handle_keydown:function(F){if(oo(F)||Qm(F)){var X=this.list,w=X._rows,i=X.isCheckMode(),L=X.sm(),d=i?X.getFocusData():L.ld();d?d.hasChildren()&&(oo(F)?X.collapse(d):X.expand(d)):w.size()>0&&(d=w.get(0),i?X.setFocusData(d):L.ss(d))}else wt.superClass.handle_keydown.call(this,F)}});var xt=nt.TableView=function(y){this._98I(),this._5o(y),new yt(this)};ot("TableView",U,{ms_ac:[Vi,_k,Co,"sortMode",qe,Nf,Ce,Mg,dg,Sm,zl,"sortColumn",op,Bg,_p,Sl,cd,Yp,Xo],ms_v:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_45o:1,_47o:1,_sortMode:Fq,_editable:!0,_batchEditable:!1,_rowHeight:Sp,_rowLineVisible:r.tableViewRowLineVisible,_rowLineColor:r.tableViewRowLineColor,_columnLineVisible:r.tableViewColumnLineVisible,_columnLineColor:r.tableViewColumnLineColor,_scrollBarColor:wi,_scrollBarSize:Fp,_autoHideScrollBar:bk,_autoMakeVisible:Ae,_selectBackground:r.tableViewSelectBackground,_labelColor:r.tableViewLabelColor,_labelSelectColor:r.tableViewLabelSelectColor,_labelFont:r.tableViewLabelFont,getCheckColumn:function(){var q=this;if(!q._31o){var B=q._31o=new qt;B.setEditable(!0),B.setWidth(40),B.getValue=q.getCheckColumValue,B.drawCell=q.drawCheckColumnCell}return q._31o},isCheckMode:function(){return this._39o.contains(this._31o)},setCheckMode:function(b){var P=this,t=P._39o,X=P.getCheckColumn();b!==P.isCheckMode()&&(b?t.add(X,0):t.remove(X),P.fp(xm,!b,b))},getCheckColumValue:function(K,y,v){return v.isSelected(K)},drawCheckColumnCell:function(S,u,E,h,X,_,x,s,m){ek(S,m.getCheckIcon(u),X+x/2,_+s/2,u,m)}});var yt=function(C){oc(yt,this,[C])};sr(yt,vt,{_34o:function(_,I){var g=this.list,c=g._31o;if(g.isCellEditable(I,c,_)){var j=g._3Q(c),N=g.lp(_).x;if(j&&N>=j.startX&&N<j.startX+c.getWidth())return g.checkData(I),void 0}g._37O(I,_),g.setFocusData(I)},_33o:function(h,z){this.list._37O(z,h),yt.superClass._33o.apply(this,arguments)}});var zt=nt.TreeTableView=function(y){var o=this,d=o._4o=new qt;o._35o(),o._98I(),o._5o(y),d.setDisplayName("Name"),d.setEditable(!0),d.setWidth(180),d.drawCell=At,d.getValue=Bt,o._39o.add(d),new Ct(o)},At=function(Q,v,A,X,B,l,w,R,Z){Z.drawTree(Q,v,A,B,l,w,R)},Bt=function(j,h,d){return d.getLabel(j)};ot("TreeTableView",U,{ms_ac:[Vi,_k,Co,"sortMode",qe,Nf,sd,xm,"rootData","rootVisible",op,Bg,"sortColumn",pm,Og,_p,Sl,cd,Yp,dg,Ce,Mg,Sm,zl,Xo,"loader"],ms_v:1,ms_bnb:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_48o:1,_14Q:1,_45o:1,_47o:1,_sortMode:Fq,_checkMode:h,_editable:!0,_batchEditable:!1,_indent:fs,_rowHeight:Sp,_rowLineVisible:r.treeTableViewRowLineVisible,_rowLineColor:r.treeTableViewRowLineColor,_columnLineVisible:r.treeTableViewColumnLineVisible,_columnLineColor:r.treeTableViewColumnLineColor,_expandIcon:r.treeTableViewExpandIcon,_collapseIcon:r.treeTableViewCollapseIcon,_scrollBarColor:wi,_scrollBarSize:Fp,_autoHideScrollBar:bk,_autoMakeVisible:Ae,_selectBackground:r.treeTableViewSelectBackground,_labelColor:r.treeTableViewLabelColor,_labelSelectColor:r.treeTableViewLabelSelectColor,_labelFont:r.treeTableViewLabelFont,getTreeColumn:function(){return this._4o}});var Ct=function(H){oc(Ct,this,[H])};sr(Ct,vt,{_34o:function(n,m){var r=this.list,D=r._4o,z=r._3Q(D),U=r.lp(n).x;if(z){var K=r._indent,f=z.startX+K*r.getLevel(m);if(Tj(r.getToggleIcon(m))&&U>=f&&f+K>=U)return r.toggle(m),void 0;if(r.isCellEditable(m,D)&&(f+=K,U>=f&&f+K>=U))return r.checkData(m),void 0}r._37O(m,n),r.setFocusData(m)},_33o:function(p,O){var m=this.list,r=m.lp(p).x;if(Tj(m.getToggleIcon(O))){var i=m._3Q(m._4o);if(i){var E=m._indent,U=i.startX+E*m.getLevel(O);if(r>=U&&U+E>=r)return m.toggle(O),void 0}}m._37O(O,p),Ct.superClass._33o.apply(this,arguments)}});var Dt=nt.TableHeader=function(B){var I=this,R=I._view=eh(1,I),W=I._39o=B.getColumnModel(),e=I.iv;I.tv=I._tableView=B,I._60I=new zc,I._canvas=gi(R),R.style.background=r.tableHeaderBackground||"",R.style.height=Yc+Fj,W.mm(e,I),W.md(e,I),W.mh(e,I),B.mp(function(M){et[M.property]&&I.iv()},I),new Et(I),I.iv()};ot("TableHeader",U,{ms_v:1,ms_lp:1,ms_fire:1,ms_ac:["checkIcon","sortDescIcon","sortAscIcon",Vi,Co,sd,"moveBackground","insertColor",Sm,zl,"resizable","movable"],_checkIcon:Wm,_movable:!0,_resizable:!0,_labelColor:r.tableHeaderLabelColor,_labelFont:r.tableHeaderLabelFont,_columnLineColor:r.tableHeaderColumnLineColor,_columnLineVisible:r.tableHeaderColumnLineVisible,_sortDescIcon:r.tableHeaderSortDescIcon,_sortAscIcon:r.tableHeaderSortAscIcon,_moveBackground:r.tableHeaderMoveBackground,_insertColor:r.tableHeaderInsertColor,_indent:fs,getCheckIcon:function(){return this._checkIcon},getTableView:function(){return this.tv},getLabel:function(e){return e.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(n){return n.getColor()||this._labelColor},getLabelAlign:function(W){return W._align},onPropertyChanged:function(){this.iv()},_5Q:function(k){this._61I=k,this.iv()},getLogicalPoint:function(J){return Ge(J,this._canvas,this.tv.tx())},validateImpl:function(){var m=this,C=m._canvas,N=m.getWidth(),P=m.getHeight(),y=m.tv,h=m._60I,g=m._61I,o=-y.tx(),V=0;(N!==C.clientWidth||P!==C.clientHeight)&&Ir(C,N,P),h.clear(),m._39o._roots.each(function(i){if(i.isVisible()){var $=V+i.getWidth();o+N>=V&&$>=o&&h.add({column:i,startX:V}),V=$}});var u=df(C);if(Oc(u,-o,0,1),u.beginPath(),u.rect(o,0,N,P),u.clip(),u.clearRect(o,0,N,P),h.each(function(I){var Z=I.column,o=I.startX,X=Z.getWidth();X>0&&(u.save(),u.beginPath(),u.rect(o,0,X,P),u.clip(),g&&g.column===Z||m.drawColumn(u,Z,o,0,X,P),m._columnLineVisible&&qd(u,o+X-1,0,1,P,m._columnLineColor),u.restore())}),g){var O=g.column,V=g.startX,Z=g.position,q=O.getWidth();u.save(),u.beginPath(),u.rect(V,0,q,P),u.clip(),u.fillStyle=m._moveBackground,u.fill(),m.drawColumn(u,O,V,0,q,P),u.restore(),fh(u,m._insertColor,Z,0,P)}u.restore()},_6Q:function(T){var O=this.tv;return O._31o===T&&O.sm().getSelectionMode()===dl},drawColumn:function(c,F,n,N,C,y){var v=this,h=v.tv,P=Tj(F.getIcon()),_=v.getLabelAlign(F);if(v._6Q(F)){var q=Tj(v._checkIcon);ek(c,q,n+C/2,N+y/2,F,v)}else{var e=v.getLabel(F),D=v.getLabelFont(F),w=v.getLabelColor(F),g=Ne(D,e).width,Z=P?v._indent:0;_===tq?(P&&ms(c,P,Om,n,N,Z,y),jf(c,e,D,w,n+Z,N,C,y,tq)):_===_h?(P&&ms(c,P,Om,n+C-g-Z,N,Z,y),jf(c,e,D,w,n,N,C,y,_h)):(P&&ms(c,P,Om,n+(C-g-Z)/2,N,Z,y),jf(c,e,D,w,n+(C-g+Z)/2,N,0,y,tq))}if(F.isSortable()&&h.getSortColumn()===F&&(P=Tj(F.getSortOrder()===zr?v._sortAscIcon:v._sortDescIcon))){var L=Xf(P,F)/2+2;ek(c,P,_===_h?n+L:n+C-L,N+y/2,F,h)}}});var Et=function(c){var v=this;v.th=c,v.tv=c._tableView,v.addListeners()};sr(Et,U,{ms_listener:1,getView:function(){return this.th.getView()},setCursor:function(X){this.getView().style.cursor=X},handle_mousemove:function(s){if(!Hn){var p=this;delete p._29o,p.setCursor(Bo);for(var S=p.th,Y=S._60I,J=S.lp(s).x,T=Y.size()-1;T>=0;T--){var v=Y.get(T),A=v.column,X=v.startX+A.getWidth();if(S.isResizable()&&z(X-J)<=(Xq?10:3))return p._29o=v,p.setCursor(cs),void 0;J>v.startX&&X>J&&(p._29o=v),(A.isClickable()||A.isSortable()||S.isMovable()||p.tv.getCheckColumn&&A===p.tv.getCheckColumn())&&J>v.startX&&X>J&&p.setCursor(dh)}}},handle_mousedown:function(G){this.handle_touchstart(G)},handle_touchstart:function(G){var T=this;ae(G),T.tv.endEditing(),T.handle_mousemove(G),T._29o&&(T.x=ao(G).x,T.lx=T.th.lp(G).x,T.w=T._29o.column.getWidth(),Qb(T,G))},handleWindowMouseMove:function(I){this.handleWindowTouchMove(I)},handleWindowTouchMove:function(X){var i=this,c=i.th,R=i.getView().style.cursor,J=i._29o,j=ao(X).x-i.x;if(i.resizing||i.moving||(R===cs?i.resizing=1:c.isMovable()&&R===dh&&z(j)>2&&(i.moving=1)),i.resizing)J.column.setWidth(i.w+j);else if(i.moving){var F=i.lx+j;c._60I.each(function(h){var Z=h.startX,H=Z+h.column.getWidth();if(F>=Z&&H>=F){var P={column:J.column,startX:J.startX+j,front:H-F>F-Z,insertColumn:h.column};P.position=P.front?Z:H,c._5Q(P)}})}},_16Q:function(j,A){var f=this,M=f.tv,a=f.th,P=a._checkIcon;if(a._6Q(j)){var c=Tj(P),N=f.lx,m=j.getWidth(),k=Xf(c,j);if(N>=A+m/2-k&&A+m/2+k>=N){a.setCheckIcon(P===Mc?Wm:Mc);var S=M.sm(),l=M._rows;return P===Mc?S.rs(l):S.ss(l),M.onCheckColumnClicked(j),!0}}return!1},handleWindowMouseUp:function(W){this.handleWindowTouchEnd(W)},handleWindowTouchEnd:function(C){var l=this,i=l.tv,Z=l.th,L=l._29o;if(l.moving){var Y=Z._61I;if(Y&&Y.insertColumn!==Y.column){var E=Y.column,J=i.getColumnModel()._roots,Q=J.remove(E),b=J.indexOf(Y.insertColumn);b>=0&&(Y.front||b++,b<=J.size()&&(J.add(E,b),i.getColumnModel()._38I(E,Q,b)))}Z._5Q(h),delete l.moving}else if(!l.resizing&&L){E=L.column;var S=Z.lp(C).x,p=L.startX,P=!0;if(Z.onColumnClicked){var I=Z.onColumnClicked(E,C,p);I===!1&&(P=!1)}if(P&&S>=p&&S<=p+E.getWidth()&&!l._16Q(E,p)){if(E.isSortable()){var O=i.getSortMode(),s=E.getSortOrder();O===Fq?i.getSortColumn()===E?(s===un&&i.setSortColumn(h),E.setSortOrder(s===zr?un:zr)):i.setSortColumn(E):"bistate"===O&&(i.getSortColumn()===E?E.setSortOrder(s===zr?un:zr):i.setSortColumn(E))}i.onColumnClicked(E,C,p)}}l._29o=l.resizing=l.x=l.lx=l.w=h}}),nt.TablePane=function(M){this.init(new xt(M))},ot("TablePane",U,{ms_v:1,_44o:1}),nt.TreeTablePane=function(l){this.init(new zt(l))},ot("TreeTablePane",U,{ms_v:1,_44o:1}),nt.Toolbar=function(z){var x=this,l=x._view=eh(1,x),F=l.style;F.background=r.toolbarBackground||"",F.height=To+Fj,x._canvas=gi(l),x._30o=new zc,x._90I=new zc,x.setItems(z||[]),l.handleGroupSelectedChanged=function(q){if(q.isSelected()){var c=q.getGroupId();null!=c&&x._items.forEach(function(x){var Y=x.element;Y&&Y!==q&&Y.setSelected&&Y.getGroupId&&Y.getGroupId()===c&&Y.setSelected(!1)})}},new Ft(x)},ot("Toolbar",U,{ms_v:1,ms_fire:1,ms_tx:1,ms_lp:1,ms_tip:1,ms_value:1,ms_ac:[ds,Vi,Co,_k,Xo,"itemGap","separatorColor","currentItem","stickToRight"],_labelColor:r.toolbarLabelColor,_labelSelectColor:r.toolbarLabelSelectColor,_labelFont:r.toolbarLabelFont,_selectBackground:r.toolbarSelectBackground,_itemGap:r.toolbarItemGap,_separatorColor:r.toolbarSeparatorColor,_stickToRight:!1,getSumWidth:function(){return this._64I},getToolTip:function(l){var J=this.getItemInfoAt(l);return J?J.item.toolTip:h},getLabelColor:function(V){return V&&V.selected&&V.type!==Mc&&V.type!==jn?this._labelSelectColor:this._labelColor},onPropertyChanged:function(d){this.iv(),d.property===ds&&this._items.forEach(function(P){os(P)})},redraw:function(){this.iv()},addItem:function(K,T){var H=this._items;T==h?H.push(K):H.splice(T,0,K),this.fp(ds,h,H)},removeItem:function(D){if(D)for(var N=this._items,O=0;O<N.length;O++)D===N[O]&&(N.splice(O,1),this.fp(ds,h,N))},removeItemById:function($){if($!=h)for(var P=this._items,R=0;R<P.length;R++)if($===P[R].id){var M=P.splice(R,1)[0];return this.fp(ds,h,P),M}},getItemById:function($){if($!=h)for(var e=this._items,L=0;L<e.length;L++){var U=e[L];if($===U.id)return U}},setItemVisible:function($,q){var k=this.getItemById($);k&&(k.visible=q)},getItemInfos:function(){return this._30o},getItemInfoAt:function(R){var K=this,a=0,B=K._30o,n=K.lp(R),U=n.x,l=n.y;if(l>=0&&l<=K.getHeight())for(;a<B.size();a++){var D=B.get(a);if(D.startX<=U&&U<=D.endX)return D}return h},drawItem:function(B,U,m,F,A){if(U.visible===!1)return 0;if(Il(U.visible)&&!U.visible())return 0;var W=this,$=U.disabled;$&&(B.globalAlpha=sb);var d=W.drawItemImpl(B,U,m,F,A),u=W._itemGap;return $&&(B.globalAlpha=1),this._currentItem!==U||"separator"===U||U.separator===!0||U.unfocusable||wh(B,W._separatorColor,m-u/2,0,d+u,F),d},drawItemImpl:function(X,i,p,E,B){var f=this,L=f._view,w=f._itemGap,P=E/2,V=i.type,u=i.element,z=i.label;Pr(u)&&(z=u,u=h);var c,$=f.getLabelFont(i),T=f.getLabelColor(i),R=i.selected,x=Tj(i.icon),b=Xf(x,i),d=0,C=b+(z?Ne($,z).width:0);if("separator"===i||i.separator===!0)return fh(X,f._separatorColor,p,E/4,P),1;if(u){x&&ek(X,x,p+b/2,P,i,f),jf(X,z,$,T,p+b,0,0,E);var Z=sm(u);B||f._90I.add(Z),Z.parentNode!==L&&Bm(L,Z),u.iv&&u.iv(),u.validate&&u.validate();var k=Z.getBoundingClientRect(),a=k.width,Q=Z.style;return _r(Z),Q.left=f.tx()+p+C+Fj,Q.top=(E-k.height)/2+Fj,C+a}return V===jn?c=Tj(R?Yj:ld):V===Mc&&(c=Tj(R?Mc:Wm)),c?(d=Xf(c,i),ek(X,c,p+d/2,P,i,f),p+=d,C+=d):R&&qd(X,p-w/2,0,C+w,E,f.getSelectBackground(i)),x&&ek(X,x,p+b/2,P,i,f),jf(X,z,$,T,p+b,0,0,E),C},validateImpl:function(){var g=this,O=g._canvas,L=g.getWidth(),h=g.getHeight(),r=g._30o,P=g._items;Ir(O,L,h);var T=df(O),H=g._itemGap,M=H/2;Oc(T,g.tx(),0,1),T.clearRect(0,0,L,h);var x=g._90I;g._90I=new zc,r.clear(),P.forEach(function(Q){var F=g.drawItem(T,Q,M,h);r.add({item:Q,startX:M,endX:M+F,width:F}),F&&(M+=F+H)}),x.each(function(y){g._90I.contains(y)||fo(y)});var u=g._64I;g._64I=k(0,M-H/2),T.restore(),g._stickToRight?(g._65O=0,T=df(O),M=L-g._64I+H/2,Oc(T,0,0,1),T.clearRect(0,0,L,h),r.clear(),P.forEach(function(x){var v=g.drawItem(T,x,M,h,!0);r.add({item:x,startX:M,endX:M+v,width:v}),v&&(M+=v+H)}),T.restore()):g.tx(g.tx()),u!==g._64I&&g.onSumWidthChanged(u,g._64I)},onSumWidthChanged:function(){},handleClick:function(Q,w){var b=this,g=Q.type,e=Q.action,x=Q.groupId,r=Q.selected;Q.disabled||(x!=h?r||(Q.selected=!0,this._items.forEach(function(J){J.groupId===x&&Q!==J&&(J.selected=!1)}),e&&Q.action(Q,b,w)):g===Mc||"toggle"===g?(Q.selected=!r,e&&Q.action(Q,b,w)):e&&Q.action(Q,b,w)),pp(),b.iv()}});var Ft=function(A){this.tb=A,this.addListeners()};sr(Ft,U,{ms_listener:1,getView:function(){return this.tb._view},handle_mousewheel:function(Y){this.handleScroll(Y,10*(Y.wheelDelta/40))},handle_DOMMouseScroll:function(Z){this.handleScroll(Z,10*-Z.detail)},handleScroll:function(T,P){ae(T);var h=this.tb;h.isScrollable()&&!h._stickToRight&&(h.tx(h.tx()+P),Or())},handle_mousemove:function(p){var U=this;Hn||U.setItem(p)},handle_mouseout:function(u){var a=this;u.target===a.getView()?a.tb.setCurrentItem(h):a.handle_mousemove(u)},handle_mousedown:function(V){this.handle_mousemove(V),this.handle_touchstart(V)},handle_touchstart:function(o){var y=this,n=y.tb,S=o.target;Yf(o)&&(S===y.getView()||S===n._canvas)&&(ae(o),n.setFocus(o)&&(this.setItem(o,!0),(n.isScrollable()||y.info&&!y.info.item.disabled)&&(y.x=ao(o).x,y.tx=n.tx(),Qb(y,o))))},handleWindowMouseMove:function(o){this.handleWindowTouchMove(o)},handleWindowTouchMove:function(L){var i=this,G=i.tb;if(!G._stickToRight){var c=ao(L).x-i.x;!i._25o&&z(c)>2&&G.isScrollable()&&(i._25o=1),i._25o&&G.tx(i.tx+c)}},handleWindowMouseUp:function(O){this.handleWindowTouchEnd(O)},handleWindowTouchEnd:function(J){var M=this,p=M.tb,f=M.info,X=M.tb.getItemInfoAt(J);if(!M._25o&&f){var Y=f.item;X&&X.item===Y&&p.handleClick(Y,J)}M._25o=M.x=M.tx=h,M.setItem()},setItem:function(u,B){var Q=this,j=Q.tb,c=Q.info=u?j.getItemInfoAt(u):h,g=c?c.item:h;j.setCurrentItem(g),B&&g&&Il(g.onDown)&&g.onDown(u)}}),nt.BorderPane=function(){this._view=eh(1,this),this.iv()},ot("BorderPane",U,{ms_v:1,ms_ac:["topHeight","bottomHeight","leftWidth","rightWidth"],ms_fire:1,getLeftView:function(){return this._leftView},setLeftView:function(X,v){this._12o("leftView",X),v!=h&&this.setLeftWidth(v)},getRightView:function(){return this._rightView},setRightView:function(N,i){this._12o("rightView",N),i!=h&&this.setRightWidth(i)},getTopView:function(){return this._topView},setTopView:function(m,J){this._12o("topView",m),J!=h&&this.setTopHeight(J)},getBottomView:function(){return this._bottomView},setBottomView:function(u,H){this._12o("bottomView",u),H!=h&&this.setBottomHeight(H)},getCenterView:function(){return this._centerView},setCenterView:function(g){this._12o("centerView",g)},_12o:function(d,U){var g=this,Y="_"+d,T=g._view,X=g[Y];X!==U&&(X&&(X.getView?fo(X.getView()):fo(X)),g[Y]=U,U&&(U.getView?Bm(T,U.getView(),1):Bm(T,U,1)),g.fp(d,X,U))},onPropertyChanged:function(){this.iv()},validateImpl:function(){var a=this,e=a._topView,z=a._bottomView,O=a._leftView,o=a._rightView,f=a._centerView,t=a.getWidth(),D=a.getHeight(),L=0,d=0,r=t,J=D,Z=0,G=0,x=0,j=0;e&&(Z=a._topHeight==h?lr(e):a._topHeight,d=Z),z&&(G=a._bottomHeight==h?lr(z):a._bottomHeight,J=D-G),O&&(x=a._leftWidth==h?Ep(O):a._leftWidth,L=x),o&&(j=a._rightWidth==h?Ep(o):a._rightWidth,r=t-j);var c=k(0,r-L),m=k(0,J-d);e&&xq(e,0,0,t,Z),z&&xq(z,0,J,t,G),O&&xq(O,0,d,x,m),o&&xq(o,r,d,j,m),f&&xq(f,L,d,c,m)}})}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);
